exports.id=194,exports.ids=[194],exports.modules={9890:e=>{"use strict";e.exports={}},6395:e=>{"use strict";e.exports=JSON.parse('{"Diagnostic":{"annotatedParamCountMismatch":"Parameter annotation count mismatch: expected {expected} but received {received}","annotatedTypeArgMissing":"Expected at least one type argument after \\"Annotated\\"","annotationFormatString":"Type annotations cannot use format string literals (f-strings)","annotationNotSupported":"Type annotation not supported for this type of expression","annotationSpansStrings":"Type annotations cannot span multiple string literals","annotationStringEscape":"Type annotations cannot contain escape characters","annotationTripleQuote":"Type annotations cannot use triple quotes","argAssignment":"Argument of type \\"{argType}\\" cannot be assigned to parameter of type \\"{paramType}\\"","argAssignmentFunction":"Argument of type \\"{argType}\\" cannot be assigned to parameter of type \\"{paramType}\\" in function \\"{functionName}\\"","argAssignmentParam":"Argument of type \\"{argType}\\" cannot be assigned to parameter \\"{paramName}\\" of type \\"{paramType}\\"","argAssignmentParamFunction":"Argument of type \\"{argType}\\" cannot be assigned to parameter \\"{paramName}\\" of type \\"{paramType}\\" in function \\"{functionName}\\"","argMissingForParam":"Argument missing for parameter {name}","argMissingForParams":"Arguments missing for parameters {names}","argPositional":"Expected positional argument","argPositionalExpectedCount":"Expected {expected} positional arguments","argPositionalExpectedOne":"Expected 1 positional argument","argTypePartiallyUnknown":"Argument type is partially unknown","argTypeUnknown":"Argument type is unknown","assertAlwaysTrue":"Assert expression always evaluates to true","assignmentExprContext":"Assignment expression must be within module, function or lambda","assignmentExprComprehension":"Assignment expression target \\"{name}\\" cannot use same name as comprehension for target","assignmentInProtocol":"Assignment to instance or class variables not allowed within a Protocol class","assignmentTargetExpr":"Expression cannot be assignment target","awaitIllegal":"Use of \\"await\\" requires Python 3.5 or newer","awaitNotInAsync":"\\"await\\" allowed only within async function","backticksIllegal":"Expressions surrounded by backticks are not supported in Python 3.x; use repr instead","baseClassCircular":"Class cannot derive from itself","baseClassFinal":"Base class \\"{type}\\" is marked final and cannot be subclassed","baseClassInvalid":"Argument to class must be a base class","baseClassUnknown":"Base class type is unknown, obscuring type of derived class","bindTypeMismatch":"Could not bind method \\"{methodName}\\" because \\"{type}\\" is not assignable to parameter \\"{paramName}\\"","breakOutsideLoop":"\\"break\\" can be used only within a loop","callableExtraArgs":"Expected only two type arguments to \\"Callable\\"","callableFirstArg":"Expected parameter type list or \\"...\\"","classDecoratorTypeUnknown":"Untyped class decorator obscures type of class; ignoring decorator","classGetItemClsParam":"__class_getitem__ override should take a \\"cls\\" parameter","classMethodClsParam":"Class methods should take a \\"cls\\" parameter","classNotRuntimeSubscriptable":"Subscript for class \\"{name}\\" will generate runtime exception; enclose type annotation in quotes","classVarFirstArgMissing":"Expected a type argument after \\"ClassVar\\"","classVarTooManyArgs":"Expected only one type argument after \\"ClassVar\\"","comprehensionInDict":"Comprehension cannot be used with other dictionary entries","comprehensionInSet":"Comprehension cannot be used with other set entries","concatenateParamSpecMissing":"Last type argument for \\"Concatenate\\" must be a ParamSpec","concatenateTypeArgsMissing":"\\"Concatenate\\" requires at least two type arguments","constantRedefinition":"\\"{name}\\" is constant and cannot be redefined","continueInFinally":"\\"continue\\" cannot be used within a finally clause","continueOutsideLoop":"\\"continue\\" can be used only within a loop","constructorNoArgs":"Expected no arguments to \\"{type}\\" constructor","dataClassFieldWithDefault":"Data class fields without default value cannot appear after data fields with default values","declaredReturnTypePartiallyUnknown":"Declared return type, \\"{returnType}\\", is partially unknown","declaredReturnTypeUnknown":"Declared return type is unknown","defaultValueContainsCall":"Function calls within default value initializer are not permitted","defaultValueNotAllowed":"Parameter with \\"*\\" or \\"**\\" cannot have default value","defaultValueNotEllipsis":"Default values in stub files should be specified as \\"...\\"","delTargetExpr":"Expression cannot be deleted","dictExpandIllegalInComprehension":"Dictionary expansion not allowed in comprehension","dictInAnnotation":"Dictionary expression not allowed in type annotation","dictKeyValuePairs":"Dictionary entries must contain key/value pairs","duplicateArgsParam":"Only one \\"*\\" parameter is allowed","duplicateBaseClass":"Duplicate base class is not allowed","duplicateCatchAll":"Only one catch-all except clause is allowed","duplicateImport":"\\"{importName}\\" is imported more than once","duplicateKwargsParam":"Only one \\"**\\" parameter is allowed","duplicateNameOnly":"Only one \\"*\\" separator is allowed","duplicateParam":"Duplicate parameter \\"{name}\\"","duplicatePositionOnly":"Only one \\"/\\" parameter is allowed","duplicateUnpack":"Only one unpack operation allowed in list","ellipsisContext":"\\"...\\" not allowed in this context","ellipsisSecondArg":"\\"...\\" allowed only as the second of two arguments","exceptionTypeIncorrect":"\\"{type}\\" does not derive from BaseException","exceptionTypeNotClass":"\\"{type}\\" is not valid exception class","exceptionTypeNotInstantiable":"Constructor for exception type \\"{type}\\" requires one or more arguments","expectedAfterDecorator":"Expected function or class declaration after decorator","expectedArrow":"Expected \\"->\\" followed by return type annotation","expectedAsAfterException":"Expected \\"as\\" after exception type","expectedAssignRightHandExpr":"Expected expression to the right of \\"=\\"","expectedBinaryRightHandExpr":"Expected expression to the right of operator","expectedBoolLiteral":"Expected True or False","expectedClassName":"Expected class name","expectedCloseBrace":"Expected \\"}\\"","expectedCloseBracket":"Expected \\"]\\"","expectedCloseParen":"Expected \\")\\"","expectedColon":"Expected \\":\\"","expectedDecoratorExpr":"Expression form not supported for decorator prior to Python 3.9","expectedDecoratorName":"Expected decorator name","expectedDecoratorNewline":"Expected new line at end of decorator","expectedDelExpr":"Expected expression after \\"del\\"","expectedElse":"Expected \\"else\\"","expectedExceptionClass":"Invalid exception class or object","expectedExceptionObj":"Expected exception object or None","expectedExpr":"Expected expression","expectedIdentifier":"Expected identifier","expectedImport":"Expected \\"import\\"","expectedImportAlias":"Expected symbol after \\"as\\"","expectedImportSymbols":"Expected one or more symbol names after import","expectedIndentedBlock":"Expected indented block","expectedInExpr":"Expected expression after \\"in\\"","expectedIn":"Expected \\"in\\"","expectedFunctionAfterAsync":"Expected function definition after \\"async\\"","expectedFunctionName":"Expected function name after \\"def\\"","expectedMemberName":"Expected member name after \\".\\"","expectedModuleName":"Expected module name","expectedNameAfterAs":"Expected symbol name after \\"as\\"","expectedNamedArgument":"Named argument must follow \\"*\\"","expectedNewlineOrSemicolon":"Statements must be separated by newlines or semicolons","expectedOpenParen":"Expected \\"(\\"","expectedParamName":"Expected parameter name","expectedReturnExpr":"Expected expression after \\"return\\"","expectedSliceIndex":"Expected index or slice expression","expectedTypeNotString":"Expected type but received a string literal","expectedYieldExpr":"Expected expression in yield statement","finalContext":"\\"Final\\" is not allowed in this context","finalMethodOverride":"Method \\"{name}\\" cannot override final method defined in class \\"{className}\\"","finalReassigned":"\\"{name}\\" is declared as Final and cannot be reassigned","finalRedeclaration":"\\"{name}\\" was previously declared as Final","finalRedeclarationBySubclass":"\\"{name}\\" cannot be redeclared because parent class \\"{className}\\" declares it as Final","finalTooManyArgs":"Expected a single type argument after \\"Final\\"","finalUnassigned":"\\"{name}\\" is declared Final, but value is not assigned","formatStringBrace":"Single close brace not allowed within f-string literal; use double close brace","formatStringBytes":"Format string literals (f-strings) cannot be binary","formatStringEscape":"Escape sequence (backslash) not allowed in expression portion of f-string","formatStringUnicode":"Format string literals (f-strings) cannot be unicode","formatStringIllegal":"Format string literals (f-strings) require Python 3.6 or newer","formatStringUnterminated":"Unterminated expression in f-string; missing close brace","functionDecoratorTypeUnknown":"Untyped function decorator obscures type of function; ignoring decorator","genericClassAssigned":"Generic class type cannot be assigned","genericClassDeleted":"Generic class type cannot be deleted","genericNotAllowed":"\\"Generic\\" is not valid in this context","genericTypeArgMissing":"\\"Generic\\" requires at least one type argument","genericTypeArgTypeVar":"Type argument for \\"Generic\\" must be a type variable","genericTypeArgUnique":"Type arguments for \\"Generic\\" must be unique","globalReassignment":"\\"{name}\\" is assigned before global declaration","globalRedefinition":"\\"{name}\\" was already declared global","implicitStringConcat":"Implicit string concatenation not allowed","importCycleDetected":"Cycle detected in import chain","importDepthExceeded":"Import chain depth exceeded {depth}","importResolveFailure":"Import \\"{importName}\\" could not be resolved","importSourceResolveFailure":"Import \\"{importName}\\" could not be resolved from source","importSymbolUnknown":"\\"{name}\\" is unknown import symbol","incompatibleMethodOverride":"Method \\"{name}\\" overrides class \\"{className}\\" in an incompatible manner","inconsistentIndent":"Unindent amount does not match previous indent","inconsistentTabs":"Inconsistent use of tabs and spaces in indentation","initSubclassClsParam":"__init_subclass__ override should take a \\"cls\\" parameter","instanceMethodSelfParam":"Instance methods should take a \\"self\\" parameter","internalBindError":"An internal error occurred while binding file \\"{file}\\": {message}","internalParseError":"An internal error occurred while parsing file \\"{file}\\": {message}","internalTypeCheckingError":"An internal error occurred while type checking file \\"{file}\\": {message}","invalidIdentifierChar":"Invalid character in identifier","invalidStubStatement":"Statement is meaningless within a type stub file","invalidTokenChars":"Invalid character in token \\"{text}\\"","isInstanceInvalidType":"Second argument to \\"isinstance\\" must be a class or tuple of classes","isSubclassInvalidType":"Second argument to \\"issubclass\\" must be a class or tuple of classes","keyRequiredDeleted":"\\"{name}\\" is a required key and cannot be deleted","keyValueInSet":"Key/value pairs are not allowed within a set","lambdaReturnTypeUnknown":"Return type of lambda is unknown","lambdaReturnTypePartiallyUnknown":"Return type of lambda, \\"{returnType}\\", is partially unknown","listInAnnotation":"List expression not allowed in type annotation","literalUnsupportedType":"Type arguments for \\"Literal\\" must be None, a literal value (int, bool, str, or bytes), or an enum value","literalEmptyArgs":"Expected one or more type arguments after \\"Literal\\"","memberAccess":"Cannot access member \\"{name}\\" for type \\"{type}\\"","memberDelete":"Cannot delete member \\"{name}\\" for type \\"{type}\\"","memberSet":"Cannot assign member \\"{name}\\" for type \\"{type}\\"","metaclassConflict":"The metaclass of a derived class must be a subclass of the metaclasses of all its base classes","metaclassDuplicate":"Only one metaclass can be provided","methodNotDefined":"\\"{name}\\" method not defined","methodNotDefinedOnType":"\\"{name}\\" method not defined on type \\"{type}\\"","methodOrdering":"Cannot create consistent method ordering","methodOverridden":"\\"{name}\\" overrides method of same name in class \\"{className}\\"","methodReturnsNonObject":"\\"{name}\\" method does not return an object","moduleContext":"Module not allowed in this context","moduleUnknownMember":"\\"{name}\\" is not a known member of module","namedExceptAfterCatchAll":"A named except clause cannot appear after catch-all except clause","namedTupleEmptyName":"Names within a named tuple cannot be empty","namedTupleFirstArg":"Expected named tuple class name as first argument","namedTupleNameString":"Expected string literal for tuple entry name","namedTupleNameType":"Expected two-entry tuple specifying entry name and type","namedTupleNameUnique":"Names within a named tuple must be unique","namedTupleNoTypes":"\\"namedtuple\\" provides no types for tuple entries; use \\"NamedTuple\\" instead","namedTupleSecondArg":"Expected named tuple entry list as second argument","newClsParam":"__new__ override should take a \\"cls\\" parameter","nonDefaultAfterDefault":"Non-default argument follows default argument","noneNotCallable":"Object of type \\"None\\" cannot be called","noneNotIterable":"Object of type \\"None\\" cannot be used as iterable value","noneOperator":"Operator \\"{operator}\\" not supported for \\"None\\"","noneNotSubscriptable":"Object of type \\"None\\" cannot be subscripted","noneNotUsableWith":"Object of type \\"None\\" cannot be used with \\"with\\"","noneUnknownMember":"\\"{name}\\" is not a known member of \\"None\\"","nonLocalNoBinding":"No binding for nonlocal \\"{name}\\" found","nonLocalReassignment":"\\"{name}\\" is assigned before nonlocal declaration","nonLocalRedefinition":"\\"{name}\\" was already declared nonlocal","nonLocalInModule":"Nonlocal declaration not allowed at module level","noOverload":"No overloads for \\"{expression}\\" match parameters","noReturnContainsReturn":"Function with declared return type \\"NoReturn\\" cannot include a return statement","noReturnContainsYield":"Function with declared return type \\"NoReturn\\" cannot include a yield statement","noReturnReturnsNone":"Function with declared type of \\"NoReturn\\" cannot return \\"None\\"","objectNotCallable":"Object of type \\"{type}\\" is not callable","obscuredClassDeclaration":"Class declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredFunctionDeclaration":"Function declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredParameterDeclaration":"Parameter declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredVariableDeclaration":"Declaration \\"{name}\\" is obscured by a declaration of the same name","operatorLessOrGreaterDeprecated":"Operator \\"<>\\" is not supported in Python 3; use \\"!=\\" instead","optionalExtraArgs":"Expected one type argument after \\"Optional\\"","overlappingOverload":"Overload {obscured} for \\"{name}\\" will never be used because its parameters overlap overload {obscuredBy}","overloadAbstractMismatch":"Overloaded methods must all be abstract or not","overloadReturnTypeMismatch":"Overload {prevIndex} for \\"{name}\\" overlaps overload {newIndex} and returns an incompatible type","paramAfterKwargsParam":"Parameter cannot follow \\"**\\" parameter","paramAlreadyAssigned":"Parameter \\"{name}\\" is already assigned","paramNameMissing":"No parameter named \\"{name}\\"","paramSpecAssignedName":"ParamSpec must be assigned to a variable named \\"{name}\\"","paramSpecContext":"ParamSpec not allowed in this context","paramSpecIllegal":"ParamSpec requires Python 3.10 or newer","paramSpecFirstArg":"Expected name of ParamSpec as first argument","paramSpecUnknownArg":"ParamSpec does not support more than one argument","paramSpecUnknownMember":"\\"{name}\\" is not a known member of ParamSpec","paramSpecUnknownParam":"\\"{name}\\" is unknown parameter to ParamSpec","paramAssignmentMismatch":"Expression of type \\"{sourceType}\\" cannot be assigned to parameter of type \\"{paramType}\\"","paramTypeCovariant":"Covariant type variable cannot be used in parameter type","paramTypeUnknown":"Type of parameter \\"{paramName}\\" is unknown","paramTypePartiallyUnknown":"Type of parameter \\"{paramName}\\" is partially unknown","positionArgAfterNamedArg":"Positional argument cannot appear after named arguments","positionOnlyAfterNameOnly":"\\"/\\" parameter must appear before \\"*\\" parameter","positionOnlyIncompatible":"Position-only argument separator requires Python 3.8 or greater","positionOnlyFirstParam":"Position-only argument separator is not allowed as first parameter","privateUsedOutsideOfClass":"\\"{name}\\" is private and used outside of the class in which it is declared","privateUsedOutsideOfModule":"\\"{name}\\" is private and used outside of the module in which it is declared","propertyStaticOrClassMethod":"Static and class methods not allowed for property getter, setter or deleter","protectedUsedOutsideOfClass":"\\"{name}\\" is protected and used outside of the class in which it is declared","protocolUsedInCall":"Protocol class cannot be used in \\"{name}\\" call","protocolIllegal":"Use of \\"Protocol\\" requires Python 3.7 or newer","raiseParams":"\\"raise\\" requires one or more parameters when used outside of except clause","relativeImportNotAllowed":"Relative imports cannot be used with \\"import .a\\" form; use \\"from . import a\\" instead","returnOutsideFunction":"\\"return\\" can be used only within a function","returnMissing":"Function with declared type of \\"{returnType}\\" must return value","returnTypeContravariant":"Contravariant type variable cannot be used in return type","returnTypeMismatch":"Expression of type \\"{exprType}\\" cannot be assigned to return type \\"{returnType}\\"","returnTypeUnknown":"Return type is unknown","returnTypePartiallyUnknown":"Return type, \\"{returnType}\\", is partially unknown","setterGetterTypeMismatch":"Property setter value type is not assignable to the getter return type","singleOverload":"\\"{name}\\" is marked as overload, but additional overloads are missing","staticClsSelfParam":"Static methods should not take a \\"self\\" or \\"cls\\" parameter","stringNonAsciiBytes":"Non-ASCII character not allowed in bytes string literal","stringUnsupportedEscape":"Unsupported escape sequence in string literal","stringUnterminated":"String literal is unterminated","stubFileMissing":"Stub file not found for \\"{importName}\\"","stubUsesGetAttr":"Type stub file is incomplete; \\"__getattr__\\" obscures type errors for module","sublistParamsIncompatible":"Sublist parameters are not supported in Python 3.x","superCallArgCount":"Expected no more than two arguments to \\"super\\" call","superCallFirstArg":"Expected class type as first argument to \\"super\\" call but received \\"{type}\\"","superCallSecondArg":"Second argument to \\"super\\" call must be object or class that derives from \\"{type}\\"","superCallZeroArgForm":"Zero-argument form of \\"super\\" call is valid only within a class","symbolIsUnbound":"\\"{name}\\" is unbound","symbolIsUndefined":"\\"{name}\\" is not defined","symbolIsPossiblyUnbound":"\\"{name}\\" is possibly unbound","symbolOverridden":"\\"{name}\\" overrides symbol of same name in class \\"{className}\\"","tupleInAnnotation":"Tuple expression not allowed in type annotation","tupleSizeMismatch":"Tuple size mismatch: expected {expected} but received {received}","typeAbstract":"Cannot instantiate abstract class \\"{type}\\"","typeAliasIsRecursive":"Type alias \\"{name}\\" cannot use itself in its definition","typeAliasNotInModule":"A TypeAlias can be defined only within a module scope","typeAliasRedeclared":"\\"{name}\\" is declared as a TypeAlias and can be assigned only once","typeArgsExpectingNone":"Expected no type arguments","typeArgsMismatchOne":"Expected one type argument but received {received}","typeArgsMissingForAlias":"Expected type arguments for generic type alias \\"{name}\\"","typeArgsMissingForClass":"Expected type arguments for generic class \\"{name}\\"","typeArgsTooFew":"Too few type arguments provided for class \\"{name}\\"; expected {expected} but received {received}","typeArgsTooMany":"Too many type arguments provided for class \\"{name}\\"; expected {expected} but received {received}","typeAssignmentMismatch":"Expression of type \\"{sourceType}\\" cannot be assigned to declared type \\"{destType}\\"","typeCallNotAllowed":"type() call should not be used in type annotation","typedDictAccess":"Could not access item in TypedDict","typedDictBadVar":"TypedDict classes can contain only type annotations","typedDictBaseClass":"All base classes for \\"TypedDict\\" classes must also be \\"TypedDict\\" classes","typedDictDelete":"Could not delete item in TypedDict","typedDictEmptyName":"Names within a TypedDict cannot be empty","typedDictEntryName":"Expected string literal for dictionary entry name","typedDictEntryUnique":"Names within a dictionary must be unique","typedDictExtraArgs":"Extra TypedDict arguments not supported","typedDictFirstArg":"Expected TypedDict class name as first argument","typedDictSecondArgDict":"Expected dict or named parameter as second parameter","typedDictSecondArgDictEntry":"Expected simple dictionary entry","typedDictSet":"Could not assign item in TypedDict","typedDictTotalParam":"Expected \\"total\\" parameter to have a value of True or False","typeExpectedClass":"Expected class type but received \\"{type}\\"","typeGuardArgCount":"Expected a single type argument after \\"TypeGuard\\"","typeNotAwaitable":"\\"{type}\\" is not awaitable","typeNotCallable":"\\"{expression}\\" has type \\"{type}\\" and is not callable","typeNotIntantiable":"\\"{type}\\" cannot be instantiated","typeNotIterable":"\\"{type}\\" is not iterable","typeNotSpecializable":"Could not specialize type \\"{type}\\"","typeNotSubscriptable":"Object of type \\"{type}\\" cannot be subscripted","typeNotUsableWith":"Object of type \\"{type}\\" cannot be used with \\"with\\" because it does not implement {method}","typeNotSupportBinaryOperator":"Operator \\"{operator}\\" not supported for types \\"{leftType}\\" and \\"{rightType}\\"","typeNotSupportUnaryOperator":"Operator \\"{operator}\\" not supported for type \\"{type}\\"","typePartiallyUnknown":"Type of \\"{name}\\" is partially unknown","typeUnknown":"Type of \\"{name}\\" is unknown","typeVarAssignedName":"TypeVar must be assigned to a variable named \\"{name}\\"","typeVarAssignmentMismatch":"Type \\"{type}\\" cannot be assigned to TypeVar \\"{name}\\"","typeVarBoundAndConstrained":"TypeVar cannot be both bound and constrained","typeVarFirstArg":"Expected name of TypeVar as first argument","typeVarGeneric":"TypeVar bound type cannot be generic","typeVarNotUsedByOuterScope":"TypeVar \\"{name}\\" has no meaning in this context","typeVarSingleConstraint":"TypeVar cannot have only a single constraint","typeVarUnknownParam":"\\"{name}\\" is unknown parameter to TypeVar","typeVarUsedByOuterScope":"TypeVar \\"{name}\\" is already in use by an outer scope","typeVarVariance":"TypeVar cannot be both covariant and contravariant","unaccessedClass":"Class \\"{name}\\" is not accessed","unaccessedFunction":"Function \\"{name}\\" is not accessed","unaccessedImport":"Import \\"{name}\\" is not accessed","unaccessedSymbol":"\\"{name}\\" is not accessed","unaccessedVariable":"Variable \\"{name}\\" is not accessed","unexpectedAsyncToken":"Expected \\"def\\", \\"with\\" or \\"for\\" to follow \\"async\\"","unexpectedExprToken":"Unexpected token at end of expression","unexpectedIndent":"Unexpected indentation","unexpectedUnindent":"Unindent not expected","unionSyntaxIllegal":"Alternative syntax for unions requires Python 3.10 or newer","unnecessaryCast":"Unnecessary \\"cast\\" call; type is already \\"{type}\\"","unnecessaryIsInstanceAlways":"Unnecessary isinstance call; \\"{testType}\\" is always an instance of \\"{classType}\\"","unnecessaryIsInstanceNever":"Unnecessary isinstance call; \\"{testType}\\" is never an instance of \\"{classType}\\"","unnecessaryIsSubclassAlways":"Unnecessary issubclass call; \\"{testType}\\" is always a subclass of \\"{classType}\\"","unnecessaryIsSubclassNever":"Unnecessary issubclass call; \\"{testType}\\" is never a subclass of \\"{classType}\\"","unpackIllegalInComprehension":"Unpack operation not allowed in comprehension","unpackInDict":"Unpack operation not allowed in dictionaries","unpackInSet":"Unpack operator not allowed within a set","unpackTuplesIllegal":"Unpack operation not allowed in tuples prior to Python 3.8","unreachableCode":"Code is unreachable","varAnnotationIllegal":"Type annotations for variables requires Python 3.6 or newer; use type comment for compatibility with previous versions","walrusIllegal":"Operator \\":=\\" requires Python 3.8 or newer","walrusNotAllowed":"Operator \\":=\\" not allowed in this context","wildcardInFunction":"Wildcard import is not allowed within a class or function","wildcardLibraryImport":"Wildcard import from a library is not allowed","yieldFromIllegal":"Use of \\"yield from\\" requires Python 3.3 or newer","yieldFromOutsideAsync":"\\"yield from\\" not allowed in an async function","yieldOutsideFunction":"\\"yield\\" not allowed outside of a function or lambda","yieldTypeMismatch":"Expression of type \\"{exprType}\\" cannot be assigned to yield type \\"{yieldType}\\""},"DiagnosticAddendum":{"argParam":"Argument corresponds to parameter \\"{paramName}\\"","argParamFunction":"Argument corresponds to parameter \\"{paramName}\\" in function \\"{functionName}\\"","argsParamMissing":"Parameter *{paramName} has no corresponding parameter","argumentType":"Argument type is \\"{type}\\"","argumentTypes":"Argument types: ({types})","assignToNone":"Cannot assign to \\"None\\"","asyncHelp":"Did you mean \\"async with\\"?","finalMethod":"Final method","keyUndefined":"\\"{name}\\" is not a defined key in \\"{type}\\"","functionReturnTypeMismatch":"Function return type \\"{sourceType}\\" is not compatible with type \\"{destType}\\"","functionTooFewParams":"Function accepts too few positional parameters; expected {expected} but received {received}","functionTooManyParams":"Function accepts too many positional parameters; expected {expected} but received {received}","literalAssignmentMismatch":"\\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","memberSetClassVar":"Member \\"{name}\\" cannot be assigned through a class instance because it is a ClassVar","memberAssignment":"Expression of type \\"{type}\\" cannot be assigned to member \\"{name}\\" of class \\"{classType}\\"","memberIsAbstract":"\\"{type}.{name}\\" is abstract","memberIsAbstractMore":"and {count} more...","memberTypeMismatch":"\\"{name}\\" is an incompatible type","memberUnknown":"Member \\"{name}\\" is unknown","namedParamMissingInDest":"Named parameter \\"{name}\\" is missing in destination","namedParamMissingInSource":"Named parameter \\"{name}\\" is missing in source","namedParamTypeMismatch":"Named parameter \\"{name}\\" of type \\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","noOverloadAssignable":"No overloaded function matches type \\"{type}\\"","overloadCallName":"Calling function \\"{name}\\"","overloadNotAssignable":"One or more overloads of \\"{name}\\" is not assignable","overriddenMethod":"Overridden method","overriddenSymbol":"Overridden symbol","overrideParamCount":"Parameter count mismatch; base method has {baseCount}, but override has {overrideCount}","overrideParamName":"Parameter {index} name mismatch: base parameter is named \\"{baseName}\\", override parameter is named \\"{overrideName}\\"","overrideParamType":"Parameter {index} type mismatch: base parameter is type \\"{baseType}\\", override parameter is type \\"{overrideType}\\"","overrideReturnType":"Return type mismatch: base method returns type \\"{baseType}\\", override returns type \\"{overrideType}\\"","overrideType":"Base class defines type as \\"{type}\\"","paramAssignment":"Parameter {index}: type \\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","paramType":"Parameter type is \\"{paramType}\\"","propertyMissingDeleter":"Property \\"{name}\\" has no defined deleter","propertyMissingSetter":"Property \\"{name}\\" has no defined setter","protocolMemberMissing":"\\"{name}\\" is not present","protocolMemberClassVar":"\\"{name}\\" is not a class variable","seeDeclaration":"See declaration","seeClassDeclaration":"See class declaration","seeFunctionDeclaration":"See function declaration","seeMethodDeclaration":"See method declaration","seeParameterDeclaration":"See parameter declaration","seeVariableDeclaration":"See variable declaration","tupleEntryTypeMismatch":"Tuple entry {entry} is incorrect type","tupleSizeMismatch":"Tuple size mismatch; expected {expected} but received {received}","typeAssignmentMismatch":"Type \\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","typeBound":"Type \\"{sourceType}\\" is not compatible with bound type \\"{destType}\\" for TypeVar \\"{name}\\"","typeConstrainedTypeVar":"Type \\"{type}\\" is not compatible with constrained TypeVar \\"{name}\\"","typeConstraint":"Type \\"{type}\\" is not compatible with constrained type \\"{name}\\"","typedDictFieldMissing":"\\"{name}\\" is missing from \\"{type}\\"","typedDictFieldNotRequired":"\\"{name}\\" is not required in \\"{type}\\"","typedDictFieldRequired":"\\"{name}\\" is required in \\"{type}\\"","typedDictFieldTypeMismatch":"Type \\"{type}\\" is not assignable to field \\"{name}\\"","typedDictFieldUndefined":"\\"{name}\\" is an undefined field in type \\"{type}\\"","typeIncompatible":"\\"{sourceType}\\" is incompatible with \\"{destType}\\"","typeNotCallable":"Type \\"{type}\\" is not callable","typeNotClass":"\\"{type}\\" is not a class","typeParamSpec":"Type \\"{type}\\" is not compatible with ParamSpec \\"{name}\\"","typeNotStringLiteral":"\\"{type}\\" is not a string literal","typeOfSymbol":"Type of \\"{name}\\" is \\"{type}\\"","typeUnsupported":"Type \\"{type}\\" is unsupported","typeVarIsContravariant":"TypeVar \\"{name}\\" is contravariant","typeVarIsCovariant":"TypeVar \\"{name}\\" is covariant","typeVarIsInvariant":"TypeVar \\"{name}\\" is invariant","typeVarNotAllowed":"TypeVar or generic type with type arguments is not allowed","useDictInstead":"Use Dict[T1, T2] instead","useListInstead":"Use List[T] instead","useTupleInstead":"Use Tuple[T1, ..., Tn] instead","useTypeInstead":"Use Type[T] instead"},"CodeAction":{"addOptionalToAnnotation":"Add \\"Optional\\" to Type Annotation","createTypeStub":"Create Type Stub","createTypeStubFor":"Create Type Stub For \\"{moduleName}\\"","executingCommand":"Executing command","filesToAnalyzeOne":"1 file to analyze","filesToAnalyzeCount":"{count} files to analyze","findingReferences":"Finding references","organizeImports":"Organize Imports"}}')},6961:e=>{"use strict";e.exports={}},9356:e=>{"use strict";e.exports={}},886:e=>{"use strict";e.exports={}},7523:e=>{"use strict";e.exports={}},6853:e=>{"use strict";e.exports={}},3019:e=>{"use strict";e.exports={}},6673:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveAliasDeclaration=void 0,t.resolveAliasDeclaration=function e(t,n,s){let i=n;const r=[];for(;;){if(6!==i.type)return i;if(!i.symbolName)return i;if(!s&&i.usesLocalName)return i;let o;if(i.path&&(o=t(i.path),!o))return;const a=o?o.symbolTable.get(i.symbolName):void 0;if(!a)return i.submoduleFallback?e(t,i.submoduleFallback,s):void 0;let l=a.getTypedDeclarations();if(0===l.length&&(l=a.getDeclarations(),0===l.length))return;if(i=l[l.length-1],r.find(e=>e===i))return n;r.push(i)}}},1241:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeProgram=t.nullCallback=void 0;const o=n(3213),a=r(n(5839)),l=n(8718);t.nullCallback=e=>{},t.analyzeProgram=function(e,n,s,i,r,c){let p=!1;i=null!=i?i:t.nullCallback;try{o.throwIfCancellationRequested(c);const t=new l.Duration;p=e.analyze(n,c);const r=e.getFilesToAnalyzeCount();a.assert(0===r||p);const u=e.getDiagnostics(s),d=u.length,h=t.getDurationInSeconds();(d>0||!p)&&i({diagnostics:u,filesInProgram:e.getFileCount(),filesRequiringAnalysis:r,checkingOnlyOpenFiles:e.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:h})}catch(e){if(o.OperationCanceledException.is(e))return!1;const t=a.getErrorString(e);r.error("Error performing analysis: "+t),i({diagnostics:[],filesInProgram:0,filesRequiringAnalysis:0,checkingOnlyOpenFiles:!0,fatalErrorOccurred:!0,configParseErrorOccurred:!1,elapsedTime:0})}return p}},563:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCodeUnreachable=t.setDunderAllNames=t.getDunderAllNames=t.setCodeFlowExpressions=t.getCodeFlowExpressions=t.setFileInfo=t.getFileInfo=t.setAfterFlowNode=t.getAfterFlowNode=t.setFlowNode=t.getFlowNode=t.setDeclaration=t.getDeclaration=t.setScope=t.getScope=t.setImportInfo=t.getImportInfo=t.cleanNodeAnalysisInfo=void 0;const s=n(6610);function i(e){return e.flowNode}t.cleanNodeAnalysisInfo=function(e){const t=e;delete t.scope,delete t.declaration,delete t.flowNode,delete t.afterFlowNode,delete t.fileInfo},t.getImportInfo=function(e){return e.importInfo},t.setImportInfo=function(e,t){e.importInfo=t},t.getScope=function(e){return e.scope},t.setScope=function(e,t){e.scope=t},t.getDeclaration=function(e){return e.declaration},t.setDeclaration=function(e,t){e.declaration=t},t.getFlowNode=i,t.setFlowNode=function(e,t){e.flowNode=t},t.getAfterFlowNode=function(e){return e.afterFlowNode},t.setAfterFlowNode=function(e,t){e.afterFlowNode=t},t.getFileInfo=function(e){return e.fileInfo},t.setFileInfo=function(e,t){e.fileInfo=t},t.getCodeFlowExpressions=function(e){return e.codeFlowExpressions},t.setCodeFlowExpressions=function(e,t){e.codeFlowExpressions=t},t.getDunderAllNames=function(e){return e.dunderAllNames},t.setDunderAllNames=function(e,t){e.dunderAllNames=t},t.isCodeUnreachable=function(e){let t=e;for(;t;){const e=i(t);if(e)return!!(e.flags&s.FlowFlags.Unreachable);t=t.parent}return!1}},5674:function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,r){function o(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundAnalysisProgram=void 0;const i=n(1241),r=n(8408);t.BackgroundAnalysisProgram=class{constructor(e,t,n,s,i,o){this._console=e,this._configOptions=t,this._importResolver=n,this._program=new r.Program(this._importResolver,this._configOptions,this._console,s),this._backgroundAnalysis=i,this._maxAnalysisTime=o}get configOptions(){return this._configOptions}get importResolver(){return this._importResolver}get program(){return this._program}get backgroundAnalysis(){return this._backgroundAnalysis}setConfigOptions(e){var t;this._configOptions=e,null===(t=this._backgroundAnalysis)||void 0===t||t.setConfigOptions(e),this._program.setConfigOptions(e)}setImportResolver(e){this._importResolver=e,this._program.setImportResolver(e)}setTrackedFiles(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.setTrackedFiles(e);const n=this._program.setTrackedFiles(e);this._reportDiagnosticsForRemovedFiles(n)}setAllowedThirdPartyImports(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.setAllowedThirdPartyImports(e),this._program.setAllowedThirdPartyImports(e)}setFileOpened(e,t,n){var s;null===(s=this._backgroundAnalysis)||void 0===s||s.setFileOpened(e,t,n),this._program.setFileOpened(e,t,n)}updateOpenFileContents(e,t,n){this.setFileOpened(e,t,n),this.markFilesDirty([e],!0)}setFileClosed(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.setFileClosed(e);const n=this._program.setFileClosed(e);this._reportDiagnosticsForRemovedFiles(n)}markAllFilesDirty(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.markAllFilesDirty(e),this._program.markAllFilesDirty(e)}markFilesDirty(e,t){var n;null===(n=this._backgroundAnalysis)||void 0===n||n.markFilesDirty(e,t),this._program.markFilesDirty(e,t)}setCompletionCallback(e){var t;this._onAnalysisCompletion=e,null===(t=this._backgroundAnalysis)||void 0===t||t.setCompletionCallback(e)}startAnalysis(e){return this._backgroundAnalysis?(this._backgroundAnalysis.startAnalysis(this._indices,e),!1):i.analyzeProgram(this._program,this._maxAnalysisTime,this._configOptions,this._onAnalysisCompletion,this._console,e)}test_setIndexing(e,t){const n=this._getIndices();for(const[t,s]of e)n.setWorkspaceIndex(t,s);for(const[e,s]of t)for(const[t,i]of s)n.setIndex(e,t,i)}startIndexing(){var e;this._configOptions.indexing&&(null===(e=this._backgroundAnalysis)||void 0===e||e.startIndexing(this._configOptions,this._getIndices()))}refreshIndexing(){var e;this._configOptions.indexing&&(null===(e=this._backgroundAnalysis)||void 0===e||e.refreshIndexing(this._configOptions,this._indices))}cancelIndexing(){var e;null===(e=this._backgroundAnalysis)||void 0===e||e.cancelIndexing(this._configOptions)}getIndexing(e){var t;return null===(t=this._indices)||void 0===t?void 0:t.getIndex(this._configOptions.findExecEnvironment(e).root)}getDiagnosticsForRange(e,t,n){return s(this,void 0,void 0,(function*(){return this._backgroundAnalysis?this._backgroundAnalysis.getDiagnosticsForRange(e,t,n):this._program.getDiagnosticsForRange(e,t)}))}writeTypeStub(e,t,n,r){return s(this,void 0,void 0,(function*(){return this._backgroundAnalysis?this._backgroundAnalysis.writeTypeStub(e,t,n,r):(i.analyzeProgram(this._program,void 0,this._configOptions,this._onAnalysisCompletion,this._console,r),this._program.writeTypeStub(e,t,n,r))}))}invalidateAndForceReanalysis(){var e;this.refreshIndexing(),null===(e=this._backgroundAnalysis)||void 0===e||e.invalidateAndForceReanalysis(),this._importResolver.invalidateCache(),this._program.markAllFilesDirty(!0)}invalidateCache(){this._importResolver.invalidateCache()}restart(){var e;null===(e=this._backgroundAnalysis)||void 0===e||e.restart()}_getIndices(){if(!this._indices){const e=this._program,t=new Map;this._indices={setWorkspaceIndex(t,n){var s;null===(s=e.getSourceFile(t))||void 0===s||s.cacheIndexResults(n)},getIndex:e=>t.get(e),setIndex(e,n,s){let i=t.get(e);i||(i=new Map,t.set(e,i)),i.set(n,s)},reset(){t.clear()}}}return this._indices}_reportDiagnosticsForRemovedFiles(e){e.length>0&&!this._backgroundAnalysis&&this._onAnalysisCompletion&&this._onAnalysisCompletion({diagnostics:e,filesInProgram:this._program.getFileCount(),filesRequiringAnalysis:this._program.getFilesToAnalyzeCount(),checkingOnlyOpenFiles:this._program.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:0})}}},6052:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.YieldFinder=t.Binder=void 0;const o=n(5839),a=n(9744),l=n(6657),c=n(1464),p=n(6886),u=n(3550),d=n(3550),h=n(2122),m=r(n(5136)),y=r(n(563)),g=n(6610),f=r(n(8494)),_=n(427),T=n(1561),v=r(n(8235)),b=n(817),C=n(1766);class S extends _.ParseTreeWalker{constructor(e){super(),this._deferredBindingTasks=[],this._nestedExceptDepth=0,this._finallyTargets=[],this._typingImportAliases=[],this._typingSymbolAliases=new Map,this._potentialPrivateSymbols=new Map,this._fileInfo=e}bindModule(e){const t=void 0===this._fileInfo.builtinsScope;return this._createNewScope(t?4:3,this._fileInfo.builtinsScope,()=>{y.setScope(e,this._currentScope),y.setFlowNode(e,this._currentFlowNode),this._addBuiltInSymbolToCurrentScope("__doc__",e,"str"),this._addBuiltInSymbolToCurrentScope("__name__",e,"str"),this._addBuiltInSymbolToCurrentScope("__loader__",e,"Any"),this._addBuiltInSymbolToCurrentScope("__package__",e,"str"),this._addBuiltInSymbolToCurrentScope("__spec__",e,"Any"),this._addBuiltInSymbolToCurrentScope("__path__",e,"List[str]"),this._addBuiltInSymbolToCurrentScope("__file__",e,"str"),this._addBuiltInSymbolToCurrentScope("__cached__",e,"str"),this._addBuiltInSymbolToCurrentScope("__dict__",e,"Dict[str, Any]"),this._currentFlowNode=this._createStartFlowNode(),this._walkStatementsAndReportUnreachable(e.statements),y.setCodeFlowExpressions(e,this._currentExecutionScopeReferenceMap),y.setAfterFlowNode(e,this._currentFlowNode)}),this._bindDeferred(),this._potentialPrivateSymbols.forEach((e,t)=>{var n;(null===(n=this._dunderAllNames)||void 0===n?void 0:n.some(e=>e===t))||e.setIsExternallyHidden()}),y.setDunderAllNames(e,this._dunderAllNames),{moduleDocString:f.getDocString(e.statements)}}visitModule(e){return o.fail("We should never get here"),!1}visitSuite(e){return this._walkStatementsAndReportUnreachable(e.statements),!1}visitModuleName(e){const t=y.getImportInfo(e);if(o.assert(void 0!==t),t)if(t.isImportFound){if(!t.isStubFile&&1===t.importType&&!t.isPyTypedPresent){const n=this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingTypeStubs,a.DiagnosticRule.reportMissingTypeStubs,h.Localizer.Diagnostic.stubFileMissing().format({importName:t.importName}),e);if(n){const e={action:"pyright.createtypestub",moduleName:t.importName};n.addAction(e)}}t.isStubFile&&0!==t.importType&&t.nonStubImportResult&&!t.nonStubImportResult.isImportFound&&(this._fileInfo.isStubFile||this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingModuleSource,a.DiagnosticRule.reportMissingModuleSource,h.Localizer.Diagnostic.importSourceResolveFailure().format({importName:t.importName}),e))}else this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingImports,a.DiagnosticRule.reportMissingImports,h.Localizer.Diagnostic.importResolveFailure().format({importName:t.importName}),e);return!0}visitClass(e){this.walkMultiple(e.decorators);const t={type:4,node:e,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.name.start,d.TextRange.getEnd(e.name),this._fileInfo.lines),moduleName:this._fileInfo.moduleName},n=this._bindNameToScope(this._currentScope,e.name.value);n&&n.addDeclaration(t),y.setDeclaration(e,t),this.walkMultiple(e.arguments);let s=this._currentScope;for(;2===s.type;)s=s.parent;return this._createNewScope(2,s,()=>{y.setScope(e,this._currentScope),this.walk(e.suite)}),this._addSymbolToCurrentScope(e.name.value,!0),this._createAssignmentTargetFlowNodes(e.name,!1,!1),!1}visitFunction(e){const t=this._bindNameToScope(this._currentScope,e.name.value),n=f.getEnclosingClass(e,!0),s={type:3,node:e,isMethod:!!n,isGenerator:!1,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.name.start,d.TextRange.getEnd(e.name),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};t&&t.addDeclaration(s),y.setDeclaration(e,s),this.walkMultiple(e.decorators),e.parameters.forEach(e=>{e.defaultValue&&this.walk(e.defaultValue),e.typeAnnotation&&this.walk(e.typeAnnotation),e.typeAnnotationComment&&this.walk(e.typeAnnotationComment)}),e.returnTypeAnnotation&&this.walk(e.returnTypeAnnotation),e.functionAnnotationComment&&this.walk(e.functionAnnotationComment);let i=e.parent;for(;i&&37!==i.nodeType&&29!==i.nodeType;)i=i.parent;o.assert(void 0!==i);const r=y.getScope(i);return o.assert(void 0!==r),this._createNewScope(1,r,()=>{y.setScope(e,this._currentScope),f.getEnclosingClass(e)&&this._addBuiltInSymbolToCurrentScope("__class__",e,"class"),this._deferBinding(()=>{this._currentFlowNode=this._createStartFlowNode(),e.parameters.forEach(e=>{if(e.name){const t=this._bindNameToScope(this._currentScope,e.name.value);if(t){const n={type:2,node:e,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.start,d.TextRange.getEnd(e),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};t.addDeclaration(n),y.setDeclaration(e.name,n)}this._createFlowAssignment(e.name)}}),this._targetFunctionDeclaration=s,this._currentReturnTarget=this._createBranchLabel(),this.walk(e.suite),y.setAfterFlowNode(e.suite,this._currentFlowNode),this._addAntecedent(this._currentReturnTarget,this._currentFlowNode);const t=this._finishFlowLabel(this._currentReturnTarget);y.setAfterFlowNode(e,t)}),y.setCodeFlowExpressions(e,this._currentExecutionScopeReferenceMap)}),this._createAssignmentTargetFlowNodes(e.name,!1,!1),!1}visitLambda(e){return e.parameters.forEach(e=>{e.defaultValue&&this.walk(e.defaultValue)}),this._createNewScope(1,this._currentScope,()=>{y.setScope(e,this._currentScope),this._deferBinding(()=>{this._currentFlowNode=this._createStartFlowNode(),e.parameters.forEach(e=>{if(e.name){const t=this._bindNameToScope(this._currentScope,e.name.value);if(t){const n={type:2,node:e,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.start,d.TextRange.getEnd(e),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};t.addDeclaration(n),y.setDeclaration(e.name,n)}this._createFlowAssignment(e.name),this.walk(e.name)}}),this.walk(e.expression),y.setCodeFlowExpressions(e,this._currentExecutionScopeReferenceMap)})}),!1}visitCall(e){var t;if(this.walk(e.leftExpression),this.walkMultiple(e.arguments),this._createCallFlowNode(e),3===this._currentScope.type&&36===e.leftExpression.nodeType&&39===e.leftExpression.leftExpression.nodeType&&"__all__"===e.leftExpression.leftExpression.value)if("extend"===e.leftExpression.memberName.value&&1===e.arguments.length){const t=e.arguments[0].valueExpression;if(32===t.nodeType)t.entries.forEach(e=>{var t;49===e.nodeType&&1===e.strings.length&&50===e.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(e.strings[0].value))});else if(36===t.nodeType&&39===t.leftExpression.nodeType&&"__all__"===t.memberName.value){const e=this._getDunderAllNamesFromImport(t.leftExpression.value);e&&e.forEach(e=>{var t;null===(t=this._dunderAllNames)||void 0===t||t.push(e)})}}else if("remove"===e.leftExpression.memberName.value&&1===e.arguments.length){const t=e.arguments[0].valueExpression;49===t.nodeType&&1===t.strings.length&&50===t.strings[0].nodeType&&this._dunderAllNames&&(this._dunderAllNames=this._dunderAllNames.filter(e=>e!==t.strings[0].value))}else if("append"===e.leftExpression.memberName.value&&1===e.arguments.length){const n=e.arguments[0].valueExpression;49===n.nodeType&&1===n.strings.length&&50===n.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(n.strings[0].value))}return!1}visitAssignment(e){if(this._handleTypingStubAssignmentOrAnnotation(e))return!1;this._bindPossibleTupleNamedTarget(e.leftExpression),e.typeAnnotationComment&&(this.walk(e.typeAnnotationComment),this._addTypeDeclarationForVariable(e.leftExpression,e.typeAnnotationComment)),this.walk(e.rightExpression);let t=!0;if((f.getEnclosingClass(e)||f.getEnclosingFunction(e)||9===e.rightExpression.nodeType&&this._fileInfo.isTypingStubFile)&&(t=!1),this._addInferredTypeAssignmentForVariable(e.leftExpression,e.rightExpression,t),this._createAssignmentTargetFlowNodes(e.leftExpression,!0,!1),3===this._currentScope.type&&(39===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value||55===e.leftExpression.nodeType&&39===e.leftExpression.valueExpression.nodeType&&"__all__"===e.leftExpression.valueExpression.value)){const t=e.rightExpression;this._dunderAllNames=[],32===t.nodeType?t.entries.forEach(e=>{49===e.nodeType&&1===e.strings.length&&50===e.strings[0].nodeType&&this._dunderAllNames.push(e.strings[0].value)}):53===t.nodeType&&t.expressions.forEach(e=>{49===e.nodeType&&1===e.strings.length&&50===e.strings[0].nodeType&&this._dunderAllNames.push(e.strings[0].value)})}return!1}visitAssignmentExpression(e){this.walk(e.rightExpression);const t=f.getEvaluationNodeForAssignmentExpression(e);if(t){const n=y.getScope(t);let s=this._currentScope;for(;s&&s!==n;){if(s.lookUpSymbol(e.name.value)){this._addError(h.Localizer.Diagnostic.assignmentExprComprehension().format({name:e.name.value}),e.name);break}s=s.parent}this._bindNameToScope(n,e.name.value),this._addInferredTypeAssignmentForVariable(e.name,e.rightExpression)}else this._addError(h.Localizer.Diagnostic.assignmentExprContext(),e);return this._createAssignmentTargetFlowNodes(e.name,!0,!1),!1}visitAugmentedAssignment(e){if(this.walk(e.leftExpression),this.walk(e.rightExpression),this._addInferredTypeAssignmentForVariable(e.destExpression,e.rightExpression),this._bindPossibleTupleNamedTarget(e.destExpression),this._createAssignmentTargetFlowNodes(e.destExpression,!1,!1),1===e.operator&&3===this._currentScope.type&&39===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value){const t=e.rightExpression;if(32===t.nodeType)t.entries.forEach(e=>{var t;49===e.nodeType&&1===e.strings.length&&50===e.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(e.strings[0].value))});else if(36===t.nodeType&&39===t.leftExpression.nodeType&&"__all__"===t.memberName.value){const e=this._getDunderAllNamesFromImport(t.leftExpression.value);e&&e.forEach(e=>{var t;null===(t=this._dunderAllNames)||void 0===t||t.push(e)})}}return!1}visitDel(e){return e.expressions.forEach(e=>{this._bindPossibleTupleNamedTarget(e),this.walk(e),this._createAssignmentTargetFlowNodes(e,!1,!0)}),!1}visitTypeAnnotation(e){if(this._handleTypingStubAssignmentOrAnnotation(e))return!1;this._bindPossibleTupleNamedTarget(e.valueExpression),this._addTypeDeclarationForVariable(e.valueExpression,e.typeAnnotation);const t=[];return this._isNarrowingExpression(e.valueExpression,t)&&t.forEach(e=>{const t=g.createKeyForReference(e);this._currentExecutionScopeReferenceMap.set(t,t)}),!0}visitFor(e){this._bindPossibleTupleNamedTarget(e.targetExpression),this._addInferredTypeAssignmentForVariable(e.targetExpression,e),this.walk(e.iterableExpression);const t=this._createLoopLabel(),n=this._createBranchLabel(),s=this._createBranchLabel();return this._addAntecedent(t,this._currentFlowNode),this._currentFlowNode=t,this._addAntecedent(n,this._currentFlowNode),this._createAssignmentTargetFlowNodes(e.targetExpression,!0,!1),this._bindLoopStatement(t,s,()=>{this.walk(e.forSuite),this._addAntecedent(t,this._currentFlowNode)}),this._currentFlowNode=this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),!1}visitContinue(e){return this._currentContinueTarget&&this._addAntecedent(this._currentContinueTarget,this._currentFlowNode),this._currentFlowNode=S._unreachableFlowNode,!1}visitBreak(e){return this._currentBreakTarget&&this._addAntecedent(this._currentBreakTarget,this._currentFlowNode),this._currentFlowNode=S._unreachableFlowNode,!1}visitReturn(e){return this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.returnStatements||(this._targetFunctionDeclaration.returnStatements=[]),this._targetFunctionDeclaration.returnStatements.push(e)),e.returnExpression&&this.walk(e.returnExpression),y.setFlowNode(e,this._currentFlowNode),this._currentReturnTarget&&this._addAntecedent(this._currentReturnTarget,this._currentFlowNode),this._finallyTargets.forEach(e=>{this._addAntecedent(e,this._currentFlowNode)}),this._currentFlowNode=S._unreachableFlowNode,!1}visitYield(e){return this._bindYield(e),!1}visitYieldFrom(e){return this._bindYield(e),!1}visitMemberAccess(e){return y.setFlowNode(e,this._currentFlowNode),!0}visitName(e){return y.setFlowNode(e,this._currentFlowNode),!1}visitIf(e){const t=this._createBranchLabel(),n=this._createBranchLabel(),s=this._createBranchLabel(),i=v.evaluateStaticBoolLikeExpression(e.testExpression,this._fileInfo.executionEnvironment);return this._bindConditional(e.testExpression,t,n),this._currentFlowNode=!1===i?S._unreachableFlowNode:this._finishFlowLabel(t),this.walk(e.ifSuite),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=!0===i?S._unreachableFlowNode:this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),!1}visitWhile(e){const t=this._createBranchLabel(),n=this._createBranchLabel(),s=this._createBranchLabel(),i=v.evaluateStaticBoolLikeExpression(e.testExpression,this._fileInfo.executionEnvironment),r=this._createLoopLabel();return this._addAntecedent(r,this._currentFlowNode),this._currentFlowNode=r,this._bindConditional(e.testExpression,t,n),this._currentFlowNode=!1===i?S._unreachableFlowNode:this._finishFlowLabel(t),this._bindLoopStatement(r,s,()=>{this.walk(e.whileSuite)}),this._addAntecedent(r,this._currentFlowNode),this._currentFlowNode=!0===i?S._unreachableFlowNode:this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),!1}visitAssert(e){const t=this._createBranchLabel(),n=this._createBranchLabel();return this._bindConditional(e.testExpression,t,n),e.exceptionExpression&&(this._currentFlowNode=this._finishFlowLabel(n),this.walk(e.exceptionExpression)),this._currentFlowNode=this._finishFlowLabel(t),!1}visitExcept(e){if(e.typeExpression&&this.walk(e.typeExpression),e.name){this.walk(e.name);const t=this._bindNameToScope(this._currentScope,e.name.value);if(this._createAssignmentTargetFlowNodes(e.name,!0,!1),t){const n={type:1,node:e.name,isConstant:C.isConstantName(e.name.value),inferredTypeSource:e,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.name.start,d.TextRange.getEnd(e.name),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};t.addDeclaration(n)}}return this.walk(e.exceptSuite),e.name&&this._createFlowAssignment(e.name,!0),!1}visitRaise(e){return this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.raiseStatements||(this._targetFunctionDeclaration.raiseStatements=[]),this._targetFunctionDeclaration.raiseStatements.push(e)),e.typeExpression||0!==this._nestedExceptDepth||this._addError(h.Localizer.Diagnostic.raiseParams(),e),e.typeExpression&&this.walk(e.typeExpression),e.valueExpression&&this.walk(e.valueExpression),e.tracebackExpression&&this.walk(e.tracebackExpression),this._finallyTargets.forEach(e=>{this._addAntecedent(e,this._currentFlowNode)}),this._currentFlowNode=S._unreachableFlowNode,!1}visitTry(e){const t=e.exceptClauses.map(()=>this._createBranchLabel()),n=this._createBranchLabel(),s=this._createBranchLabel();let i=!1;const r={flags:g.FlowFlags.PreFinallyGate,id:g.getUniqueFlowNodeId(),antecedent:s,isGateClosed:!1};e.finallySuite&&this._addAntecedent(n,r),t.forEach(e=>{this._addAntecedent(e,this._currentFlowNode)}),e.finallySuite&&this._finallyTargets.push(s);const o=this._currentExceptTargets;if(this._currentExceptTargets=t,this.walk(e.trySuite),this._currentExceptTargets=o,e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(n,this._currentFlowNode),this._isCodeUnreachable()||(i=!0),this._nestedExceptDepth++,e.exceptClauses.forEach((e,s)=>{this._currentFlowNode=this._finishFlowLabel(t[s]),this.walk(e),this._addAntecedent(n,this._currentFlowNode),this._isCodeUnreachable()||(i=!0)}),this._nestedExceptDepth--,e.finallySuite&&this._finallyTargets.pop(),this._currentFlowNode=this._finishFlowLabel(n),e.finallySuite){this.walk(e.finallySuite);const t={flags:g.FlowFlags.PostFinally,id:g.getUniqueFlowNodeId(),antecedent:this._currentFlowNode,preFinallyGate:r};this._currentFlowNode=i?t:S._unreachableFlowNode}return!1}visitAwait(e){const t=f.getEnclosingFunction(e);return void 0!==t&&t.isAsync||this._addError(h.Localizer.Diagnostic.awaitNotInAsync(),e),!0}visitStringList(e){for(const t of e.strings)t.hasUnescapeErrors&&m.getUnescapedString(t.token).unescapeErrors.forEach(e=>{const n={start:t.token.start+t.token.prefixLength+t.token.quoteMarkLength+e.offset,length:e.length};0===e.errorType?this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStringEscapeSequence,a.DiagnosticRule.reportInvalidStringEscapeSequence,h.Localizer.Diagnostic.stringUnsupportedEscape(),n):1===e.errorType?this._addError(h.Localizer.Diagnostic.formatStringEscape(),n):2===e.errorType?this._addError(h.Localizer.Diagnostic.formatStringBrace(),n):3===e.errorType&&this._addError(h.Localizer.Diagnostic.formatStringUnterminated(),n)});return!0}visitGlobal(e){const t=this._currentScope.getGlobalScope();return e.nameList.forEach(e=>{const n=e.value;0===this._currentScope.getBindingType(n)&&this._addError(h.Localizer.Diagnostic.nonLocalRedefinition().format({name:n}),e);const s=this._currentScope.lookUpSymbolRecursive(n);s&&s.scope===this._currentScope&&this._addError(h.Localizer.Diagnostic.globalReassignment().format({name:n}),e),this._bindNameToScope(t,n),this._currentScope!==t&&this._currentScope.setBindingType(n,1)}),!0}visitNonlocal(e){const t=this._currentScope.getGlobalScope();return this._currentScope===t?this._addError(h.Localizer.Diagnostic.nonLocalInModule(),e):e.nameList.forEach(e=>{const n=e.value;1===this._currentScope.getBindingType(n)&&this._addError(h.Localizer.Diagnostic.globalRedefinition().format({name:n}),e);const s=this._currentScope.lookUpSymbolRecursive(n);s&&s.scope===this._currentScope?this._addError(h.Localizer.Diagnostic.nonLocalReassignment().format({name:n}),e):s&&s.scope!==t||this._addError(h.Localizer.Diagnostic.nonLocalNoBinding().format({name:n}),e),s&&this._currentScope.setBindingType(n,0)}),!0}visitImportAs(e){var t;if(e.module.nameParts.length>0){const n=e.module.nameParts[0].value;let s;s=e.alias?e.alias.value:n;const i=this._bindNameToScope(this._currentScope,s);i&&!e.alias&&(this._fileInfo.isStubFile?i.setIsExternallyHidden():this._fileInfo.isInPyTypedPackage&&3===this._currentScope.type&&this._potentialPrivateSymbols.set(s,i));const r=y.getImportInfo(e.module);o.assert(void 0!==r),i&&this._createAliasDeclarationForMultipartImportName(e,e.alias,r,i),this._createFlowAssignment(e.alias?e.alias:e.module.nameParts[0]),1===e.module.nameParts.length&&("typing"!==n&&"typing_extensions"!==n||this._typingImportAliases.push((null===(t=e.alias)||void 0===t?void 0:t.value)||n))}return!0}visitImportFrom(e){const t=["Final","TypeAlias"],n=y.getImportInfo(e.module);let s="";n&&n.isImportFound&&(s=n.resolvedPaths[n.resolvedPaths.length-1]);const i="__init__"===l.stripFileExtension(l.getFileName(this._fileInfo.filePath))&&1===e.module.leadingDots&&e.module.nameParts.length>0;let r=!1;if(1===e.module.nameParts.length){const t=e.module.nameParts[0].value;"typing"!==t&&"typing_extensions"!==t||(r=!0)}if(e.isWildcardImport){if((f.getEnclosingClass(e)||f.getEnclosingFunction(e))&&this._addError(h.Localizer.Diagnostic.wildcardInFunction(),e),n){const o=[],a=this._fileInfo.importLookup(s);if(a){const t=this._getWildcardImportNames(a);i&&(t.some(t=>t===e.module.nameParts[0].value)||this._addImplicitFromImport(e,n)),t.forEach(t=>{const i=this._bindNameToScope(this._currentScope,t);if(i)if(a.symbolTable.get(t)){const n={type:6,node:e,path:s,range:u.getEmptyRange(),usesLocalName:!1,symbolName:t,moduleName:this._fileInfo.moduleName};i.addDeclaration(n),o.push(t)}else if(n&&n.implicitImports){const r=n.implicitImports.find(e=>e.name===t);if(r){const n={type:6,node:e,path:r.path,range:u.getEmptyRange(),usesLocalName:!1,moduleName:this._fileInfo.moduleName},o={type:6,node:e,path:s,usesLocalName:!1,symbolName:t,submoduleFallback:n,range:u.getEmptyRange(),moduleName:this._fileInfo.moduleName};i.addDeclaration(o)}}})}this._createFlowWildcardImport(e,o),r&&t.forEach(e=>{this._typingSymbolAliases.set(e,e)})}}else i&&(e.imports.some(t=>(t.alias||t.name).value===e.module.nameParts[0].value)||this._addImplicitFromImport(e,n)),e.imports.forEach(i=>{const o=i.name.value,a=i.alias||i.name,l=this._bindNameToScope(this._currentScope,a.value);if(l){let c,p;i.alias||(this._fileInfo.isStubFile?l.setIsExternallyHidden():this._fileInfo.isInPyTypedPackage&&3===this._currentScope.type&&this._potentialPrivateSymbols.set(a.value,l)),n&&n.implicitImports&&(c=n.implicitImports.find(e=>e.name===o)),c&&(p={type:6,node:i,path:c.path,range:u.getEmptyRange(),usesLocalName:!1,moduleName:this._fileInfo.moduleName},0===e.module.nameParts.length&&(s=""));const d={type:6,node:i,path:s,usesLocalName:!!i.alias,symbolName:o,submoduleFallback:p,range:u.getEmptyRange(),moduleName:this._fileInfo.moduleName};l.addDeclaration(d),this._createFlowAssignment(i.alias||i.name),r&&t.some(e=>e===i.name.value)&&this._typingSymbolAliases.set(a.value,i.name.value)}});return!0}visitWith(e){return e.withItems.forEach(e=>{this.walk(e.expression),e.target&&(this._bindPossibleTupleNamedTarget(e.target),this._addInferredTypeAssignmentForVariable(e.target,e),this._createAssignmentTargetFlowNodes(e.target,!0,!1))}),this.walk(e.suite),!1}visitTernary(e){const t=this._createBranchLabel(),n=this._createBranchLabel(),s=this._createBranchLabel();return this._bindConditional(e.testExpression,t,n),this._currentFlowNode=this._finishFlowLabel(t),this.walk(e.ifExpression),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(n),this.walk(e.elseExpression),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),!1}visitUnaryOperation(e){if(38===e.operator&&this._currentFalseTarget&&this._currentTrueTarget)this._bindConditional(e.expression,this._currentFalseTarget,this._currentTrueTarget);else{const t=this._currentTrueTarget,n=this._currentFalseTarget;this._currentTrueTarget=void 0,this._currentFalseTarget=void 0,this.walk(e.expression),this._currentFalseTarget=n,this._currentTrueTarget=t}return!1}visitBinaryOperation(e){if(36===e.operator||37===e.operator){let t,n=this._currentTrueTarget,s=this._currentFalseTarget;n&&s||(t=this._createBranchLabel(),n=s=t);const i=this._createBranchLabel();36===e.operator?this._bindConditional(e.leftExpression,i,s):this._bindConditional(e.leftExpression,n,i),this._currentFlowNode=this._finishFlowLabel(i),this._bindConditional(e.rightExpression,n,s),t&&(this._currentFlowNode=this._finishFlowLabel(t))}else{const t=this._currentTrueTarget,n=this._currentFalseTarget;this._currentTrueTarget=void 0,this._currentFalseTarget=void 0,this.walk(e.leftExpression),this.walk(e.rightExpression),this._currentFalseTarget=n,this._currentTrueTarget=t}return!1}visitListComprehension(e){return this._createNewScope(0,this._currentScope,()=>{y.setScope(e,this._currentScope);const t=this._createBranchLabel(),n=[];for(let t=0;t<e.comprehensions.length;t++){const s=e.comprehensions[t],i=new Map;34===s.nodeType&&(this._bindPossibleTupleNamedTarget(s.targetExpression,i),this._addInferredTypeAssignmentForVariable(s.targetExpression,s)),n.push(i)}for(let s=0;s<e.comprehensions.length;s++){const i=e.comprehensions[s];if(34===i.nodeType){const e=n[s];for(const t of e){const e=this._currentScope.parent.lookUpSymbol(t[0]);e&&this._createAssignmentAliasFlowNode(t[1].id,e.id)}this.walk(i.iterableExpression),this._createAssignmentTargetFlowNodes(i.targetExpression,!0,!1)}else{const e=this._createBranchLabel();this._bindConditional(i.testExpression,e,t),this._currentFlowNode=this._finishFlowLabel(e)}}this.walk(e.expression),this._addAntecedent(t,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(t)}),!1}_getDunderAllNamesFromImport(e){var t;const n=this._currentScope.lookUpSymbol(e);if(!n)return;const s=n.getDeclarations().find(e=>6===e.type),i=(null==s?void 0:s.path)||(null===(t=null==s?void 0:s.submoduleFallback)||void 0===t?void 0:t.path);if(!i)return;const r=this._fileInfo.importLookup(i);return r?r.dunderAllNames:void 0}_addImplicitFromImport(e,t){const n=e.module.nameParts[0].value,s=this._bindNameToScope(this._currentScope,n);s&&this._createAliasDeclarationForMultipartImportName(e,void 0,t,s),this._createFlowAssignment(e.module.nameParts[0])}_createAliasDeclarationForMultipartImportName(e,t,n,s){const i=e.module.nameParts[0].value;if(n&&n.isImportFound&&!n.isNativeLib&&n.resolvedPaths.length>0){const r=s.getDeclarations().find(e=>6===e.type&&e.firstNamePart===i);let o;if(o=r||{type:6,node:e,path:"",moduleName:n.importName,range:u.getEmptyRange(),firstNamePart:i,usesLocalName:!!t},t||1===e.module.nameParts.length)o.path=n.resolvedPaths[n.resolvedPaths.length-1],this._addImplicitImportsToLoaderActions(n,o);else{let t=o;for(let s=1;s<e.module.nameParts.length&&!(s>=n.resolvedPaths.length);s++){const i=e.module.nameParts[s].value;let r=t.implicitImports?t.implicitImports.get(i):void 0;r||(r={path:"",implicitImports:new Map},t.implicitImports||(t.implicitImports=new Map),t.implicitImports.set(i,r)),s===e.module.nameParts.length-1&&(r.path=n.resolvedPaths[s],this._addImplicitImportsToLoaderActions(n,r)),t=r}}r||s.addDeclaration(o)}else{const n={type:6,node:e,path:"*** unresolved ***",range:u.getEmptyRange(),usesLocalName:!!t,moduleName:""};s.addDeclaration(n)}}_getWildcardImportNames(e){if(e.dunderAllNames)return e.dunderAllNames;const t=[];return e.symbolTable.forEach((e,n)=>{n.startsWith("_")||e.isIgnoredForProtocolMatch()||t.push(n)}),t}_walkStatementsAndReportUnreachable(e){let t=!1;for(const n of e)y.setFlowNode(n,this._currentFlowNode),t||(t=this._isCodeUnreachable()),t?this._targetFunctionDeclaration&&!this._targetFunctionDeclaration.isGenerator&&(new I).checkContainsYield(n)&&(this._targetFunctionDeclaration.isGenerator=!0):this.walk(n);return!1}_createStartFlowNode(){return{flags:g.FlowFlags.Start,id:g.getUniqueFlowNodeId()}}_createBranchLabel(){return{flags:g.FlowFlags.BranchLabel,id:g.getUniqueFlowNodeId(),antecedents:[]}}_createLoopLabel(){return{flags:g.FlowFlags.LoopLabel,id:g.getUniqueFlowNodeId(),antecedents:[]}}_finishFlowLabel(e){return 0===e.antecedents.length?S._unreachableFlowNode:1===e.antecedents.length?e.antecedents[0]:e}_bindConditional(e,t,n){const s=this._currentTrueTarget,i=this._currentFalseTarget;this._currentTrueTarget=t,this._currentFalseTarget=n,this.walk(e),this._currentTrueTarget=s,this._currentFalseTarget=i,this._isLogicalExpression(e)||(this._addAntecedent(t,this._createFlowConditional(g.FlowFlags.TrueCondition,this._currentFlowNode,e)),this._addAntecedent(n,this._createFlowConditional(g.FlowFlags.FalseCondition,this._currentFlowNode,e)))}_createFlowConditional(e,t,n){if(t.flags&g.FlowFlags.Unreachable)return t;const s=v.evaluateStaticBoolLikeExpression(n,this._fileInfo.executionEnvironment);if(!0===s&&e&g.FlowFlags.FalseCondition||!1===s&&e&g.FlowFlags.TrueCondition)return S._unreachableFlowNode;const i=[];if(!this._isNarrowingExpression(n,i))return t;i.forEach(e=>{const t=g.createKeyForReference(e);this._currentExecutionScopeReferenceMap.set(t,t)});const r={flags:e,id:g.getUniqueFlowNodeId(),expression:n,antecedent:t};return this._addExceptTargets(r),r}_isLogicalExpression(e){switch(e.nodeType){case 56:return 38===e.operator;case 7:return 36===e.operator||37===e.operator}return!1}_isNarrowingExpression(e,t){switch(e.nodeType){case 39:case 36:return!!g.isCodeFlowSupportedForReference(e)&&(t.push(e),!0);case 4:return t.push(e.name),!0;case 7:{const n=39===e.operator||40===e.operator,s=12===e.operator||28===e.operator;if(n||s){if(11===e.rightExpression.nodeType&&24===e.rightExpression.constType)return this._isNarrowingExpression(e.leftExpression,t);if(n&&9===e.leftExpression.nodeType&&39===e.leftExpression.leftExpression.nodeType&&"type"===e.leftExpression.leftExpression.value&&1===e.leftExpression.arguments.length&&0===e.leftExpression.arguments[0].argumentCategory)return this._isNarrowingExpression(e.leftExpression.arguments[0].valueExpression,t);const i=this._isNarrowingExpression(e.leftExpression,t);if(n)return i;if(s){const n=this._isNarrowingExpression(e.rightExpression,t);return i||n}}return!(41!==e.operator&&42!==e.operator||!this._isNarrowingExpression(e.rightExpression,t))||41===e.operator&&this._isNarrowingExpression(e.leftExpression,t)}case 56:return 38===e.operator&&this._isNarrowingExpression(e.expression,t);case 5:return this._isNarrowingExpression(e.rightExpression,t);case 9:if(39===e.leftExpression.nodeType&&("isinstance"===e.leftExpression.value||"issubclass"===e.leftExpression.value)&&2===e.arguments.length)return this._isNarrowingExpression(e.arguments[0].valueExpression,t);if(39===e.leftExpression.nodeType&&"callable"===e.leftExpression.value&&1===e.arguments.length)return this._isNarrowingExpression(e.arguments[0].valueExpression,t);if(e.arguments.length>=1)return this._isNarrowingExpression(e.arguments[0].valueExpression,t)}return!1}_createAssignmentTargetFlowNodes(e,t,n){switch(e.nodeType){case 39:case 36:this._createFlowAssignment(e,n),t&&this.walk(e);break;case 53:e.expressions.forEach(e=>{this._createAssignmentTargetFlowNodes(e,t,n)});break;case 55:this._createAssignmentTargetFlowNodes(e.valueExpression,!1,n),t&&this.walk(e);break;case 57:this._createAssignmentTargetFlowNodes(e.expression,!1,n),t&&this.walk(e);break;case 32:e.entries.forEach(e=>{this._createAssignmentTargetFlowNodes(e,t,n)});break;default:t&&this.walk(e)}}_createCallFlowNode(e){if(!this._isCodeUnreachable()){const t={flags:g.FlowFlags.Call,id:g.getUniqueFlowNodeId(),node:e,antecedent:this._currentFlowNode};this._currentFlowNode=t}y.setFlowNode(e,this._currentFlowNode)}_createAssignmentAliasFlowNode(e,t){if(!this._isCodeUnreachable()){const n={flags:g.FlowFlags.AssignmentAlias,id:g.getUniqueFlowNodeId(),antecedent:this._currentFlowNode,targetSymbolId:e,aliasSymbolId:t};this._currentFlowNode=n}}_createFlowAssignment(e,t=!1){let n=b.indeterminateSymbolId;if(39===e.nodeType){const t=this._currentScope.lookUpSymbolRecursive(e.value);o.assert(void 0!==t),n=t.symbol.id}const s=this._currentFlowNode;if(!this._isCodeUnreachable()&&g.isCodeFlowSupportedForReference(e)){const s={flags:g.FlowFlags.Assignment,id:g.getUniqueFlowNodeId(),node:e,antecedent:this._currentFlowNode,targetSymbolId:n},i=g.createKeyForReference(e);this._currentExecutionScopeReferenceMap.set(i,i),t&&(s.flags|=g.FlowFlags.Unbind),this._addExceptTargets(s),this._currentFlowNode=s}t&&void 0!==y.getFlowNode(e)||y.setFlowNode(e,t?s:this._currentFlowNode)}_createFlowWildcardImport(e,t){if(!this._isCodeUnreachable()){const n={flags:g.FlowFlags.WildcardImport,id:g.getUniqueFlowNodeId(),node:e,names:t,antecedent:this._currentFlowNode};this._addExceptTargets(n),this._currentFlowNode=n}y.setFlowNode(e,this._currentFlowNode)}_isCodeUnreachable(){return!!(this._currentFlowNode.flags&g.FlowFlags.Unreachable)}_addExceptTargets(e){this._currentExceptTargets&&this._currentExceptTargets.forEach(t=>{this._addAntecedent(t,e)})}_bindLoopStatement(e,t,n){const s=this._currentContinueTarget,i=this._currentBreakTarget;this._currentContinueTarget=e,this._currentBreakTarget=t,n(),this._currentContinueTarget=s,this._currentBreakTarget=i}_addAntecedent(e,t){this._currentFlowNode.flags&g.FlowFlags.Unreachable||e.antecedents.some(e=>e.id===t.id)||e.antecedents.push(t)}_bindNameToScope(e,t,n){if(void 0===this._currentScope.getBindingType(t)){let s=e.lookUpSymbol(t);if(!s){if(s=e.addSymbol(t,5),2===e.type){const n=e.parent.lookUpSymbol(t);n&&this._createAssignmentAliasFlowNode(s.id,n.id)}C.isPrivateOrProtectedName(t)&&(this._fileInfo.isStubFile?s.setIsExternallyHidden():this._fileInfo.isInPyTypedPackage&&3===this._currentScope.type&&this._potentialPrivateSymbols.set(t,s)),n&&n.set(t,s)}return s}}_bindPossibleTupleNamedTarget(e,t){switch(e.nodeType){case 39:this._bindNameToScope(this._currentScope,e.value,t);break;case 53:e.expressions.forEach(e=>{this._bindPossibleTupleNamedTarget(e,t)});break;case 32:e.entries.forEach(e=>{this._bindPossibleTupleNamedTarget(e,t)});break;case 55:this._bindPossibleTupleNamedTarget(e.valueExpression,t);break;case 57:this._bindPossibleTupleNamedTarget(e.expression,t)}}_addBuiltInSymbolToCurrentScope(e,t,n){const s=this._addSymbolToCurrentScope(e,!1);s&&(s.addDeclaration({type:0,node:t,intrinsicType:n,path:this._fileInfo.filePath,range:u.getEmptyRange(),moduleName:this._fileInfo.moduleName}),s.setIsIgnoredForProtocolMatch())}_addSymbolToCurrentScope(e,t){let n=this._currentScope.lookUpSymbol(e);if(!n){let s=0;t&&(s|=1),2===this._currentScope.type&&(s|=4),this._fileInfo.isStubFile&&C.isPrivateOrProtectedName(e)&&(s|=2),n=this._currentScope.addSymbol(e,s)}return n}_createNewScope(e,t,n){const s=this._currentScope,i=new T.Scope(e,t);this._currentScope=i;const r=4===e||3===e||1===e,o=this._currentExecutionScopeReferenceMap;return r&&(this._currentExecutionScopeReferenceMap=new Map),n(),this._currentExecutionScopeReferenceMap=o,this._currentScope=s,i}_addInferredTypeAssignmentForVariable(e,t,n=!1){switch(e.nodeType){case 39:{const s=e,i=this._currentScope.lookUpSymbolRecursive(s.value);if(i&&i.symbol){const r={type:1,node:e,isConstant:C.isConstantName(e.value),inferredTypeSource:t,typeAliasName:n?e:void 0,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(s.start,d.TextRange.getEnd(s),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};i.symbol.addDeclaration(r)}break}case 36:{const n=this._getMemberAccessInfo(e);if(n){const s=e.memberName;let i=n.classScope.lookUpSymbol(s.value);if(!i){i=n.classScope.addSymbol(s.value,1);const e="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;C.isPrivateOrProtectedName(s.value)&&e&&i.setIsPrivateMember()}n.isInstanceMember?i.isClassMember()&&i.getDeclarations().some(e=>3===e.type&&e.isMethod)||i.setIsInstanceMember():i.setIsClassMember();const r={type:1,node:e.memberName,isConstant:C.isConstantName(s.value),inferredTypeSource:t,isDefinedByMemberAccess:!0,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(e.memberName.start,e.memberName.start+e.memberName.length,this._fileInfo.lines),moduleName:this._fileInfo.moduleName};i.addDeclaration(r)}break}case 53:e.expressions.forEach(e=>{this._addInferredTypeAssignmentForVariable(e,t)});break;case 55:this._addInferredTypeAssignmentForVariable(e.valueExpression,t);break;case 57:this._addInferredTypeAssignmentForVariable(e.expression,t);break;case 32:e.entries.forEach(e=>{this._addInferredTypeAssignmentForVariable(e,t)})}}_addTypeDeclarationForVariable(e,t){let n=!1;switch(e.nodeType){case 39:{const s=e,i=this._currentScope.lookUpSymbolRecursive(s.value);if(i&&i.symbol){const n=this._isAnnotationFinal(t),r=this._isAnnotationTypeAlias(t);let o=t;r?(o=void 0,3!==this._currentScope.type&&this._addError(h.Localizer.Diagnostic.typeAliasNotInModule(),t)):n.isFinal&&(o=n.finalTypeNode);const a={type:1,node:e,isConstant:C.isConstantName(s.value),isFinal:n.isFinal,typeAliasAnnotation:r?t:void 0,typeAliasName:r?e:void 0,path:this._fileInfo.filePath,typeAnnotationNode:o,range:c.convertOffsetsToRange(s.start,d.TextRange.getEnd(s),this._fileInfo.lines),moduleName:this._fileInfo.moduleName};i.symbol.addDeclaration(a),24===t.nodeType&&39===t.baseExpression.nodeType&&"ClassVar"===t.baseExpression.value?i.symbol.setIsClassVar():i.symbol.setIsInstanceMember()}n=!0;break}case 36:{const s=this._getMemberAccessInfo(e);if(s){const i=e.memberName;let r=s.classScope.lookUpSymbol(i.value);if(!r){r=s.classScope.addSymbol(i.value,1);const e="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;C.isPrivateOrProtectedName(i.value)&&e&&r.setIsPrivateMember()}s.isInstanceMember?r.setIsInstanceMember():r.setIsClassMember();const o=this._isAnnotationFinal(t),a={type:1,node:e.memberName,isConstant:C.isConstantName(i.value),isDefinedByMemberAccess:!0,isFinal:o.isFinal,path:this._fileInfo.filePath,typeAnnotationNode:o.isFinal?o.finalTypeNode:t,range:c.convertOffsetsToRange(e.memberName.start,e.memberName.start+e.memberName.length,this._fileInfo.lines),moduleName:this._fileInfo.moduleName};r.addDeclaration(a),n=!0}break}}n||this._addError(h.Localizer.Diagnostic.annotationNotSupported(),t)}_isTypingAnnotation(e,t){if(39===e.nodeType){if(this._typingSymbolAliases.get(e.value)===t)return!0}else if(36===e.nodeType&&39===e.leftExpression.nodeType&&e.memberName.value===t){const t=e.leftExpression.value;return this._typingImportAliases.some(e=>e===t)}return!1}_isAnnotationFinal(e){let t,n=!1;return e&&(this._isTypingAnnotation(e,"Final")?n=!0:24===e.nodeType&&1===e.items.items.length&&this._isAnnotationFinal(e.baseExpression).isFinal&&(n=!0,t=e.items.items[0])),{isFinal:n,finalTypeNode:t}}_isAnnotationTypeAlias(e){return!!e&&!(this._fileInfo.executionEnvironment.pythonVersion<p.PythonVersion.V3_10&&!this._fileInfo.isStubFile)&&this._isTypingAnnotation(e,"TypeAlias")}_getMemberAccessInfo(e){if(39!==e.leftExpression.nodeType)return;const t=e.leftExpression.value,n=f.getEnclosingFunction(e);if(!n)return;const s=f.getEnclosingClass(n);if(!s)return;let i=!1;if(n.parameters.length<1||!n.parameters[0].name)return;const r=s.name.value,a=n.parameters[0].name.value;if(t===r)i=!1;else{if(t!==a)return;if("__new__"===n.name.value)i=!1;else{i=!0;for(const e of n.decorators)if(39===e.expression.nodeType){const t=e.expression.value;if("staticmethod"===t)return;if("classmethod"===t){i=!1;break}}}}const l=y.getScope(s);return o.assert(void 0!==l),{classNode:s,methodNode:n,classScope:l,isInstanceMember:i}}_addImplicitImportsToLoaderActions(e,t){e.implicitImports.forEach(e=>{const n=t.implicitImports?t.implicitImports.get(e.name):void 0;n?n.path=e.path:(t.implicitImports||(t.implicitImports=new Map),t.implicitImports.set(e.name,{path:e.path,implicitImports:new Map}))})}_handleTypingStubAssignmentOrAnnotation(e){if(!this._fileInfo.isTypingStubFile)return!1;let t;if(55===e.nodeType)t=e;else{if(55!==e.leftExpression.nodeType)return!1;t=e.leftExpression}if(39!==t.valueExpression.nodeType)return!1;const n=t.valueExpression.value;if(!{Tuple:!0,Generic:!0,Protocol:!0,Callable:!0,Type:!0,ClassVar:!0,Final:!0,Literal:!0,TypedDict:!0,Union:!0,Optional:!0,Annotated:!0,TypeAlias:!0,OrderedDict:!0,Concatenate:!0,TypeGuard:!0}[n])return!1;const s=this._bindNameToScope(this._currentScope,n);return s&&s.addDeclaration({type:5,node:t,path:this._fileInfo.filePath,range:c.convertOffsetsToRange(t.start,d.TextRange.getEnd(t),this._fileInfo.lines),moduleName:this._fileInfo.moduleName}),!0}_deferBinding(e){this._deferredBindingTasks.push({scope:this._currentScope,codeFlowExpressionMap:this._currentExecutionScopeReferenceMap,callback:e})}_bindDeferred(){for(;this._deferredBindingTasks.length>0;){const e=this._deferredBindingTasks.shift();this._currentScope=e.scope,this._nestedExceptDepth=0,this._currentExecutionScopeReferenceMap=e.codeFlowExpressionMap,e.callback()}}_bindYield(e){const t=f.getEnclosingFunction(e);t?t.isAsync&&62===e.nodeType&&this._addError(h.Localizer.Diagnostic.yieldFromOutsideAsync(),e):f.getEnclosingLambda(e)||this._addError(h.Localizer.Diagnostic.yieldOutsideFunction(),e),this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.yieldStatements||(this._targetFunctionDeclaration.yieldStatements=[]),this._targetFunctionDeclaration.yieldStatements.push(e),this._targetFunctionDeclaration.isGenerator=!0),e.expression&&this.walk(e.expression),y.setFlowNode(e,this._currentFlowNode)}_addDiagnostic(e,t,n,s){let i;switch(e){case"error":i=this._addError(n,s);break;case"warning":i=this._addWarning(n,s);break;case"information":i=this._addInformation(n,s);break;case"none":break;default:return o.assertNever(e,e+" is not expected")}return i&&i.setRule(t),i}_addError(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("error",e,t)}_addWarning(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("warning",e,t)}_addInformation(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("information",e,t)}}t.Binder=S,S._unreachableFlowNode={flags:g.FlowFlags.Unreachable,id:g.getUniqueFlowNodeId()};class I extends _.ParseTreeWalker{constructor(){super(...arguments),this._containsYield=!1}checkContainsYield(e){return this.walk(e),this._containsYield}visitYield(e){return this._containsYield=!0,!1}visitYieldFrom(e){return this._containsYield=!0,!1}}t.YieldFinder=I},6329:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Checker=void 0;const o=n(5839),a=n(1290),l=n(9744),c=n(3550),p=n(2122),u=n(5275),d=r(n(563)),h=n(5523),m=n(7012),y=r(n(8494)),g=n(427),f=n(5083),_=r(n(1766)),T=n(2917),v=n(1133),b=n(5168);class C extends g.ParseTreeWalker{constructor(e,t){super(),this._scopedNodes=[],this._moduleNode=e,this._fileInfo=d.getFileInfo(e),this._evaluator=t}check(){this._scopedNodes.push(this._moduleNode),this._walkStatementsAndReportUnreachable(this._moduleNode.statements);const e=d.getDunderAllNames(this._moduleNode);e&&this._evaluator.markNamesAccessed(this._moduleNode,e),this._validateSymbolTables(),this._reportDuplicateImports()}walk(e){d.isCodeUnreachable(e)?this._evaluator.suppressDiagnostics(()=>{super.walk(e)}):super.walk(e)}visitSuite(e){return this._walkStatementsAndReportUnreachable(e.statements),!1}visitStatementList(e){return e.statements.forEach(e=>{u.isExpressionNode(e)&&this._evaluator.getType(e)}),!0}visitClass(e){const t=this._evaluator.getTypeOfClass(e);return this.walk(e.suite),this.walkMultiple(e.decorators),this.walkMultiple(e.arguments),t&&(this._validateClassMethods(t.classType),this._validateFinalMemberOverrides(t.classType),v.ClassType.isTypedDictClass(t.classType)&&this._validateTypedDictClassSuite(e.suite)),this._scopedNodes.push(e),!1}visitFunction(e){var t;const n=this._evaluator.getTypeOfFunction(e),s=y.getEnclosingClass(e,!0);if(n&&(e.parameters.forEach((e,t)=>{if(e.name&&"_"!==e.name.value){const s=n.functionType.details.parameters[t].type;if(v.isUnknown(s)||v.isTypeVar(s)&&s.details.isSynthesized&&!s.details.boundType)this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,l.DiagnosticRule.reportUnknownParameterType,p.Localizer.Diagnostic.paramTypeUnknown().format({paramName:e.name.value}),e.name);else if(b.isPartlyUnknown(s)){const t=new a.DiagnosticAddendum;t.addMessage(p.Localizer.DiagnosticAddendum.paramType().format({paramType:this._evaluator.printType(s,!0)})),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,l.DiagnosticRule.reportUnknownParameterType,p.Localizer.Diagnostic.paramTypePartiallyUnknown().format({paramName:e.name.value})+t.getString(),e.name)}}if(e.defaultValue&&this._fileInfo.isStubFile){const t=this._evaluator.getType(e.defaultValue);t&&b.isEllipsisType(t)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,l.DiagnosticRule.reportInvalidStubStatement,p.Localizer.Diagnostic.defaultValueNotEllipsis(),e.defaultValue)}}),this._fileInfo.isStubFile&&(e.returnTypeAnnotation||(null===(t=e.functionAnnotationComment)||void 0===t?void 0:t.returnTypeAnnotation)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,l.DiagnosticRule.reportUnknownParameterType,p.Localizer.Diagnostic.returnTypeUnknown(),e.name)),s&&this._validateMethod(e,n.functionType,s)),e.parameters.forEach((t,s)=>{if(t.defaultValue&&this.walk(t.defaultValue),t.typeAnnotation&&this.walk(t.typeAnnotation),t.typeAnnotationComment&&this.walk(t.typeAnnotationComment),n){const i=t.typeAnnotation||t.typeAnnotationComment;if(i){const t=n.functionType.details.parameters[s].type,r=new a.DiagnosticAddendum;this._containsCovariantTypeVar(t,e.id,r)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.paramTypeCovariant()+r.getString(),i)}}}),e.returnTypeAnnotation&&this.walk(e.returnTypeAnnotation),e.functionAnnotationComment&&this.walk(e.functionAnnotationComment),this.walkMultiple(e.decorators),e.parameters.forEach(e=>{e.name&&this.walk(e.name)}),this.walk(e.suite),n&&this._validateFunctionReturn(e,n.functionType),this._fileInfo.isStubFile&&"__getattr__"===e.name.value){const t=f.getScopeForNode(e);3===(null==t?void 0:t.type)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownMemberType,l.DiagnosticRule.reportUnknownMemberType,p.Localizer.Diagnostic.stubUsesGetAttr(),e.name)}if(this._scopedNodes.push(e),n&&6===n.decoratedType.category){const t=n.decoratedType.overloads;t.length>1&&this._validateOverloadConsistency(e,t[t.length-1],t.slice(0,t.length-1))}return!1}visitLambda(e){this._evaluator.getType(e),this.walkMultiple([...e.parameters,e.expression]),e.parameters.forEach(e=>{if(e.name){const t=this._evaluator.getType(e.name);t&&(v.isUnknown(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,l.DiagnosticRule.reportUnknownLambdaType,p.Localizer.Diagnostic.paramTypeUnknown().format({paramName:e.name.value}),e.name):b.isPartlyUnknown(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,l.DiagnosticRule.reportUnknownLambdaType,p.Localizer.Diagnostic.paramTypePartiallyUnknown().format({paramName:e.name.value}),e.name))}});const t=this._evaluator.getType(e.expression);return t&&(v.isUnknown(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,l.DiagnosticRule.reportUnknownLambdaType,p.Localizer.Diagnostic.lambdaReturnTypeUnknown(),e.expression):b.isPartlyUnknown(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,l.DiagnosticRule.reportUnknownLambdaType,p.Localizer.Diagnostic.lambdaReturnTypePartiallyUnknown().format({returnType:this._evaluator.printType(t,!1)}),e.expression)),this._scopedNodes.push(e),!1}visitCall(e){return this._validateIsInstanceCall(e),y.isWithinDefaultParamInitializer(e)&&!this._fileInfo.isStubFile&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportCallInDefaultInitializer,l.DiagnosticRule.reportCallInDefaultInitializer,p.Localizer.Diagnostic.defaultValueContainsCall(),e),!0}visitFor(e){return this._evaluator.evaluateTypesForStatement(e),!0}visitListComprehension(e){return this._scopedNodes.push(e),!0}visitIf(e){return this._evaluator.getType(e.testExpression),!0}visitWhile(e){return this._evaluator.getType(e.testExpression),!0}visitWith(e){return e.withItems.forEach(e=>{this._evaluator.evaluateTypesForStatement(e)}),!0}visitReturn(e){let t;const n=y.getEnclosingFunction(e),s=n?this._evaluator.getFunctionDeclaredReturnType(n):void 0;if(t=e.returnExpression?this._evaluator.getType(e.returnExpression)||v.UnknownType.create():v.NoneType.createInstance(),this._evaluator.isNodeReachable(e)&&n){if(s)if(b.isNoReturnType(s))this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.noReturnContainsReturn(),e);else{const n=new a.DiagnosticAddendum,i=b.specializeType(s,void 0);this._evaluator.canAssignType(i,t,n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.returnTypeMismatch().format({exprType:this._evaluator.printType(t,!1),returnType:this._evaluator.printType(i,!1)})+n.getString(),e.returnExpression?e.returnExpression:e)}v.isUnknown(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,l.DiagnosticRule.reportUnknownVariableType,p.Localizer.Diagnostic.returnTypeUnknown(),e.returnExpression):b.isPartlyUnknown(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,l.DiagnosticRule.reportUnknownVariableType,p.Localizer.Diagnostic.returnTypePartiallyUnknown().format({returnType:this._evaluator.printType(t,!0)}),e.returnExpression)}return!0}visitYield(e){const t=e.expression?this._evaluator.getType(e.expression):v.NoneType.createInstance();let n=t;const s=this._evaluator.getBuiltInType(e,"Iterator");return n=t&&v.isClass(s)?v.ObjectType.create(v.ClassType.cloneForSpecialization(s,[t],!1)):v.UnknownType.create(),this._validateYieldType(e,n),!0}visitYieldFrom(e){const t=this._evaluator.getType(e.expression);return t&&this._validateYieldType(e,t),!0}visitRaise(e){if(this._evaluator.verifyRaiseExceptionType(e),e.valueExpression){const t=this._evaluator.getBuiltInType(e,"BaseException"),n=this._evaluator.getType(e.valueExpression);if(n&&t&&v.isClass(t)){const s=new a.DiagnosticAddendum;b.doForSubtypes(n,e=>(v.isAnyOrUnknown(e)||v.isNone(e)||v.isObject(e)&&b.derivesFromClassRecursive(e.classType,t,!1)||s.addMessage(p.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e,!1)})),e)),s.isEmpty()||this._evaluator.addError(p.Localizer.Diagnostic.expectedExceptionObj()+s.getString(),e.valueExpression)}}return!0}visitExcept(e){if(e.typeExpression){this._evaluator.evaluateTypesForStatement(e);const t=this._evaluator.getType(e.typeExpression);t&&this._validateExceptionType(t,e.typeExpression)}return!0}visitAssert(e){e.exceptionExpression&&this._evaluator.getType(e.exceptionExpression);const t=this._evaluator.getType(e.testExpression);if(t&&v.isObject(t)&&b.isTupleClass(t.classType)&&t.classType.typeArguments&&t.classType.typeArguments.length>0){const n=t.classType.typeArguments[t.classType.typeArguments.length-1];b.isEllipsisType(n)||this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportAssertAlwaysTrue,l.DiagnosticRule.reportAssertAlwaysTrue,p.Localizer.Diagnostic.assertAlwaysTrue(),e.testExpression)}return!0}visitAssignment(e){return this._evaluator.evaluateTypesForStatement(e),e.typeAnnotationComment&&this._evaluator.getType(e.typeAnnotationComment),!0}visitAssignmentExpression(e){return this._evaluator.getType(e),!0}visitAugmentedAssignment(e){return this._evaluator.evaluateTypesForStatement(e),!0}visitIndex(e){return this._evaluator.getType(e),!0}visitBinaryOperation(e){return this._evaluator.getType(e),!0}visitSlice(e){return this._evaluator.getType(e),!0}visitUnpack(e){return this._evaluator.getType(e),!0}visitTuple(e){return this._evaluator.getType(e),!0}visitUnaryOperation(e){return this._evaluator.getType(e),!0}visitTernary(e){return this._evaluator.getType(e),!0}visitStringList(e){return e.typeAnnotation&&this._evaluator.getType(e),e.strings.length>1&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportImplicitStringConcatenation,l.DiagnosticRule.reportImplicitStringConcatenation,p.Localizer.Diagnostic.implicitStringConcat(),e),!0}visitFormatString(e){return e.expressions.forEach(e=>{this._evaluator.getType(e)}),!0}visitName(e){return this._conditionallyReportPrivateUsage(e),!0}visitDel(e){return e.expressions.forEach(e=>{this._evaluator.verifyDeleteExpression(e)}),!0}visitMemberAccess(e){return this._evaluator.getType(e),this._conditionallyReportPrivateUsage(e.memberName),this.walk(e.leftExpression),!1}visitImportAs(e){return this._evaluator.evaluateTypesForStatement(e),!1}visitImportFrom(e){if(e.isWildcardImport){const t=d.getImportInfo(e.module);t&&t.isImportFound&&2!==t.importType&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportWildcardImportFromLibrary,l.DiagnosticRule.reportWildcardImportFromLibrary,p.Localizer.Diagnostic.wildcardLibraryImport(),e.wildcardToken||e)}else e.imports.forEach(e=>{this._evaluator.evaluateTypesForStatement(e)});return!1}visitTypeAnnotation(e){return this._evaluator.getType(e.typeAnnotation),!0}visitError(e){return e.child&&this._evaluator.getType(e.child),!1}_validateOverloadConsistency(e,t,n){for(let s=0;s<n.length;s++){const i=n[s];if(this._isOverlappingOverload(t,i)){this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.overlappingOverload().format({name:e.name.value,obscured:n.length+1,obscuredBy:s+1}),e.name);break}}for(let s=0;s<n.length;s++){const i=n[s];if(this._isOverlappingOverload(i,t)){const r=v.FunctionType.getSpecializedReturnType(i),o=v.FunctionType.getSpecializedReturnType(t);if(r&&o&&!this._evaluator.canAssignType(o,r,new a.DiagnosticAddendum)){const t=this._findNodeForOverload(e,i);this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.overloadReturnTypeMismatch().format({name:e.name.value,newIndex:n.length+1,prevIndex:s+1}),(t||e).name);break}}}}_findNodeForOverload(e,t){const n=this._evaluator.getDeclarationsForNameNode(e.name);if(n)for(const e of n)if(3===e.type){const n=this._evaluator.getTypeOfFunction(e.node);if((null==n?void 0:n.functionType)===t)return e.node}}_isOverlappingOverload(e,t){return this._evaluator.canAssignType(e,t,new a.DiagnosticAddendum,void 0,28)}_walkStatementsAndReportUnreachable(e){let t=!1;for(const n of e){if(!t&&!this._evaluator.isNodeReachable(n)){const s=n.start,i=e[e.length-1],r=c.TextRange.getEnd(i);this._evaluator.addUnusedCode(n,{start:s,length:r-s}),t=!0}!t&&this._fileInfo.isStubFile&&this._validateStubStatement(n),this.walk(n)}}_validateStubStatement(e){switch(e.nodeType){case 19:case 29:case 10:case 0:break;case 58:case 27:case 54:case 59:this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,l.DiagnosticRule.reportInvalidStubStatement,p.Localizer.Diagnostic.invalidStubStatement(),e);break;case 48:for(const t of e.statements)switch(t.nodeType){case 2:case 4:case 5:case 6:case 7:case 9:case 11:case 14:case 15:case 24:case 27:case 28:case 30:case 31:case 32:case 36:case 39:case 40:case 41:case 44:case 45:case 46:case 47:case 52:case 53:case 54:case 56:case 57:case 58:case 59:case 60:case 61:case 62:this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,l.DiagnosticRule.reportInvalidStubStatement,p.Localizer.Diagnostic.invalidStubStatement(),t)}}}_validateExceptionType(e,t){const n=this._evaluator.getBuiltInType(t,"BaseException"),s=e=>!n||!v.isClass(n)||b.derivesFromClassRecursive(e,n,!1),i=new a.DiagnosticAddendum;let r;if(v.isAnyOrUnknown(e))r=e;else if(v.isObject(e)&&(e=b.transformTypeObjectToClass(e)),v.isClass(e))s(e)||i.addMessage(p.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e,!1)})),r=v.ObjectType.create(e);else if(v.isObject(e)){const n=this._evaluator.getTypeFromIterable(e,!1,t,!1);r=b.doForSubtypes(n,t=>{if(v.isAnyOrUnknown(t))return t;const n=b.transformTypeObjectToClass(t);return v.isClass(n)?(s(n)||i.addMessage(p.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e,!1)})),v.ObjectType.create(n)):(i.addMessage(p.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e,!1)})),v.UnknownType.create())})}return i.isEmpty()||this._evaluator.addError(p.Localizer.Diagnostic.exceptionTypeNotClass().format({type:this._evaluator.printType(e,!1)}),t),r||v.UnknownType.create()}_validateSymbolTables(){for(const e of this._scopedNodes){const t=d.getScope(e);t&&t.symbolTable.forEach((e,n)=>{this._conditionallyReportUnusedSymbol(n,e,t.type),this._reportIncompatibleDeclarations(n,e),this._reportMultipleFinalDeclarations(n,e),this._reportMultipleTypeAliasDeclarations(n,e),this._reportInvalidOverload(n,e)})}}_reportInvalidOverload(e,t){const n=t.getTypedDeclarations();if(1===n.length){const s=n[0];if(3===s.type){const n=this._evaluator.getEffectiveTypeOfSymbol(t);5===n.category&&v.FunctionType.isOverloaded(n)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.singleOverload().format({name:e}),s.node.name)}}}_reportMultipleFinalDeclarations(e,t){if(!T.isFinalVariable(t))return;const n=t.getDeclarations();let s=!1,i=!1;if(n.forEach(t=>{h.isFinalVariableDeclaration(t)&&(s&&this._evaluator.addError(p.Localizer.Diagnostic.finalRedeclaration().format({name:e}),t.node),s=!0),1===t.type&&t.inferredTypeSource&&(i&&this._evaluator.addError(p.Localizer.Diagnostic.finalReassigned().format({name:e}),t.node),i=!0)}),!i&&!this._fileInfo.isStubFile){const t=n.find(e=>1===e.type&&e.isFinal);t&&this._evaluator.addError(p.Localizer.Diagnostic.finalUnassigned().format({name:e}),t.node)}}_reportMultipleTypeAliasDeclarations(e,t){const n=t.getDeclarations(),s=n.find(e=>h.isExplicitTypeAliasDeclaration(e));s&&n.length>1&&n.forEach(t=>{t!==s&&this._evaluator.addError(p.Localizer.Diagnostic.typeAliasRedeclared().format({name:e}),t.node)})}_reportIncompatibleDeclarations(e,t){const n=T.getLastTypedDeclaredForSymbol(t);if(!n)return;let s,i=t.getDeclarations().filter(e=>e!==n);if(3===n.type&&(i=i.filter(e=>3!==e.type)),0===i.length)return;s=3===n.type?n.isMethod?p.Localizer.DiagnosticAddendum.seeMethodDeclaration():p.Localizer.DiagnosticAddendum.seeFunctionDeclaration():4===n.type?p.Localizer.DiagnosticAddendum.seeClassDeclaration():2===n.type?p.Localizer.DiagnosticAddendum.seeParameterDeclaration():1===n.type?p.Localizer.DiagnosticAddendum.seeVariableDeclaration():p.Localizer.DiagnosticAddendum.seeDeclaration();const r=e=>{if(e){let t;3===n.type||4===n.type?t=n.node.name:1===n.type?39===n.node.nodeType&&(t=n.node):2===n.type&&n.node.name&&(t=n.node.name),t&&e.addRelatedInfo(s,n.path,n.range)}};for(const t of i)if(4===t.type)r(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.obscuredClassDeclaration().format({name:e}),t.node.name));else if(3===t.type)r(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.obscuredFunctionDeclaration().format({name:e}),t.node.name));else if(2===t.type)t.node.name&&r(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.obscuredParameterDeclaration().format({name:e}),t.node.name));else if(1===t.type){const s=this._evaluator.getTypeForDeclaration(n);if(t.typeAnnotationNode){if(39===t.node.nodeType){let i=!1;if(1===n.type){const e=this._evaluator.getTypeForDeclaration(t);s&&e&&v.isTypeSame(s,e)&&(i=!0)}i||r(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.obscuredVariableDeclaration().format({name:e}),t.node))}}else!s||b.isProperty(s)||3!==n.type&&4!==n.type||r(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.obscuredVariableDeclaration().format({name:e}),t.node))}}_conditionallyReportUnusedSymbol(e,t,n){const s=this._fileInfo.accessedSymbolMap;t.isIgnoredForProtocolMatch()||s.has(t.id)||"_"!==e&&(_.isDunderName(e)||t.getDeclarations().forEach(t=>{this._conditionallyReportUnusedDeclaration(t,this._isSymbolPrivate(e,n))}))}_conditionallyReportUnusedDeclaration(e,t){let n,s,i,r;switch(e.type){case 6:if(n=this._fileInfo.diagnosticRuleSet.reportUnusedImport,r=l.DiagnosticRule.reportUnusedImport,21===e.node.nodeType)if(e.node.alias)this._fileInfo.isStubFile||(s=e.node.alias);else{const t=e.node.module.nameParts;if(t.length>0){const e=t.map(e=>e.value).join("."),n={start:t[0].start,length:t[0].length};return c.TextRange.extend(n,t[t.length-1]),this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange(p.Localizer.Diagnostic.unaccessedSymbol().format({name:e}),n,{action:"pyright.unusedImport"}),void this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportUnusedImport,l.DiagnosticRule.reportUnusedImport,p.Localizer.Diagnostic.unaccessedImport().format({name:e}),n)}}else if(23===e.node.nodeType){const t=e.node.parent,n=this._fileInfo.isStubFile&&void 0!==e.node.alias,i=1===t.module.nameParts.length&&"__future__"===t.module.nameParts[0].value;n||i||(s=e.node.alias||e.node.name)}s&&(i=p.Localizer.Diagnostic.unaccessedImport().format({name:s.value}));break;case 1:case 2:if(!t)return;if(this._fileInfo.isStubFile)return;n=this._fileInfo.diagnosticRuleSet.reportUnusedVariable,39===e.node.nodeType?s=e.node:42===e.node.nodeType&&(s=e.node.name,n="none"),s&&(r=l.DiagnosticRule.reportUnusedVariable,i=p.Localizer.Diagnostic.unaccessedVariable().format({name:s.value}));break;case 4:if(!t)return;if(this._fileInfo.isStubFile)return;n=this._fileInfo.diagnosticRuleSet.reportUnusedClass,s=e.node.name,r=l.DiagnosticRule.reportUnusedClass,i=p.Localizer.Diagnostic.unaccessedClass().format({name:s.value});break;case 3:if(!t)return;if(this._fileInfo.isStubFile)return;n=this._fileInfo.diagnosticRuleSet.reportUnusedFunction,s=e.node.name,r=l.DiagnosticRule.reportUnusedFunction,i=p.Localizer.Diagnostic.unaccessedFunction().format({name:s.value});break;default:return}if(s&&void 0!==r&&i){const e=r===l.DiagnosticRule.reportUnusedImport?{action:"pyright.unusedImport"}:void 0;this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange(p.Localizer.Diagnostic.unaccessedSymbol().format({name:s.value}),s,e),this._evaluator.addDiagnostic(n,r,i,s)}}_validateIsInstanceCall(e){if(39!==e.leftExpression.nodeType||"isinstance"!==e.leftExpression.value&&"issubclass"!==e.leftExpression.value||2!==e.arguments.length)return;const t=e.leftExpression.value,n="isinstance"===t;let s=this._evaluator.getType(e.arguments[0].valueExpression);if(!s)return;if(s=b.doForSubtypes(s,e=>b.transformPossibleRecursiveTypeAlias(b.transformTypeObjectToClass(e))),b.derivesFromAnyOrUnknown(s))return;const i=this._evaluator.getType(e.arguments[1].valueExpression);if(!i)return;const r=e=>{let t=!0;return b.doForSubtypes(e,e=>{switch((e=b.makeTypeVarsConcrete(e)).category){case 2:case 1:case 0:break;case 7:e.isTypeArgumentExplicit&&(t=!1);break;case 5:t=v.TypeBase.isInstantiable(e);break;default:t=!1}}),t};let o=!0;if(o=v.isObject(i)&&b.isTupleClass(i.classType)&&i.classType.typeArguments?!i.classType.typeArguments.some(e=>!r(e)):r(i),!o){const t=new a.DiagnosticAddendum;t.addMessage(p.Localizer.DiagnosticAddendum.typeVarNotAllowed()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,n?p.Localizer.Diagnostic.isInstanceInvalidType().format({type:this._evaluator.printType(i,!1)})+t.getString():p.Localizer.Diagnostic.isSubclassInvalidType().format({type:this._evaluator.printType(i,!1)})+t.getString(),e.arguments[1])}let c=e;for(;c;){if(2===c.nodeType)return;c=c.parent}const u=["FunctionType","LambdaType","BuiltinFunctionType","BuiltinMethodType"],d=[];if(v.isClass(i)){if(d.push(i),v.ClassType.isBuiltIn(i)&&u.some(e=>e===i.details.name))return}else{if(!v.isObject(i))return;{const e=i.classType;if(b.isTupleClass(e)&&e.typeArguments&&e.typeArguments.forEach(e=>{v.isClass(e)&&d.push(e)}),v.ClassType.isBuiltIn(e)&&u.some(t=>t===e.details.name))return}}d.some(e=>v.ClassType.isProtocolClass(e)&&!v.ClassType.isRuntimeCheckable(e))&&this._evaluator.addError(p.Localizer.Diagnostic.protocolUsedInCall().format({name:t}),e.arguments[1].valueExpression);const h=e=>v.combineTypes(e),m=e=>{const t=[];for(const n of d){const s=v.ClassType.isDerivedFrom(e,n),i=v.ClassType.isDerivedFrom(n,e);i&&i&&!v.ClassType.isSameGenericClass(e,n)?t.push(v.UnknownType.create()):s?t.push(e):i&&t.push(n)}return n?t.map(e=>v.isClass(e)?v.ObjectType.create(e):e):t};let y;if(n&&v.isObject(s))y=h(m(s.classType));else if(!n&&v.isClass(s))y=h(m(s));else{if(10!==s.category)return;{let e=[],t=!1;if(s.subtypes.forEach(s=>{v.isAnyOrUnknown(s)&&(t=!0),n&&v.isObject(s)?e=e.concat(m(s.classType)):!n&&v.isClass(s)&&(e=e.concat(m(s)))}),y=h(e),t)return}}const g=()=>{const e=d.map(e=>v.ObjectType.create(e));return v.combineTypes(e)};v.isNever(y)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryIsInstance,l.DiagnosticRule.reportUnnecessaryIsInstance,n?p.Localizer.Diagnostic.unnecessaryIsInstanceNever().format({testType:this._evaluator.printType(s,!1),classType:this._evaluator.printType(g(),!1)}):p.Localizer.Diagnostic.unnecessaryIsSubclassNever().format({testType:this._evaluator.printType(s,!1),classType:this._evaluator.printType(g(),!1)}),e):v.isTypeSame(y,s)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryIsInstance,l.DiagnosticRule.reportUnnecessaryIsInstance,n?p.Localizer.Diagnostic.unnecessaryIsInstanceAlways().format({testType:this._evaluator.printType(s,!1),classType:this._evaluator.printType(g(),!1)}):p.Localizer.Diagnostic.unnecessaryIsSubclassAlways().format({testType:this._evaluator.printType(s,!1),classType:this._evaluator.printType(g(),!1)}),e)}_isSymbolPrivate(e,t){return 1===t||0===t||(!!_.isPrivateName(e)||!!_.isProtectedName(e)&&!(2===t))}_conditionallyReportPrivateUsage(e){if("none"===this._fileInfo.diagnosticRuleSet.reportPrivateUsage)return;if(this._fileInfo.isStubFile)return;const t=e.value,n=_.isPrivateName(t),s=_.isProtectedName(t);if(!n&&!s)return;const i=this._evaluator.getDeclarationsForNameNode(e);let r,o=i&&i.length>0?i[i.length-1]:void 0;if(!o||o.node===e)return;if(6===o.type&&o.usesLocalName)return;if(o=this._evaluator.resolveAliasDeclaration(o,!0),!o||o.node===e)return;o.node&&(r=y.getEnclosingClassOrModule(o.node)),o.node&&o.node.parent&&o.node.parent===r&&10===r.nodeType&&(r=y.getEnclosingClassOrModule(r));let a=!1;if(r&&10===r.nodeType&&s){const t=this._evaluator.getTypeOfClass(r);if(t&&v.isClass(t.decoratedType)){a=!0;const n=y.getEnclosingClass(e);if(n){a=!0;const e=this._evaluator.getTypeOfClass(n);if(e&&v.isClass(e.decoratedType)&&b.derivesFromClassRecursive(e.decoratedType,t.decoratedType,!0))return}}}r&&!y.isNodeContainedWithin(e,r)&&(a?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportPrivateUsage,l.DiagnosticRule.reportPrivateUsage,p.Localizer.Diagnostic.protectedUsedOutsideOfClass().format({name:t}),e):this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportPrivateUsage,l.DiagnosticRule.reportPrivateUsage,10===r.nodeType?p.Localizer.Diagnostic.privateUsedOutsideOfClass().format({name:t}):p.Localizer.Diagnostic.privateUsedOutsideOfModule().format({name:t}),e))}_validateTypedDictClassSuite(e){const t=e=>{this._evaluator.addError(p.Localizer.Diagnostic.typedDictBadVar(),e)};e.statements.forEach(e=>{if(!d.isCodeUnreachable(e))if(48===e.nodeType)for(const n of e.statements)55!==n.nodeType&&18!==n.nodeType&&49!==n.nodeType&&43!==n.nodeType&&t(n);else t(e)})}_validateFunctionReturn(e,t){var n;if(this._fileInfo.isStubFile)return;const s=e.returnTypeAnnotation||(null===(n=e.functionAnnotationComment)||void 0===n?void 0:n.returnTypeAnnotation);if(s){const n=!this._evaluator.isAfterNodeReachable(e),i=this._evaluator.isAfterNodeReachable(e.suite);let r=t.details.declaredReturnType;if(r){v.isUnknown(r)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,l.DiagnosticRule.reportUnknownVariableType,p.Localizer.Diagnostic.declaredReturnTypeUnknown(),s):b.isPartlyUnknown(r)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,l.DiagnosticRule.reportUnknownVariableType,p.Localizer.Diagnostic.declaredReturnTypePartiallyUnknown().format({returnType:this._evaluator.printType(r,!0)}),s);const t=new a.DiagnosticAddendum;this._containsContravariantTypeVar(r,e.id,t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.returnTypeContravariant()+t.getString(),s)}if(v.FunctionType.isGenerator(t)&&(r=b.getDeclaredGeneratorReturnType(t)),r&&!n&&i)if(b.isNoReturnType(r))y.isSuiteEmpty(e.suite)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.noReturnReturnsNone(),s);else if(!v.FunctionType.isAbstractMethod(t)){const t=new a.DiagnosticAddendum;this._evaluator.canAssignType(r,v.NoneType.createInstance(),t)||y.isSuiteEmpty(e.suite)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.returnMissing().format({returnType:this._evaluator.printType(r,!1)})+t.getString(),s)}}else{const n=this._evaluator.getFunctionInferredReturnType(t);v.isUnknown(n)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,l.DiagnosticRule.reportUnknownParameterType,p.Localizer.Diagnostic.returnTypeUnknown(),e.name):b.isPartlyUnknown(n)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,l.DiagnosticRule.reportUnknownParameterType,p.Localizer.Diagnostic.returnTypePartiallyUnknown().format({returnType:this._evaluator.printType(n,!0)}),e.name)}}_containsContravariantTypeVar(e,t,n){let s=!0;return b.doForSubtypes(e,e=>{if(v.isTypeVar(e)&&e.details.isContravariant){const i=v.TypeVarType.makeScopeId(e.details.name,t);e.scopeId!==i&&(n.addMessage(p.Localizer.DiagnosticAddendum.typeVarIsContravariant().format({name:e.details.name})),s=!1)}}),!s}_containsCovariantTypeVar(e,t,n){let s=!0;return b.doForSubtypes(e,e=>{if(v.isTypeVar(e)&&e.details.isCovariant){const i=v.TypeVarType.makeScopeId(e.details.name,t);e.scopeId!==i&&(n.addMessage(p.Localizer.DiagnosticAddendum.typeVarIsCovariant().format({name:e.details.name})),s=!1)}}),!s}_validateFinalMemberOverrides(e){e.details.fields.forEach((t,n)=>{const s=b.lookUpClassMember(e,n,1);if(s&&v.isClass(s.classType)&&T.isFinalVariable(s.symbol)){const e=t.getDeclarations()[0];this._evaluator.addError(p.Localizer.Diagnostic.finalRedeclarationBySubclass().format({name:n,className:s.classType.details.name}),e.node)}})}_validateClassMethods(e){this._fileInfo.isStubFile||this._validateBaseClassOverrides(e)}_validateBaseClassOverrides(e){e.details.fields.forEach((t,n)=>{if(!t.isClassMember()||_.isDunderName(n)||_.isPrivateOrProtectedName(n))return;const s=this._evaluator.getEffectiveTypeOfSymbol(t);if(v.isAnyOrUnknown(s))return;const i=b.lookUpClassMember(e,n,1);if(!i||!v.isClass(i.classType))return;if(!i.symbol.hasTypedDeclarations())return;const r=b.partiallySpecializeType(this._evaluator.getEffectiveTypeOfSymbol(i.symbol),i.classType),o=new a.DiagnosticAddendum;if(5===r.category||6===r.category){if(5===s.category){if(!this._evaluator.canOverrideMethod(r,s,o)){const e=T.getLastTypedDeclaredForSymbol(t);if(e&&3===e.type){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,l.DiagnosticRule.reportIncompatibleMethodOverride,p.Localizer.Diagnostic.incompatibleMethodOverride().format({name:n,className:i.classType.details.name})+o.getString(),e.node.name),s=T.getLastTypedDeclaredForSymbol(i.symbol);t&&s&&t.addRelatedInfo(p.Localizer.DiagnosticAddendum.overriddenMethod(),s.path,s.range)}}if(5===r.category&&v.FunctionType.isFinal(r)){const e=T.getLastTypedDeclaredForSymbol(t);if(e&&3===e.type){const t=this._evaluator.addError(p.Localizer.Diagnostic.finalMethodOverride().format({name:n,className:i.classType.details.name}),e.node.name),s=T.getLastTypedDeclaredForSymbol(i.symbol);t&&s&&t.addRelatedInfo(p.Localizer.DiagnosticAddendum.finalMethod(),s.path,s.range)}}}else if(!v.isAnyOrUnknown(s)){const e=t.getDeclarations();if(e.length>0){const t=e[e.length-1],s=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,l.DiagnosticRule.reportIncompatibleMethodOverride,p.Localizer.Diagnostic.methodOverridden().format({name:n,className:i.classType.details.name})+o.getString(),t.node),r=T.getLastTypedDeclaredForSymbol(i.symbol);s&&r&&s.addRelatedInfo(p.Localizer.DiagnosticAddendum.overriddenMethod(),r.path,r.range)}}}else if("none"!==this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride&&!this._evaluator.canAssignType(r,s,o)){const e=t.getDeclarations();if(e.length>0){const t=e[e.length-1];if(t){const e=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,l.DiagnosticRule.reportIncompatibleVariableOverride,p.Localizer.Diagnostic.symbolOverridden().format({name:n,className:i.classType.details.name})+o.getString(),t.node),s=T.getLastTypedDeclaredForSymbol(i.symbol);e&&s&&e.addRelatedInfo(p.Localizer.DiagnosticAddendum.overriddenSymbol(),s.path,s.range)}}}})}_validateMethod(e,t,n){if(e.name&&"__new__"===e.name.value)(0===e.parameters.length||!e.parameters[0].name||"cls"!==e.parameters[0].name.value&&"mcs"!==e.parameters[0].name.value)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,l.DiagnosticRule.reportSelfClsParameterName,p.Localizer.Diagnostic.newClsParam(),e.parameters.length>0?e.parameters[0]:e.name);else if(e.name&&"__init_subclass__"===e.name.value)0!==e.parameters.length&&e.parameters[0].name&&"cls"===e.parameters[0].name.value||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,l.DiagnosticRule.reportSelfClsParameterName,p.Localizer.Diagnostic.initSubclassClsParam(),e.parameters.length>0?e.parameters[0]:e.name);else if(e.name&&"__class_getitem__"===e.name.value)0!==e.parameters.length&&e.parameters[0].name&&"cls"===e.parameters[0].name.value||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,l.DiagnosticRule.reportSelfClsParameterName,p.Localizer.Diagnostic.classGetItemClsParam(),e.parameters.length>0?e.parameters[0]:e.name);else if(v.FunctionType.isStaticMethod(t)){if(e.parameters.length>0&&e.parameters[0].name){const t=e.parameters[0].name.value;"self"!==t&&"cls"!==t||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,l.DiagnosticRule.reportSelfClsParameterName,p.Localizer.Diagnostic.staticClsSelfParam(),e.parameters[0].name)}}else if(v.FunctionType.isClassMethod(t)){let t="";e.parameters.length>0&&e.parameters[0].name&&(t=e.parameters[0].name.value),"cls"!==t&&(this._fileInfo.isStubFile&&(t.startsWith("_")||"metacls"===t)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,l.DiagnosticRule.reportSelfClsParameterName,p.Localizer.Diagnostic.classMethodClsParam(),e.parameters.length>0?e.parameters[0]:e.name))}else if(0===e.decorators.length){let t="",s=!0;if(e.parameters.length>0&&(e.parameters[0].name&&(t=e.parameters[0].name.value),0!==e.parameters[0].category&&(s=!1)),s&&"self"!==t){let s=!1;if("cls"===t){const e=this._evaluator.getTypeOfClass(n),t=this._evaluator.getBuiltInType(n,"type");t&&v.isClass(t)&&e&&v.isClass(e.classType)&&b.derivesFromClassRecursive(e.classType,t,!0)&&(s=!0)}const i=_.isPrivateOrProtectedName(t);s||i||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,l.DiagnosticRule.reportSelfClsParameterName,p.Localizer.Diagnostic.instanceMethodSelfParam(),e.parameters.length>0?e.parameters[0]:e.name)}}}_validateYieldType(e,t){let n;const s=y.getEnclosingFunction(e);if(s){const t=this._evaluator.getTypeOfFunction(s);if(t){o.assert(5===t.functionType.category);const s=this._evaluator.getBuiltInType(e,"Iterable");n=b.getDeclaredGeneratorYieldType(t.functionType,s)}}if(this._evaluator.isNodeReachable(e)&&n)if(b.isNoReturnType(n))this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.noReturnContainsYield(),e);else{const s=new a.DiagnosticAddendum;this._evaluator.canAssignType(n,t,s)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,p.Localizer.Diagnostic.yieldTypeMismatch().format({exprType:this._evaluator.printType(t,!1),yieldType:this._evaluator.printType(n,!1)})+s.getString(),e.expression||e)}}_reportDuplicateImports(){const e=m.getTopLevelImports(this._moduleNode),t=new Map;e.orderedImports.forEach(e=>{if(22===e.node.nodeType){const t=new Map;e.node.imports.forEach(e=>{e.alias||(t.get(e.name.value)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDuplicateImport,l.DiagnosticRule.reportDuplicateImport,p.Localizer.Diagnostic.duplicateImport().format({importName:e.name.value}),e.name):t.set(e.name.value,e))})}else e.subnode&&!e.subnode.alias&&(t.get(e.moduleName)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDuplicateImport,l.DiagnosticRule.reportDuplicateImport,p.Localizer.Diagnostic.duplicateImport().format({importName:e.moduleName}),e.subnode):t.set(e.moduleName,e.subnode))})}}t.Checker=C},2835:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CircularDependency=void 0,t.CircularDependency=class{constructor(){this._paths=[]}appendPath(e){this._paths.push(e)}getPaths(){return this._paths}normalizeOrder(){let e=0;this._paths.forEach((t,n)=>{t<this._paths[e]&&(e=n)}),0!==e&&(this._paths=this._paths.slice(e).concat(this._paths.slice(0,e)))}isEqual(e){if(e._paths.length!==this._paths.length)return!1;for(let t=0;t<this._paths.length;t++)if(this._paths[t]!==e._paths[t])return!1;return!0}}},6610:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createKeyForReference=t.isCodeFlowSupportedForReference=t.getUniqueFlowNodeId=t.FlowFlags=void 0;const s=n(5839);var i;(i=t.FlowFlags||(t.FlowFlags={}))[i.Unreachable=1]="Unreachable",i[i.Start=2]="Start",i[i.BranchLabel=4]="BranchLabel",i[i.LoopLabel=8]="LoopLabel",i[i.Assignment=16]="Assignment",i[i.Unbind=32]="Unbind",i[i.WildcardImport=64]="WildcardImport",i[i.TrueCondition=128]="TrueCondition",i[i.FalseCondition=512]="FalseCondition",i[i.Call=1024]="Call",i[i.PreFinallyGate=2048]="PreFinallyGate",i[i.PostFinally=4096]="PostFinally",i[i.AssignmentAlias=8192]="AssignmentAlias";let r=1;t.getUniqueFlowNodeId=function(){return r++},t.isCodeFlowSupportedForReference=function e(t){return 39===t.nodeType||36===t.nodeType&&e(t.leftExpression)},t.createKeyForReference=function(e){let t;if(39===e.nodeType)t=e.value;else{t=e.memberName.value;let n=e.leftExpression;for(;36===n.nodeType;)t=n.memberName.value+"."+t,n=n.leftExpression;s.assert(39===n.nodeType),t=n.value+"."+t}return t}},2272:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileLevelDirectives=void 0;const s=n(2930);function i(e){const t=s.getStrictDiagnosticRuleSet(),n=s.getBooleanDiagnosticRules(),i=s.getDiagLevelDiagnosticRules(),r=s.getStrictModeNotOverriddenRules();for(const s of n)r.find(e=>e===s)||t[s]&&(e[s]=!0);for(const n of i){if(r.find(e=>e===n))continue;const s=t[n],i=e[n];("error"===s||"warning"===s&&"error"!==i||"information"===s&&"error"!==i&&"warning"!==i)&&(e[n]=s)}}function r(e,t){const n=["pyright:","mspython:"].find(t=>e.startsWith(t));if(n){const s=e.substr(n.length).trim().split(",").map(e=>e.trim());s.some(e=>"strict"===e)&&i(t);for(const e of s)t=o(e,t)}return t}function o(e,t){const n=e.split("=").map(e=>e.trim());if(2!==n.length)return t;const i=n[0],r=s.getBooleanDiagnosticRules();if(s.getDiagLevelDiagnosticRules().find(e=>e===i)){const e=function(e){switch(e){case"false":case"none":return"none";case"true":case"error":return"error";case"warning":return"warning";case"information":return"information";default:return}}(n[1]);void 0!==e&&(t[i]=e)}else if(r.find(e=>e===i)){const e="false"!==(o=n[1])&&("true"===o||void 0);void 0!==e&&(t[i]=e)}var o;return t}t.getFileLevelDirectives=function(e,t,n){let o=s.cloneDiagnosticRuleSet(t);n&&i(o);for(let t=0;t<e.count;t++){const n=e.getItemAt(t);if(n.comments)for(const e of n.comments)o=r(e.value.trim(),o)}return o}},5523:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNameFromDeclaration=t.isPossibleTypeAliasDeclaration=t.isExplicitTypeAliasDeclaration=t.isFinalVariableDeclaration=t.areDeclarationsSame=t.hasTypeForDeclaration=void 0,t.hasTypeForDeclaration=function(e){switch(e.type){case 0:case 4:case 5:case 3:return!0;case 2:{if(e.node.typeAnnotation||e.node.typeAnnotationComment)return!0;const t=e.node.parent;return!(29!==(null==t?void 0:t.nodeType)||!t.functionAnnotationComment||t.functionAnnotationComment.isParamListEllipsis)}case 1:return!!e.typeAnnotationNode;case 6:return!1}},t.areDeclarationsSame=function(e,t){return e.type===t.type&&e.path===t.path&&e.range.start.line===t.range.start.line&&e.range.start.character===t.range.start.character&&(6!==e.type||6!==t.type||e.symbolName===t.symbolName&&e.firstNamePart===t.firstNamePart&&e.usesLocalName===t.usesLocalName)},t.isFinalVariableDeclaration=function(e){return 1===e.type&&!!e.isFinal},t.isExplicitTypeAliasDeclaration=function(e){return 1===e.type&&!!e.typeAliasAnnotation},t.isPossibleTypeAliasDeclaration=function(e){return 1===e.type&&!!e.typeAliasName},t.getNameFromDeclaration=function(e){var t;switch(e.type){case 6:return e.symbolName;case 4:case 3:return e.node.name.value;case 2:return null===(t=e.node.name)||void 0===t?void 0:t.value;case 1:return 39===e.node.nodeType?e.node.value:void 0;case 0:case 5:return}throw new Error("Shouldn't reach here")}},8434:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertDocStringToMarkdown=void 0,t.convertDocStringToMarkdown=function(e){return new C(e).convert()};const n=/\S|$/,s=/\r?\n/,i=/\S/,r=/^\s*~~~+$/,o=/^\s*\+\+\++$/,a=/^(\s+\* )(.*)$/,l=/^\s*\.\. /,c=/^\s*\.\.\s+(\w+)::\s*(.*)$/,p=/ *>>> /,u=/^\s*:(param|arg|type|return|rtype|raise|except|var|ivar|cvar|copyright|license)/,d=[{exp:/^\s*=+(\s+=+)+$/,replacement:"="},{exp:/^\s*-+(\s+-+)+$/,replacement:"-"},{exp:/^\s*~+(\s+-+)+$/,replacement:"~"},{exp:/^\s*\++(\s+\++)+$/,replacement:"+"}],h=/\s/g,m=/``/g,y=/\t/g,g=/~/g,f=/\+/g,_=/(?<!\\)([_*~[\]])/g,T=[{exp:/</g,replacement:"&lt;"},{exp:/>/g,replacement:"&gt;"}],v=/^\s*::$/,b=[{exp:/\s+::$/g,replacement:""},{exp:/(\S)\s*::$/g,replacement:"$1:"},{exp:/:[\w_\-+:.]+:`/g,replacement:"`"},{exp:/`:[\w_\-+:.]+:/g,replacement:"`"}];class C{constructor(e){this._builder="",this._skipAppendEmptyLine=!0,this._insideInlineCode=!1,this._appendDirectiveBlock=!1,this._stateStack=[],this._lineNum=0,this._blockIndent=0,this._state=this._parseText,this._lines=function(e){let t=(e=e.replace(y," ".repeat(8))).split(s).map(e=>e.trimRight());if(t.length>0){let e=t[0].trimLeft();""===e?e=void 0:t.splice(0,1),t=function(e,t){const n=function(e){const t=e.filter(e=>!I(e)).map(S);return t.length>0?Math.min(...t):0}(e);return e.map(e=>n>e.length?"":e.substr(n))}(t),void 0!==e&&t.splice(0,0,e)}return t}(e)}convert(){for(;void 0!==this._currentLineOrUndefined();){const e=this._state,t=this._lineNum;if(this._state(),this._state===e&&this._lineNum===t)break}return this._state===this._parseBacktickBlock||this._state===this._parseDocTest||this._state===this._parseLiteralBlock?this._trimOutputAndAppendLine("```"):this._insideInlineCode&&this._trimOutputAndAppendLine("`",!0),this._builder.trim()}_eatLine(){this._lineNum++}_currentLineOrUndefined(){return this._lineNum<this._lines.length?this._lines[this._lineNum]:void 0}_currentLine(){return this._currentLineOrUndefined()||""}_currentIndent(){return S(this._currentLine())}_lineAt(e){return e<this._lines.length?this._lines[e]:void 0}_nextBlockIndent(){return S(this._lines.slice(this._lineNum+1).find(e=>!I(e))||"")}_currentLineIsOutsideBlock(){return this._currentIndent()<this._blockIndent}_currentLineWithinBlock(){return this._currentLine().substr(this._blockIndent)}_pushAndSetState(e){this._state===this._parseText&&(this._insideInlineCode=!1),this._stateStack.push(this._state),this._state=e}_popState(){this._state=this._stateStack.splice(0,1)[0],this._state===this._parseText&&(this._insideInlineCode=!1)}_parseText(){I(this._currentLineOrUndefined())?this._state=this._parseEmpty:this._beginBacktickBlock()||this._beginLiteralBlock()||this._beginDocTest()||this._beginDirective()||(this._appendTextLine(this._escapeHtml(this._currentLine())),this._eatLine())}_escapeHtml(e){return T.forEach(t=>{e=e.replace(t.exp,t.replacement)}),e}_appendTextLine(e){e=this._preprocessTextLine(e),!this._insideInlineCode&&u.test(e)&&this._appendLine();const t=e.split("`");for(let e=0;e<t.length;e++){let n=t[e];if(e>0&&(this._insideInlineCode=!this._insideInlineCode,this._append("`")),this._insideInlineCode)this._append(n);else{if(0===e){if(1===t.length){for(const e of d)if(e.exp.test(n)){n=n.replace(h,e.replacement);break}if(r.test(n)){this._append(n.replace(g,"-"));continue}if(o.test(n)){this._append(n.replace(f,"-"));continue}}const e=a.exec(n);null!==e&&3===e.length&&(this._append(e[1]),n=e[2])}n=n.replace(_,"\\$1"),this._append(n)}}this._builder+="\n"}_preprocessTextLine(e){return v.test(e)?"":(b.forEach(t=>e=e.replace(t.exp,t.replacement)),e=e.replace(m,"`"))}_parseEmpty(){if(I(this._currentLineOrUndefined()))return this._appendLine(),void this._eatLine();this._state=this._parseText}_beginMinIndentCodeBlock(e){this._appendLine("```"),this._pushAndSetState(e),this._blockIndent=this._currentIndent()}_beginBacktickBlock(){return!!this._currentLine().startsWith("```")&&(this._appendLine(this._currentLine()),this._pushAndSetState(this._parseBacktickBlock),this._eatLine(),!0)}_parseBacktickBlock(){this._currentLine().startsWith("```")?(this._appendLine("```"),this._appendLine(),this._popState()):this._appendLine(this._currentLine()),this._eatLine()}_beginDocTest(){return!!p.test(this._currentLine())&&(this._beginMinIndentCodeBlock(this._parseDocTest),this._appendLine(this._currentLineWithinBlock()),this._eatLine(),!0)}_parseDocTest(){if(this._currentLineIsOutsideBlock()||I(this._currentLine()))return this._trimOutputAndAppendLine("```"),this._appendLine(),void this._popState();this._appendLine(this._currentLineWithinBlock()),this._eatLine()}_beginLiteralBlock(){const e=this._lineAt(this._lineNum-1);if(void 0===e)return!1;if(!I(e))return!1;let t=this._lineNum-2;for(;t>=0;t--){const e=this._lineAt(t);if(!I(e)){if(e.endsWith("::"))break;return!1}}return!(t<0||(0===this._currentIndent()?(this._appendLine("```"),this._pushAndSetState(this._parseLiteralBlockSingleLine),0):(this._beginMinIndentCodeBlock(this._parseLiteralBlock),0)))}_parseLiteralBlock(){return I(this._currentLineOrUndefined())?(this._appendLine(),void this._eatLine()):this._currentLineIsOutsideBlock()?(this._trimOutputAndAppendLine("```"),this._appendLine(),void this._popState()):(this._appendLine(this._currentLineWithinBlock()),void this._eatLine())}_parseLiteralBlockSingleLine(){this._appendLine(this._currentLine()),this._appendLine("```"),this._appendLine(),this._popState(),this._eatLine()}_beginDirective(){return!!l.test(this._currentLine())&&(this._pushAndSetState(this._parseDirective),this._blockIndent=this._nextBlockIndent(),this._appendDirectiveBlock=!1,!0)}_parseDirective(){const e=c.exec(this._currentLine());if(null!==e&&3===e.length){const t=e[1],n=e[2];"class"===t&&(this._appendDirectiveBlock=!0,this._appendLine(),this._appendLine("```"),this._appendLine(n),this._appendLine("```"),this._appendLine())}0===this._blockIndent?this._popState():this._state=this._parseDirectiveBlock,this._eatLine()}_parseDirectiveBlock(){I(this._currentLineOrUndefined())||!this._currentLineIsOutsideBlock()?(this._appendDirectiveBlock&&this._appendTextLine(this._currentLine().trimLeft()),this._eatLine()):this._popState()}_appendLine(e){I(e)?this._skipAppendEmptyLine||(this._builder+="\n",this._skipAppendEmptyLine=!0):(this._builder+=e+"\n",this._skipAppendEmptyLine=!1)}_append(e){this._builder+=e,this._skipAppendEmptyLine=!1}_trimOutputAndAppendLine(e,t=!1){this._builder=this._builder.trimRight(),this._skipAppendEmptyLine=!1,t||this._appendLine(),this._appendLine(e)}}function S(e){return e.search(n)}function I(e){return void 0===e||!i.test(e)}},5678:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractParameterDocumentation=t.decodeDocString=void 0,t.decodeDocString=function(e){const t=e.replace(/\r/g,"").replace(/\t/g,"        ").split("\n");let n=Number.MAX_VALUE;t.forEach((e,s)=>{if(t.length<=1||s>0){const t=e.trimLeft();t&&(n=Math.min(n,e.length-t.length))}}),n>=Number.MAX_VALUE&&(n=0);const s=[];for(t.forEach((e,t)=>{0===t?s.push(e.trimRight()):s.push(e.substr(n).trimRight())});s.length>0&&0===s[0].length;)s.shift();for(;s.length>0&&0===s[s.length-1].length;)s.pop();return s.join("\n")},t.extractParameterDocumentation=function(e,t){if(!e||!t)return;const n=e.split("\n");for(const e of n){const n=e.trim();let s=n.indexOf("@param "+t);if(s>=0)return n.substr(s+7);if(s=n.indexOf(":param "+t),s>=0)return n.substr(s+7);if(s=n.indexOf(t+": "),s>=0)return n.substr(s);if(s=n.indexOf(t+" ("),s>=0)return n.substr(s)}}},2374:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ImportResolver=void 0;const o=n(6657),a=n(6886),l=n(7559),c=r(n(7559)),p=n(6956),u=r(n(1887)),d=n(1277),h=n(1766),m=[".pyd",".so",".dylib"],y=[".py",".pyi",...m],g="-stubs";t.ImportResolver=class{constructor(e,t){this._cachedPythonSearchPaths=new Map,this._cachedImportResults=new Map,this.fileSystem=e,this._configOptions=t}invalidateCache(){this._cachedPythonSearchPaths=new Map,this._cachedImportResults=new Map}resolveImport(e,t,n){const s=this._formatImportName(n),i=[],r={importName:s,isRelative:!1,isImportFound:!1,isNamespacePackage:!1,isStubPackage:!1,importFailureInfo:i,resolvedPaths:[],importType:2,isStubFile:!1,isNativeLib:!1,implicitImports:[],nonStubImportResult:void 0};if(n.leadingDots>0){const t=this._resolveRelativeImport(e,n,s,i);if(t)return t.isRelative=!0,t}else{const i=this._lookUpResultsInCache(t,s,n.importedSymbols);if(i)return i;const o=this._resolveBestAbsoluteImport(e,t,n,!0);if(o)return o.isStubFile&&(o.nonStubImportResult=this._resolveBestAbsoluteImport(e,t,n,!1)||r),this.addResultsToCache(t,s,o,n.importedSymbols)}return this.addResultsToCache(t,s,r,void 0)}getCompletionSuggestions(e,t,n,s){const i=[],r=[];if(n.leadingDots>0)this._getCompletionSuggestionsRelative(e,n,r,s);else{n.nameParts.length>0&&this._getCompletionSuggestionsTypeshedPath(t,n,!0,r,s),this._getCompletionSuggestionsAbsolute(t.root,n,r,s);for(const e of t.extraPaths)this._getCompletionSuggestionsAbsolute(e,n,r,s);this._configOptions.stubPath&&this._getCompletionSuggestionsAbsolute(this._configOptions.stubPath,n,r,s),this._getCompletionSuggestionsTypeshedPath(t,n,!1,r,s);const e=this._getPythonSearchPaths(t,i);for(const t of e)this._getCompletionSuggestionsAbsolute(t,n,r,s)}return r}getSourceFilesFromStub(e,t,n){const s=[];if(this._cachedImportResults.forEach((t,n)=>{t.forEach((t,n)=>{if(t.isStubFile&&t.isImportFound&&t.nonStubImportResult&&t.resolvedPaths.some(t=>t===e)&&t.nonStubImportResult.isImportFound){const e=t.nonStubImportResult.resolvedPaths.filter(e=>e.endsWith(".py"));s.push(...e)}})}),0===s.length){const t=o.changeAnyExtension(e,".py");this.fileSystem.existsSync(t)&&s.push(t)}if(0===s.length){const n=this.getImportRoots(t,!0),i=[];for(const t of n)if(o.containsPath(t,e,!0)){const n=o.getRelativePathComponentsFromDirectory(t,e,!0);if(n.length>1){n[1].endsWith(g)&&(n[1]=n[1].substr(0,n[1].length-g.length));const e=o.combinePathComponents(n);e&&i.push(e)}}for(const e of i)for(const t of n){const n=o.resolvePaths(t,e);let i=o.changeAnyExtension(n,".py");if(this.fileSystem.existsSync(i))s.push(i);else{const e=o.stripFileExtension(i);e.endsWith("__init__")?(i=e.substr(0,e.length-9)+".py",this.fileSystem.existsSync(i)&&s.push(i)):(i=o.combinePaths(e,"__init__.py"),this.fileSystem.existsSync(i)&&s.push(i))}}}return s}getModuleNameForImport(e,t){let n,s=0,i=!1;const r=[],o=this._getTypeshedPath(!0,t,r);if(o&&(n=this._getModuleNameFromPath(o,e,!0),n))return{moduleName:n,importType:s,isLocalTypingsFile:i};n=this._getModuleNameFromPath(t.root,e);for(const i of t.extraPaths){const t=this._getModuleNameFromPath(i,e);(!n||t&&t.length<n.length)&&(n=t,s=2)}if(this._configOptions.stubPath){const t=this._getModuleNameFromPath(this._configOptions.stubPath,e);(!n||t&&t.length<n.length)&&(n=t,s=2,i=!0)}const a=this._getTypeshedPath(!1,t,r);if(a){const t=this._getModuleNameFromPath(a,e,!0);(!n||t&&t.length<n.length)&&(n=t,s=1)}const l=this.getTypeshedPathEx(t,r);if(l){const t=this._getModuleNameFromPath(l,e);(!n||t&&t.length<n.length)&&(n=t,s=1)}const c=this._getPythonSearchPaths(t,r);for(const t of c){const i=this._getModuleNameFromPath(t,e);(!n||i&&i.length<n.length)&&(n=i,s=1)}return n?{moduleName:n,importType:s,isLocalTypingsFile:i}:{moduleName:"",importType:2,isLocalTypingsFile:i}}getTypeshedStdLibPath(e){return this._getTypeshedPath(!0,e,[])}getImportRoots(e,t){const n=[],s=[],i=255&e.pythonVersion,r=["2and3","3"];i>0&&r.push(a.versionToString(768+i));const l=this._getTypeshedPath(!0,e,n);l&&(t?s.push(...r.map(e=>o.combinePaths(l,e))):s.push(l)),s.push(e.root),s.push(...e.extraPaths),this._configOptions.stubPath&&s.push(this._configOptions.stubPath);const c=this._getTypeshedPath(!1,e,n);c&&(t?s.push(...r.map(e=>o.combinePaths(c,e))):s.push(c));const p=this.getTypeshedPathEx(e,n);p&&s.push(p);const u=this._getPythonSearchPaths(e,n);return u.length>0&&s.push(...u),s}addResultsToCache(e,t,n,s){let i=this._cachedImportResults.get(e.root);return i||(i=new Map,this._cachedImportResults.set(e.root,i)),i.set(t,n),this._filterImplicitImports(n,s)}resolveAbsoluteImport(e,t,n,s,i=!1,r=!1,a=!1,c=!0){s.push(`Attempting to resolve using root path '${e}'`);const p=[];let u,d,h=e,y=!1,f=!1,_=!1,T=!1,v=[];if(0===t.nameParts.length){const e="__init__",t=o.combinePaths(h,e+".py"),n=o.combinePaths(h,e+".pyi");c&&this.fileSystem.existsSync(n)&&o.isFile(this.fileSystem,n)?(s.push(`Resolved import with file '${n}'`),p.push(n),_=!0):this.fileSystem.existsSync(t)&&o.isFile(this.fileSystem,t)?(s.push(`Resolved import with file '${t}'`),p.push(t)):(s.push(`Partially resolved import with directory '${h}'`),p.push(""),y=!0),v=this._findImplicitImports(h,[t,n])}else for(let e=0;e<t.nameParts.length;e++){const n=0===e,i=e===t.nameParts.length-1;h=o.combinePaths(h,t.nameParts[e]),a&&n&&(h+=g,f=!0);const d=this.fileSystem.existsSync(h)&&o.isDirectory(this.fileSystem,h);if(d){if(n&&(u=h),!i){p.push("");continue}const e="__init__",t=o.combinePaths(h,e+".py"),r=o.combinePaths(h,e+".pyi");let a=!1;if(c&&this.fileSystem.existsSync(r)&&o.isFile(this.fileSystem,r)?(s.push(`Resolved import with file '${r}'`),p.push(r),i&&(_=!0),a=!0):this.fileSystem.existsSync(t)&&o.isFile(this.fileSystem,t)&&(s.push(`Resolved import with file '${t}'`),p.push(t),a=!0),a){v=this._findImplicitImports(h,[t,r]);break}}let b=o.stripTrailingDirectorySeparator(h);const C=o.getFileName(b);b=o.getDirectoryPath(b);const S=o.combinePaths(b,C+".py"),I=o.combinePaths(b,C+".pyi");if(c&&this.fileSystem.existsSync(I)&&o.isFile(this.fileSystem,I))s.push(`Resolved import with file '${I}'`),p.push(I),i&&(_=!0);else if(this.fileSystem.existsSync(S)&&o.isFile(this.fileSystem,S))s.push(`Resolved import with file '${S}'`),p.push(S);else{if(r&&this.fileSystem.existsSync(b)&&o.isDirectory(this.fileSystem,b)){const e=this._getFilesInDirectory(b).find(e=>{const t=o.getFileExtension(e,!1).toLowerCase(),n=o.stripFileExtension(e,!0);return!(!m.some(e=>e===t)||!l.equateStringsCaseInsensitive(C,n))});if(e){const t=o.combinePaths(b,e);s.push(`Resolved import with file '${t}'`),p.push(t),T=!0}}!T&&d?(s.push(`Partially resolved import with directory '${h}'`),p.push(""),i&&(v=this._findImplicitImports(h,[S,I]),y=!0)):s.push(`Did not find file '${I}' or '${S}'`)}break}return i?d=p.length>0:(d=p.length>=t.nameParts.length,y&&0===v.length&&(d=!1)),{importName:n,isRelative:!1,isNamespacePackage:y,isStubPackage:f,isImportFound:d,importFailureInfo:s,importType:2,resolvedPaths:p,searchPath:e,isStubFile:_,isNativeLib:T,implicitImports:v,packageDirectory:u}}getTypeshedPathEx(e,t){}resolveImportEx(e,t,n,s,i=[],r=!0){}_lookUpResultsInCache(e,t,n){const s=this._cachedImportResults.get(e.root);if(!s)return;const i=s.get(t);return i?this._filterImplicitImports(i,n):void 0}_getModuleNameFromPath(e,t,n=!1){e=o.ensureTrailingDirectorySeparator(e);let s=o.stripFileExtension(t);if(!s.startsWith(e))return;s.endsWith("__init__")&&(s=s.substr(0,s.length-9));const i=s.substr(e.length),r=o.getPathComponents(i);if(r.shift(),n){if(0===r.length)return;r.shift()}return 0===r.length||(r[0].endsWith(g)&&(r[0]=r[0].substr(0,r[0].length-g.length)),r.some(e=>!this._isIdentifier(e)))?void 0:r.join(".")}_resolveBestAbsoluteImport(e,t,n,s){const i=this._formatImportName(n),r=[];if(s&&n.nameParts.length>0){const e=this._findTypeshedPath(t,n,i,!0,r);if(e)return e.isTypeshedFile=!0,e}if(s&&this._configOptions.stubPath){r.push(`Looking in stubPath '${this._configOptions.stubPath}'`);const e=this.resolveAbsoluteImport(this._configOptions.stubPath,n,i,r);if(e.isImportFound)return e.importType=2,e.isLocalTypingsFile=!0,e}let a;r.push(`Looking in root directory of execution environment '${t.root}'`);let l=this.resolveAbsoluteImport(t.root,n,i,r,void 0,!0,void 0,s);if(l.isImportFound&&!l.isNamespacePackage)return l;a=l;for(const e of t.extraPaths){if(r.push(`Looking in extraPath '${e}'`),l=this.resolveAbsoluteImport(e,n,i,r,void 0,!0,void 0,s),l.isImportFound)return l;l&&(void 0===a||!a.isImportFound&&l.isImportFound||a.isNamespacePackage&&!l.isNamespacePackage||l.resolvedPaths.length>a.resolvedPaths.length)&&(a=l)}const c=this._getPythonSearchPaths(t,r);if(c.length>0)for(const e of c){r.push(`Looking in python search path '${e}'`);const t=o.combinePaths(e,n.nameParts[0]);let l,c;if(s&&(l=d.getPyTypedInfo(this.fileSystem,t+g),c=this.resolveAbsoluteImport(e,n,i,r,!1,!1,!0,s)),(null==c?void 0:c.isImportFound)||(null==c?void 0:c.packageDirectory)&&!(null==l?void 0:l.isPartiallyTyped)||(l=d.getPyTypedInfo(this.fileSystem,t),c=this.resolveAbsoluteImport(e,n,i,r,!1,!0,!1,s)),c){if(c.importType=1,c.isPyTypedPresent=null==l?void 0:l.isPyTypedPresent,c.isImportFound&&c.isStubFile)return c;(void 0===a||!a.isImportFound&&c.isImportFound||a.isNamespacePackage&&c.isImportFound&&!c.isNamespacePackage||c.isImportFound&&c.resolvedPaths.length>a.resolvedPaths.length)&&(a=c)}}else r.push("No python interpreter search path");const p=this.resolveImportEx(e,t,n,i,r,s);if(void 0!==p)return p;if(s){r.push("Looking for typeshed path");const e=this._findTypeshedPath(t,n,i,!1,r);if(e)return e.isTypeshedFile=!0,e}return a}_isIdentifier(e){for(let t=0;t<e.length;t++)if(0===t?!p.isIdentifierStartChar(e.charCodeAt(t)):!p.isIdentifierChar(e.charCodeAt(t)))return!1;return!0}_getPythonSearchPaths(e,t){const n=e.venv?e.venv:"<default>";return this._cachedPythonSearchPaths.has(n)||this._cachedPythonSearchPaths.set(n,u.findPythonSearchPaths(this.fileSystem,this._configOptions,e.venv,t)||[]),this._cachedPythonSearchPaths.get(n)}_findTypeshedPath(e,t,n,s,i){i.push(`Looking for typeshed ${s?u.stdLibFolderName:u.thirdPartyFolderName} path`);const r=this._getTypeshedPath(s,e,i);if(!r)return;let l=255&e.pythonVersion;for(;;){const e=l>0?a.versionToString(768+l):0===l?"3":"2and3",c=o.combinePaths(r,e);if(this.fileSystem.existsSync(c)){const e=this.resolveAbsoluteImport(c,t,n,i);if(e.isImportFound)return e.importType=s?0:1,e}if(-1===l)break;l--}i.push("Typeshed path not found")}_getCompletionSuggestionsTypeshedPath(e,t,n,s,i){const r=this._getTypeshedPath(n,e,[]);if(!r)return;let l=255&e.pythonVersion;for(;;){const e=l>0?a.versionToString(768+l):0===l?"3":"2and3",n=o.combinePaths(r,e);if(this.fileSystem.existsSync(n)&&this._getCompletionSuggestionsAbsolute(n,t,s,i),-1===l)break;l--}}_getTypeshedPath(e,t,n){if(e){if(void 0!==this._cachedTypeshedStdLibPath)return this._cachedTypeshedStdLibPath}else if(void 0!==this._cachedTypeshedThirdPartyPath)return this._cachedTypeshedThirdPartyPath;let s="";if(this._configOptions.typeshedPath){const e=this._configOptions.typeshedPath;this.fileSystem.existsSync(e)&&o.isDirectory(this.fileSystem,e)&&(s=e)}else{const e=this._getPythonSearchPaths(t,n);for(const t of e){const e=o.combinePaths(t,"typeshed");if(this.fileSystem.existsSync(e)&&o.isDirectory(this.fileSystem,e)){s=e;break}}}if(s||(s=u.getTypeShedFallbackPath(this.fileSystem)||""),s=u.getTypeshedSubdirectory(s,e),this.fileSystem.existsSync(s)&&o.isDirectory(this.fileSystem,s))return e?this._cachedTypeshedStdLibPath=s:this._cachedTypeshedThirdPartyPath=s,s}_resolveRelativeImport(e,t,n,s){s.push("Attempting to resolve relative import");let i=o.getDirectoryPath(e);for(let e=1;e<t.leadingDots;e++){if(""===i)return void s.push(`Invalid relative path '${n}'`);i=o.getDirectoryPath(i)}const r=this.resolveAbsoluteImport(i,t,n,s);return this._filterImplicitImports(r,t.importedSymbols)}_getCompletionSuggestionsRelative(e,t,n,s){let i=o.getDirectoryPath(e);for(let e=1;e<t.leadingDots;e++){if(""===i)return;i=o.getDirectoryPath(i)}this._getCompletionSuggestionsAbsolute(i,t,n,s)}_getFilesInDirectory(e){return this.fileSystem.readdirEntriesSync(e).filter(e=>e.isFile()).map(e=>e.name)}_getCompletionSuggestionsAbsolute(e,t,n,s){let i=e;const r=t.nameParts.map(e=>e);if(t.hasTrailingDot&&r.push(""),0===r.length)this._addFilteredSuggestions(i,"",n,s);else for(let e=0;e<r.length&&(e===r.length-1&&this._addFilteredSuggestions(i,r[e],n,s),i=o.combinePaths(i,r[e]),this.fileSystem.existsSync(i)&&o.isDirectory(this.fileSystem,i));e++);}_addFilteredSuggestions(e,t,n,s){const i=o.getFileSystemEntries(this.fileSystem,e);i.files.forEach(e=>{const i=o.getFileExtension(e,!1).toLowerCase(),r=o.stripFileExtension(e,!0);y.some(e=>e===i)&&"__init__"!==r&&(!t||c.computeCompletionSimilarity(t,r)>=s)&&this._addUniqueSuggestion(r,n)}),i.directories.forEach(e=>{t&&!e.startsWith(t)||this._addUniqueSuggestion(e,n)})}_addUniqueSuggestion(e,t){t.some(t=>t===e)||/[.-]/.test(e)||h.isDunderName(e)||t.push(e)}_filterImplicitImports(e,t){if(void 0===t){const t=Object.assign({},e);return t.implicitImports=[],t}if(0===t.length)return e;if(0===e.implicitImports.length)return e;const n=e.implicitImports.filter(e=>t.some(t=>t===e.name));if(n.length===e.implicitImports.length)return e;const s=Object.assign({},e);return s.implicitImports=n,s}_findImplicitImports(e,t){const n=new Map,s=o.getFileSystemEntries(this.fileSystem,e);for(const i of s.files)if(i.endsWith(".py")||i.endsWith(".pyi")){const s=o.combinePaths(e,i);if(!t.find(e=>e===s)){const e=o.stripFileExtension(i),t={isStubFile:i.endsWith(".pyi"),name:e,path:s},r=n.get(t.name);r&&r.isStubFile||n.set(t.name,t)}}for(const i of s.directories){const s=o.combinePaths(e,i,"__init__.py"),r=s+"i";let a=!1,l="";if(this.fileSystem.existsSync(r)&&o.isFile(this.fileSystem,r)?(a=!0,l=r):this.fileSystem.existsSync(s)&&o.isFile(this.fileSystem,s)&&(l=s),l&&!t.find(e=>e===l)){const e={isStubFile:a,name:i,path:l};n.set(e.name,e)}}return[...n.values()]}_formatImportName(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+e.nameParts.map(e=>e).join(".")}}},7012:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getAllImportNames=t.getContainingImportStatement=t.getTextEditsForAutoImportInsertion=t.getTextEditsForAutoImportSymbolAddition=t.getTopLevelImports=t.compareImportStatements=t.getImportGroup=void 0;const o=n(3213),a=n(1464),l=n(3550),c=r(n(563)),p=r(n(1766));function u(e){return e.importResult?0===e.importResult.importType?0:1===e.importResult.importType||e.importResult.isLocalTypingsFile?1:e.importResult.isRelative?3:2:2}function d(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+=e.nameParts.map(e=>e.value).join("."),t}t.getImportGroup=u,t.compareImportStatements=function(e,t){const n=u(e),s=u(t);return n<s?-1:n>s?1:e.moduleName<t.moduleName?-1:1},t.getTopLevelImports=function(e){const t={orderedImports:[],mapByFilePath:new Map};let n=!1,s=!1;return e.statements.forEach(e=>{48===e.nodeType?e.statements.forEach(e=>{20===e.nodeType?(s=!0,function(e,t,n){e.list.forEach(s=>{const i=c.getImportInfo(s.module);let r;i&&i.isImportFound&&(r=i.resolvedPaths[i.resolvedPaths.length-1]);const o={node:e,subnode:s,importResult:i,resolvedPath:r,moduleName:d(s.module),followsNonImportStatement:n};t.orderedImports.push(o),r&&(t.mapByFilePath.has(r)||t.mapByFilePath.set(r,o))})}(e,t,n),n=!1):22===e.nodeType?(s=!0,function(e,t,n){const s=c.getImportInfo(e.module);let i;s&&s.isImportFound&&(i=s.resolvedPaths[s.resolvedPaths.length-1]);const r={node:e,importResult:s,resolvedPath:i,moduleName:d(e.module),followsNonImportStatement:n};if(t.orderedImports.push(r),i){const e=t.mapByFilePath.get(i);(!e||20===e.node.nodeType||e.moduleName.length>r.moduleName.length)&&t.mapByFilePath.set(i,r)}}(e,t,n),n=!1):n=s}):n=s}),t},t.getTextEditsForAutoImportSymbolAddition=function(e,t,n,s){const i=[];let r;if(t.node&&22===t.node.nodeType&&!t.node.imports.some(t=>t.name.value===e)){for(const n of t.node.imports){if(n.name.value>e)break;r=n}const o=r?l.TextRange.getEnd(r):t.node.imports.length>0?t.node.imports[0].start:t.node.start+t.node.length,c=a.convertOffsetToPosition(o,n.tokenizerOutput.lines),p=s?`${e} as ${s}`:e;i.push({range:{start:c,end:c},replacementText:r?", "+p:p+", "})}return i},t.getTextEditsForAutoImportInsertion=function(e,t,n,s,i,r,o){const c=[],d=e||n,h=o?`${d} as ${o}`:d;let m,y=e?`from ${n} import ${h}`:"import "+h;const g=a.convertPositionToOffset(r,i.tokenizerOutput.lines);if(t.orderedImports.length>0&&g>=t.orderedImports[0].node.start){let e=!0,r=t.orderedImports[0],o=0;for(const a of t.orderedImports){const l=a.importResult?u(a):o;if(s<l){!e&&o<s&&(y=i.tokenizerOutput.predominantEndOfLineSequence+y);break}if(s===l&&a.moduleName>n)break;if(a.followsNonImportStatement){s>o&&(y=i.tokenizerOutput.predominantEndOfLineSequence+y);break}a===t.orderedImports[t.orderedImports.length-1]&&s>l&&(y=i.tokenizerOutput.predominantEndOfLineSequence+y),e=!e&&s<o&&s===l,o=l,r=a}r?(e?y+=i.tokenizerOutput.predominantEndOfLineSequence:y=i.tokenizerOutput.predominantEndOfLineSequence+y,m=a.convertOffsetToPosition(e?r.node.start:l.TextRange.getEnd(r.node),i.tokenizerOutput.lines)):m={line:0,character:0}}else{m={line:0,character:0};let e=!1;for(const t of i.parseTree.statements){let n=!0;if(48===t.nodeType&&1===t.statements.length){const e=t.statements[0];(49===e.nodeType||3===e.nodeType&&39===e.leftExpression.nodeType&&p.isDunderName(e.leftExpression.value))&&(n=!1)}if(n){m=a.convertOffsetToPosition(t.start,i.tokenizerOutput.lines),e=!1;break}m=a.convertOffsetToPosition(t.start+t.length,i.tokenizerOutput.lines),e=!0}y+=i.tokenizerOutput.predominantEndOfLineSequence+i.tokenizerOutput.predominantEndOfLineSequence,e?y=i.tokenizerOutput.predominantEndOfLineSequence+y:y+=i.tokenizerOutput.predominantEndOfLineSequence}return c.push({range:{start:m,end:m},replacementText:y}),c},t.getContainingImportStatement=function(e,t){for(;e&&(o.throwIfCancellationRequested(t),20!==e.nodeType&&22!==e.nodeType);)e=e.parent;return e},t.getAllImportNames=function(e){return 20===e.nodeType?e.list:e.imports}},2559:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageTypeVerifier=t.PackageSymbolType=void 0;const s=n(2930),i=n(1290),r=n(6657),o=n(3550),a=n(2374),l=n(8408),c=n(1277),p=n(5083),u=n(1766),d=n(1133),h=n(5168);var m;!function(e){e[e.Indeterminate=0]="Indeterminate",e[e.Module=1]="Module",e[e.Class=2]="Class",e[e.Variable=3]="Variable",e[e.Constant=4]="Constant",e[e.Function=5]="Function",e[e.Method=6]="Method",e[e.TypeVar=7]="TypeVar",e[e.TypeAlias=8]="TypeAlias"}(m=t.PackageSymbolType||(t.PackageSymbolType={}));class y{constructor(e){this._fileSystem=e,this._typeCache=new Map,this._configOptions=new s.ConfigOptions(""),this._execEnv=this._configOptions.findExecEnvironment("."),this._importResolver=new a.ImportResolver(this._fileSystem,this._configOptions),this._program=new l.Program(this._importResolver,this._configOptions)}verify(e){const t=e.trim(),n={packageName:t,rootDirectory:this._getDirectoryForPackage(t),pyTypedPath:void 0,symbolCount:0,unknownTypeCount:0,missingFunctionDocStringCount:0,missingClassDocStringCount:0,missingDefaultParamCount:0,modules:[],diagnostics:[]};try{if(!t||t.includes("."))n.diagnostics.push(new i.Diagnostic(0,`Package name "${t}" is invalid`,o.getEmptyRange()));else if(n.rootDirectory){const e=c.getPyTypedInfo(this._fileSystem,n.rootDirectory);if(e.isPyTypedPresent){n.pyTypedPath=e.pyTypedPath;const s=this._getListOfPublicModules(n.rootDirectory,t),i=new Map;s.forEach(e=>{this._getPublicSymbolsForModule(e,i)}),s.forEach(e=>{this._verifyTypesForModule(e,i,n)})}else n.diagnostics.push(new i.Diagnostic(0,"No py.typed file found",o.getEmptyRange()))}else n.diagnostics.push(new i.Diagnostic(0,`Package "${t}" cannot be resolved`,o.getEmptyRange()))}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);n.diagnostics.push(new i.Diagnostic(0,`An internal error occurred while verifying types: "${t}"`,o.getEmptyRange()))}return n}static getSymbolTypeString(e){switch(e){case m.Class:return"class";case m.Function:return"function";case m.Method:return"method";case m.Constant:return"constant";case m.Variable:return"variable";case m.Module:return"module";case m.TypeAlias:return"type alias";case m.TypeVar:return"type variable";case m.Indeterminate:return"symbol"}}_resolveImport(e){const t={leadingDots:0,nameParts:e.split("."),importedSymbols:[]};return this._importResolver.resolveImport("",this._execEnv,t)}_getPublicSymbolsForModule(e,t){const n=this._resolveImport(e);if(n.isImportFound){const s=n.resolvedPaths[n.resolvedPaths.length-1];this._program.addTrackedFiles([s],!0,!0);const i=this._program.getBoundSourceFile(s);if(i){const n={name:e,symbols:[]},s=i.getParseResults().parseTree,r=p.getScopeForNode(s);this._getPublicSymbolsInSymbolTable(t,n,n.name,r.symbolTable,3)}}}_getPublicSymbolsInSymbolTable(e,t,n,s,i){s.forEach((s,r)=>{if(!(u.isPrivateOrProtectedName(r)||s.isExternallyHidden()||s.isIgnoredForProtocolMatch()||this._isSymbolTypeImplied(i,r))){const i=`${n}.${r}`,o=this._program.getTypeForSymbol(s);e.set(i,i);const a=s.getTypedDeclarations();a.length>0&&a.find(e=>4===e.type)&&d.isClass(o)&&this._getPublicSymbolsInSymbolTable(e,t,i,o.details.fields,2)}})}_verifyTypesForModule(e,t,n){const s={name:e,symbols:[]};n.modules.push(s);const r=this._resolveImport(e);if(r.isImportFound)if(r.isStubPackage)n.diagnostics.push(new i.Diagnostic(0,`No inlined types found for module "${e}" because stub package was present`,o.getEmptyRange()));else{const e=r.resolvedPaths[r.resolvedPaths.length-1];this._program.addTrackedFiles([e],!0,!0);const a=this._program.getBoundSourceFile(e);if(a){const e=a.getParseResults().parseTree,i=p.getScopeForNode(e);this._verifySymbolsInSymbolTable(n,s,s.name,i.symbolTable,3,t,"")}else n.diagnostics.push(new i.Diagnostic(0,`Could not bind file "${e}"`,o.getEmptyRange()))}else n.diagnostics.push(new i.Diagnostic(0,`Could not resolve module "${e}"`,o.getEmptyRange()))}_getListOfPublicModules(e,t){const n=[];this._addPublicModulesRecursive(e,t,n);const s=[],i=new Map;return n.forEach(e=>{i.has(e)||(s.push(e),i.set(e,e))}),s}_addPublicModulesRecursive(e,t,n){this._fileSystem.readdirEntriesSync(e).forEach(s=>{if(s.isFile()){const e=r.getFileExtension(s.name);if(".py"===e||".pyi"===e){const e=r.stripFileExtension(s.name);"__init__"===e?n.push(t):!u.isPrivateOrProtectedName(e)&&this._isLegalModulePartName(e)&&n.push(`${t}.${e}`)}}else s.isDirectory()&&!u.isPrivateOrProtectedName(s.name)&&this._isLegalModulePartName(s.name)&&this._addPublicModulesRecursive(r.combinePaths(e,s.name),`${t}.${s.name}`,n)})}_isLegalModulePartName(e){return!!e.match(/[a-z_]+/)}_verifySymbolsInSymbolTable(e,t,n,s,r,a,l){s.forEach((s,c)=>{if(!(u.isPrivateOrProtectedName(c)||s.isExternallyHidden()||s.isIgnoredForProtocolMatch()||this._isSymbolTypeImplied(r,c))){const p=`${n}.${c}`,m=this._program.getTypeForSymbol(s);let g="";const f=this._getPackageSymbolType(s,m),_=y.getSymbolTypeString(f),T={name:c,fullName:p,symbolType:f};t.symbols.push(T),e.symbolCount++;const v=s.getTypedDeclarations();if(!this._isSymbolTypeImplied(r,c))if(d.isUnknown(m))g=0===v.length?`Type not declared for ${_} "${p}"`:`Type unknown for ${_} "${p}"`;else{const e=new i.DiagnosticAddendum;this._validateTypeIsCompletelyKnown(m,e,a,p,[])||(g=`Type partially unknown for ${_} "${p}"`+e.getString(16,32))}if(g&&(e.diagnostics.push(new i.Diagnostic(0,g,o.getEmptyRange())),e.unknownTypeCount++),v.length>0&&(v.find(e=>4===e.type)&&d.isClass(m)&&(m.details.docString||(e.diagnostics.push(new i.Diagnostic(1,`No docstring found for class "${p}"`,o.getEmptyRange())),e.missingClassDocStringCount++),this._verifySymbolsInSymbolTable(e,t,p,m.details.fields,2,a,l)),v.filter(e=>3===e.type).length>0)){let t=!1,n=!1;d.isFunction(m)?(m.details.docString||(t=!0),m.details.parameters.find(e=>e.hasDefault&&h.isEllipsisType(e.defaultType))&&(n=!0)):d.isOverloadedFunction(m)&&(m.overloads.find(e=>e.details.docString)||(t=!0),m.overloads.forEach(e=>{e.details.parameters.find(e=>e.hasDefault&&h.isEllipsisType(e.defaultType))&&(n=!0)})),t&&(u.isDunderName(c)||(e.diagnostics.push(new i.Diagnostic(1,`No docstring found for function "${p}"`,o.getEmptyRange())),e.missingFunctionDocStringCount++)),n&&(e.diagnostics.push(new i.Diagnostic(1,`One or more default values in function "${p}" is specified as "..."`,o.getEmptyRange())),e.missingDefaultParamCount++)}}})}_pushType(e,t,n){e.push(t);const s=n();return e.pop(),s}_validateTypeIsCompletelyKnown(e,t,n,s,i){if(i.length>16)return!0;switch((e=h.transformTypeObjectToClass(e)).category){case 0:case 2:case 3:case 4:case 11:return!0;case 1:return!1;case 8:return this._validateTypeIsCompletelyKnown(e.classType,t,n,s,i);case 6:{let r=!0;for(const o of e.overloads)this._validateTypeIsCompletelyKnown(o,t.createAddendum(),n,s,i)||(r=!1);return r}case 10:{let r=!0;for(const o of e.subtypes)this._validateTypeIsCompletelyKnown(o,t.createAddendum(),n,s,i)||(r=!1);return r}case 5:{let r=!0;if(e.details.parameters.forEach(e=>{if(e.name){const o=t.createAddendum();e.hasDeclaredType?d.isUnknown(e.type)?(o.addMessage(`Type unknown for parameter "${e.name}"`),r=!1):this._validateTypeIsCompletelyKnown(e.type,o.createAddendum(),n,s,i)||(o.addMessage(`Type partially unknown for parameter "${e.name}"`),r=!1):d.isTypeVar(e.type)&&e.type.details.isSynthesized||(o.addMessage(`Parameter "${e.name}" is missing a type annotation`),r=!1)}}),e.details.declaredReturnType){const o=t.createAddendum();d.isUnknown(e.details.declaredReturnType)?(o.addMessage("Return type unknown"),r=!1):this._validateTypeIsCompletelyKnown(e.details.declaredReturnType,o.createAddendum(),n,s,i)||(o.addMessage("Return type partially unknown"),r=!1)}else"__init__"!==e.details.name&&(t.createAddendum().addMessage("Return type annotation is missing"),r=!1);return r}case 7:{const r=this._validateClassTypeIsCompletelyKnown(e,n,s,i);let o=r.isFullyKnown;if(s===e.details.fullName||!n.has(e.details.fullName)){const n=t.createAddendum();o||n.addAddendum(r.diag),r.classFields&&r.classFields.forEach(e=>{e.isFullyKnown||(n.addAddendum(e.diag),o=!1)}),o||n.addMessage(`Type partially unknown for class "${this._program.printType(h.convertToInstance(e),!1)}"`)}return o}case 9:{const s=this._validateModuleTypeIsCompletelyKnown(e,n,i);return s.isFullyKnown||t.addAddendum(s.diag),s.isFullyKnown}}}_validateClassTypeIsCompletelyKnown(e,t,n,s){let r;const o=new i.DiagnosticAddendum;if(n!==e.details.fullName&&t.has(e.details.fullName))r={isFullyKnown:!0,diag:o,classFields:void 0};else{if(s.some(t=>t===e.details.fullName))return{isFullyKnown:!0,diag:o,classFields:void 0};this._pushType(s,e.details.fullName,()=>{var a;const l=this._typeCache.get(e.details.fullName);if(l)r=l;else if(d.ClassType.isBuiltIn(e))r={isFullyKnown:!0,diag:o,classFields:void 0};else{this._typeCache.set(e.details.fullName,{isFullyKnown:!0,diag:o,classFields:void 0});const l=new Map;let c=!0;if(e.details.fields.forEach((e,r)=>{if(!u.isPrivateOrProtectedName(r)&&!e.isExternallyHidden()&&!e.isIgnoredForProtocolMatch()){const a=this._program.getTypeForSymbol(e),c=this._getPackageSymbolType(e,a),p=y.getSymbolTypeString(c),u=new i.DiagnosticAddendum;this._isSymbolTypeImplied(2,r)||(d.isUnknown(a)?(u.addMessage(`Type unknown for ${p} "${r}"`),o.addAddendum(u)):this._validateTypeIsCompletelyKnown(a,u.createAddendum(),t,n,s)||(u.addMessage(`Type partially unknown for ${p} "${r}"`),o.addAddendum(u))),l.set(r,{isFullyKnown:u.isEmpty(),diag:u,classFields:void 0})}}),e.details.mro.forEach((e,r)=>{if(0!==r&&d.isClass(e)){const r=this._validateClassTypeIsCompletelyKnown(e,t,n,s);if(r.classFields){const n=e.details.baseClasses.find(t=>d.isClass(t)&&t.details.mro.some(t=>d.isClass(t)&&d.ClassType.isSameGenericClass(t,e))),s=n&&t.has(n.details.fullName);r.classFields.forEach((t,n)=>{if(!l.has(n)){const r=!t.isFullyKnown&&!s,o=new i.DiagnosticAddendum;r&&(o.addAddendum(t.diag),o.addMessage(`Type partially unknown for symbol "${n}" defined in base class "${this._program.printType(h.convertToInstance(e),!1)}"`)),l.set(n,{isFullyKnown:!r,diag:o,classFields:void 0})}})}}}),e.details.effectiveMetaclass)if(d.isClass(e.details.effectiveMetaclass)){if(!d.ClassType.isBuiltIn(e.details.effectiveMetaclass)){const r=this._validateClassTypeIsCompletelyKnown(e.details.effectiveMetaclass,t,n,s),l=new i.DiagnosticAddendum;let p=!0;r.isFullyKnown||(l.addAddendum(r.diag),p=!1),null===(a=r.classFields)||void 0===a||a.forEach(e=>{e.isFullyKnown||(l.addAddendum(e.diag),p=!1)}),p||(l.addMessage(`Type of metaclass "${e.details.effectiveMetaclass.details.fullName}" is partially unknown`),o.addAddendum(l),c=!1)}}else o.addMessage("Type for metaclass is unknown"),c=!1;e.details.baseClasses.forEach((e,r)=>{const a=new i.DiagnosticAddendum;if(d.isClass(e)){if(!d.ClassType.isBuiltIn(e)){const i=this._validateClassTypeIsCompletelyKnown(e,t,n,s);i.isFullyKnown||(a.addMessage(`Type partially unknown for base class "${this._program.printType(h.convertToInstance(e),!1)}"`),o.addAddendum(i.diag),c=!1)}}else a.addMessage("Type unknown for base class "+(r+1)),c=!1}),r={isFullyKnown:c,diag:o,classFields:l},this._typeCache.set(e.details.fullName,r)}})}return e.typeArguments&&this._pushType(s,e.details.fullName,()=>{const o=new i.DiagnosticAddendum;r.diag.getChildren().forEach(e=>{o.addAddendum(e)}),r={isFullyKnown:r.isFullyKnown,diag:o,classFields:r.classFields},e.typeArguments.forEach((a,l)=>{const c=new i.DiagnosticAddendum,p=l<e.details.typeParameters.length?" which corresponds to TypeVar "+e.details.typeParameters[l].details.name:"";d.isUnknown(a)?(c.addMessage(`Type unknown for type argument ${l+1}${p}`),o.addAddendum(c),r.isFullyKnown=!1):this._validateTypeIsCompletelyKnown(a,c,t,n,s)||(c.addMessage(`Type partially unknown for type argument ${l+1}${p}`),o.addAddendum(c),r.isFullyKnown=!1)})}),r}_validateModuleTypeIsCompletelyKnown(e,t,n){let s=this._typeCache.get(e.moduleName);if(s)return s;const r=new i.DiagnosticAddendum;if(n.length>16)return{isFullyKnown:!0,diag:r,classFields:void 0};let o=!0;return e.fields.forEach((e,s)=>{if(!(u.isPrivateOrProtectedName(s)||e.isExternallyHidden()||e.isIgnoredForProtocolMatch()||this._isSymbolTypeImplied(3,s))){const a=this._program.getTypeForSymbol(e),l=this._getPackageSymbolType(e,a),c=y.getSymbolTypeString(l),p=new i.DiagnosticAddendum;d.isUnknown(a)?(p.addMessage(`Type unknown for ${c} "${s}"`),r.addAddendum(p),o=!1):this._validateTypeIsCompletelyKnown(a,p.createAddendum(),t,"",n)||(p.addMessage(`Type partially unknown for ${c} "${s}"`),r.addAddendum(p),o=!1)}}),s={isFullyKnown:o,diag:r,classFields:void 0},this._typeCache.set(e.moduleName,s),s}_getPackageSymbolType(e,t){if(t.typeAliasInfo)return m.TypeAlias;switch(t.category){case 7:return m.Class;case 5:case 6:{const t=e.getDeclarations().find(e=>3===e.type);return t&&t.isMethod?m.Method:m.Function}case 8:{const t=e.getDeclarations().find(e=>1===e.type);return t&&(t.isConstant||t.isFinal)?m.Constant:m.Variable}case 9:return m.Module;case 11:return m.TypeVar;default:{const t=e.getDeclarations().find(e=>1===e.type);return t?t.isConstant||t.isFinal?m.Constant:m.Variable:m.Indeterminate}}}_getDirectoryForPackage(e){const t={leadingDots:0,nameParts:[e],importedSymbols:[]},n=this._importResolver.resolveImport("",this._execEnv,t);if(n.isImportFound){const e=n.resolvedPaths[n.resolvedPaths.length-1];return r.getDirectoryPath(e)}}_isSymbolTypeImplied(e,t){return 2===e?["__class__","__dict__","__doc__","__module__","__slots__"].some(e=>e===t):3===e&&["__all__","__author__","__copyright__","__email__","__license__","__title__","__uri__","__version__"].some(e=>e===t)}}t.PackageTypeVerifier=y},4482:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ParseTreeCleanerWalker=void 0;const o=r(n(563)),a=n(427);class l extends a.ParseTreeWalker{constructor(e){super(),this._parseTree=e}clean(){this.walk(this._parseTree)}visitNode(e){return o.cleanNodeAnalysisInfo(e),super.visitNode(e)}}t.ParseTreeCleanerWalker=l},8494:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAssignmentToDefaultsFollowingNamedTuple=t.getDocString=t.isWithinAnnotationComment=t.isWithinTypeAnnotation=t.isWithinDefaultParamInitializer=t.isMatchingExpression=t.isSuiteEmpty=t.isNodeContainedWithin=t.isFinalAllowedForAssignmentTarget=t.getTypeAnnotationNode=t.getExecutionScopeNode=t.getTypeVarScopeNode=t.getEvaluationScopeNode=t.getEvaluationNodeForAssignmentExpression=t.getEnclosingSuiteOrModule=t.getEnclosingClassOrFunction=t.getEnclosingLambda=t.getEnclosingFunction=t.getEnclosingClassOrModule=t.getEnclosingModule=t.getEnclosingClass=t.printOperator=t.printExpression=t.findNodeByOffset=t.findNodeByPosition=t.getNodeDepth=void 0;const s=n(5839),i=n(1464),r=n(3550),o=n(5275),a=n(563),l=n(5678),c=n(427);function p(e,t){if(t<e.start||t>r.TextRange.getEnd(e))return;const n=(new c.ParseTreeWalker).visitNode(e);for(const e of n)if(e){const n=p(e,t);if(n)return n}return e}function u(e){const t={0:"+",1:"+=",2:"=",3:"&",4:"&=",5:"~",6:"|",7:"|=",8:"^",9:"^=",10:"/",11:"/=",12:"==",13:"//",14:"//=",15:">",16:">=",17:"<<",18:"<<=",19:"<>",20:"<",21:"<=",22:"@",23:"@=",24:"%",25:"%=",26:"*",27:"*=",28:"!=",29:"**",30:"**=",31:">>",32:">>=",33:"-",34:"-=",36:"and",37:"or",38:"not",39:"is",40:"is not",41:"in",42:"not in"};return t[e]?t[e]:"unknown"}function d(e,t=!1){let n=e.parent;for(;n;){if(10===n.nodeType)return n;if(37===n.nodeType)return;if(29===n.nodeType&&t)return;n=n.parent}}function h(e){let t=e.parent;for(;t;){if(29===t.nodeType)return t;if(10===t.nodeType)return;t=t.parent}}function m(e){let t,n=e,i=!1;for(;n;){switch(42===n.nodeType&&t===n.name&&(i=!0),n.nodeType){case 29:if(n.parameters.some(e=>e===t)){if(i&&void 0!==a.getScope(n))return n}else if(t===n.suite&&void 0!==a.getScope(n))return n;break;case 31:if(n.parameters.some(e=>e===t)){if(i&&void 0!==a.getScope(n))return n}else if(t===n.expression&&void 0!==a.getScope(n))return n;break;case 10:if(t===n.suite&&void 0!==a.getScope(n))return n;break;case 33:case 37:if(void 0!==a.getScope(n))return n}t=n,n=n.parent}s.fail("Did not find evaluation scope")}t.getNodeDepth=function(e){let t=0,n=e;for(;n;)t++,n=n.parent;return t},t.findNodeByPosition=function(e,t,n){const s=i.convertPositionToOffset(t,n);if(void 0!==s)return p(e,s)},t.findNodeByOffset=p,t.printExpression=function e(t,n=0){switch(t.nodeType){case 39:return t.value;case 36:return e(t.leftExpression,n)+"."+t.memberName.value;case 9:return e(t.leftExpression,n)+"("+t.arguments.map(t=>{let s="";return 1===t.argumentCategory?s="*":2===t.argumentCategory&&(s="**"),t.name&&(s+=t.name.value+"="),s+=e(t.valueExpression,n),s}).join(", ")+")";case 24:return e(t.baseExpression,n)+"["+t.items.items.map(t=>e(t,n)).join(", ")+"]";case 56:return u(t.operator)+" "+e(t.expression,n);case 7:return e(t.leftExpression,n)+" "+u(t.operator)+" "+e(t.rightExpression,n);case 41:{let e=t.value.toString();return t.isImaginary&&(e+="j"),e}case 49:return 1&n&&t.typeAnnotation?e(t.typeAnnotation,n):t.strings.map(t=>e(t,n)).join(" ");case 50:{let e="";return 8&t.token.flags&&(e+="r"),16&t.token.flags&&(e+="u"),32&t.token.flags&&(e+="b"),64&t.token.flags&&(e+="f"),4&t.token.flags?1&t.token.flags?e+=`'''${t.token.escapedValue}'''`:e+=`"""${t.token.escapedValue}"""`:1&t.token.flags?e+=`'${t.token.escapedValue}'`:e+=`"${t.token.escapedValue}"`,e}case 3:return e(t.leftExpression,n)+" = "+e(t.rightExpression,n);case 4:return e(t.name,n)+" := "+e(t.rightExpression,n);case 55:return e(t.valueExpression,n)+": "+e(t.typeAnnotation,n);case 5:return e(t.leftExpression,n)+" "+u(t.operator)+" "+e(t.rightExpression,n);case 6:return"await "+e(t.expression,n);case 52:return e(t.ifExpression,n)+" if "+e(t.testExpression,n)+" else "+e(t.elseExpression,n);case 32:return`[${t.entries.map(t=>e(t,n)).join(", ")}]`;case 57:return"*"+e(t.expression,n);case 53:{const s=t.expressions.map(t=>e(t,n));return 1===s.length?`(${s[0]}, )`:`(${s.join(", ")})`}case 61:return t.expression?"yield "+e(t.expression,n):"yield";case 62:return"yield from "+e(t.expression,n);case 18:return"...";case 33:{let s="<ListExpression>";return o.isExpressionNode(t.expression)?s=e(t.expression,n):17===t.expression.nodeType&&(s=`${e(t.expression.keyExpression,n)}: ${e(t.expression.valueExpression,n)}`),s+" "+t.comprehensions.map(t=>34===t.nodeType?(t.isAsync?"async ":"")+"for "+e(t.targetExpression,n)+" in "+e(t.iterableExpression,n):"if "+e(t.testExpression,n)).join(" ")}case 47:{let s="";return t.startValue&&(s+=e(t.startValue,n)),t.endValue&&(s+=": "+e(t.endValue,n)),t.stepValue&&(s+=": "+e(t.stepValue,n)),s}case 31:return"lambda "+t.parameters.map(t=>{let s="";return 1===t.category?s+="*":2===t.category&&(s+="**"),t.name&&(s+=t.name.value),t.defaultValue&&(s+=" = "+e(t.defaultValue,n)),s}).join(", ")+": "+e(t.expression,n);case 11:if(31===t.constType)return"True";if(14===t.constType)return"False";if(8===t.constType)return"__debug__";if(24===t.constType)return"None";break;case 15:return`{ ${t.entries.map(t=>17===t.nodeType?e(t.keyExpression,n)+": "+e(t.valueExpression,n):e(t,n))} }`;case 16:return"**"+e(t.expandExpression,n);case 46:return t.entries.map(t=>e(t,n)).join(", ")}return"<Expression>"},t.printOperator=u,t.getEnclosingClass=d,t.getEnclosingModule=function(e){let t=e.parent;for(;t;){if(37===t.nodeType)return t;t=t.parent}s.fail("Module node not found")},t.getEnclosingClassOrModule=function(e,t=!1){let n=e.parent;for(;n;){if(10===n.nodeType)return n;if(37===n.nodeType)return n;if(29===n.nodeType&&t)return;n=n.parent}},t.getEnclosingFunction=h,t.getEnclosingLambda=function(e){let t=e.parent;for(;t;){if(31===t.nodeType)return t;if(51===t.nodeType)return;t=t.parent}},t.getEnclosingClassOrFunction=function(e){let t=e.parent;for(;t;){if(29===t.nodeType)return t;if(10===t.nodeType)return t;t=t.parent}},t.getEnclosingSuiteOrModule=function(e){let t=e.parent;for(;t;){if(51===t.nodeType)return t;if(37===t.nodeType)return t;if(31===t.nodeType)return;t=t.parent}},t.getEvaluationNodeForAssignmentExpression=function(e){let t=m(e);for(;void 0!==t;){switch(t.nodeType){case 29:case 31:case 37:return t;case 10:return}t=t.parent}},t.getEvaluationScopeNode=m,t.getTypeVarScopeNode=function(e){let t,n=e;for(;n;){switch(n.nodeType){case 29:case 10:if(t===n.suite)return n}t=n,n=n.parent}},t.getExecutionScopeNode=function(e){let t=m(e);for(;10===t.nodeType||33===t.nodeType;)t=m(t.parent);return t},t.getTypeAnnotationNode=function(e){let t=e,n=e.parent;for(;n;){if(55===n.nodeType){if(n.typeAnnotation===t)return n;break}t=n,n=n.parent}},t.isFinalAllowedForAssignmentTarget=function(e){if(39===e.nodeType)return!0;if(36===e.nodeType){if(39!==e.leftExpression.nodeType)return!1;if(!d(e))return!1;const t=h(e);return!!t&&"__init__"===t.name.value}return!1},t.isNodeContainedWithin=function(e,t){let n=e;for(;n;){if(n===t)return!0;n=n.parent}return!1},t.isSuiteEmpty=function(e){for(const t of e.statements){if(48!==t.nodeType)return!1;for(const e of t.statements)if(18===e.nodeType);else if(49!==e.nodeType)return!1}return!0},t.isMatchingExpression=function e(t,n){return 39===t.nodeType&&39===n.nodeType?t.value===n.value:36===t.nodeType&&36===n.nodeType&&e(t.leftExpression,n.leftExpression)&&t.memberName.value===n.memberName.value},t.isWithinDefaultParamInitializer=function(e){let t,n=e;for(;n;){if(42===n.nodeType&&t===n.defaultValue)return!0;if(31===n.nodeType||29===n.nodeType||10===n.nodeType||37===n.nodeType)return!1;t=n,n=n.parent}return!1},t.isWithinTypeAnnotation=function(e,t){let n,s=e,i=!1;for(;s;){if(42===s.nodeType&&(n===s.typeAnnotation||n===s.typeAnnotationComment))return i||!t;if(29===s.nodeType&&n===s.returnTypeAnnotation)return i||!t;if(29===s.nodeType&&n===s.functionAnnotationComment)return!0;if(55===s.nodeType&&n===s.typeAnnotation)return i||!t;if(3===s.nodeType&&n===s.typeAnnotationComment)return!0;if(49===s.nodeType&&n===s.typeAnnotation&&(i=!0),31===s.nodeType||29===s.nodeType||10===s.nodeType||37===s.nodeType)return!1;n=s,s=s.parent}return!1},t.isWithinAnnotationComment=function(e){let t,n=e;for(;n;){if(29===n.nodeType&&t===n.functionAnnotationComment)return!0;if(3===n.nodeType&&t===n.typeAnnotationComment)return!0;if(31===n.nodeType||29===n.nodeType||10===n.nodeType||37===n.nodeType)return!1;t=n,n=n.parent}return!1},t.getDocString=function(e){if(0===e.length)return;if(48!==e[0].nodeType)return;const t=e[0];if(0===t.statements.length||49!==t.statements[0].nodeType)return;const n=t.statements[0];return 0==(64&n.strings[0].token.flags)?l.decodeDocString(n.strings[0].value):void 0},t.isAssignmentToDefaultsFollowingNamedTuple=function(e){if(9!==e.nodeType||!e.parent||3!==e.parent.nodeType||39!==e.parent.leftExpression.nodeType||!e.parent.parent||48!==e.parent.parent.nodeType)return!1;const t=e.parent.leftExpression.value,n=e.parent.parent;if(n.statements[0]!==e.parent||!n.parent||37!==n.parent.nodeType&&51!==n.parent.nodeType)return!1;const s=n.parent;let i=s.statements.findIndex(e=>e===n);if(i<0)return!1;for(i++;i<s.statements.length;){const e=s.statements[i];if(48!==e.nodeType)break;if(49!==e.statements[0].nodeType){if(3===e.statements[0].nodeType){const n=e.statements[0];if(36===n.leftExpression.nodeType&&"__defaults__"===n.leftExpression.memberName.value){const e=n.leftExpression.leftExpression;if(36===e.nodeType&&"__new__"===e.memberName.value&&39===e.leftExpression.nodeType&&e.leftExpression.value===t)return!0}}break}i++}return!1}},427:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParseTreeWalker=void 0;const s=n(5839);t.ParseTreeWalker=class{walk(e){const t=this.visitNode(e);t.length>0&&this.walkMultiple(t)}walkMultiple(e){e.forEach(e=>{e&&this.walk(e)})}visitNode(e){switch(e.nodeType){case 1:if(this.visitArgument(e))return[e.name,e.valueExpression];break;case 2:if(this.visitAssert(e))return[e.testExpression,e.exceptionExpression];break;case 3:if(this.visitAssignment(e))return[e.leftExpression,e.rightExpression,e.typeAnnotationComment];break;case 4:if(this.visitAssignmentExpression(e))return[e.name,e.rightExpression];break;case 5:if(this.visitAugmentedAssignment(e))return[e.leftExpression,e.rightExpression];break;case 6:if(this.visitAwait(e))return[e.expression];break;case 7:if(this.visitBinaryOperation(e))return[e.leftExpression,e.rightExpression];break;case 8:if(this.visitBreak(e))return[];break;case 9:if(this.visitCall(e))return[e.leftExpression,...e.arguments];break;case 10:if(this.visitClass(e))return[...e.decorators,e.name,...e.arguments,e.suite];break;case 52:if(this.visitTernary(e))return[e.ifExpression,e.testExpression,e.elseExpression];break;case 11:if(this.visitConstant(e))return[];break;case 12:if(this.visitContinue(e))return[];break;case 13:if(this.visitDecorator(e))return[e.expression];break;case 14:if(this.visitDel(e))return e.expressions;break;case 15:if(this.visitDictionary(e))return e.entries;break;case 17:if(this.visitDictionaryKeyEntry(e))return[e.keyExpression,e.valueExpression];break;case 16:if(this.visitDictionaryExpandEntry(e))return[e.expandExpression];break;case 0:if(this.visitError(e))return[e.child];break;case 19:if(this.visitIf(e))return[e.testExpression,e.ifSuite,e.elseSuite];break;case 20:if(this.visitImport(e))return e.list;break;case 21:if(this.visitImportAs(e))return[e.module,e.alias];break;case 22:if(this.visitImportFrom(e))return[e.module,...e.imports];break;case 23:if(this.visitImportFromAs(e))return[e.name,e.alias];break;case 24:if(this.visitIndex(e))return[e.baseExpression,e.items];break;case 25:if(this.visitIndexItems(e))return e.items;break;case 18:if(this.visitEllipsis(e))return[];break;case 26:if(this.visitExcept(e))return[e.typeExpression,e.name,e.exceptSuite];break;case 27:if(this.visitFor(e))return[e.targetExpression,e.iterableExpression,e.forSuite,e.elseSuite];break;case 28:if(this.visitFormatString(e))return e.expressions;break;case 29:if(this.visitFunction(e))return[...e.decorators,e.name,...e.parameters,e.returnTypeAnnotation,e.functionAnnotationComment,e.suite];break;case 63:if(this.visitFunctionAnnotation(e))return[...e.paramTypeAnnotations,e.returnTypeAnnotation];break;case 30:if(this.visitGlobal(e))return e.nameList;break;case 31:if(this.visitLambda(e))return[...e.parameters,e.expression];break;case 32:if(this.visitList(e))return e.entries;break;case 33:if(this.visitListComprehension(e))return[e.expression,...e.comprehensions];break;case 34:if(this.visitListComprehensionFor(e))return[e.targetExpression,e.iterableExpression];break;case 35:if(this.visitListComprehensionIf(e))return[e.testExpression];break;case 36:if(this.visitMemberAccess(e))return[e.leftExpression,e.memberName];break;case 37:if(this.visitModule(e))return[...e.statements];break;case 38:if(this.visitModuleName(e))return e.nameParts;break;case 39:if(this.visitName(e))return[];break;case 40:if(this.visitNonlocal(e))return e.nameList;break;case 41:if(this.visitNumber(e))return[];break;case 42:if(this.visitParameter(e))return[e.name,e.typeAnnotation,e.typeAnnotationComment,e.defaultValue];break;case 43:if(this.visitPass(e))return[];break;case 44:if(this.visitRaise(e))return[e.typeExpression,e.valueExpression,e.tracebackExpression];break;case 45:if(this.visitReturn(e))return[e.returnExpression];break;case 46:if(this.visitSet(e))return e.entries;break;case 47:if(this.visitSlice(e))return[e.startValue,e.endValue,e.stepValue];break;case 48:if(this.visitStatementList(e))return e.statements;break;case 50:if(this.visitString(e))return[];break;case 49:if(this.visitStringList(e))return[e.typeAnnotation,...e.strings];break;case 51:if(this.visitSuite(e))return[...e.statements];break;case 53:if(this.visitTuple(e))return e.expressions;break;case 54:if(this.visitTry(e))return[e.trySuite,...e.exceptClauses,e.elseSuite,e.finallySuite];break;case 55:if(this.visitTypeAnnotation(e))return[e.valueExpression,e.typeAnnotation];break;case 56:if(this.visitUnaryOperation(e))return[e.expression];break;case 57:if(this.visitUnpack(e))return[e.expression];break;case 58:if(this.visitWhile(e))return[e.testExpression,e.whileSuite,e.elseSuite];break;case 59:if(this.visitWith(e))return[...e.withItems,e.suite];break;case 60:if(this.visitWithItem(e))return[e.expression,e.target];break;case 61:if(this.visitYield(e))return[e.expression];break;case 62:if(this.visitYieldFrom(e))return[e.expression];break;default:s.fail("Unexpected node type")}return[]}visitArgument(e){return!0}visitAssert(e){return!0}visitAssignment(e){return!0}visitAssignmentExpression(e){return!0}visitAugmentedAssignment(e){return!0}visitAwait(e){return!0}visitBinaryOperation(e){return!0}visitBreak(e){return!0}visitCall(e){return!0}visitClass(e){return!0}visitTernary(e){return!0}visitContinue(e){return!0}visitConstant(e){return!0}visitDecorator(e){return!0}visitDel(e){return!0}visitDictionary(e){return!0}visitDictionaryKeyEntry(e){return!0}visitDictionaryExpandEntry(e){return!0}visitError(e){return!0}visitEllipsis(e){return!0}visitIf(e){return!0}visitImport(e){return!0}visitImportAs(e){return!0}visitImportFrom(e){return!0}visitImportFromAs(e){return!0}visitIndex(e){return!0}visitIndexItems(e){return!0}visitExcept(e){return!0}visitFor(e){return!0}visitFormatString(e){return!0}visitFunction(e){return!0}visitFunctionAnnotation(e){return!0}visitGlobal(e){return!0}visitLambda(e){return!0}visitList(e){return!0}visitListComprehension(e){return!0}visitListComprehensionFor(e){return!0}visitListComprehensionIf(e){return!0}visitMemberAccess(e){return!0}visitModule(e){return!0}visitModuleName(e){return!0}visitName(e){return!0}visitNonlocal(e){return!0}visitNumber(e){return!0}visitParameter(e){return!0}visitPass(e){return!0}visitRaise(e){return!0}visitReturn(e){return!0}visitSet(e){return!0}visitSlice(e){return!0}visitStatementList(e){return!0}visitString(e){return!0}visitStringList(e){return!0}visitSuite(e){return!0}visitTuple(e){return!0}visitTry(e){return!0}visitTypeAnnotation(e){return!0}visitUnaryOperation(e){return!0}visitUnpack(e){return!0}visitWhile(e){return!0}visitWith(e){return!0}visitWithItem(e){return!0}visitYield(e){return!0}visitYieldFrom(e){return!0}}},8408:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t},o=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,r){function o(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Program=void 0;const a=n(4494),l=n(3213),c=n(2211),p=n(2489),u=n(5839),d=n(7345),h=n(6657),m=n(1464),y=n(3550),g=n(8718),f=n(8566),_=n(7087),T=r(n(563)),v=n(2835),b=n(8494),C=n(5083),S=n(4221),I=n(8816),D=n(1766),k=n(7887),x=n(2590);class F{constructor(e,t,n,s,i="FG"){this._extension=s,this._sourceFileList=[],this._sourceFileMap=new Map,this._parsedFileCount=0,this._lookUpImport=e=>{const t=this._getSourceFileInfoFromPath(e);if(!t)return;t.sourceFile.isBindingRequired()&&g.timingStats.typeCheckerTime.subtractFromTime(()=>{this._bindFile(t)});const n=t.sourceFile.getModuleSymbolTable();if(!n)return;const s=t.sourceFile.getModuleDocString(),i=t.sourceFile.getParseResults();return{symbolTable:n,dunderAllNames:T.getDunderAllNames(i.parseTree),docString:s}},this._console=n||new c.StandardConsole,this._logTracker=new d.LogTracker(n,i),this._importResolver=e,this._configOptions=t,this._createNewEvaluator()}get evaluator(){return this._evaluator}setConfigOptions(e){this._configOptions=e,this._createNewEvaluator()}setImportResolver(e){this._importResolver=e}setTrackedFiles(e){if(this._sourceFileList.length>0){const t=new Map;e.forEach(e=>{t.set(h.normalizePathCase(this._fs,e),e)}),this._sourceFileList.forEach(e=>{const n=h.normalizePathCase(this._fs,e.sourceFile.getFilePath());t.has(n)||(e.isTracked=!1)})}return this.addTrackedFiles(e),this._removeUnneededFiles()}setAllowedThirdPartyImports(e){this._allowedThirdPartyImports=e}addTrackedFiles(e,t=!1,n=!1){e.forEach(e=>{this.addTrackedFile(e,t,n)})}addTrackedFile(e,t=!1,n=!1){let s=this._getSourceFileInfoFromPath(e);if(s)return s.isTracked=!0,s.sourceFile;const i=this._getImportNameForFile(e),r=new S.SourceFile(this._fs,e,i,t,n,this._console,this._logTracker);return s={sourceFile:r,isTracked:!0,isOpenByClient:!1,isTypeshedFile:!1,isThirdPartyImport:t,isThirdPartyPyTypedPresent:n,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(s),r}setFileOpened(e,t,n){let s=this._getSourceFileInfoFromPath(e);if(s)s.isOpenByClient=!0,s.diagnosticsVersion=void 0;else{const t=this._getImportNameForFile(e);s={sourceFile:new S.SourceFile(this._fs,e,t,!1,!1,this._console,this._logTracker),isTracked:!1,isOpenByClient:!0,isTypeshedFile:!1,isThirdPartyImport:!1,isThirdPartyPyTypedPresent:!1,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(s)}s.sourceFile.setClientVersion(t,n)}setFileClosed(e){const t=this._getSourceFileInfoFromPath(e);return t&&(t.isOpenByClient=!1,t.sourceFile.setClientVersion(null,"")),this._removeUnneededFiles()}markAllFilesDirty(e){const t=new Map;this._sourceFileList.forEach(n=>{e?n.sourceFile.markDirty():n.sourceFile.didContentsChangeOnDisk()&&(n.sourceFile.markDirty(),this._markFileDirtyRecursive(n,t))}),t.size>0&&this._createNewEvaluator()}markFilesDirty(e,t){const n=new Map;e.forEach(e=>{const s=this._getSourceFileInfoFromPath(e);s&&(t||!s.isOpenByClient&&s.sourceFile.didContentsChangeOnDisk())&&(s.sourceFile.markDirty(),this._markFileDirtyRecursive(s,n))}),n.size>0&&this._createNewEvaluator()}getFileCount(){return this._sourceFileList.length}getFilesToAnalyzeCount(){let e=0;return this._sourceFileList.forEach(t=>{t.sourceFile.isCheckingRequired()&&this._shouldCheckFile(t)&&e++}),e}isCheckingOnlyOpenFiles(){return this._configOptions.checkOnlyOpenFiles||!1}getSourceFile(e){const t=this._getSourceFileInfoFromPath(e);if(t)return t.sourceFile}getBoundSourceFile(e){const t=this._getSourceFileInfoFromPath(e);if(t)return this._bindFile(t),this.getSourceFile(e)}analyze(e,t=a.CancellationToken.None){return this._runEvaluatorWithCancellationToken(t,()=>{const t=new g.Duration,n=this._sourceFileList.filter(e=>e.isOpenByClient&&e.sourceFile.isCheckingRequired());if(n.length>0){const s=e?e.openFilesTimeInMs:Number.MAX_VALUE;for(const e of n)if(this._checkTypes(e)&&t.getDurationInMilliseconds()>s)return!0;if(void 0!==e)return!0}if(!this._configOptions.checkOnlyOpenFiles){const n=e?e.noOpenFilesTimeInMs:Number.MAX_VALUE;for(const e of this._sourceFileList)if(this._isUserCode(e)&&this._checkTypes(e)&&t.getDurationInMilliseconds()>n)return!0}return!1})}indexWorkspace(e,t){if(this._configOptions.indexing)return this._runEvaluatorWithCancellationToken(t,()=>{for(const n of this._sourceFileList){if(!this._isUserCode(n))continue;this._bindFile(n);const s=n.sourceFile.index(!1,t);s&&e(n.sourceFile.getFilePath(),s),this._handleMemoryHighUsage()}})}printDependencies(e,t){const n=this._sourceFileList.filter(e=>!e.isTypeshedFile).sort((e,t)=>e.sourceFile.getFilePath()<t.sourceFile.getFilePath()?1:-1),s=[];n.forEach(n=>{this._console.info("");let i=n.sourceFile.getFilePath();const r=h.getRelativePath(i,e);r&&(i=r),this._console.info(""+i),this._console.info(` Imports     ${n.imports.length} file`+(1===n.imports.length?"":"s")),t&&n.imports.forEach(e=>{this._console.info("    "+e.sourceFile.getFilePath())}),this._console.info(` Imported by ${n.importedBy.length} file`+(1===n.importedBy.length?"":"s")),t&&n.importedBy.forEach(e=>{this._console.info("    "+e.sourceFile.getFilePath())}),0===n.importedBy.length&&s.push(n.sourceFile)}),s.length>0&&(this._console.info(""),this._console.info(`${s.length} file${1===s.length?"":"s"} not explicitly imported`),s.forEach(e=>{this._console.info("    "+e.getFilePath())}))}writeTypeStub(e,t,n,s){for(const i of this._sourceFileList){l.throwIfCancellationRequested(s);const r=i.sourceFile.getFilePath(),o=h.getRelativePath(r,e);if(void 0!==o){let e=h.normalizePath(h.combinePaths(n,o));e=t?h.combinePaths(h.getDirectoryPath(e),"__init__.pyi"):h.stripFileExtension(e)+".pyi";const r=h.getDirectoryPath(e);try{h.makeDirectories(this._fs,r,n)}catch(e){throw new Error(`Could not create directory for '${r}'`)}this._bindFile(i),this._runEvaluatorWithCancellationToken(s,()=>{new x.TypeStubWriter(e,i.sourceFile,this._evaluator).write()}),this._handleMemoryHighUsage()}}}getTypeForSymbol(e){return this._handleMemoryHighUsage(),(this._evaluator||this._createNewEvaluator()).getEffectiveTypeOfSymbol(e)}printType(e,t){return this._handleMemoryHighUsage(),(this._evaluator||this._createNewEvaluator()).printType(e,t)}static _getPrintTypeFlags(e){let t=0;return e.diagnosticRuleSet.printUnknownAsAny&&(t|=1),e.diagnosticRuleSet.omitTypeArgsIfAny&&(t|=2),e.diagnosticRuleSet.omitUnannotatedParamType&&(t|=4),e.diagnosticRuleSet.pep604Printing&&(t|=8),t}get _fs(){return this._importResolver.fileSystem}_getImportNameForFile(e){return this._importResolver.getModuleNameForImport(e,this._configOptions.getDefaultExecEnvironment()).moduleName}_addShadowedFile(e,t){let n=this._getSourceFileInfoFromPath(t);if(!n){const e=this._getImportNameForFile(t);n={sourceFile:new S.SourceFile(this._fs,t,e,!1,!1,this._console,this._logTracker),isTracked:!1,isOpenByClient:!1,isTypeshedFile:!1,isThirdPartyImport:!1,isThirdPartyPyTypedPresent:!1,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(n)}return n.shadows.includes(e)||n.shadows.push(e),e.shadowedBy.includes(n)||e.shadowedBy.push(n),n.sourceFile}_createNewEvaluator(){return this._evaluator=k.createTypeEvaluator(this._lookUpImport,{disableInferenceForPyTypedSources:this._configOptions.disableInferenceForPyTypedSources,printTypeFlags:F._getPrintTypeFlags(this._configOptions)}),this._evaluator}_parseFile(e){if(this._isFileNeeded(e)&&e.sourceFile.isParseRequired()&&(e.sourceFile.parse(this._configOptions,this._importResolver)&&(this._parsedFileCount++,this._updateSourceFileImports(e,this._configOptions)),e.sourceFile.isFileDeleted())){e.isTracked=!1;const t=new Map;this._markFileDirtyRecursive(e,t),this._importResolver.invalidateCache()}}_bindFile(e){if(!this._isFileNeeded(e)||!e.sourceFile.isBindingRequired())return;let t;if(this._parseFile(e),e.builtinsImport){this._bindFile(e.builtinsImport);const n=e.builtinsImport.sourceFile.getParseResults();n&&(t=T.getScope(n.parseTree),u.assert(void 0!==t))}e.sourceFile.bind(this._configOptions,this._lookUpImport,t)}_buildModuleSymbolsMap(e,t){return f.buildModuleSymbolsMap(this._sourceFileList.filter(t=>t!==e),t)}_shouldCheckFile(e){return!!e.isOpenByClient||!(this._configOptions.checkOnlyOpenFiles||!e.isTracked)}_checkTypes(e){return this._logTracker.log("analyzing: "+e.sourceFile.getFilePath(),t=>{if(!this._isFileNeeded(e))return t.suppress(),!1;if(!e.sourceFile.isCheckingRequired())return t.suppress(),!1;if(!this._shouldCheckFile(e))return t.suppress(),!1;if(this._bindFile(e),e.sourceFile.check(this._evaluator),this._handleMemoryHighUsage(),"none"!==this._configOptions.diagnosticRuleSet.reportImportCycles&&!this._allowedThirdPartyImports){const t=new Map;this._getImportsRecursive(e,t,0),t.forEach(e=>{g.timingStats.cycleDetectionTime.timeOperation(()=>{this._detectAndReportImportCycles(e)})})}return!0})}_getImportsRecursive(e,t,n){const s=h.normalizePathCase(this._fs,e.sourceFile.getFilePath());if(!t.has(s))if(n>256)e.sourceFile.setHitMaxImportDepth(256);else{t.set(s,e);for(const s of e.imports)this._getImportsRecursive(s,t,n+1)}}_detectAndReportImportCycles(e,t=[],n=new Map){if(e.sourceFile.isStubFile()||e.isThirdPartyImport)return;const s=h.normalizePathCase(this._fs,e.sourceFile.getFilePath());if(n.has(s))t.length>1&&e===t[0]&&this._logImportCycle(t);else{if(n.has(s))return;n.set(s,!0),t.push(e);for(const s of e.imports)this._detectAndReportImportCycles(s,t,n);n.set(s,!1),t.pop()}}_logImportCycle(e){const t=new v.CircularDependency;e.forEach(e=>{t.appendPath(e.sourceFile.getFilePath())}),t.normalizeOrder();const n=t.getPaths()[0],s=this._getSourceFileInfoFromPath(n);u.assert(void 0!==s),s.sourceFile.addCircularDependency(t)}_markFileDirtyRecursive(e,t){const n=h.normalizePathCase(this._fs,e.sourceFile.getFilePath());t.has(n)||(e.sourceFile.markReanalysisRequired(),t.set(n,!0),e.importedBy.forEach(e=>{this._markFileDirtyRecursive(e,t)}))}getTextOnRange(e,t,n){const s=this._sourceFileMap.get(e);if(!s)return;const i=s.sourceFile,r=i.getFileContents();return r?this._runEvaluatorWithCancellationToken(n,()=>{this._parseFile(s);const e=i.getParseResults(),n=m.convertRangeToTextRange(t,e.tokenizerOutput.lines);if(n)return r.substr(n.start,n.length)}):void 0}getAutoImports(e,t,n,s,i,r){const o=this._getSourceFileInfoFromPath(e);if(!o)return[];const a=o.sourceFile,l=a.getFileContents();return l?this._runEvaluatorWithCancellationToken(r,()=>{this._bindFile(o);const e=a.getParseResults(),c=m.convertRangeToTextRange(t,e.tokenizerOutput.lines);if(!c)return[];const p=b.findNodeByOffset(e.parseTree,c.start);if(!p)return[];const u=l.substr(c.start,c.length),d=this._buildModuleSymbolsMap(o,r),h=new f.AutoImporter(this._configOptions,this._importResolver,e,t.start,[],d,i),y=[],g=C.getScopeForNode(p);if(g){const e=null==s?void 0:s.get(u);if(e){const t=1;y.push(...h.getAutoImportCandidates(e,t,u,r))}y.push(...h.getAutoImportCandidates(u,n,void 0,r).filter(e=>!g.lookUpSymbolRecursive(e.name)))}return y}):[]}getDiagnostics(e){const t=this._removeUnneededFiles();return this._sourceFileList.forEach(n=>{if(this._shouldCheckFile(n)){const s=n.sourceFile.getDiagnostics(e,n.diagnosticsVersion);void 0!==s&&(t.push({filePath:n.sourceFile.getFilePath(),diagnostics:s}),n.diagnosticsVersion=n.sourceFile.getDiagnosticVersion())}else!n.isOpenByClient&&e.checkOnlyOpenFiles&&void 0!==n.diagnosticsVersion&&(t.push({filePath:n.sourceFile.getFilePath(),diagnostics:[]}),n.diagnosticsVersion=void 0)}),t}getDiagnosticsForRange(e,t){const n=this.getSourceFile(e);if(!n)return[];const s=n.getDiagnostics(this._configOptions);return s?s.filter(e=>y.doRangesIntersect(e.range,t)):[]}getDefinitionsForPosition(e,t,n){return this._runEvaluatorWithCancellationToken(n,()=>{const s=this._getSourceFileInfoFromPath(e);if(!s)return;this._bindFile(s);const i=this._configOptions.findExecEnvironment(e);return s.sourceFile.getDefinitionsForPosition(this._createSourceMapper(i),t,this._evaluator,n)})}getReferencesForPosition(e,t,n,s){return this._runEvaluatorWithCancellationToken(s,()=>{const i=this._getSourceFileInfoFromPath(e);if(!i)return;const r=this._isUserCode(i);this._bindFile(i);const o=this._configOptions.findExecEnvironment(e),a=i.sourceFile.getDeclarationForPosition(this._createSourceMapper(o),t,this._evaluator,s);if(a){if(a.requiresGlobalSearch){for(const e of this._sourceFileList)l.throwIfCancellationRequested(s),(e.isOpenByClient||!r||this._isUserCode(e))&&(this._bindFile(e),e.sourceFile.addReferences(a,n,this._evaluator,s)),this._handleMemoryHighUsage();if(n)for(const e of a.declarations){if(l.throwIfCancellationRequested(s),a.locations.some(t=>t.path===e.path))continue;const t=this._getSourceFileInfoFromPath(e.path);if(!t)continue;const i={requiresGlobalSearch:a.requiresGlobalSearch,nodeAtOffset:a.nodeAtOffset,symbolName:a.symbolName,declarations:a.declarations,locations:[]};t.sourceFile.addReferences(i,n,this._evaluator,s);for(const t of i.locations)t.path===e.path&&y.doesRangeContain(e.range,t.range)&&a.locations.push(t)}}else i.sourceFile.addReferences(a,n,this._evaluator,s);return a.locations}})}getFileIndex(e,t,n){if(t){const t=h.stripFileExtension(h.getFileName(e));if(D.isPrivateOrProtectedName(t))return}return this._handleMemoryHighUsage(),this._runEvaluatorWithCancellationToken(n,()=>{const s=this._getSourceFileInfoFromPath(e);if(s)return this._bindFile(s),s.sourceFile.index(t,n)})}addSymbolsForDocument(e,t,n){return this._runEvaluatorWithCancellationToken(n,()=>{const s=this._getSourceFileInfoFromPath(e);s&&(s.sourceFile.getCachedIndexResults()||this._bindFile(s),s.sourceFile.addHierarchicalSymbolsForDocument(t,n))})}addSymbolsForWorkspace(e,t,n){return this._runEvaluatorWithCancellationToken(n,()=>{if(t)for(const s of this._sourceFileList)this._isUserCode(s)&&(s.sourceFile.getCachedIndexResults()||this._bindFile(s),s.sourceFile.addSymbolsForDocument(e,t,n),this._handleMemoryHighUsage())})}getHoverForPosition(e,t,n){return this._runEvaluatorWithCancellationToken(n,()=>{const s=this._getSourceFileInfoFromPath(e);if(!s)return;this._bindFile(s);const i=this._configOptions.findExecEnvironment(e);return s.sourceFile.getHoverForPosition(this._createSourceMapper(i,!0),t,this._evaluator,n)})}getDocumentHighlight(e,t,n){return this._runEvaluatorWithCancellationToken(n,()=>{const s=this._getSourceFileInfoFromPath(e);if(!s)return;this._bindFile(s);const i=this._configOptions.findExecEnvironment(e);return s.sourceFile.getDocumentHighlight(this._createSourceMapper(i),t,this._evaluator,n)})}getSignatureHelpForPosition(e,t,n){return this._runEvaluatorWithCancellationToken(n,()=>{const s=this._getSourceFileInfoFromPath(e);if(s)return this._bindFile(s),s.sourceFile.getSignatureHelpForPosition(t,this._lookUpImport,this._evaluator,n)})}getCompletionsForPosition(e,t,n,s,i){var r;return o(this,void 0,void 0,(function*(){const o=this._getSourceFileInfoFromPath(e);if(!o)return;const a=this._runEvaluatorWithCancellationToken(i,()=>{this._bindFile(o);const r=this._configOptions.findExecEnvironment(e);return o.sourceFile.getCompletionsForPosition(t,n,this._configOptions,this._importResolver,this._lookUpImport,this._evaluator,this._createSourceMapper(r,!0),s,()=>this._buildModuleSymbolsMap(o,i),i)});if(!(null==a?void 0:a.completionList)||!(null===(r=this._extension)||void 0===r?void 0:r.completionListExtension))return a;const l=o.sourceFile.getParseResults(),c=o.sourceFile.getFileContents();if((null==l?void 0:l.parseTree)&&c){const e=m.convertPositionToOffset(t,l.tokenizerOutput.lines);void 0!==e&&(a.completionList=yield this._extension.completionListExtension.updateCompletionList(a.completionList,l.parseTree,c,e,this._configOptions,i))}return a}))}resolveCompletionItem(e,t,n,s){return this._runEvaluatorWithCancellationToken(s,()=>{const i=this._getSourceFileInfoFromPath(e);if(!i)return;this._bindFile(i);const r=this._configOptions.findExecEnvironment(e);i.sourceFile.resolveCompletionItem(this._configOptions,this._importResolver,this._lookUpImport,this._evaluator,this._createSourceMapper(r,!0),n,()=>this._buildModuleSymbolsMap(i,s),t,s)})}renameSymbolAtPosition(e,t,n,s){return this._runEvaluatorWithCancellationToken(s,()=>{const i=this._getSourceFileInfoFromPath(e);if(!i)return;this._bindFile(i);const r=this._configOptions.findExecEnvironment(e),o=i.sourceFile.getDeclarationForPosition(this._createSourceMapper(r),t,this._evaluator,s);if(!o)return;if(o.declarations.some(e=>!this._isUserCode(this._getSourceFileInfoFromPath(e.path))))return;if(0===o.declarations.length)return;if(o.requiresGlobalSearch)for(const e of this._sourceFileList)this._isUserCode(e)&&(this._bindFile(e),e.sourceFile.addReferences(o,!0,this._evaluator,s)),this._handleMemoryHighUsage();else this._isUserCode(i)&&i.sourceFile.addReferences(o,!0,this._evaluator,s);const a=[];return o.locations.forEach(e=>{a.push({filePath:e.path,range:e.range,replacementText:n})}),a})}getCallForPosition(e,t,n){const s=this._getSourceFileInfoFromPath(e);if(!s)return;this._bindFile(s);const i=this._configOptions.findExecEnvironment(e),r=s.sourceFile.getDeclarationForPosition(this._createSourceMapper(i),t,this._evaluator,n);if(!r||0===r.declarations.length)return;const o=_.CallHierarchyProvider.getTargetDeclaration(r.declarations,r.nodeAtOffset);return _.CallHierarchyProvider.getCallForDeclaration(r.symbolName,o,this._evaluator,n)}getIncomingCallsForPosition(e,t,n){const s=this._getSourceFileInfoFromPath(e);if(!s)return;this._bindFile(s);const i=this._configOptions.findExecEnvironment(e),r=s.sourceFile.getDeclarationForPosition(this._createSourceMapper(i),t,this._evaluator,n);if(!r||0===r.declarations.length)return;const o=_.CallHierarchyProvider.getTargetDeclaration(r.declarations,r.nodeAtOffset);let a=[];for(const e of this._sourceFileList)if(this._isUserCode(e)||e.isOpenByClient){this._bindFile(e);const t=_.CallHierarchyProvider.getIncomingCallsForDeclaration(e.sourceFile.getFilePath(),r.symbolName,o,e.sourceFile.getParseResults(),this._evaluator,n);t&&(a=a.concat(...t)),this._handleMemoryHighUsage()}return a}getOutgoingCallsForPosition(e,t,n){const s=this._getSourceFileInfoFromPath(e);if(!s)return;this._bindFile(s);const i=this._configOptions.findExecEnvironment(e),r=s.sourceFile.getDeclarationForPosition(this._createSourceMapper(i),t,this._evaluator,n);if(!r||0===r.declarations.length)return;const o=_.CallHierarchyProvider.getTargetDeclaration(r.declarations,r.nodeAtOffset);return _.CallHierarchyProvider.getOutgoingCallsForDeclaration(o,s.sourceFile.getParseResults(),this._evaluator,n)}performQuickAction(e,t,n,s){const i=this._getSourceFileInfoFromPath(e);if(i)return this._bindFile(i),i.sourceFile.performQuickAction(t,n,s)}_handleMemoryHighUsage(){if(this._evaluator.getTypeCacheSize()>75e4||this._parsedFileCount>1e3){const e=Math.round(process.memoryUsage().heapUsed/1048576);e>1536&&(this._console.info(`Emptying type cache to avoid heap overflow. Heap size used: ${e}MB`),this._createNewEvaluator(),this._discardCachedParseResults(),this._parsedFileCount=0)}}_discardCachedParseResults(){for(const e of this._sourceFileList)e.sourceFile.dropParseAndBindInfo()}_isUserCode(e){return e&&e.isTracked&&!e.isThirdPartyImport&&!e.isTypeshedFile}_runEvaluatorWithCancellationToken(e,t){try{return e&&!p.isDebugMode()?this._evaluator.runWithCancellationToken(e,t):t()}catch(e){throw e instanceof l.OperationCanceledException||this._createNewEvaluator(),e}}_removeUnneededFiles(){const e=[];for(let t=0;t<this._sourceFileList.length;){const n=this._sourceFileList[t];this._isFileNeeded(n)?(this._shouldCheckFile(n)||void 0===n.diagnosticsVersion||(e.push({filePath:n.sourceFile.getFilePath(),diagnostics:[]}),n.diagnosticsVersion=void 0),t++):(e.push({filePath:n.sourceFile.getFilePath(),diagnostics:[]}),n.sourceFile.prepareForClose(),this._removeSourceFileFromListAndMap(n.sourceFile.getFilePath(),t),n.imports.forEach(s=>{const i=s.importedBy.findIndex(e=>e===n);if(u.assert(i>=0),s.importedBy.splice(i,1),!this._isFileNeeded(s)){const n=this._sourceFileList.findIndex(e=>e===s);n>=0&&n<t&&(e.push({filePath:s.sourceFile.getFilePath(),diagnostics:[]}),s.sourceFile.prepareForClose(),this._removeSourceFileFromListAndMap(s.sourceFile.getFilePath(),n),t--)}}),n.shadowedBy.forEach(e=>{e.shadows=e.shadows.filter(e=>e!==n)}),n.shadowedBy=[])}return e}_isFileNeeded(e){return!e.sourceFile.isFileDeleted()&&(!(!e.isTracked&&!e.isOpenByClient)||e.shadows.length>0||0!==e.importedBy.length&&this._isImportNeededRecursive(e,new Map))}_isImportNeededRecursive(e,t){if(e.isTracked||e.isOpenByClient||e.shadows.length>0)return!0;const n=h.normalizePathCase(this._fs,e.sourceFile.getFilePath());if(t.has(n))return!1;t.set(n,!0);for(const n of e.importedBy)if(this._isImportNeededRecursive(n,t))return!0;return!1}_createSourceMapper(e,t){return new I.SourceMapper(this._importResolver,e,this._evaluator,(e,t)=>{const n=this._getSourceFileInfoFromPath(e);if(n)return this._addShadowedFile(n,t),this.getBoundSourceFile(t)},null!=t&&t)}_isImportAllowed(e,t,n){if(t.isNativeLib)return!1;let s=this._configOptions.useLibraryCodeForTypes||1===t.importType&&!!t.isPyTypedPresent||2===t.importType&&e.isThirdPartyPyTypedPresent;return!((1===t.importType||e.isThirdPartyImport&&2===t.importType)&&(this._allowedThirdPartyImports&&(t.isRelative||this._allowedThirdPartyImports.some(e=>t.importName===e||!!t.importName.startsWith(e+".")))&&(s=!0),!n))||s}_updateSourceFileImports(e,t){const n=[],s=e.sourceFile.getImports(),i=t=>{let n=!1,s=!1;return 1===t.importType?(n=!0,t.isPyTypedPresent&&(s=!0)):e.isThirdPartyImport&&2===t.importType&&(n=!0,e.isThirdPartyPyTypedPresent&&(s=!0)),{isThirdPartyImport:n,isPyTypedPresent:s}},r=new Map;s.forEach(n=>{if(n.isImportFound){if(this._isImportAllowed(e,n,n.isStubFile)&&n.resolvedPaths.length>0){const e=n.resolvedPaths[n.resolvedPaths.length-1];if(e){const t=i(n);r.set(h.normalizePathCase(this._fs,e),{path:e,isTypeshedFile:!!n.isTypeshedFile,isThirdPartyImport:t.isThirdPartyImport,isPyTypedPresent:t.isPyTypedPresent})}}n.implicitImports.forEach(t=>{if(this._isImportAllowed(e,n,t.isStubFile)){const e=i(n);r.set(h.normalizePathCase(this._fs,t.path),{path:t.path,isTypeshedFile:!!n.isTypeshedFile,isThirdPartyImport:e.isThirdPartyImport,isPyTypedPresent:e.isPyTypedPresent})}})}else t.verboseOutput&&(this._console.info(`Could not import '${n.importName}' in file '${e.sourceFile.getFilePath()}'`),n.importFailureInfo&&n.importFailureInfo.forEach(e=>{this._console.info("  "+e)}))});const o=new Map;e.imports.forEach(t=>{const n=h.normalizePathCase(this._fs,t.sourceFile.getFilePath());r.has(n)?o.set(n,t):t.importedBy=t.importedBy.filter(t=>h.normalizePathCase(this._fs,t.sourceFile.getFilePath())!==h.normalizePathCase(this._fs,e.sourceFile.getFilePath()))}),r.forEach((t,s)=>{if(!o.has(s)){let i;if(this._getSourceFileInfoFromPath(t.path))i=this._getSourceFileInfoFromPath(t.path);else{const e=this._getImportNameForFile(t.path);i={sourceFile:new S.SourceFile(this._fs,t.path,e,t.isThirdPartyImport,t.isPyTypedPresent,this._console,this._logTracker),isTracked:!1,isOpenByClient:!1,isTypeshedFile:t.isTypeshedFile,isThirdPartyImport:t.isThirdPartyImport,isThirdPartyPyTypedPresent:t.isPyTypedPresent,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(i),n.push(i)}i.importedBy.push(e),o.set(s,i)}}),e.imports=[],r.forEach((t,n)=>{this._getSourceFileInfoFromPath(n)&&e.imports.push(this._getSourceFileInfoFromPath(n))}),e.builtinsImport=void 0;const a=e.sourceFile.getBuiltinsImport();if(a&&a.isImportFound){const t=a.resolvedPaths[a.resolvedPaths.length-1];e.builtinsImport=this._getSourceFileInfoFromPath(t)}return n}_getSourceFileInfoFromPath(e){return this._sourceFileMap.get(h.normalizePathCase(this._fs,e))}_removeSourceFileFromListAndMap(e,t){this._sourceFileMap.delete(h.normalizePathCase(this._fs,e)),this._sourceFileList.splice(t,1)}_addToSourceFileListAndMap(e){const t=h.normalizePathCase(this._fs,e.sourceFile.getFilePath());u.assert(!this._sourceFileMap.has(t)),this._sourceFileList.push(e),this._sourceFileMap.set(t,e)}}t.Program=F},1277:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPyTypedInfo=void 0;const s=n(6657);t.getPyTypedInfo=function(e,t){let n,i=!1,r=!1;if(e.existsSync(t)&&s.isDirectory(e,t)&&(n=s.combinePaths(t,"py.typed"),e.existsSync(t)&&s.isFile(e,n))){i=!0;const t=e.statSync(n);if(t.size>0&&t.size<65536){const t=e.readFileSync(n,"utf8");(t.match(/partial\n/)||t.match(/partial\r\n/))&&(r=!0)}}return{isPyTypedPresent:i,pyTypedPath:i?n:void 0,isPartiallyTyped:r}}},1887:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isPythonBinary=t.getPythonPathFromPythonInterpreter=t.findPythonSearchPaths=t.getTypeshedSubdirectory=t.getTypeShedFallbackPath=t.thirdPartyFolderName=t.stdLibFolderName=void 0;const o=r(n(3129)),a=r(n(3188)),l=n(6657),c=new Map;function p(e,t,n){const s={paths:[],prefix:""};try{const i=["-c","import sys, json; json.dump(dict(path=sys.path, prefix=sys.prefix), sys.stdout)"];n.push(`Executing interpreter: '${t}'`);const r=o.execFileSync(t,i,{encoding:"utf8"});try{const t=JSON.parse(r);for(let i of t.path)if(i=i.trim(),i){const t=l.normalizePath(i);e.existsSync(t)&&l.isDirectory(e,t)?s.paths.push(t):n.push(`Skipping '${t}' because it is not a valid directory`)}s.prefix=t.prefix,0===s.paths.length&&n.push("Found no valid directories")}catch(e){throw n.push(`Could not parse output: '${r}'`),e}}catch(e){return}return s}function u(e,t,n){const s=t||"",i=c.get(s);if(i)return i;let r;return t?r=p(e,t,n):("win32"!==process.platform&&(r=p(e,"python3",n)),r||(r=p(e,"python",n))),r||(r={paths:[],prefix:""}),c.set(s,r),n.push(`Received ${r.paths.length} paths from interpreter`),r.paths.forEach(e=>{n.push("  "+e)}),r}t.stdLibFolderName="stdlib",t.thirdPartyFolderName="third_party",t.getTypeShedFallbackPath=function(e){let t=e.getModulePath();if(!t)return;t=l.getDirectoryPath(l.ensureTrailingDirectorySeparator(l.normalizePath(t)));const n=l.combinePaths(t,a.typeshedFallback);if(e.existsSync(n))return n;const s=l.combinePaths(l.getDirectoryPath(t),a.typeshedFallback);return e.existsSync(s)?s:void 0},t.getTypeshedSubdirectory=function(e,n){return l.combinePaths(e,n?t.stdLibFolderName:t.thirdPartyFolderName)},t.findPythonSearchPaths=function(e,t,n,s,i,r){let o;if(s.push("Finding python search paths"),void 0!==n?t.venvPath&&(o=l.combinePaths(t.venvPath,n)):t.defaultVenv&&t.venvPath&&(o=l.combinePaths(t.venvPath,t.defaultVenv)),o){let t=l.combinePaths(o,a.lib);if(e.existsSync(t)?s.push(`Found path '${t}'; looking for ${a.sitePackages}`):(s.push(`Did not find '${t}'; trying 'Lib' instead`),t=l.combinePaths(o,"Lib"),e.existsSync(t)?s.push(`Found path '${t}'; looking for ${a.sitePackages}`):(s.push(`Did not find '${t}'`),t="")),t){const n=l.combinePaths(t,a.sitePackages);if(e.existsSync(n))return s.push(`Found path '${n}'`),[n];s.push(`Did not find '${n}', so looking for python subdirectory`);const i=l.getFileSystemEntries(e,t);for(let n=0;n<i.directories.length;n++){const r=i.directories[n];if(r.startsWith("python")){const n=l.combinePaths(t,r,a.sitePackages);if(e.existsSync(n))return s.push(`Found path '${n}'`),[n];s.push(`Path '${n}' is not a valid directory`)}}}s.push(`Did not find '${a.sitePackages}'. Falling back on python interpreter.`)}const c=u(e,t.pythonPath,s);return i&&r?c.paths.filter(e=>!l.containsPath(r,e,!0)||l.containsPath(c.prefix,e,!0)):c.paths},t.getPythonPathFromPythonInterpreter=u,t.isPythonBinary=function(e){return"python"===(e=e.trim())||"python3"===e}},1561:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scope=void 0;const s=n(5839),i=n(817);t.Scope=class{constructor(e,t){this.symbolTable=new Map,this.notLocalBindings=new Map,this.type=e,this.parent=t}getGlobalScope(){let e=this;for(;e;){if(3===e.type||4===e.type)return e;e=e.parent}return s.fail("failed to find scope"),this}isIndependentlyExecutable(){return 3===this.type||1===this.type}lookUpSymbol(e){return this.symbolTable.get(e)}lookUpSymbolRecursive(e){return this._lookUpSymbolRecursiveInternal(e,!1,!1)}addSymbol(e,t){const n=new i.Symbol(t);return this.symbolTable.set(e,n),n}getBindingType(e){return this.notLocalBindings.get(e)}setBindingType(e,t){return this.notLocalBindings.set(e,t)}_lookUpSymbolRecursiveInternal(e,t,n){const s=this.symbolTable.get(e);if(s){if(t&&s.isExternallyHidden())return;const e=s.getDeclarations();if(0===e.length||e.some(e=>1!==e.type||!e.isDefinedByMemberAccess))return{symbol:s,isOutsideCallerModule:t,isBeyondExecutionScope:n,scope:this}}let i;if(i=1===this.notLocalBindings.get(e)?this.getGlobalScope():this.parent,i)return i._lookUpSymbolRecursiveInternal(e,t||3===this.type,n||this.isIndependentlyExecutable())}}},5083:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getScopeForNode=t.getBuiltInScope=void 0;const s=n(563),i=n(8494);t.getBuiltInScope=function(e){let t=e;for(;4!==t.type;)t=t.parent;return t},t.getScopeForNode=function(e){const t=i.getEvaluationScopeNode(e);return s.getScope(t)}},6708:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyzerService=t.configFileNames=void 0;const s=n(3213),i=n(2930),r=n(2211),o=n(7830),a=n(6657),l=n(8718),c=n(5674),p=n(2374),u=n(1887);t.configFileNames=["pyrightconfig.json","mspythonconfig.json"];class d{constructor(e,t,n,s,o,a,l,p,u){this._typeStubTargetIsSingleFile=!1,this._requireTrackedFileUpdate=!0,this._lastUserInteractionTime=Date.now(),this._disposed=!1,this._instanceName=e,this._console=n||new r.StandardConsole,this._executionRootPath="",this._extension=a,this._importResolverFactory=s||d.createImportResolver,this._maxAnalysisTimeInForeground=p,this._backgroundAnalysisProgramFactory=u,o=null!=o?o:new i.ConfigOptions(process.cwd());const h=this._importResolverFactory(t,o);this._backgroundAnalysisProgram=void 0!==u?u(this._console,o,h,this._extension,l,this._maxAnalysisTimeInForeground):new c.BackgroundAnalysisProgram(this._console,o,h,this._extension,l,this._maxAnalysisTimeInForeground)}clone(e,t){return new d(e,this._fs,this._console,this._importResolverFactory,this._backgroundAnalysisProgram.configOptions,this._extension,t,this._maxAnalysisTimeInForeground,this._backgroundAnalysisProgramFactory)}dispose(){this._disposed=!0,this._removeSourceFileWatchers(),this._removeConfigFileWatcher(),this._removeLibraryFileWatcher(),this._clearReloadConfigTimer(),this._clearReanalysisTimer(),this._clearLibraryReanalysisTimer()}get backgroundAnalysisProgram(){return this._backgroundAnalysisProgram}static createImportResolver(e,t){return new p.ImportResolver(e,t)}setCompletionCallback(e){this._onCompletionCallback=e,this._backgroundAnalysisProgram.setCompletionCallback(e)}setOptions(e,t=!0){this._commandLineOptions=e;const n=this._getConfigOptions(e);n.pythonPath&&n.ensureDefaultPythonVersion(n.pythonPath,this._console),n.ensureDefaultPythonPlatform(this._console),this._backgroundAnalysisProgram.setConfigOptions(n),this._executionRootPath=a.normalizePath(a.combinePaths(e.executionRoot,n.projectRoot)),this._applyConfigOptions(t)}setFileOpened(e,t,n){this._backgroundAnalysisProgram.setFileOpened(e,t,n),this._scheduleReanalysis(!1)}updateOpenFileContents(e,t,n){this._backgroundAnalysisProgram.updateOpenFileContents(e,t,n),this._scheduleReanalysis(!1)}test_setIndexing(e,t){this._backgroundAnalysisProgram.test_setIndexing(e,t)}startIndexing(){this._backgroundAnalysisProgram.startIndexing()}setFileClosed(e){this._backgroundAnalysisProgram.setFileClosed(e),this._scheduleReanalysis(!1)}getParseResult(e){var t;return null===(t=this._program.getBoundSourceFile(e))||void 0===t?void 0:t.getParseResults()}getTextOnRange(e,t,n){return this._program.getTextOnRange(e,t,n)}getAutoImports(e,t,n,s,i){return this._program.getAutoImports(e,t,n,s,this._backgroundAnalysisProgram.getIndexing(e),i)}getDefinitionForPosition(e,t,n){return this._program.getDefinitionsForPosition(e,t,n)}getReferencesForPosition(e,t,n,s){return this._program.getReferencesForPosition(e,t,n,s)}addSymbolsForDocument(e,t,n){this._program.addSymbolsForDocument(e,t,n)}addSymbolsForWorkspace(e,t,n){this._program.addSymbolsForWorkspace(e,t,n)}getHoverForPosition(e,t,n){return this._program.getHoverForPosition(e,t,n)}getDocumentHighlight(e,t,n){return this._program.getDocumentHighlight(e,t,n)}getSignatureHelpForPosition(e,t,n){return this._program.getSignatureHelpForPosition(e,t,n)}getCompletionsForPosition(e,t,n,s){return this._program.getCompletionsForPosition(e,t,n,this._backgroundAnalysisProgram.getIndexing(e),s)}resolveCompletionItem(e,t,n){this._program.resolveCompletionItem(e,t,this._backgroundAnalysisProgram.getIndexing(e),n)}performQuickAction(e,t,n,s){return this._program.performQuickAction(e,t,n,s)}renameSymbolAtPosition(e,t,n,s){return this._program.renameSymbolAtPosition(e,t,n,s)}getCallForPosition(e,t,n){return this._program.getCallForPosition(e,t,n)}getIncomingCallsForPosition(e,t,n){return this._program.getIncomingCallsForPosition(e,t,n)}getOutgoingCallsForPosition(e,t,n){return this._program.getOutgoingCallsForPosition(e,t,n)}printStats(){this._console.info(""),this._console.info("Analysis stats");const e=this._program.getFileCount();this._console.info("Total files analyzed: "+e.toString())}printDependencies(e){this._program.printDependencies(this._executionRootPath,e)}getDiagnosticsForRange(e,t,n){return this._backgroundAnalysisProgram.getDiagnosticsForRange(e,t,n)}getConfigOptions(){return this._configOptions}getImportResolver(){return this._backgroundAnalysisProgram.importResolver}recordUserInteractionTime(){this._lastUserInteractionTime=Date.now(),this._analyzeTimer&&this._scheduleReanalysis(!1)}get test_program(){return this._program}test_getConfigOptions(e){return this._getConfigOptions(e)}test_getFileNamesFromFileSpecs(){return this._getFileNamesFromFileSpecs()}_getConfigOptions(e){var t,n;let s,o=e.executionRoot;e.configFilePath?(s=a.combinePaths(e.executionRoot,a.normalizePath(e.configFilePath)),this._fs.existsSync(s)?s.toLowerCase().endsWith(".json")?o=a.getDirectoryPath(s):(o=s,s=this._findConfigFile(s),s||this._console.info(`Configuration file not found at ${o}.`)):(this._console.info(`Configuration file not found at ${s}.`),s=e.executionRoot)):o&&(s=this._findConfigFileHereOrUp(o),s?o=a.getDirectoryPath(s):(this._console.info("No configuration file found."),s=void 0));const l=new i.ConfigOptions(o,this._typeCheckingMode),c=["**/node_modules","**/__pycache__",".git"];if(e.fileSpecs.length>0?e.fileSpecs.forEach(e=>{l.include.push(a.getFileSpec(o,e))}):s||e.executionRoot&&(l.include.push(a.getFileSpec(e.executionRoot,".")),c.forEach(t=>{l.exclude.push(a.getFileSpec(e.executionRoot,t))})),this._configFilePath=s,s){this._console.info("Loading configuration file at "+s);const t=this._parseConfigFile(s);if(t){l.initializeFromJson(t,this._typeCheckingMode,this._console,e.diagnosticSeverityOverrides,e.pythonPath,e.fileSpecs.length>0);const n=a.getDirectoryPath(s);0===l.include.length&&(this._console.info("No include entries specified; assuming "+n),l.include.push(a.getFileSpec(n,"."))),0===l.exclude.length&&(c.forEach(e=>{this._console.info("Auto-excluding "+e),l.exclude.push(a.getFileSpec(n,e))}),void 0===l.autoExcludeVenv&&(l.autoExcludeVenv=!0)),0===l.executionEnvironments.length&&l.addExecEnvironmentForExtraPaths(this._fs,e.autoSearchPaths||!1,e.extraPaths||[])}}else l.addExecEnvironmentForExtraPaths(this._fs,e.autoSearchPaths||!1,e.extraPaths||[]),l.autoExcludeVenv=!0,l.applyDiagnosticOverrides(e.diagnosticSeverityOverrides);const p=(t,n)=>{const s=e.fromVsCodeExtension?"the client settings":"a command-line option";this._console.warn(`The ${t} has been specified in both the config file and ${s}. The value in the config file (${n}) will take precedence`)};if(e.venvPath&&(l.venvPath?p("venvPath",l.venvPath):l.venvPath=e.venvPath),e.pythonPath&&(this._console.info(`Setting pythonPath for service "${this._instanceName}": "${e.pythonPath}"`),l.pythonPath=e.pythonPath),e.typeshedPath&&(l.typeshedPath?p("typeshedPath",l.typeshedPath):l.typeshedPath=e.typeshedPath),l.verboseOutput=null!==(t=e.verboseOutput)&&void 0!==t?t:l.verboseOutput,l.checkOnlyOpenFiles=!!e.checkOnlyOpenFiles,l.autoImportCompletions=!!e.autoImportCompletions,l.indexing=!!e.indexing,void 0===l.useLibraryCodeForTypes?l.useLibraryCodeForTypes=!!e.useLibraryCodeForTypes:void 0!==e.useLibraryCodeForTypes&&p("useLibraryCodeForTypes",l.useLibraryCodeForTypes),e.stubPath?l.stubPath?p("stubPath",l.stubPath):l.stubPath=e.stubPath:l.stubPath||(l.stubPath=a.normalizePath(a.combinePaths(l.projectRoot,"typings"))),l.venvPath){if(this._fs.existsSync(l.venvPath)&&a.isDirectory(this._fs,l.venvPath)||this._console.error(`venvPath ${l.venvPath} is not a valid directory.`),l.defaultVenv=null!==(n=l.defaultVenv)&&void 0!==n?n:this._configOptions.defaultVenv,l.defaultVenv){const e=a.combinePaths(l.venvPath,l.defaultVenv);if(this._fs.existsSync(e)&&a.isDirectory(this._fs,e)){const e=[];void 0===u.findPythonSearchPaths(this._fs,l,void 0,e)&&(this._console.error(`site-packages directory cannot be located for venvPath ${l.venvPath} and venv ${l.defaultVenv}.`),l.verboseOutput&&e.forEach(e=>{this._console.error("  "+e)}))}else this._console.error(`venv ${l.defaultVenv} subdirectory not found in venv path ${l.venvPath}.`)}}else{const t=[],n=u.getPythonPathFromPythonInterpreter(this._fs,l.pythonPath,t).paths;if(0===n.length){const t=l.verboseOutput?r.LogLevel.Error:r.LogLevel.Log;(e.fromVsCodeExtension||l.verboseOutput)&&r.log(this._console,t,"No search paths found for configured python interpreter.")}else if(e.fromVsCodeExtension||l.verboseOutput){const e=l.verboseOutput?r.LogLevel.Info:r.LogLevel.Log;r.log(this._console,e,"Search paths found for configured python interpreter:"),n.forEach(t=>{r.log(this._console,e,"  "+t)})}l.verboseOutput&&t.length>0&&(this._console.info("When attempting to get search paths from python interpreter:"),t.forEach(e=>{this._console.info("  "+e)}))}return(l.defaultVenv||l.executionEnvironments.find(e=>!!e.venv))&&(l.venvPath||this._console.warn("venvPath not specified, so venv settings will be ignored.")),l.typeshedPath&&(this._fs.existsSync(l.typeshedPath)&&a.isDirectory(this._fs,l.typeshedPath)||this._console.error(`typeshedPath ${l.typeshedPath} is not a valid directory.`)),l.stubPath&&(this._fs.existsSync(l.stubPath)&&a.isDirectory(this._fs,l.stubPath)||this._console.error(`stubPath ${l.stubPath} is not a valid directory.`)),l}writeTypeStub(e){const t=this._getTypeStubFolder();this._program.writeTypeStub(this._typeStubTargetPath,this._typeStubTargetIsSingleFile,t,e)}writeTypeStubInBackground(e){const t=this._getTypeStubFolder();return this._backgroundAnalysisProgram.writeTypeStub(this._typeStubTargetPath,this._typeStubTargetIsSingleFile,t,e)}invalidateAndForceReanalysis(){this._backgroundAnalysisProgram.invalidateAndForceReanalysis()}restart(){this._applyConfigOptions(),this._backgroundAnalysisProgram.restart()}get _fs(){return this._backgroundAnalysisProgram.importResolver.fileSystem}get _program(){return this._backgroundAnalysisProgram.program}get _configOptions(){return this._backgroundAnalysisProgram.configOptions}get _watchForSourceChanges(){var e;return!!(null===(e=this._commandLineOptions)||void 0===e?void 0:e.watchForSourceChanges)}get _watchForLibraryChanges(){var e;return!!(null===(e=this._commandLineOptions)||void 0===e?void 0:e.watchForLibraryChanges)}get _typeCheckingMode(){var e;return null===(e=this._commandLineOptions)||void 0===e?void 0:e.typeCheckingMode}get _verboseOutput(){return!!this._configOptions.verboseOutput}get _typeStubTargetImportName(){var e;return null===(e=this._commandLineOptions)||void 0===e?void 0:e.typeStubTargetImportName}_getTypeStubFolder(){const e=this._configOptions.stubPath;if(!this._typeStubTargetPath||!this._typeStubTargetImportName){const e=`Import '${this._typeStubTargetImportName}' could not be resolved`;throw this._console.error(e),new Error(e)}if(!e){const e="No typings path was specified";throw this._console.info(e),new Error(e)}const t=this._typeStubTargetImportName.split(".");if(0===t[0].length){const e=`Import '${this._typeStubTargetImportName}' could not be resolved`;throw this._console.error(e),new Error(e)}try{this._fs.existsSync(e)||this._fs.mkdirSync(e)}catch(t){const n=`Could not create typings directory '${e}'`;throw this._console.error(n),new Error(n)}const n=a.combinePaths(e,t[0]);try{this._fs.existsSync(n)||this._fs.mkdirSync(n)}catch(e){const t=`Could not create typings subdirectory '${n}'`;throw this._console.error(t),new Error(t)}return n}_findConfigFileHereOrUp(e){return a.forEachAncestorDirectory(e,e=>this._findConfigFile(e))}_findConfigFile(e){for(const n of t.configFileNames){const t=a.combinePaths(e,n);if(this._fs.existsSync(t))return t}}_parseConfigFile(e){let t="",n=0;for(;;){try{t=this._fs.readFileSync(e,"utf8")}catch(t){return this._console.error(`Config file "${e}" could not be read.`),void this._reportConfigParseError()}let s,i=!1;try{return s=JSON.parse(t),s}catch(e){i=!0}if(!i)break;if(n++>=5)return this._console.error(`Config file "${e}" could not be parsed. Verify that JSON is correct.`),void this._reportConfigParseError()}}_getFileNamesFromFileSpecs(){const e=new Map;return l.timingStats.findFilesTime.timeOperation(()=>{const t=this._matchFiles(this._configOptions.include,this._configOptions.exclude);for(const n of t)e.set(n,n)}),[...e.values()]}_updateTrackedFileList(e){if(this._typeStubTargetImportName){const e=this._configOptions.findExecEnvironment(this._executionRootPath),t={leadingDots:0,nameParts:this._typeStubTargetImportName.split("."),importedSymbols:[]},n=this._backgroundAnalysisProgram.importResolver.resolveImport("",e,t);if(n.isImportFound){const e=[],t=n.resolvedPaths[n.resolvedPaths.length-1];let s=a.getDirectoryPath(t),i=t;for(let e=n.resolvedPaths.length-2;e>=0;e--){const t=n.resolvedPaths[e];t?(s=a.getDirectoryPath(t),i=t):(s=a.getDirectoryPath(i),i=s)}a.isDirectory(this._fs,s)&&(this._typeStubTargetPath=s),t?(e.push(t),this._typeStubTargetIsSingleFile=1===n.resolvedPaths.length&&"__init__"!==a.stripFileExtension(a.getFileName(n.resolvedPaths[0]))):this._typeStubTargetIsSingleFile=!1,n.implicitImports.forEach(t=>{e.push(t.path)}),this._backgroundAnalysisProgram.setAllowedThirdPartyImports([this._typeStubTargetImportName]),this._backgroundAnalysisProgram.setTrackedFiles(e)}else this._console.error(`Import '${this._typeStubTargetImportName}' not found`)}else{let t=[];this._console.info("Searching for source files"),t=this._getFileNamesFromFileSpecs(),this._backgroundAnalysisProgram.setTrackedFiles(t),this._backgroundAnalysisProgram.markAllFilesDirty(e),0===t.length?this._console.info("No source files found."):this._console.info(`Found ${t.length} source `+(1===t.length?"file":"files"))}this._requireTrackedFileUpdate=!1}_isInExcludePath(e,t){return!!t.find(t=>t.regExp.test(e))}_matchFiles(e,t){const n=/\.pyi?$/,s=[["bin","activate"],["Scripts","activate"],["pyvenv.cfg"]],i=[],r=(e,o)=>{if(this._configOptions.autoExcludeVenv&&s.some(t=>this._fs.existsSync(a.combinePaths(e,...t))))return void this._console.info("Auto-excluding "+e);const{files:l,directories:c}=a.getFileSystemEntries(this._fs,e);for(const s of l){const r=a.combinePaths(e,s);o.test(r)&&!this._isInExcludePath(r,t)&&n.test(r)&&i.push(r)}for(const n of c){const s=a.combinePaths(e,n);o.test(s)&&(this._isInExcludePath(s,t)||r(s,o))}};return e.forEach(e=>{let s=!1;if(!this._isInExcludePath(e.wildcardRoot,t))try{const t=this._fs.statSync(e.wildcardRoot);t.isFile()?n.test(e.wildcardRoot)&&(i.push(e.wildcardRoot),s=!0):t.isDirectory()&&(r(e.wildcardRoot,e.regExp),s=!0)}catch(e){}s||this._console.error(`File or directory "${e.wildcardRoot}" does not exist.`)}),i}_removeSourceFileWatchers(){this._sourceFileWatcher&&(this._sourceFileWatcher.close(),this._sourceFileWatcher=void 0)}_updateSourceFileWatchers(){if(this._removeSourceFileWatchers(),this._backgroundAnalysisProgram.invalidateCache(),this._watchForSourceChanges&&this._configOptions.include.length>0){const e=this._configOptions.include.map(e=>a.combinePaths(this._executionRootPath,e.wildcardRoot));try{this._verboseOutput&&this._console.info("Adding fs watcher for directories:\n "+e.join("\n"));const t=o.ignoredWatchEventFunction(e);this._sourceFileWatcher=this._fs.createFileSystemWatcher(e,(e,n)=>{if(!t(n))if(this._verboseOutput&&this._console.info(`SourceFile: Received fs event '${e}' for path '${n}'`),"change"===e&&this._fs.existsSync(n))this._backgroundAnalysisProgram.markFilesDirty([n],!1),this._scheduleReanalysis(!1);else{const e=a.getFileName(n).split(".");let t=!1;4===e.length&&e[3]===e[1]&&32===e[2].length&&(t=!0),t||(this.invalidateAndForceReanalysis(),this._scheduleReanalysis(!0))}})}catch(t){this._console.error("Exception caught when installing fs watcher for:\n "+e.join("\n"))}}}_removeLibraryFileWatcher(){this._libraryFileWatcher&&(this._libraryFileWatcher.close(),this._libraryFileWatcher=void 0)}_updateLibraryFileWatcher(){if(this._removeLibraryFileWatcher(),this._backgroundAnalysisProgram.invalidateCache(),!this._watchForLibraryChanges)return;const e=u.findPythonSearchPaths(this._fs,this._backgroundAnalysisProgram.configOptions,void 0,[],!0,this._executionRootPath);if(e&&e.length>0)try{this._verboseOutput&&this._console.info("Adding fs watcher for library directories:\n "+e.join("\n"));const t=o.ignoredWatchEventFunction(e);this._libraryFileWatcher=this._fs.createFileSystemWatcher(e,(e,n)=>{t(n)||(this._verboseOutput&&this._console.info(`LibraryFile: Received fs event '${e}' for path '${n}'}'`),this._scheduleLibraryAnalysis())})}catch(t){this._console.error("Exception caught when installing fs watcher for:\n "+e.join("\n"))}}_clearLibraryReanalysisTimer(){var e;this._libraryReanalysisTimer&&(clearTimeout(this._libraryReanalysisTimer),this._libraryReanalysisTimer=void 0,null===(e=this._backgroundAnalysisProgram)||void 0===e||e.cancelIndexing())}_scheduleLibraryAnalysis(){this._disposed||(this._clearLibraryReanalysisTimer(),this._libraryReanalysisTimer=setTimeout(()=>{this._clearLibraryReanalysisTimer(),this.invalidateAndForceReanalysis(),this._scheduleReanalysis(!1)},1e3))}_removeConfigFileWatcher(){this._configFileWatcher&&(this._configFileWatcher.close(),this._configFileWatcher=void 0)}_updateConfigFileWatcher(){this._removeConfigFileWatcher(),this._configFilePath?this._configFileWatcher=this._fs.createFileSystemWatcher([this._configFilePath],e=>{this._verboseOutput&&this._console.info(`Received fs event '${e}' for config file`),this._scheduleReloadConfigFile()}):this._executionRootPath&&(this._configFileWatcher=this._fs.createFileSystemWatcher([this._executionRootPath],(e,n)=>{if("add"===e||"change"===e){const s=a.getFileName(n);s&&t.configFileNames.some(e=>e===s)&&(this._verboseOutput&&this._console.info(`Received fs event '${e}' for config file`),this._commandLineOptions&&this.setOptions(this._commandLineOptions))}}))}_clearReloadConfigTimer(){this._reloadConfigTimer&&(clearTimeout(this._reloadConfigTimer),this._reloadConfigTimer=void 0)}_scheduleReloadConfigFile(){this._clearReloadConfigTimer(),this._reloadConfigTimer=setTimeout(()=>{this._clearReloadConfigTimer(),this._reloadConfigFile()},100)}_reloadConfigFile(){if(this._updateConfigFileWatcher(),this._configFilePath){this._console.info("Reloading configuration file at "+this._configFilePath);const e=this._getConfigOptions(this._commandLineOptions);this._backgroundAnalysisProgram.setConfigOptions(e),this._applyConfigOptions()}}_applyConfigOptions(e=!0){const t=this._importResolverFactory(this._fs,this._backgroundAnalysisProgram.configOptions);this._backgroundAnalysisProgram.setImportResolver(t),this._updateLibraryFileWatcher(),this._updateConfigFileWatcher(),this._updateSourceFileWatchers(),this._updateTrackedFileList(!0),e&&this._scheduleReanalysis(!1)}_clearReanalysisTimer(){this._analyzeTimer&&(clearTimeout(this._analyzeTimer),this._analyzeTimer=void 0)}_scheduleReanalysis(e){var t;if(this._disposed)return;e&&(this._requireTrackedFileUpdate=!0),null===(t=this._backgroundAnalysisCancellationSource)||void 0===t||t.cancel(),this._clearReanalysisTimer();const n=Date.now()-this._lastUserInteractionTime,i=Math.max(250-n,20);this._analyzeTimer=setTimeout(()=>{this._analyzeTimer=void 0,this._requireTrackedFileUpdate&&this._updateTrackedFileList(!1),this._backgroundAnalysisCancellationSource=s.createBackgroundThreadCancellationTokenSource(),this._backgroundAnalysisProgram.startAnalysis(this._backgroundAnalysisCancellationSource.token)&&this._scheduleReanalysis(!1)},i)}_reportConfigParseError(){this._onCompletionCallback&&this._onCompletionCallback({diagnostics:[],filesInProgram:0,filesRequiringAnalysis:0,checkingOnlyOpenFiles:!0,fatalErrorOccurred:!1,configParseErrorOccurred:!0,elapsedTime:0})}}t.AnalyzerService=d},4221:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.SourceFile=void 0;const o=n(5013),a=r(n(1766)),l=n(3213),c=n(2930),p=n(2211),u=n(5839),d=n(1290),h=n(3980),m=n(7345),y=n(6657),g=r(n(7559)),f=n(3550),_=n(3420),T=n(8718),v=n(9209),b=n(3778),C=n(8221),S=n(2816),I=n(3334),D=n(2858),k=n(4952),x=n(9437),F=n(2122),P=n(5275),A=n(5303),w=r(n(563)),E=n(6052),N=n(6329),O=r(n(2272)),R=n(4482),L=n(2041);t.SourceFile=class{constructor(e,t,n,s,i,r,a){this._isFileDeleted=!1,this._diagnosticVersion=0,this._fileContentsVersion=0,this._lastFileContentLength=void 0,this._lastFileContentHash=void 0,this._clientVersion=null,this._analyzedFileContentsVersion=-1,this._parseTreeNeedsCleaning=!1,this._isBindingInProgress=!1,this._parseDiagnostics=[],this._bindDiagnostics=[],this._checkerDiagnostics=[],this._diagnosticRuleSet=c.getBasicDiagnosticRuleSet(),this._circularDependencies=[],this._isBindingNeeded=!0,this._isCheckingNeeded=!0,this._indexingNeeded=!0,this.fileSystem=e,this._console=r||new p.StandardConsole,this._filePath=t,this._moduleName=n,this._isStubFile=t.endsWith(".pyi"),this._isThirdPartyImport=s,this._isThirdPartyPyTypedPresent=i;const l=y.getFileName(t);this._isTypingStubFile=this._isStubFile&&("typing.pyi"===l||"typing_extensions.pyi"===l),this._isTypingExtensionsStubFile=this._isStubFile&&"typing_extensions.pyi"===l,this._isBuiltInStubFile=!1,this._isStubFile&&(this._filePath.endsWith(y.normalizeSlashes("/collections/__init__.pyi"))||this._filePath.endsWith(y.normalizeSlashes("/asyncio/futures.pyi"))||"builtins.pyi"===l||"_importlib_modulespec.pyi"===l||"dataclasses.pyi"===l||"abc.pyi"===l||"enum.pyi"===l||"queue.pyi"===l||"types.pyi"===l)&&(this._isBuiltInStubFile=!0),this._logTracker=null!=a?a:new m.LogTracker(r,o.isMainThread?"FG":"BG")}getFilePath(){return this._filePath}getDiagnosticVersion(){return this._diagnosticVersion}isStubFile(){return this._isStubFile}getDiagnostics(e,t){if(this._diagnosticVersion===t)return;let n=!0;this._isThirdPartyImport&&(n=!1);let s=[];if(s=s.concat(this._parseDiagnostics,this._bindDiagnostics,this._checkerDiagnostics),e.diagnosticRuleSet.enableTypeIgnoreComments){const e=this._parseResults?this._parseResults.tokenizerOutput.typeIgnoreLines:{};Object.keys(e).length>0&&(s=s.filter(t=>{if(3!==t.category)for(let n=t.range.start.line;n<=t.range.end.line;n++)if(e[n])return!1;return!0}))}if("none"!==e.diagnosticRuleSet.reportImportCycles&&this._circularDependencies.length>0){const t=d.convertLevelToCategory(e.diagnosticRuleSet.reportImportCycles);this._circularDependencies.forEach(e=>{s.push(new d.Diagnostic(t,F.Localizer.Diagnostic.importCycleDetected()+"\n"+e.getPaths().map(e=>"  "+e).join("\n"),f.getEmptyRange()))})}return void 0!==this._hitMaxImportDepth&&s.push(new d.Diagnostic(0,F.Localizer.Diagnostic.importDepthExceeded().format({depth:this._hitMaxImportDepth}),f.getEmptyRange())),e.ignore.find(e=>e.regExp.test(this._filePath))&&(s=[]),e.diagnosticRuleSet.enableTypeIgnoreComments&&this._parseResults&&this._parseResults.tokenizerOutput.typeIgnoreAll&&(s=[]),n||(s=s.filter(e=>3===e.category)),s}getImports(){return this._imports||[]}getBuiltinsImport(){return this._builtinsImport}getModuleSymbolTable(){return this._moduleSymbolTable}getModuleDocString(){return this._binderResults?this._binderResults.moduleDocString:void 0}didContentsChangeOnDisk(){if(null!==this._clientVersion)return!1;if(void 0===this._lastFileContentLength)return!1;try{const e=this.fileSystem.readFileSync(this._filePath,"utf8");if(e.length!==this._lastFileContentLength)return!0;if(g.hashString(e)!==this._lastFileContentHash)return!0}catch(e){return!0}return!1}dropParseAndBindInfo(){this._parseResults=void 0,this._moduleSymbolTable=void 0,this._isBindingNeeded=!0,this._binderResults=void 0}markDirty(){this._fileContentsVersion++,this._isCheckingNeeded=!0,this._isBindingNeeded=!0,this._indexingNeeded=!0,this._moduleSymbolTable=void 0,this._binderResults=void 0,this._cachedIndexResults=void 0}markReanalysisRequired(){this._isCheckingNeeded=!0,this._parseResults&&(this._parseResults.containsWildcardImport||w.getDunderAllNames(this._parseResults.parseTree))&&(this._parseTreeNeedsCleaning=!0,this._isBindingNeeded=!0,this._indexingNeeded=!0,this._moduleSymbolTable=void 0,this._binderResults=void 0,this._cachedIndexResults=void 0)}getClientVersion(){return this._clientVersion}getFileContents(){return this._fileContents}setClientVersion(e,t){this._clientVersion=e,null===e?this._fileContents=void 0:(void 0!==this._fileContents&&this._fileContents!==t&&this.markDirty(),this._fileContents=t)}prepareForClose(){}isFileDeleted(){return this._isFileDeleted}isParseRequired(){return!this._parseResults||this._analyzedFileContentsVersion!==this._fileContentsVersion}isBindingRequired(){return!this._isBindingInProgress&&(!!this.isParseRequired()||this._isBindingNeeded)}isIndexingRequired(){return this._indexingNeeded}isCheckingRequired(){return this._isCheckingNeeded}getParseResults(){if(!this.isParseRequired())return this._parseResults}getCachedIndexResults(){return this._cachedIndexResults}cacheIndexResults(e){this._cachedIndexResults=e}addCircularDependency(e){let t=!1;this._circularDependencies.length<4&&(this._circularDependencies.some(t=>t.isEqual(e))||(this._circularDependencies.push(e),t=!0)),t&&this._diagnosticVersion++}setHitMaxImportDepth(e){this._hitMaxImportDepth=e}parse(e,t){return this._logTracker.log("parsing: "+this._filePath,n=>{if(!this.isParseRequired())return n.suppress(),!1;const s=new h.DiagnosticSink;let i=this._fileContents;if(null===this._clientVersion)try{T.timingStats.readFileTime.timeOperation(()=>{i=this.fileSystem.readFileSync(this._filePath,"utf8"),this._lastFileContentLength=i.length,this._lastFileContentHash=g.hashString(i)})}catch(e){s.addError("Source file could not be read",f.getEmptyRange()),i="",this.fileSystem.existsSync(this._filePath)||(this._isFileDeleted=!0)}const r=e.findExecEnvironment(this._filePath),o=new A.ParseOptions;this._filePath.endsWith("pyi")&&(o.isStubFile=!0),o.pythonVersion=r.pythonVersion;try{const n=(new A.Parser).parseSourceFile(i,o,s);u.assert(void 0!==n&&void 0!==n.tokenizerOutput),this._parseResults=n,T.timingStats.resolveImportsTime.timeOperation(()=>{const e=this._resolveImports(t,n.importedModules,r);this._imports=e.imports,this._builtinsImport=e.builtinsImportResult,this._typingModulePath=e.typingModulePath,this._typeshedModulePath=e.typeshedModulePath,this._collectionsModulePath=e.collectionsModulePath,this._parseDiagnostics=s.fetchAndClear()});const a=void 0!==e.strict.find(e=>e.regExp.test(this._filePath));this._diagnosticRuleSet=O.getFileLevelDirectives(this._parseResults.tokenizerOutput.tokens,e.diagnosticRuleSet,a)}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(F.Localizer.Diagnostic.internalParseError().format({file:this.getFilePath(),message:t})),this._parseResults={text:"",parseTree:P.ModuleNode.create({start:0,length:0}),importedModules:[],futureImports:new Map,tokenizerOutput:{tokens:new _.TextRangeCollection([]),lines:new _.TextRangeCollection([]),typeIgnoreAll:!1,typeIgnoreLines:{},predominantEndOfLineSequence:"\n",predominantTabSequence:"    ",predominantSingleQuoteCharacter:"'"},containsWildcardImport:!1},this._imports=void 0,this._builtinsImport=void 0;const n=new h.DiagnosticSink;n.addError(F.Localizer.Diagnostic.internalParseError().format({file:this.getFilePath(),message:t}),f.getEmptyRange()),this._parseDiagnostics=n.fetchAndClear()}return this._analyzedFileContentsVersion=this._fileContentsVersion,this._indexingNeeded=!0,this._isBindingNeeded=!0,this._isCheckingNeeded=!0,this._parseTreeNeedsCleaning=!1,this._hitMaxImportDepth=void 0,this._diagnosticVersion++,!0})}index(e,t){if(!this._parseResults||!this.isIndexingRequired())return;this._indexingNeeded=!1;const n=S.DocumentSymbolProvider.indexSymbols(this._parseResults,e,t),s=y.stripFileExtension(y.getFileName(this._filePath));return{privateOrProtected:a.isPrivateOrProtectedName(s),symbols:n}}getDefinitionsForPosition(e,t,n,s){if(this._parseResults)return b.DefinitionProvider.getDefinitionsForPosition(e,this._parseResults,t,n,s)}getDeclarationForPosition(e,t,n,s){if(this._parseResults)return k.ReferencesProvider.getDeclarationForPosition(e,this._parseResults,this._filePath,t,n,s)}addReferences(e,t,n,s){this._parseResults&&k.ReferencesProvider.addReferences(this._parseResults,this._filePath,e,t,n,s)}addHierarchicalSymbolsForDocument(e,t){(this._parseResults||this._cachedIndexResults)&&S.DocumentSymbolProvider.addHierarchicalSymbolsForDocument(this.getCachedIndexResults(),this._parseResults,e,t)}addSymbolsForDocument(e,t,n){(this._parseResults||this._cachedIndexResults)&&S.DocumentSymbolProvider.addSymbolsForDocument(this.getCachedIndexResults(),this._parseResults,this._filePath,t,e,n)}getHoverForPosition(e,t,n,s){if(!this._isBindingNeeded&&this._parseResults)return I.HoverProvider.getHoverForPosition(e,this._parseResults,t,n,s)}getDocumentHighlight(e,t,n,s){if(!this._isBindingNeeded&&this._parseResults)return C.DocumentHighlightProvider.getDocumentHighlight(this._parseResults,t,n,s)}getSignatureHelpForPosition(e,t,n,s){if(this._parseResults)return x.SignatureHelpProvider.getSignatureHelpForPosition(this._parseResults,e,n,s)}getCompletionsForPosition(e,t,n,s,i,r,o,a,l,c){if(this._parseResults&&void 0!==this._fileContents)return new v.CompletionProvider(t,this._parseResults,this._fileContents,s,e,this._filePath,n,i,r,o,a,l,c).getCompletionsForPosition()}resolveCompletionItem(e,t,n,s,i,r,o,a,l){if(!this._parseResults||void 0===this._fileContents)return;const c=a.data;new v.CompletionProvider(c.workspacePath,this._parseResults,this._fileContents,t,c.position,this._filePath,e,n,s,i,r,o,l).resolveCompletionItem(a)}performQuickAction(e,t,n){if(this._parseResults&&void 0!==this._fileContents)return D.performQuickAction(e,t,this._parseResults,n)}bind(e,t,n){return u.assert(!this.isParseRequired()),u.assert(this.isBindingRequired()),u.assert(!this._isBindingInProgress),u.assert(void 0!==this._parseResults),this._logTracker.log("binding: "+this._filePath,()=>{try{T.timingStats.bindTime.timeOperation(()=>{this._cleanParseTreeIfRequired();const s=this._buildFileInfo(e,this._parseResults.text,t,n);w.setFileInfo(this._parseResults.parseTree,s);const i=new E.Binder(s);this._isBindingInProgress=!0,this._binderResults=i.bindModule(this._parseResults.parseTree),e.internalTestMode&&(new L.TestWalker).walk(this._parseResults.parseTree),this._bindDiagnostics=s.diagnosticSink.fetchAndClear();const r=w.getScope(this._parseResults.parseTree);u.assert(void 0!==r),this._moduleSymbolTable=r.symbolTable})}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(F.Localizer.Diagnostic.internalBindError().format({file:this.getFilePath(),message:t}));const n=new h.DiagnosticSink;n.addError(F.Localizer.Diagnostic.internalBindError().format({file:this.getFilePath(),message:t}),f.getEmptyRange()),this._bindDiagnostics=n.fetchAndClear()}finally{this._isBindingInProgress=!1}this._diagnosticVersion++,this._isCheckingNeeded=!0,this._indexingNeeded=!0,this._isBindingNeeded=!1})}check(e){return u.assert(!this.isParseRequired()),u.assert(!this.isBindingRequired()),u.assert(!this._isBindingInProgress),u.assert(this.isCheckingRequired()),u.assert(void 0!==this._parseResults),this._logTracker.log("checking: "+this._filePath,()=>{try{T.timingStats.typeCheckerTime.timeOperation(()=>{new N.Checker(this._parseResults.parseTree,e).check(),this._isCheckingNeeded=!1;const t=w.getFileInfo(this._parseResults.parseTree);this._checkerDiagnostics=t.diagnosticSink.fetchAndClear()})}catch(e){if(!l.OperationCanceledException.is(e)){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(F.Localizer.Diagnostic.internalTypeCheckingError().format({file:this.getFilePath(),message:t}));const n=new h.DiagnosticSink;n.addError(F.Localizer.Diagnostic.internalTypeCheckingError().format({file:this.getFilePath(),message:t}),f.getEmptyRange()),this._checkerDiagnostics=n.fetchAndClear(),this._isCheckingNeeded=!1}throw e}finally{this._circularDependencies=[],this._diagnosticVersion++}})}_buildFileInfo(e,t,n,s){u.assert(void 0!==this._parseResults);const i=new h.TextRangeDiagnosticSink(this._parseResults.tokenizerOutput.lines);return{importLookup:n,futureImports:this._parseResults.futureImports,builtinsScope:s,typingModulePath:this._typingModulePath,typeshedModulePath:this._typeshedModulePath,collectionsModulePath:this._collectionsModulePath,diagnosticSink:i,executionEnvironment:e.findExecEnvironment(this._filePath),diagnosticRuleSet:this._diagnosticRuleSet,fileContents:t,lines:this._parseResults.tokenizerOutput.lines,filePath:this._filePath,moduleName:this._moduleName,isStubFile:this._isStubFile,isTypingStubFile:this._isTypingStubFile,isTypingExtensionsStubFile:this._isTypingExtensionsStubFile,isBuiltInStubFile:this._isBuiltInStubFile,isInPyTypedPackage:this._isThirdPartyPyTypedPresent,accessedSymbolMap:new Map}}_cleanParseTreeIfRequired(){this._parseResults&&this._parseTreeNeedsCleaning&&(new R.ParseTreeCleanerWalker(this._parseResults.parseTree).clean(),this._parseTreeNeedsCleaning=!1)}_resolveImports(e,t,n){const s=[];let i=e.resolveImport(this._filePath,n,{leadingDots:0,nameParts:["builtins"],importedSymbols:void 0});0===i.resolvedPaths.length||i.resolvedPaths[0]!==this.getFilePath()?s.push(i):i=void 0;const r=e.resolveImport(this._filePath,n,{leadingDots:0,nameParts:["typing"],importedSymbols:void 0});let o;0!==r.resolvedPaths.length&&r.resolvedPaths[0]===this.getFilePath()||(s.push(r),o=r.resolvedPaths[0]);const a=e.resolveImport(this._filePath,n,{leadingDots:0,nameParts:["_typeshed"],importedSymbols:void 0});let l,c;0!==a.resolvedPaths.length&&a.resolvedPaths[0]===this.getFilePath()||(s.push(a),l=a.resolvedPaths[0]);for(const i of t){const t=e.resolveImport(this._filePath,n,{leadingDots:i.leadingDots,nameParts:i.nameParts,importedSymbols:i.importedSymbols});t.isImportFound&&t.isTypeshedFile&&i.nameParts.length>=1&&"collections"===i.nameParts[0]&&(c=t.resolvedPaths[t.resolvedPaths.length-1]),s.push(t),w.setImportInfo(i.nameNode,t)}return{imports:s,builtinsImportResult:i,typingModulePath:o,typeshedModulePath:l,collectionsModulePath:c}}}},8816:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isStubFile=t.SourceMapper=void 0;const o=r(n(563)),a=r(n(8494)),l=n(6657);function c(e){return".pyi"===l.getAnyExtensionFromPath(e,[".pyi"],!1)}function p(e){return void 0!==e}t.SourceMapper=class{constructor(e,t,n,s,i){this._importResolver=e,this._execEnv=t,this._evaluator=n,this._fileBinder=s,this._mapCompiled=i}findModules(e){return this._getBoundSourceFiles(e).map(e=>{var t;return null===(t=e.getParseResults())||void 0===t?void 0:t.parseTree}).filter(p)}findDeclarations(e){return 4===e.type?this.findClassDeclarations(e):3===e.type?this.findFunctionDeclarations(e):[]}findClassDeclarations(e){const t=this._getFullClassName(e.node);return this._getBoundSourceFiles(e.path).flatMap(e=>this._findClassDeclarations(e,t))}findFunctionDeclarations(e){const t=e.node.name.value,n=this._getBoundSourceFiles(e.path);if(e.isMethod){const s=a.getEnclosingClass(e.node);if(void 0===s)return[];const i=this._getFullClassName(s);return n.flatMap(e=>this._findMethodDeclarations(e,i,t))}return n.flatMap(e=>this._findFunctionDeclarations(e,t))}_findMethodDeclarations(e,t,n){const s=[],i=this._findClassDeclarations(e,t);for(const e of i){const t=this._lookUpSymbolDeclarations(e.node,n);for(const e of t)3===e.type&&e.isMethod&&s.push(e)}return s}_findFunctionDeclarations(e,t){var n;const s=[],i=this._lookUpSymbolDeclarations(null===(n=e.getParseResults())||void 0===n?void 0:n.parseTree,t);for(const e of i)if(3===e.type)s.push(e);else if(6===e.type){const t=this._evaluator.resolveAliasDeclaration(e,!0);t&&3===t.type&&(c(t.path)?s.push(...this.findFunctionDeclarations(t)):s.push(t))}return s}_findClassDeclarations(e,t){var n;let s=[];const i=null===(n=e.getParseResults())||void 0===n?void 0:n.parseTree;if(i){let n=t.split(".");n.length>0&&(s=this._findClassDeclarationsUnderNode(e,n[0],i),n=n.slice(1));for(const t of n)s=this._findClassDeclarationsUnderClass(e,t,s)}return s}_findClassDeclarationsUnderClass(e,t,n){return n.flatMap(n=>this._findClassDeclarationsUnderNode(e,t,n.node))}_findClassDeclarationsUnderNode(e,t,n){const s=[];for(const e of this._lookUpSymbolDeclarations(n,t))4===e.type&&s.push(e);return s}_lookUpSymbolDeclarations(e,t){if(void 0===e)return[];const n=o.getScope(e),s=null==n?void 0:n.lookUpSymbol(t),i=null==s?void 0:s.getDeclarations();return null!=i?i:[]}_getFullClassName(e){const t=[];let n=e;for(;void 0!==n;)t.push(n.name.value),n=a.getEnclosingClass(n);return t.reverse().join(".")}_getBoundSourceFiles(e){return this._importResolver.getSourceFilesFromStub(e,this._execEnv,this._mapCompiled).map(t=>this._fileBinder(e,t)).filter(p)}},t.isStubFile=c},8235:(e,t)=>{"use strict";function n(e,t){if(56===e.nodeType){if(37===e.operator||36===e.operator){const n=s(e.expression,t);if(void 0!==n)return!n}}else if(7===e.nodeType){if(37===e.operator||36===e.operator){const s=n(e.leftExpression,t),i=n(e.rightExpression,t);if(void 0===s||void 0===i)return;return 37===e.operator?s||i:s&&i}if(o(e.leftExpression)&&53===e.rightExpression.nodeType){const n=function(e){let t;if(e.expressions.length>=2){if(41===e.expressions[0].nodeType&&!e.expressions[0].isImaginary&&41===e.expressions[1].nodeType&&!e.expressions[1].isImaginary){const n=e.expressions[0],s=e.expressions[1];t=256*n.value+s.value}}else 1===e.expressions.length&&(t=256*e.expressions[0].value);return t}(e.rightExpression);return i(e.operator,t.pythonVersion,n)}if(24===e.leftExpression.nodeType&&o(e.leftExpression.baseExpression)&&1===e.leftExpression.items.items.length&&41===e.leftExpression.items.items[0].nodeType&&!e.leftExpression.items.items[0].isImaginary&&0===e.leftExpression.items.items[0].value&&41===e.rightExpression.nodeType)return i(e.operator,Math.floor(t.pythonVersion/256),e.rightExpression.value);if(function(e){return 36===e.nodeType&&39===e.leftExpression.nodeType&&"sys"===e.leftExpression.value&&"platform"===e.memberName.value}(e.leftExpression)&&49===e.rightExpression.nodeType){const n=e.rightExpression.strings.map(e=>e.value).join(""),s=function(e){return"Darwin"===e.pythonPlatform?"darwin":"Windows"===e.pythonPlatform?"win32":"Linux"===e.pythonPlatform?"linux":void 0}(t);return r(e.operator,s||"",n)}if(function(e){return 36===e.nodeType&&39===e.leftExpression.nodeType&&"os"===e.leftExpression.value&&"name"===e.memberName.value}(e.leftExpression)&&49===e.rightExpression.nodeType){const n=e.rightExpression.strings.map(e=>e.value).join(""),s=function(e){return"Darwin"===e.pythonPlatform?"posix":"Windows"===e.pythonPlatform?"nt":"Linux"===e.pythonPlatform?"posix":void 0}(t);if(void 0!==s)return r(e.operator,s,n)}}else if(11===e.nodeType){if(31===e.constType)return!0;if(14===e.constType)return!1}else if(39===e.nodeType){if("TYPE_CHECKING"===e.value)return!0}else if(36===e.nodeType&&"TYPE_CHECKING"===e.memberName.value&&39===e.leftExpression.nodeType&&"typing"===e.leftExpression.value)return!0}function s(e,t){return(11!==e.nodeType||24!==e.constType)&&n(e,t)}function i(e,t,n){if(void 0!==t&&void 0!==n){if(20===e)return t<n;if(21===e)return t<=n;if(15===e)return t>n;if(16===e)return t>=n;if(12===e)return t===n;if(28===e)return t!==n}}function r(e,t,n){if(void 0!==t&&void 0!==n){if(12===e)return t===n;if(28===e)return t!==n}}function o(e){return 36===e.nodeType&&39===e.leftExpression.nodeType&&"sys"===e.leftExpression.value&&"version_info"===e.memberName.value}Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateStaticBoolLikeExpression=t.evaluateStaticBoolExpression=void 0,t.evaluateStaticBoolExpression=n,t.evaluateStaticBoolLikeExpression=s},817:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Symbol=t.indeterminateSymbolId=void 0;const s=n(5523);let i=1;t.indeterminateSymbolId=0;class r{constructor(e=4){this.id=i++,this._flags=e}static createWithType(e,t){const n=new r(e);return n._synthesizedType=t,n}isInitiallyUnbound(){return!!(1&this._flags)}setIsExternallyHidden(){this._flags|=2}isExternallyHidden(){return!!(2&this._flags)}setIsIgnoredForProtocolMatch(){this._flags|=64}isIgnoredForProtocolMatch(){return!!(64&this._flags)}setIsClassMember(){this._flags|=4}isClassMember(){return!!(4&this._flags)}setIsInstanceMember(){this._flags|=8}isInstanceMember(){return!!(8&this._flags)}setIsClassVar(){this._flags|=128}isClassVar(){return!!(128&this._flags)}setIsPrivateMember(){this._flags|=32}isPrivateMember(){return!!(32&this._flags)}addDeclaration(e){if(this._declarations){const t=this._declarations.findIndex(t=>s.areDeclarationsSame(t,e));if(t<0)this._declarations.push(e),this._declarations.forEach(e=>{1===e.type&&e.typeAliasName&&delete e.typeAliasName});else{const n=this._declarations[t];s.hasTypeForDeclaration(e)?(this._declarations[t]=e,1===n.type&&1===e.type&&!e.inferredTypeSource&&n.inferredTypeSource&&(e.inferredTypeSource=n.inferredTypeSource)):1===e.type&&1===n.type&&(e.isFinal&&(n.isFinal=!0),e.typeAliasAnnotation&&(n.typeAliasAnnotation=e.typeAliasAnnotation),!n.inferredTypeSource&&e.inferredTypeSource&&(n.inferredTypeSource=e.inferredTypeSource))}}else this._declarations=[e]}hasDeclarations(){return!!this._declarations&&this._declarations.length>0}getDeclarations(){return this._declarations?this._declarations:[]}hasTypedDeclarations(){return!!this._synthesizedType||this.getDeclarations().some(e=>s.hasTypeForDeclaration(e))}getTypedDeclarations(){return this.getDeclarations().filter(e=>s.hasTypeForDeclaration(e))}getSynthesizedType(){return this._synthesizedType}}t.Symbol=r},1766:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isConstantName=t.isDunderName=t.isPrivateOrProtectedName=t.isProtectedName=t.isPrivateName=void 0;const n=/^[A-Z0-9_]+$/,s=/^[_]+$/;function i(e){return e.length>2&&e.startsWith("__")&&!e.endsWith("__")}function r(e){return e.length>1&&e.startsWith("_")&&!e.startsWith("__")}t.isPrivateName=i,t.isProtectedName=r,t.isPrivateOrProtectedName=function(e){return i(e)||r(e)},t.isDunderName=function(e){return e.length>4&&e.startsWith("__")&&e.endsWith("__")},t.isConstantName=function(e){return!!e.match(n)&&!e.match(s)}},2917:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFinalVariable=t.isTypedDictMemberAccessedThroughIndex=t.getLastTypedDeclaredForSymbol=void 0;const s=n(5523);t.getLastTypedDeclaredForSymbol=function(e){const t=e.getTypedDeclarations();if(t.length>0)return t[t.length-1]},t.isTypedDictMemberAccessedThroughIndex=function(e){const t=e.getTypedDeclarations();return t.length>0&&1===t[t.length-1].type},t.isFinalVariable=function(e){return e.getDeclarations().some(e=>s.isFinalVariableDeclaration(e))}},2041:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestWalker=void 0;const s=n(427),i=n(5839),r=n(3550);class o extends s.ParseTreeWalker{constructor(){super()}visitNode(e){const t=super.visitNode(e);return this._verifyParentChildLinks(e,t),this._verifyChildRanges(e,t),t}_verifyParentChildLinks(e,t){t.forEach(t=>{t&&t.parent!==e&&i.fail(`Child node ${t.nodeType} does not contain a reference to its parent `+e.nodeType)})}_verifyChildRanges(e,t){let n;t.forEach(t=>{if(t){let s=!1;3===e.nodeType&&t===e.typeAnnotationComment&&(s=!0),49===e.nodeType&&t===e.typeAnnotation&&(s=!0),s||((t.start<e.start||r.TextRange.getEnd(t)>r.TextRange.getEnd(e))&&i.fail(`Child node ${t.nodeType} is not contained within its parent `+e.nodeType),n&&t.start<r.TextRange.getEnd(n)&&63!==n.nodeType&&i.fail("Child node is not after previous child node"),n=t)}})}}t.TestWalker=o},3090:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IncompleteTypeTracker=t.SpeculativeTypeTracker=t.isIncompleteType=void 0;const s=n(5839);t.isIncompleteType=function(e){return!!e.isIncompleteType},t.SpeculativeTypeTracker=class{constructor(){this._speculativeContextStack=[]}enterSpeculativeContext(e){this._speculativeContextStack.push({speculativeRootNode:e,entriesToUndo:[]})}leaveSpeculativeContext(){s.assert(this._speculativeContextStack.length>0),this._speculativeContextStack.pop().entriesToUndo.forEach(e=>{e.cache.delete(e.id)})}isSpeculative(){return this._speculativeContextStack.length>0}getSpeculativeRootNode(){const e=this._speculativeContextStack.length;if(e>0)return this._speculativeContextStack[e-1].speculativeRootNode}trackEntry(e,t){const n=this._speculativeContextStack.length;n>0&&this._speculativeContextStack[n-1].entriesToUndo.push({cache:e,id:t})}disableSpeculativeMode(){const e=this._speculativeContextStack;return this._speculativeContextStack=[],e}enableSpeculativeMode(e){s.assert(0===this._speculativeContextStack.length),this._speculativeContextStack=e}},t.IncompleteTypeTracker=class{constructor(){this._entriesToUndo=[],this._requiresUndo=!1}trackEntry(e,t){this._requiresUndo&&this._entriesToUndo.push({cache:e,id:t})}leaveIncompleteTypeMode(){this._entriesToUndo.forEach(e=>{e.cache.delete(e.id)}),this._requiresUndo=!1,this._entriesToUndo=[]}enterIncompleteTypeMode(){this._requiresUndo=!0}isIncompleteTypeMode(){return this._requiresUndo}}},3371:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getFunctionDocStringFromDeclaration=t.getFunctionDocStringFromType=t.getClassDocString=t.getModuleDocString=t.getOverloadedFunctionDocStrings=void 0;const o=r(n(8494)),a=n(8816);function l(e,t){let n=c([e]);return!n&&a.isStubFile(e.path)&&(n=c(t.findFunctionDeclarations(e))),n}function c(e){var t,n;for(const s of e){const e=o.getDocString(null===(n=null===(t=s.node)||void 0===t?void 0:t.suite)||void 0===n?void 0:n.statements);if(e)return e}}t.getOverloadedFunctionDocStrings=function(e,t,n){const s=[];if(e.overloads.some(e=>e.details.docString))e.overloads.forEach(e=>{e.details.docString&&s.push(e.details.docString)});else if(t&&a.isStubFile(t.path)&&3===t.type){const e=c(n.findFunctionDeclarations(t));e&&s.push(e)}return s},t.getModuleDocString=function(e,t,n){let s=e.docString;return!s&&t&&a.isStubFile(t.path)&&(s=function(e){for(const t of e)if(t.statements){const e=o.getDocString(t.statements);if(e)return e}}(n.findModules(t.path))),s},t.getClassDocString=function(e,t,n){let s=e.details.docString;return!s&&t&&a.isStubFile(t.path)&&4===t.type&&(s=c(n.findClassDeclarations(t))),s},t.getFunctionDocStringFromType=function(e,t){let n=e.details.docString;return!n&&e.details.declaration&&(n=l(e.details.declaration,t)),n},t.getFunctionDocStringFromDeclaration=l},7887:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createTypeEvaluator=void 0;const o=n(3213),a=n(5839),l=n(1290),c=n(9744),p=n(1464),u=n(6886),d=n(3550),h=n(2122),m=n(5275),y=n(5303),g=r(n(6673)),f=r(n(563)),_=n(6610),T=n(5523),v=r(n(8494)),b=r(n(5083)),C=n(8235),S=n(817),I=n(1766),D=n(2917),k=n(3090),x=n(1133),F=n(5168),P=n(1659),A={0:["__add__","__radd__"],33:["__sub__","__rsub__"],26:["__mul__","__rmul__"],13:["__floordiv__","__rfloordiv__"],10:["__truediv__","__rtruediv__"],24:["__mod__","__rmod__"],29:["__pow__","__rpow__"],22:["__matmul__","__rmatmul__"]},w={3:["__and__","__rand__"],6:["__or__","__ror__"],8:["__xor__","__rxor__"],17:["__lshift__","__rlshift__"],31:["__rshift__","__rrshift__"]},E={12:["__eq__","__ne__"],28:["__ne__","__eq__"],20:["__lt__","__gt__"],21:["__le__","__ge__"],15:["__gt__","__lt__"],16:["__ge__","__le__"]},N={36:!0,37:!0,39:!0,40:!0,41:!0,42:!0},O={"asyncio.futures.Future":u.PythonVersion.V3_9,"builtins.dict":u.PythonVersion.V3_9,"builtins.frozenset":u.PythonVersion.V3_9,"builtins.list":u.PythonVersion.V3_9,"builtins._PathLike":u.PythonVersion.V3_9,"builtins.set":u.PythonVersion.V3_9,"builtins.tuple":u.PythonVersion.V3_9,"collections.ChainMap":u.PythonVersion.V3_9,"collections.Counter":u.PythonVersion.V3_9,"collections.DefaultDict":u.PythonVersion.V3_9,"collections.deque":u.PythonVersion.V3_9,"collections.OrderedDict":u.PythonVersion.V3_9,"queue.Queue":u.PythonVersion.V3_9};t.createTypeEvaluator=function(e,t){const n=[],s=new Map,i=new Map,r=new Map,R=new Map,L=new Map,M=new k.SpeculativeTypeTracker,U=new k.IncompleteTypeTracker;let z,V,j=!1,B=1;const W=[];let q;function G(){z&&o.throwIfCancellationRequested(z)}function $(e){let t;if(t=q&&Y(e)?q.get(e.id):L.get(e.id),void 0!==t)return a.assert(!k.isIncompleteType(t)),t}function K(e,t){const n=q&&Y(e)?q:L;n.set(e.id,t);const s=M.getSpeculativeRootNode();s&&v.isNodeContainedWithin(e,s)&&M.trackEntry(n,e.id),U.trackEntry(n,e.id)}function H(e){(q&&Y(e)?q:L).delete(e.id)}function Y(e){const t=W.length;if(0===t)return!1;const n=W[t-1];let s=e;for(;s;){if(s===n.functionNode)return!0;s=s.parent}return!1}function Q(e,t){return n.findIndex(n=>n.symbolId===e.id&&n.declaration===t)}function J(e,t){const s=Q(e,t);if(s>=0){for(let e=s+1;e<n.length;e++)n[e].isResultValid=!1;return!1}return n.push({symbolId:e.id,declaration:t,isResultValid:!0}),!0}function X(e){const t=n.pop();return a.assert(t.symbolId===e.id),t.isResultValid}function Z(e,t,s){const i=Q(e,t);i>=0&&(n[i].partialType=s)}function ee(e,t){const s=Q(e,t);if(s>=0)return n[s].partialType}function te(e){return Et(e),$(e)}function ne(e,t,n=0){var s;const i=$(e);if(i)return{type:i,node:e};let r;G(),t=F.transformPossibleRecursiveTypeAlias(t),V||(V=function(e,t){return ge("NoneType",Jt(e).typeshedModulePath)}(e)||x.AnyType.create());let o=0!=(256&n);switch(e.nodeType){case 39:r=function(e,t){const n=Jt(e),s=e.value;let i,r=!1;const o=0!=(4&t),l=Kt(e,s,!o);if(l){let a=!o;if(4===l.scope.type&&(a=!1),n.isStubFile){const e=D.getLastTypedDeclaredForSymbol(l.symbol);e&&4===e.type&&(a=!1)}const p=l.symbol,u=sn(p,a?e:void 0),d=u.type;u.isResolutionCyclical&&(r=!0);const m=!!d&&x.isClass(d)&&x.ClassType.isSpecialBuiltIn(d);if(i=d,a&&!m){const t=l.isBeyondExecutionScope||!p.isInitiallyUnbound()?d:x.UnboundType.create(),n=Mt(e,p.id,t);n&&(i=n)}2&t||(x.isClass(i)?(0!=(256&t)&&0==(4096&t)&&F.requiresTypeArguments(i)&&!i.typeArguments&&Ie(n.diagnosticRuleSet.reportMissingTypeArgument,c.DiagnosticRule.reportMissingTypeArgument,h.Localizer.Diagnostic.typeArgsMissingForClass().format({name:i.details.name}),e),i.typeArguments||(i=Bt(i,void 0,t,e))):x.isObject(i)?i=Ne(i):0!=(256&t)&&i.typeAliasInfo&&i.typeAliasInfo.typeParameters&&i.typeAliasInfo.typeParameters.length>0&&!i.typeAliasInfo.typeArguments&&Ie(n.diagnosticRuleSet.reportMissingTypeArgument,c.DiagnosticRule.reportMissingTypeArgument,h.Localizer.Diagnostic.typeArgsMissingForAlias().format({name:i.typeAliasInfo.aliasName}),e)),r||f.isCodeUnreachable(e)||(x.isUnbound(i)?Ie(n.diagnosticRuleSet.reportUnboundVariable,c.DiagnosticRule.reportUnboundVariable,h.Localizer.Diagnostic.symbolIsUnbound().format({name:s}),e):x.isPossiblyUnbound(i)&&Ie(n.diagnosticRuleSet.reportUnboundVariable,c.DiagnosticRule.reportUnboundVariable,h.Localizer.Diagnostic.symbolIsPossiblyUnbound().format({name:s}),e)),Pe(n,p,e)}else"reveal_type"!==s&&Ie(n.diagnosticRuleSet.reportUndefinedVariable,c.DiagnosticRule.reportUndefinedVariable,h.Localizer.Diagnostic.symbolIsUndefined().format({name:s}),e),i=x.UnknownType.create();if(x.isTypeVar(i)&&i.details.isParamSpec&&128&t&&be(h.Localizer.Diagnostic.paramSpecContext(),e),0!=(256&t)&&0==(2048&t)&&x.isClass(i)&&x.ClassType.isBuiltIn(i,"Generic")&&Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.genericNotAllowed(),e),x.isTypeVar(i)&&x.TypeBase.isInstantiable(i))if(i=function(e,t){let n=e;for(a.assert(x.TypeBase.isInstantiable(t));n&&(n=v.getTypeVarScopeNode(n),n);){let e;if(10===n.nodeType){const t=yt(n);t&&(e=t.classType.details.typeParameters)}else if(29===n.nodeType){const t=ft(n);t&&(e=[],t.functionType.details.parameters.forEach(t=>{t.hasDeclaredType&&F.addTypeVarsToListIfUnique(e,F.getTypeVarArgumentsRecursive(t.type))}))}else if(37===n.nodeType)break;if(e){const n=e.find(e=>e.details.name===t.details.name);if(n)return F.convertToInstantiable(n)}n=n.parent}return t}(e,i),0!=(8192&t)&&i.scopeId)i.details.isSynthesized||i.details.isParamSpec||Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeVarUsedByOuterScope().format({name:i.details.name}),e);else if(0!=(32768&t)){if(!i.scopeId){const t=v.getEnclosingClassOrFunction(e);t?i=x.TypeVarType.cloneForScopeId(i,t.id):a.fail("AssociateTypeVarsWithCurrentScope flag was set but enclosing scope not found")}}else 0!=(16384&t)&&(i.scopeId||i.details.isSynthesized||i.details.isParamSpec||Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeVarNotUsedByOuterScope().format({name:i.details.name}),e));return{type:i,node:e,isResolutionCyclical:r}}(e,n);break;case 36:r=function(e,t){const n=2|260&t,s=ne(e.leftExpression,void 0,n);if(s.isResolutionCyclical||F.isTypeAliasPlaceholder(s.type))return{node:e,type:x.UnknownType.create(),isResolutionCyclical:!0};const i=Ee(e,s,{method:"get"},t);if(_.isCodeFlowSupportedForReference(e)){K(e,i.type),K(e.memberName,i.type);let t=i.type;if(x.isUnbound(t)){const n=F.makeTypeVarsConcrete(s.type);let i;x.isClass(n)?i=F.lookUpClassMember(n,e.memberName.value,1):x.isObject(n)&&(i=F.lookUpObjectMember(n,e.memberName.value,1)),i&&(t=cn(i))}const n=Mt(e,S.indeterminateSymbolId,t);n&&(i.type=n)}return K(e.memberName,i.type),i}(e,n);break;case 24:r=function(e,t=0){const n=ne(e.baseExpression,void 0,2|t);if(n.isResolutionCyclical)return{node:e,type:x.UnknownType.create(),isResolutionCyclical:!0};if(0==(4&t)){const t=Jt(e);if(x.isClass(n.type)&&x.ClassType.isBuiltIn(n.type)){const s=O[n.type.details.fullName];void 0!==s&&t.executionEnvironment.pythonVersion<s&&Ie(t.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.classNotRuntimeSubscriptable().format({name:n.type.details.name}),e.baseExpression)}}return Re(e,n.type,{method:"get"},t)}(e,n);break;case 9:r=function(e,t,n){const s=ne(e.leftExpression,void 0,2);if(s.isResolutionCyclical||F.isTypeAliasPlaceholder(s.type))return{node:e,type:x.UnknownType.create(),isResolutionCyclical:!0};if(39===e.leftExpression.nodeType&&"super"===e.leftExpression.value)return function(e){let t,n;if(e.arguments.length>2&&be(h.Localizer.Diagnostic.superCallArgCount(),e.arguments[2]),e.arguments.length>0)t=ne(e.arguments[0].valueExpression).type,x.isAnyOrUnknown(t)||x.isClass(t)||be(h.Localizer.Diagnostic.superCallFirstArg().format({type:Fn(t)}),e.arguments[0].valueExpression);else{const n=v.getEnclosingClass(e);if(n){const e=yt(n);t=e?e.classType:x.UnknownType.create()}else be(h.Localizer.Diagnostic.superCallZeroArgForm(),e.leftExpression),t=x.UnknownType.create()}if(e.arguments.length>1){const s=F.specializeType(ne(e.arguments[1].valueExpression).type,void 0);let i=!1;x.isAnyOrUnknown(s)||(x.isObject(s)?(x.isClass(t)&&(F.derivesFromClassRecursive(s.classType,t,!0)||(i=!0)),n=s):x.isClass(s)?(x.isClass(t)&&(F.derivesFromClassRecursive(s,t,!0)||(i=!0)),n=s):i=!0),i&&Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.superCallSecondArg().format({type:Fn(t)}),e.arguments[1].valueExpression)}const s=e.parent;if(36===s.nodeType){const i=s.memberName.value,r=F.lookUpClassMember(t,i,1);if(r&&x.isClass(r.classType))return{type:x.ObjectType.create(r.classType),node:e,bindToType:n}}if(x.isClass(t)){if(t.details.mro.some(e=>x.isAnyOrUnknown(e)))return{type:x.UnknownType.create(),node:e};const n=t.details.baseClasses;if(n.length>0){const t=n[0];if(x.isClass(t))return{type:x.ObjectType.create(t),node:e}}}return{type:x.UnknownType.create(),node:e}}(e);if(x.isAnyOrUnknown(s.type)&&39===e.leftExpression.nodeType&&"reveal_type"===e.leftExpression.value&&1===e.arguments.length&&0===e.arguments[0].argumentCategory&&void 0===e.arguments[0].name){const t=ne(e.arguments[0].valueExpression).type,n=v.printExpression(e.arguments[0].valueExpression),s=Fn(t);ve(`Type of "${n}" is "${s}"`,e.arguments[0]);const i=Gt(e,"str");return x.isClass(i)?{type:x.ObjectType.create(x.ClassType.cloneWithLiteral(i,s)),node:e}:{type:x.AnyType.create(),node:e}}const i=e.arguments.map(e=>({valueExpression:e.valueExpression,argumentCategory:e.argumentCategory,name:e.name}));return ze(e,i,s,t,-3&n)}(e,t,n);break;case 53:r=function(e,t){const n=[];if(t&&x.isObject(t)){const s=t.classType;if(F.isTupleClass(s)&&s.typeArguments)if(2===s.typeArguments.length&&F.isEllipsisType(s.typeArguments[1]))for(let t=0;t<e.expressions.length;t++)n.push(F.transformPossibleRecursiveTypeAlias(s.typeArguments[0]));else s.typeArguments.forEach(e=>{n.push(F.transformPossibleRecursiveTypeAlias(e))})}const s=e.expressions.map((e,t)=>ne(e,t<n.length?n[t]:void 0));let i=x.UnknownType.create();const r=Gt(e,"Tuple");if(x.isClass(r)){let e=[];for(const t of s)if(t.unpackedType){if(!x.isObject(t.unpackedType)||!F.isTupleClass(t.unpackedType.classType)){e=[x.AnyType.create(!1),x.AnyType.create(!0)];break}{const n=t.unpackedType.classType.typeArguments;if(!n||n.some(e=>F.isEllipsisType(e))){e=[x.AnyType.create(!1),x.AnyType.create(!0)];break}for(const t of n)e.push(t)}}else e.push(t.type);i=F.convertToInstance(Me(r,e,!0))}return{type:i,node:e}}(e,t);break;case 11:r=function(e,t){let n;if(24===e.constType?n=0!=(256&t)?x.NoneType.createType():x.NoneType.createInstance():31!==e.constType&&14!==e.constType&&8!==e.constType||(n=$t(e,"bool"),n&&x.isObject(n)&&(31===e.constType?n=x.ObjectType.create(x.ClassType.cloneWithLiteral(n.classType,!0)):14===e.constType&&(n=x.ObjectType.create(x.ClassType.cloneWithLiteral(n.classType,!1))))),n)return{type:n,node:e}}(e,n);break;case 49:if(0==(32&n)||function(e){if(e.parent&&25===e.parent.nodeType){const t=e.parent;if(t.parent&&24===t.parent.nodeType){const e=ne(t.parent.baseExpression).type;if(e&&x.isClass(e)&&x.ClassType.isSpecialBuiltIn(e,"Literal"))return!0}}return!1}(e)){e.strings.forEach(e=>{28===e.nodeType&&e.expressions.forEach(e=>{ne(e)})});const t=0!=(32&e.strings[0].token.flags);r=e.strings.some(e=>28===e.nodeType)?{node:e,type:$t(e,t?"bytes":"str")}:{node:e,type:at(e,t?"bytes":"str",e.strings.map(e=>e.value).join(""))}}else{if(e.typeAnnotation)r=ne(e.typeAnnotation,void 0,260|n);else if(!e.typeAnnotation&&1===e.strings.length){const t=function(e){const t=Jt(e),n=new y.Parser,s=e.strings[0].value,i=e.strings[0].start+e.strings[0].token.prefixLength+e.strings[0].token.quoteMarkLength,r=new y.ParseOptions;r.isStubFile=t.isStubFile,r.pythonVersion=t.executionEnvironment.pythonVersion;const o=n.parseTextExpression(t.fileContents,i,s.length,r);if(o.parseTree)return o.diagnostics.forEach(t=>{be(t.message,e)}),o.parseTree.parent=e,o.parseTree}(e);t&&(r=ne(t,void 0,260|n))}r||(Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.expectedTypeNotString(),e),r={node:e,type:x.UnknownType.create()}),o=!1}break;case 41:r=e.isImaginary?{node:e,type:$t(e,"complex")}:e.isInteger?{node:e,type:at(e,"int",e.value)}:{node:e,type:$t(e,"float")};break;case 18:r=0!=(1&n)?{type:x.AnyType.create(!0),node:e}:0!=(1024&n)?{type:x.UnknownType.create(),node:e}:{type:$t(e,"ellipsis")||x.AnyType.create(),node:e};break;case 56:r=function(e,t){let n=F.makeTypeVarsConcrete(ne(e.expression).type);const s={0:"__pos__",33:"__neg__",5:"__invert__"};let i;if(38!==e.operator&&F.isOptionalType(n)&&(Ie(Jt(e).diagnosticRuleSet.reportOptionalOperand,c.DiagnosticRule.reportOptionalOperand,h.Localizer.Diagnostic.noneOperator().format({operator:v.printOperator(e.operator)}),e.expression),n=x.removeNoneFromUnion(n)),38===e.operator?(i=$t(e,"bool"),i||(i=x.UnknownType.create())):(i=x.isAnyOrUnknown(n)?n:et(n,[],s[e.operator],e,t),i||(Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotSupportUnaryOperator().format({operator:v.printOperator(e.operator),type:Fn(n)}),e),i=x.UnknownType.create())),(0===e.operator||33===e.operator)&&x.isObject(i)&&x.ClassType.isBuiltIn(i.classType,"int")&&x.isObject(n)&&x.ClassType.isBuiltIn(n.classType,"int")&&"number"==typeof n.classType.literalValue){const t=0===e.operator?n.classType.literalValue:-n.classType.literalValue;i=x.ObjectType.create(x.ClassType.cloneWithLiteral(i.classType,t))}return{type:i,node:e}}(e,t);break;case 7:r=function e(t,n,s){let i=t.leftExpression;E[t.operator]&&7===t.leftExpression.nodeType&&!t.leftExpression.parenthesized&&E[t.leftExpression.operator]&&(e(t.leftExpression,n,s),i=t.leftExpression.rightExpression);const r=37===t.operator||36===t.operator?n:void 0;let o=F.makeTypeVarsConcrete(ne(i,r).type),a=F.makeTypeVarsConcrete(ne(t.rightExpression,r).type);if(6===t.operator){let e=a;if(!x.isNone(o)&&x.isNone(a)&&x.TypeBase.isInstance(a)&&(e=x.NoneType.createType()),x.isUnionableType([o,e])){const n=Jt(t);return n.isStubFile||n.executionEnvironment.pythonVersion>=u.PythonVersion.V3_10||be(h.Localizer.Diagnostic.unionSyntaxIllegal(),t,t.operatorToken),{type:x.combineTypes([o,e]),node:t}}}return void 0===N[t.operator]&&(F.isOptionalType(o)&&(12!==t.operator&&28!==t.operator&&Ie(Jt(t).diagnosticRuleSet.reportOptionalOperand,c.DiagnosticRule.reportOptionalOperand,h.Localizer.Diagnostic.noneOperator().format({operator:v.printOperator(t.operator)}),t.leftExpression),o=x.removeNoneFromUnion(o)),12!==t.operator&&28!==t.operator||(a=x.removeNoneFromUnion(a))),{type:Ze(t.operator,o,a,t,n),node:t}}(e,t,n);break;case 5:{const n=Xe(e,t);Fe(e.destExpression,n,e.rightExpression),r={type:n,node:e};break}case 32:r=function(e,t){let n=t;if(t&&10===t.category){let s;for(const n of t.subtypes)if(Yt(e,()=>st(e,n))){s=n;break}n=s}if(n){const t=st(e,n);if(t)return t}return function(e,t){let n=[];e.entries.forEach((e,t)=>{t<64&&(33===e.nodeType?n.push(ot(e)):n.push(ne(e).type))}),n=n.map(e=>F.stripLiteralValue(e));let s=x.AnyType.create();return n.length>0&&(s=Jt(e).diagnosticRuleSet.strictListInference||t?x.combineTypes(n,64):F.areTypesSame(n)?n[0]:x.UnknownType.create()),{type:$t(e,"List",[s]),node:e}}(e,!!t)}(e,t);break;case 47:r=function(e){return e.startValue&&ne(e.startValue),e.endValue&&ne(e.endValue),e.stepValue&&ne(e.stepValue),{type:$t(e,"slice"),node:e}}(e);break;case 6:r=ne(e.expression,void 0,n),r={type:de(r.type,e.expression),node:e};break;case 52:r=function(e,t,n){ne(e.testExpression);const s=ne(e.ifExpression,n,t),i=ne(e.elseExpression,n,t);return{type:x.combineTypes([s.type,i.type]),node:e}}(e,n,t);break;case 33:r=function(e){const t=ot(e),n=e.comprehensions.some(e=>34===e.nodeType&&e.isAsync);let s=x.UnknownType.create();const i=ye(e,n?"AsyncGenerator":"Generator");return i&&x.isClass(i)&&(s=x.ObjectType.create(x.ClassType.cloneForSpecialization(i,n?[t,x.NoneType.createInstance()]:[t,x.NoneType.createInstance(),x.NoneType.createInstance()],!1))),{type:s,node:e}}(e);break;case 15:r=function(e,t){if(t&&10===t.category){let n;for(const s of t.subtypes)if(Yt(e,()=>tt(e,s,new l.DiagnosticAddendum))){n=s;break}t=n}const n=new l.DiagnosticAddendum;if(t){const s=tt(e,t,n);if(s)return s}return function(e,t){let n=x.AnyType.create(),s=x.AnyType.create(),i=[],r=[];return nt(e,i,r,!t),i=i.map(e=>F.stripLiteralValue(e)),r=r.map(e=>F.stripLiteralValue(e)),n=i.length>0?x.combineTypes(i):x.AnyType.create(),s=r.length>0?Jt(e).diagnosticRuleSet.strictDictionaryInference||t?x.combineTypes(r):F.areTypesSame(r)?r[0]:x.UnknownType.create():x.AnyType.create(),{type:$t(e,"Dict",[n,s]),node:e}}(e,!!t)}(e,t);break;case 31:r=function(e,t){const n=x.FunctionType.createInstance("","",0);let s;K(e,n),t&&(5===t.category?s=t:10===t.category&&(s=t.subtypes.find(e=>5===e.category))),e.parameters.forEach((e,t)=>{let i=x.UnknownType.create();s&&t<s.details.parameters.length&&(i=x.FunctionType.getEffectiveParameterType(s,t),i=F.specializeType(i,void 0,!0)),e.name&&K(e.name,i),e.defaultValue&&ne(e.defaultValue,void 0,1);const r={category:e.category,name:e.name?e.name.value:void 0,hasDefault:!!e.defaultValue,type:i};x.FunctionType.addParameter(n,r)});const i=s?on(s):void 0;return n.inferredReturnType=ne(e.expression,i).type,{type:n,node:e}}(e,t);break;case 46:r=function(e,t){const n=[];if(e.entries.forEach((e,s)=>{(s<64||void 0!==t)&&(33===e.nodeType?n.push(ot(e)):n.push(ne(e).type))}),t&&n.length>0){const s=F.doForSubtypes(t,e=>{if(x.isObject(e)){const t=x.ClassType.getAliasClass(e.classType);if(x.ClassType.isBuiltIn(t,"set")&&e.classType.typeArguments){const t=e.classType.typeArguments[0],s=new P.TypeVarMap;for(const e of n)if(!gn(t,e,new l.DiagnosticAddendum,s))return;return F.specializeType(e,s)}}});if(!x.isNever(s))return{type:s,node:e}}let s=n.length>0?x.combineTypes(n.map(e=>F.stripLiteralValue(e))):x.AnyType.create();return t||(s=F.stripLiteralValue(s)),{type:$t(e,"Set",[s]),node:e}}(e,t);break;case 3:r=ne(e.rightExpression),Fe(e.leftExpression,r.type,e.rightExpression);break;case 4:r=ne(e.rightExpression),Fe(e.name,r.type,e.rightExpression);break;case 61:r=function(e){let t;const n=v.getEnclosingFunction(e);if(n){const e=ft(n);e&&(t=F.getDeclaredGeneratorSendType(e.functionType))}return t||(t=x.UnknownType.create()),e.expression&&ne(e.expression,t),{type:t,node:e}}(e);break;case 62:r=function(e){let t;const n=v.getEnclosingFunction(e);if(n){const e=ft(n);e&&(t=F.getDeclaredGeneratorSendType(e.functionType))}return t||(t=x.UnknownType.create()),e.expression&&ne(e.expression,t),{type:t,node:e}}(e);break;case 57:{const n=ne(e.expression,t).type;r={type:he(n,!1,e,!1),unpackedType:n,node:e};break}case 55:r=ne(e.typeAnnotation,void 0,416);break;case 0:Ht(()=>{e.child&&ne(e.child)}),r={type:x.UnknownType.create(),node:e}}if(r||a.fail(`Unhandled expression type '${v.printExpression(e)}'`),o){const t=F.transformTypeObjectToClass(r.type);if(!x.TypeBase.isInstantiable(t)){const i=x.isObject(t)&&F.isTupleClass(t.classType)&&0===(null===(s=t.classType.typeArguments)||void 0===s?void 0:s.length);0!=(512&n)&&i||De(r.type,e)}}return r.isResolutionCyclical||F.isTypeAliasPlaceholder(r.type)||K(e,r.type),r}function se(e){return void 0!==e.futureImports.get("annotations")||e.isStubFile}function ie(e,t=!1,n=!1){var s,i,r;const o=Jt(e);if(o.isTypingStubFile||o.isTypingExtensionsStubFile){const t=function(e){if(!e.parent||55!==e.parent.nodeType)return;if(39!==e.parent.valueExpression.nodeType)return;const t=e.parent.valueExpression.value,n={Tuple:{alias:"tuple",module:"builtins"},Generic:{alias:"",module:"builtins"},Protocol:{alias:"",module:"builtins"},Callable:{alias:"",module:"builtins"},Type:{alias:"type",module:"builtins"},ClassVar:{alias:"",module:"builtins"},Final:{alias:"",module:"builtins"},Literal:{alias:"",module:"builtins"},TypedDict:{alias:"_TypedDict",module:"self"},Union:{alias:"",module:"builtins"},Optional:{alias:"",module:"builtins"},Annotated:{alias:"",module:"builtins"},TypeAlias:{alias:"",module:"builtins"},Concatenate:{alias:"",module:"builtins"},TypeGuard:{alias:"bool",module:"builtins"}}[t];return n?dt(e,t,n):void 0}(e);if(t)return K(e,t),t}let a=417;se(o)&&(a|=4),a|=n?32768:16384,3===(null===(s=null==e?void 0:e.parent)||void 0===s?void 0:s.nodeType)&&e.parent.typeAnnotationComment===e?a|=4:63===(null===(i=null==e?void 0:e.parent)||void 0===i?void 0:i.nodeType)?(e.parent.returnTypeAnnotation===e||e.parent.paramTypeAnnotations.some(t=>t===e))&&(a|=4):42===(null===(r=null==e?void 0:e.parent)||void 0===r?void 0:r.nodeType)&&e.parent.typeAnnotationComment===e&&(a|=4),t||(a|=64);const l=ne(e,void 0,a).type;return F.convertToInstance(l)}function re(e,t){return ze(e,[{argumentCategory:0,type:t}],ne(e.expression),void 0,18).type}function oe(e,t,n,s,i,r=0,o){const a=Oe(e,t.classType,n,s,i,16|r);let l=a?a.type:void 0;return l&&(5!==l.category&&6!==l.category||a.isClassMember&&(l=In(o||t,l,0!=(32&r),e))),l}function ae(e,t,n,s,i,r=0){let o=Oe(e,t,n,s,i,9|r),a=!1;if(!o){const i=t.details.effectiveMetaclass;i&&x.isClass(i)&&(o=Oe(e,i,n,s,new l.DiagnosticAddendum,r),a=!0)}let c=o?o.type:void 0;return c&&(5!==c.category&&6!==c.category||o.isClassMember&&(c=In(t,c,a,e))),c}function le(e,t,n){e=x.ClassType.getAliasClass(e);const s=F.lookUpClassMember(e,t,12);if(s){const t=cn(s);if(5===t.category||6===t.category){const s=In(x.ObjectType.create(e),t,n);if(s&&(5===s.category||6===s.category))return s}}}function ce(e,t){if(t>=e.parameters.length)return;const n=e.parameters[t];if(n.typeAnnotation)return n.typeAnnotation;if(n.typeAnnotationComment)return n.typeAnnotationComment;if(!e.functionAnnotationComment||e.functionAnnotationComment.isParamListEllipsis)return;const s=v.getEnclosingClass(e,!0),i=vt(e,!!s);let r=0;s&&0==(4&i)&&(r=1);const o=e.functionAnnotationComment.paramTypeAnnotations,a=t-r;return a<0||a>=o.length?void 0:o[a]}function pe(e){if(55===e.nodeType&&39===e.valueExpression.nodeType){const t=Kt(e,e.valueExpression.value,!1);if(t)return void 0!==t.symbol.getDeclarations().find(e=>T.isExplicitTypeAliasDeclaration(e))}return!1}function ue(e){let t,n,s;switch(e.nodeType){case 39:{const n=Kt(e,e.value,!0);n&&(t=n.symbol);break}case 55:return ue(e.valueExpression);case 36:{const i=F.makeTypeVarsConcrete(ne(e.leftExpression).type);let r;x.isObject(i)?(r=F.lookUpObjectMember(i,e.memberName.value,16),n=i,s=null==r?void 0:r.classType):x.isClass(i)&&(r=F.lookUpClassMember(i,e.memberName.value,24),n=i,s=null==r?void 0:r.classType),r&&(t=r.symbol);break}case 24:{const t=ue(e.baseExpression);if(t&&x.isObject(t)){const n=F.lookUpClassMember(t.classType,"__setitem__");if(n){const s=cn(n);if(5===s.category){const n=In(t,s,!1,e);if(n&&5===n.category&&2===n.details.parameters.length){const e=x.FunctionType.getEffectiveParameterType(n,1);if(!x.isAnyOrUnknown(e))return e}}}}break}}if(t){let i=rn(t);if(i){if(F.isProperty(i)){const e=F.lookUpClassMember(i.classType,"fset"),t=e?cn(e):void 0;if(!t||5!==t.category||t.details.parameters.length<2)return;i=t.details.parameters[1].type}return n&&(s&&x.isClass(s)&&(i=F.partiallySpecializeType(i,s)),i=In(n,i,!1,e)),i}}}function de(e,t){return F.doForSubtypes(e,e=>{if(x.isAnyOrUnknown(e))return e;const n=Ae(e);if(n)return n;if(x.isObject(e)){const n=we(e,"__await__",t);if(n){if(x.isAnyOrUnknown(n))return n;if(x.isObject(n)&&we(n,"__iter__",t)){const e=Ae(n);if(e)return e}}}return t&&Ie(Jt(t).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotAwaitable().format({type:Fn(e)}),t),x.UnknownType.create()})}function he(e,t,n,s){const i=t?"__aiter__":"__iter__",r=t?"__anext__":"__next__",o=s?"__getitem__":"";10===(e=F.makeTypeVarsConcrete(e)).category&&e.subtypes.some(e=>x.isNone(e))&&(n&&Ie(Jt(n).diagnosticRuleSet.reportOptionalIterable,c.DiagnosticRule.reportOptionalIterable,h.Localizer.Diagnostic.noneNotIterable(),n),e=x.removeNoneFromUnion(e));const a=(e,s,a)=>{const l=s?function(e,t,n,s){const i=F.lookUpObjectMember(x.ObjectType.create(e),n,8);if(!i)return;const r=cn(i);if(x.isAnyOrUnknown(r))return r;if(5===r.category){const e=In(t,r,!0,s);if(e)return on(e)}}(s,e.classType,i,n):we(e,i,n);if(l){if(x.isAnyOrUnknown(l))return l;if(x.isObject(l)){const e=we(l,r,n);if(e)return t?de(e,n):e;a.addMessage(h.Localizer.Diagnostic.methodNotDefinedOnType().format({name:r,type:Fn(l)}))}else a.addMessage(h.Localizer.Diagnostic.methodReturnsNonObject().format({name:i}))}else{if(o){const t=we(e,o,n);if(t)return t}a.addMessage(h.Localizer.Diagnostic.methodNotDefined().format({name:i}))}};return F.doForSubtypes(e,e=>{if(x.isAnyOrUnknown(e))return e;e=Ne(e);const t=new l.DiagnosticAddendum;if(x.isAnyOrUnknown(e))return e;if(x.isObject(e)){const n=a(e,void 0,t);if(n)return n}else if(x.isClass(e)){const n=e.details.effectiveMetaclass;if(n&&x.isClass(n)){const s=a(x.ObjectType.create(e),n,t);if(s)return s}}return n&&Ie(Jt(n).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotIterable().format({type:Fn(e)})+t.getString(),n),x.UnknownType.create()})}function me(e,t){a.assert(x.ClassType.isTypedDictClass(t));const n=x.FunctionType.createInstance("__new__","",65);x.FunctionType.addParameter(n,{category:0,name:"cls",type:t,hasDeclaredType:!0}),x.FunctionType.addDefaultParameters(n),n.details.declaredReturnType=x.ObjectType.create(t);const s=x.FunctionType.createInstance("__init__","",64);x.FunctionType.addParameter(s,{category:0,name:"self",type:x.ObjectType.create(t),hasDeclaredType:!0}),s.details.declaredReturnType=x.NoneType.createInstance(),x.FunctionType.addParameter(s,{category:1,type:x.AnyType.create(),hasDeclaredType:!0});const i=Sn(t);i.forEach((e,t)=>{x.FunctionType.addParameter(s,{category:0,name:t,hasDefault:!e.isRequired,type:e.valueType,hasDeclaredType:!0})});const r=t.details.fields;r.set("__init__",S.Symbol.createWithType(4,s)),r.set("__new__",S.Symbol.createWithType(4,n));const o=Gt(e,"str");if(x.isClass(o)){const e={category:0,name:"self",type:x.ObjectType.create(t),hasDeclaredType:!0},n=x.TypeVarType.createInstance(`__${t.details.name}_default`,!1),s=(t,n)=>{const s=x.FunctionType.createInstance("get","",320);return x.FunctionType.addParameter(s,e),x.FunctionType.addParameter(s,{category:0,name:"k",type:t,hasDeclaredType:!0}),x.FunctionType.addParameter(s,{category:0,name:"default",type:n,hasDeclaredType:!0,hasDefault:!0}),s.details.declaredReturnType=n,s},a=(t,s)=>{const i={category:0,name:"k",type:t,hasDeclaredType:!0},r=x.FunctionType.createInstance("pop","",320);x.FunctionType.addParameter(r,e),x.FunctionType.addParameter(r,i),r.details.declaredReturnType=s;const o=x.FunctionType.createInstance("pop","",320);return x.FunctionType.addParameter(o,e),x.FunctionType.addParameter(o,i),x.FunctionType.addParameter(o,{category:0,name:"default",hasDeclaredType:!0,type:n,hasDefault:!0}),o.details.declaredReturnType=x.combineTypes([s,n]),[r,o]},l=(t,s)=>{const i=x.FunctionType.createInstance("setdefault","",320);return x.FunctionType.addParameter(i,e),x.FunctionType.addParameter(i,{category:0,name:"k",hasDeclaredType:!0,type:t}),x.FunctionType.addParameter(i,{category:0,name:"default",hasDeclaredType:!0,type:n,hasDefault:!0}),i.details.declaredReturnType=x.combineTypes([s,n]),i},c=t=>{const n=x.FunctionType.createInstance("delitem","",320);return x.FunctionType.addParameter(n,e),x.FunctionType.addParameter(n,{category:0,name:"k",hasDeclaredType:!0,type:t}),n.details.declaredReturnType=x.NoneType.createInstance(),n},p=[],u=[],d=[];i.forEach((e,t)=>{const n=x.ObjectType.create(x.ClassType.cloneWithLiteral(o,t));p.push(s(n,e.valueType)),u.push(...a(n,e.valueType)),d.push(l(n,e.valueType))});const h=x.ObjectType.create(o);p.push(s(h,x.AnyType.create())),u.push(...a(h,x.AnyType.create())),d.push(l(h,x.AnyType.create())),r.set("get",S.Symbol.createWithType(4,x.OverloadedFunctionType.create(p))),r.set("pop",S.Symbol.createWithType(4,x.OverloadedFunctionType.create(u))),r.set("setdefault",S.Symbol.createWithType(4,x.OverloadedFunctionType.create(d))),r.set("__delitem__",S.Symbol.createWithType(4,c(h)))}}function ye(e,t){return ge(t,Jt(e).typingModulePath)}function ge(t,n){if(!n)return;const s=e(n);if(!s)return;const i=s.symbolTable.get(t);return i?nn(i):void 0}function fe(e){const t=f.getFlowNode(e);return!!t&&zt(t)}function _e(e){const t=f.getAfterFlowNode(e);return!!t&&zt(t)}function Te(e,t){const n=f.getFlowNode(e),s=f.getFlowNode(t);return!(!n||!s)&&(n===s||zt(s,n))}function ve(e,t,n){return Ce("information",e,t,n)}function be(e,t,n){return Ce("error",e,t,n)}function Ce(e,t,n,s){if(!Se(n))return Jt(n).diagnosticSink.addDiagnosticWithTextRange(e,t,s||n)}function Se(e){return j||Qt(e)||U.isIncompleteTypeMode()}function Ie(e,t,n,s){if("none"===e)return;const i=Ce(e,n,s);return i&&i.setRule(t),i}function De(e,t){const n=Jt(t),s=new l.DiagnosticAddendum;10===e.category&&e.subtypes.forEach(e=>{x.TypeBase.isInstantiable(e)||s.addMessage(h.Localizer.DiagnosticAddendum.typeNotClass().format({type:Fn(e)}))}),Ie(n.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeExpectedClass().format({type:Fn(e)})+s.getString(),t)}function ke(e,t,n,s){const i=e.value,r=Kt(e,i,!1);if(!r)return;const o=r.symbol.getDeclarations(),a=rn(r.symbol),p=Jt(e);let u=t;if(a&&n){let i=new l.DiagnosticAddendum;gn(a,t,i)?u=bn(a,t):(s&&(i=s),Ie(p.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeAssignmentMismatch().format({sourceType:Fn(t),destType:Fn(a)})+i.getString(),n||e),"none"!==p.diagnosticRuleSet.reportGeneralTypeIssues&&(u=a))}else{const t=b.getScopeForNode(e);if(2===(null==t?void 0:t.type)){const t=I.isConstantName(i),n=I.isPrivateOrProtectedName(i);!x.TypeBase.isInstance(u)||t||n&&"none"!==Jt(e).diagnosticRuleSet.reportPrivateUsage||(u=F.stripLiteralValue(u))}}const d=o.find(e=>1===e.type);d&&1===d.type&&n&&d.isConstant&&e!==o[0].node&&Ie(p.diagnosticRuleSet.reportConstantRedefinition,c.DiagnosticRule.reportConstantRedefinition,h.Localizer.Diagnostic.constantRedefinition().format({name:i}),e),K(e,u)}function xe(e,t,n,s){const i=e.memberName.value,r=Jt(e),o=v.getEnclosingClass(e);if(!o)return;const l=yt(o);if(l&&x.isClass(l.classType)){let o=F.lookUpClassMember(l.classType,i,n?0:8);const p=l.classType.details.fields;if(o)if(x.isClass(o.classType)&&x.ClassType.isSameGenericClass(l.classType,o.classType)&&o.isInstanceMember===n){const t=p.get(i);a.assert(void 0!==t);const n=t.getDeclarations();let o=D.isFinalVariable(t);if(n.length>0&&1===n[0].type&&s&&e.memberName!==n[0].node){n[0].isConstant&&Ie(r.diagnosticRuleSet.reportConstantRedefinition,c.DiagnosticRule.reportConstantRedefinition,h.Localizer.Diagnostic.constantRedefinition().format({name:e.memberName.value}),e.memberName);const t=v.getEnclosingFunction(e);t&&"__init__"===t.name.value&&(o=!1),o&&be(h.Localizer.Diagnostic.finalReassigned().format({name:e.memberName.value}),e.memberName)}}else{const s=rn(o.symbol);if(s&&!F.isProperty(s)&&!o.isInstanceMember&&n){Pe(r,o.symbol,e.memberName);const n=cn(o);t=x.combineTypes([t,n])}}o=F.lookUpClassMember(l.classType,i,16),!o&&s&&rt(r.diagnosticRuleSet.reportUnknownMemberType,c.DiagnosticRule.reportUnknownMemberType,e.memberName,t,e)}}function Fe(e,t,n,s){if(x.isTypeVar(t)&&n&&9===n.nodeType){const s=ne(n.leftExpression).type;x.isClass(s)&&(x.ClassType.isBuiltIn(s,"TypeVar")||x.ClassType.isBuiltIn(s,"ParamSpec"))&&(39===e.nodeType&&e.value===t.details.name||be(t.details.isParamSpec?h.Localizer.Diagnostic.paramSpecAssignedName().format({name:t.details.name}):h.Localizer.Diagnostic.typeVarAssignedName().format({name:t.details.name}),e))}switch(t=x.removeUnboundFromUnion(t),e.nodeType){case 39:rt(Jt(e).diagnosticRuleSet.reportUnknownVariableType,c.DiagnosticRule.reportUnknownVariableType,e,t,e),ke(e,t,n,s);break;case 36:!function(e,t,n,s){const i=ne(e.leftExpression),r=F.makeTypeVarsConcrete(i.type);if(39===e.leftExpression.nodeType){const s=v.getEnclosingClass(e);if(s){const i=yt(s);i&&x.isClass(i.classType)&&(x.isObject(r)?x.ClassType.isSameGenericClass(r.classType,i.classType)&&xe(e,t,!0,n):x.isClass(r)&&x.ClassType.isSameGenericClass(r,i.classType)&&xe(e,t,!1,n),x.ClassType.isProtocolClass(i.classType)&&be(h.Localizer.Diagnostic.assignmentInProtocol(),e.memberName))}}Ee(e,i,{method:"set",setType:t,setErrorNode:n,setExpectedTypeDiag:s},0),K(e.memberName,t),K(e,t)}(e,t,n,s);break;case 24:{const i=ne(e.baseExpression,void 0,2),r=Re(e,i.type,{method:"set",setType:t,setErrorNode:n,setExpectedTypeDiag:s},0);K(e,r.type);break}case 53:!function(e,t,n){const s=new Array(e.expressions.length);for(let t=0;t<e.expressions.length;t++)s[t]=[];const i=e.expressions.findIndex(e=>57===e.nodeType);F.doForSubtypes(t,t=>{const r=F.getSpecializedTupleType(t);if(r&&r.typeArguments){const t=r.typeArguments,n=t.length;if(2===n&&F.isEllipsisType(t[1]))for(let n=0;n<e.expressions.length;n++)s[n].push(t[0]);else{let r=0,o=0;for(o=0;o<e.expressions.length;o++)if(o===i){const i=e.expressions.length-o-1,a=n-r;let l=Math.max(a-i,0);for(;l>0;)s[o].push(t[r]),r++,l--}else{if(r>=n)break;s[o].push(t[r]),r++}if(o<e.expressions.length||r<n){const t=Jt(e),s=i>=0?e.expressions.length-1:e.expressions.length;Ie(t.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.tupleSizeMismatch().format({expected:s,received:n}),e)}}}else{const i=he(t,!1,n,!1);for(let t=0;t<e.expressions.length;t++)s[t].push(i)}}),e.expressions.forEach((e,t)=>{const r=s[t];let o=0===r.length?x.UnknownType.create():x.combineTypes(r);if(t===i){const t=Gt(e,"List");x.isClass(t)&&(o=x.ObjectType.create(x.ClassType.cloneForSpecialization(t,[o],!1)))}Fe(e,o,n)}),K(e,t)}(e,t,n);break;case 55:{const i=ie(e.typeAnnotation,v.isFinalAllowedForAssignmentTarget(e.valueExpression));gn(i,t,new l.DiagnosticAddendum)&&(x.isObject(t)&&x.ClassType.isEnumClass(t.classType)||(t=bn(i,t))),Fe(e.valueExpression,t,n,s);break}case 57:39===e.expression.nodeType&&ke(e.expression,t,n);break;case 32:{const s=he(t,!1,n,!1);e.entries.forEach(e=>{Fe(e,s,n)});break}case 0:Ht(()=>{e.child&&ne(e.child)});break;default:Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.assignmentTargetExpr(),e)}}function Pe(e,t,n){Qt(n)||U.isIncompleteTypeMode()||e.accessedSymbolMap.set(t.id,!0)}function Ae(e){if(x.isAnyOrUnknown(e))return e;if(x.isObject(e)){const t=e.classType;if(x.ClassType.isBuiltIn(t,"Generator")){const e=t.typeArguments;if(e&&e.length>=3)return e[2]}}}function we(e,t,n){const s=F.lookUpObjectMember(e,t,8);if(!s)return;const i=cn(s);if(x.isAnyOrUnknown(i))return i;if(5===i.category){const t=In(e,i,!1,n);if(t)return on(t)}}function Ee(e,t,n,s){const i=t.type,r=e.memberName.value;let o=new l.DiagnosticAddendum;const a=Jt(e);let p;switch(i.category){case 2:case 1:p=i;break;case 7:p=ae(e.memberName,i,r,n,o);break;case 11:return i.details.isParamSpec?"args"===r||"kwargs"===r?{type:x.AnyType.create(),node:e}:(Ie(a.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.paramSpecUnknownMember().format({name:r}),e.memberName),{type:x.UnknownType.create(),node:e}):i.details.recursiveTypeAliasName?{type:x.UnknownType.create(),node:e,isResolutionCyclical:!0}:Ee(e,{type:F.specializeType(i,void 0,!0),node:e},n,0);case 8:{const a=Ne(i);if(x.isClass(a))return Ee(e,{type:a,node:t.node,bindToType:t.bindToType},n,s);p=oe(e.memberName,i,r,n,o,void 0,t.bindToType);break}case 9:{const t=x.ModuleType.getField(i,r);if(t)"get"===n.method&&Pe(Jt(e),t,e.memberName),p=nn(t),x.isUnbound(p)&&(p=x.UnknownType.create());else{if("get"===n.method){const e=x.ModuleType.getField(i,"__getattr__");if(e&&e.getDeclarations().some(e=>e.path.toLowerCase().endsWith(".pyi"))){const t=nn(e);5===t.category&&(p=on(t))}}p||(Ie(a.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.moduleUnknownMember().format({name:r}),e.memberName),p=x.UnknownType.create())}break}case 10:p=F.doForSubtypes(i,t=>{if(x.isNone(t))Ie(Jt(e).diagnosticRuleSet.reportOptionalMemberAccess,c.DiagnosticRule.reportOptionalMemberAccess,h.Localizer.Diagnostic.noneUnknownMember().format({name:r}),e.memberName);else if(!x.isUnbound(t))return Ee(e,{type:t,node:e},n,0).type});break;case 5:case 6:p=x.AnyType.create();break;default:o.addMessage(h.Localizer.DiagnosticAddendum.typeUnsupported().format({type:Fn(i)}))}if(!p){let t=h.Localizer.Diagnostic.memberAccess();"set"===n.method?t=h.Localizer.Diagnostic.memberSet():"del"===n.method&&(t=h.Localizer.Diagnostic.memberDelete()),n.setExpectedTypeDiag&&(o=n.setExpectedTypeDiag),Ie(a.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,t.format({name:r,type:Fn(i)})+o.getString(),e.memberName),p=x.UnknownType.create()}return 0==(2&s)&&x.isClass(p)&&!p.typeArguments&&(p=Bt(p,void 0,s,e)),"get"===n.method&&rt(a.diagnosticRuleSet.reportUnknownMemberType,c.DiagnosticRule.reportUnknownMemberType,e.memberName,p,e),{type:p,node:e}}function Ne(e){if(x.isObject(e)){const t=e.classType;if(x.ClassType.isBuiltIn(t,"Type")){const e=t.typeArguments;if(e&&e.length>0){let t=e[0];if(x.isTypeVar(t)&&(t=F.getConcreteTypeFromTypeVar(t)),x.isObject(t))return t.classType}return x.AnyType.create()}}return e}function Oe(e,t,n,s,i,r,o){var c;t=x.ClassType.getAliasClass(t);let p=0;1&r&&(p|=8),2&r&&(p|=2),4&r&&(p|=4);let u=F.lookUpClassMember(t,n,16|p);if(u||(u=F.lookUpClassMember(t,n,p)),u){let o;if("get"===s.method)o=cn(u);else{const n=v.getEnclosingClass(e);if(n){const e=null===(c=yt(n))||void 0===c?void 0:c.classType;e&&x.isClass(e)&&x.ClassType.isSameGenericClass(e,t)&&(o=rn(u.symbol)||x.UnknownType.create())}o||(o=cn(u))}if("set"===s.method&&u.symbol.isClassVar()&&16&r)return void i.addMessage(h.Localizer.DiagnosticAddendum.memberSetClassVar().format({name:n}));if(x.ClassType.isTypedDictClass(t)){const e=u.symbol.getTypedDeclarations();if(e.length>0&&1===e[0].type)return void i.addMessage(h.Localizer.DiagnosticAddendum.memberUnknown().format({name:n}))}"get"===s.method&&x.isClass(u.classType)&&x.ClassType.isSameGenericClass(u.classType,t)&&Pe(Jt(e),u.symbol,e);const a=function(e,t,n,s,i,r,o,a){let l=!0;return e=F.doForSubtypes(e,e=>{if(x.isObject(e)){let c;c="get"===o.method?"__get__":"set"===o.method?"__set__":"__delete__";const p=e.classType,u=F.lookUpClassMember(p,c,8);if(x.ClassType.isPropertyClass(e.classType))if("set"===o.method){if(!u)return a.addMessage(h.Localizer.DiagnosticAddendum.propertyMissingSetter().format({name:r})),void(l=!1)}else if("del"===o.method&&!u)return a.addMessage(h.Localizer.DiagnosticAddendum.propertyMissingDeleter().format({name:r})),void(l=!1);if(u){let r=cn(u);const c=[{argumentCategory:0,type:e},{argumentCategory:0,type:s?x.ObjectType.create(n):x.NoneType.createInstance()},{argumentCategory:0,type:x.AnyType.create()}];if(6===r.category){const e=Ve(i,c,r,void 0);e&&(r=e)}if(r&&5===r.category){const n=In(e,r,!1,i);if(n){if(r=n,"get"===o.method){const e=$e(i,c.slice(1),r,new P.TypeVarMap,!0,!0,void 0).returnType||x.UnknownType.create();return x.isClass(t.classType)?F.partiallySpecializeType(e,t.classType):e}return"set"===o.method&&r.details.parameters.length>=2&&!gn(r.details.parameters[1].type,o.setType,a)?void(l=!1):x.AnyType.create()}}}}if("set"===o.method){let n=!1;if(t.symbol.hasTypedDeclarations()?n=!0:t.symbol.getDeclarations().some(e=>e.node===i)||(n=!0),n){let n=e;return s&&(t.isInstanceMember||5!==e.category||(x.FunctionType.isClassMethod(e)||x.FunctionType.isInstanceMethod(e))&&(n=F.stripFirstParameter(e))),n}}return e}),l?e:void 0}(o,u,t,0==(1&r),e,n,s,i);if(!a)return;return o=a,"set"!==s.method||gn(o,s.setType,i.createAddendum())?{type:o,isClassMember:!u.isInstanceMember}:void i.addMessage(h.Localizer.DiagnosticAddendum.memberAssignment().format({type:Fn(s.setType),name:n,classType:kn(t)}))}if(!(8&r)){const n=function(e,t,n){if("get"===n.method){const n=ae(t,e,"__getattribute__",{method:"get"},new l.DiagnosticAddendum,13);if(n&&5===n.category)return on(n);const s=ae(t,e,"__getattr__",{method:"get"},new l.DiagnosticAddendum,9);if(s&&5===s.category)return on(s)}else if("set"===n.method){if(ae(t,e,"__setattr__",{method:"get"},new l.DiagnosticAddendum,13))return x.AnyType.create()}else if(a.assert("del"===n.method),ae(t,e,"__detattr__",{method:"get"},new l.DiagnosticAddendum,13))return x.AnyType.create()}(t,e,s);if(n)return{type:n,isClassMember:!1}}i.addMessage(h.Localizer.DiagnosticAddendum.memberUnknown().format({name:n}))}function Re(e,t,n,s){var i;if((10===t.category||5===t.category||x.isClass(t)&&t.typeArguments)&&x.isUnionableType([t])){const n=[];if(F.doForSubtypes(t,e=>{F.addTypeVarsToListIfUnique(n,F.getTypeVarArgumentsRecursive(e))}),n.length>0){const r=Le(e.items,s);r.length>n.length&&be(h.Localizer.Diagnostic.typeArgsTooMany().format({name:Fn(t),expected:n.length,received:r.length}),r[n.length].node);const o=new P.TypeVarMap,a=new l.DiagnosticAddendum;n.forEach((e,t)=>{yn(e,t<r.length?F.convertToInstance(r[t].type):x.UnknownType.create(),!1,a,o)}),a.isEmpty()||be(h.Localizer.Diagnostic.typeNotSpecializable().format({type:Fn(t)})+a.getString(),e.items);let c=F.specializeType(t,o);if(t.typeAliasInfo&&c!==t){const e=[];null===(i=t.typeAliasInfo.typeParameters)||void 0===i||i.forEach(t=>{e.push(o.getTypeVar(t)||x.UnknownType.create())}),c=x.TypeBase.cloneForTypeAlias(c,t.typeAliasInfo.aliasName,t.typeAliasInfo.typeParameters,e)}return{type:c,node:e}}}if(F.isTypeAliasPlaceholder(t)){const n=Le(e.items,s).map(e=>F.convertToInstance(e.type));return{type:x.TypeBase.cloneForTypeAlias(t,t.details.recursiveTypeAliasName,void 0,n),node:e}}const r=F.doForSubtypes(t,t=>{if(t=Ne(t=F.makeTypeVarsConcrete(t)),x.isAnyOrUnknown(t))return t;if(x.isClass(t)){if("set"===n.method?be(h.Localizer.Diagnostic.genericClassAssigned(),e.baseExpression):"del"===n.method&&be(h.Localizer.Diagnostic.genericClassDeleted(),e.baseExpression),x.ClassType.isSpecialBuiltIn(t,"Literal"))return function(e,t){if(0===e.items.items.length)return be(h.Localizer.Diagnostic.literalEmptyArgs(),e.baseExpression),x.UnknownType.create();const n=[];for(const s of e.items.items){let i;if(49===s.nodeType){i=lt(e,0!=(32&s.strings[0].token.flags)?"bytes":"str",s.strings.map(e=>e.value).join(""))}else 41===s.nodeType?!s.isImaginary&&s.isInteger&&(i=lt(e,"int",s.value)):11===s.nodeType?31===s.constType?i=lt(e,"bool",!0):14===s.constType?i=lt(e,"bool",!1):24===s.constType&&(i=x.NoneType.createType()):56===s.nodeType&&33===s.operator&&41===s.expression.nodeType&&!s.expression.isImaginary&&s.expression.isInteger&&(i=lt(e,"int",-s.expression.value));if(!i){const e=ne(s);if(x.isObject(e.type)&&x.ClassType.isEnumClass(e.type.classType)&&void 0!==e.type.classType.literalValue)i=e.type.classType;else{let t=!0;F.doForSubtypes(e.type,e=>{x.isClass(e)&&void 0!==e.literalValue||(t=!1)}),t&&(i=e.type)}}i||(0!=(256&t)?(be(h.Localizer.Diagnostic.literalUnsupportedType(),s),i=x.UnknownType.create()):i=x.AnyType.create()),n.push(i)}return x.combineTypes(n)}(e,s);if(x.ClassType.isBuiltIn(t,"InitVar")){const t=Le(e.items,s);return 1===t.length?t[0].type:(be(h.Localizer.Diagnostic.typeArgsMismatchOne().format({received:t.length}),e.baseExpression),x.UnknownType.create())}if(x.ClassType.isEnumClass(t))return x.ObjectType.create(t);let i=s;x.isClass(t)&&F.isTupleClass(t)&&(i|=512);const r=x.isClass(t)&&x.ClassType.isBuiltIn(t,"Annotated");return Bt(t,Le(e.items,i,r),s,e)}return x.isObject(t)?function(e,t,n){if(x.ClassType.isTypedDictClass(t.classType)){if(1!==e.items.items.length)return be(h.Localizer.Diagnostic.typeArgsMismatchOne().format({received:e.items.items.length}),e),x.UnknownType.create();const s=Sn(t.classType),i=ne(e.items.items[0]).type;let r=new l.DiagnosticAddendum;const o=F.doForSubtypes(i,i=>{if(x.isAnyOrUnknown(i))return i;if(x.isObject(i)&&x.ClassType.isBuiltIn(i.classType,"str")){if(void 0===i.classType.literalValue)return x.UnknownType.create();const o=i.classType.literalValue,a=s.get(o);return a?("set"===n.method?gn(a.valueType,n.setType,r):"del"===n.method&&a.isRequired&&Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.keyRequiredDeleted().format({name:o}),e),a.valueType):(r.addMessage(h.Localizer.DiagnosticAddendum.keyUndefined().format({name:o,type:Fn(t)})),x.UnknownType.create())}return r.addMessage(h.Localizer.DiagnosticAddendum.typeNotStringLiteral().format({type:Fn(i)})),x.UnknownType.create()});if(n.setExpectedTypeDiag&&(r=n.setExpectedTypeDiag),!r.isEmpty()){let t;t="set"===n.method?h.Localizer.Diagnostic.typedDictSet():"del"===n.method?h.Localizer.Diagnostic.typedDictDelete():h.Localizer.Diagnostic.typedDictAccess(),Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,t+r.getString(),e)}return o}let s;"get"===n.method?s="__getitem__":"set"===n.method?s="__setitem__":(a.assert("del"===n.method),s="__delitem__");const i=oe(e,t,s,{method:"get"},new l.DiagnosticAddendum,9);if(!i)return Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.methodNotDefinedOnType().format({name:s,type:Fn(t)}),e.baseExpression),x.UnknownType.create();const r=e.items.items.map(e=>ne(e).type);let o;if(1===r.length){o=r[0];const n=t.classType;if(41===e.items.items[0].nodeType&&e.items.items[0].isInteger&&!e.items.items[0].isImaginary){const t=F.getSpecializedTupleType(n);if(t&&t.typeArguments&&t.typeArguments.length>0){const n=e.items.items[0];if(n.isInteger&&n.value>=0){if(2===t.typeArguments.length&&F.isEllipsisType(t.typeArguments[1]))return t.typeArguments[0];if(n.value<t.typeArguments.length)return t.typeArguments[n.value]}}}}else{const t=Gt(e,"Tuple");o=x.isClass(t)?F.convertToInstance(Me(t,r,!1)):x.UnknownType.create()}const p=[{argumentCategory:0,type:o}];return"set"===n.method&&p.push({argumentCategory:0,type:n.setType||x.AnyType.create()}),Ge(e,p,i,new P.TypeVarMap,!1,!0,void 0).returnType||x.UnknownType.create()}(e,t,n):x.isNever(t)?x.UnknownType.create():x.isNone(t)?(Ie(Jt(e).diagnosticRuleSet.reportOptionalSubscript,c.DiagnosticRule.reportOptionalSubscript,h.Localizer.Diagnostic.noneNotSubscriptable(),e.baseExpression),x.UnknownType.create()):(x.isUnbound(t)||Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotSubscriptable().format({type:Fn(t)}),e.baseExpression),x.UnknownType.create())});return e.items.items.forEach(e=>{ne(e,void 0,4&s)}),{type:r,node:e}}function Le(e,t,n=!1){const s=[],i=-129&t;return e.items.forEach((e,t)=>{n&&t>0?s.push(ne(e,void 0,130)):s.push(function(e,t){let n,s=353|t;return se(Jt(e))&&(s|=4),n=32===e.nodeType?{type:x.UnknownType.create(),typeList:e.entries.map(e=>ne(e,void 0,s)),node:e}:ne(e,void 0,s),n}(e,i))}),s}function Me(e,t,n){let s=x.AnyType.create(!1);s=2===t.length&&F.isEllipsisType(t[1])?t[0]:x.combineTypes(t);const i=[s],r=x.ClassType.cloneForSpecialization(e,t,n,void 0,i);return r.details=Object.assign({},r.details),r.details.mro=[...r.details.mro],r.details.mro[0]=r,x.ClassType.isBuiltIn(e,"Tuple")&&e.details.mro.length>=2&&x.isClass(e.details.mro[0])&&x.ClassType.isBuiltIn(e.details.mro[0],"Tuple")&&x.isClass(e.details.mro[1])&&x.ClassType.isBuiltIn(e.details.mro[1],"tuple")?(r.details.mro[1]=x.ClassType.cloneForSpecialization(r.details.mro[1],[s],n,void 0,i),r):x.ClassType.isBuiltIn(e,"tuple")&&e.details.mro.length>=1&&x.isClass(e.details.mro[0])&&x.ClassType.isBuiltIn(e.details.mro[0],"tuple")?r:e}function Ue(e,t,n){const s=e.details.mro.findIndex(e=>x.isClass(e)&&x.ClassType.isBuiltIn(e,"NamedTuple"));if(s<0||e.details.mro.length<s+2)return;const i=e.details.mro[s],r=e.details.mro[s+1],o=e.details.mro[s+2];if(!(x.isClass(r)&&x.ClassType.isBuiltIn(r,"Tuple")&&x.isClass(o)&&x.ClassType.isBuiltIn(o,"tuple")))return;const a=Me(r,t,n),l=x.ClassType.cloneForSpecialization(i,[],n);l.details=Object.assign({},l.details),l.details.mro=[...l.details.mro],l.details.mro[1]=a.details.mro[0],l.details.mro[2]=a.details.mro[1],e.details.mro[s]=l,e.details.mro[s+1]=a.details.mro[0],e.details.mro[s+2]=a.details.mro[1]}function ze(e,t,n,s,i){const r=0!=(16&i),o=new l.DiagnosticAddendum;let u=F.doForSubtypes(n.type,n=>{let u;n=F.makeTypeVarsConcrete(n);let m=!1;switch(x.isObject(n)&&x.ClassType.isBuiltIn(n.classType,"Type")&&(n=Ne(n),m=!0),n.category){case 7:if(x.ClassType.isBuiltIn(n)){const i=n.details.name;if("type"===i){if(je(e,t,n,r,s),1===t.length){const e=Wt(t[0]);x.isObject(e)?u=e.classType:3===e.category&&(u=x.NoneType.createType())}else t.length>=2&&(u=function(e,t){const n=Jt(e),s=Wt(t[0]);if(!x.isObject(s)||!x.ClassType.isBuiltIn(s.classType,"str"))return;const i=s.classType.literalValue||"_",r=Wt(t[1]);if(!x.isObject(r)||!F.isTupleClass(r.classType)||void 0===r.classType.typeArguments)return;const o=x.ClassType.create(i,Qe(e,n.moduleName,i),n.moduleName,0,e.id,void 0,r.classType.details.effectiveMetaclass);return r.classType.typeArguments.forEach(n=>{x.isClass(n)||x.isAnyOrUnknown(n)?o.details.baseClasses.push(n):De(n,t[1].valueExpression||e)}),F.computeMroLinearization(o)||be(h.Localizer.Diagnostic.methodOrdering(),e),o}(e,t));u||(u=x.AnyType.create())}else"TypeVar"===i?u=He(e,t,!1):"ParamSpec"===i?u=He(e,t,!0):"NamedTuple"===i?u=Je(e,t,!0):"Protocol"===i||"Generic"===i||"Callable"===i||"Concatenate"===i||"Type"===i?Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotIntantiable().format({type:i}),e):"Enum"===i||"IntEnum"===i||"Flag"===i||"IntFlag"===i?u=function(e,t,n){const s=Jt(e);let i="enum";if(0===n.length)return;{const e=n[0];if(0!==e.argumentCategory||!e.valueExpression||49!==e.valueExpression.nodeType)return;i=e.valueExpression.strings.map(e=>e.value).join("")}const r=x.ClassType.create(i,Qe(e,s.moduleName,i),s.moduleName,64,e.id,void 0,t.details.effectiveMetaclass);r.details.baseClasses.push(t),F.computeMroLinearization(r);const o=r.details.fields;if(o.set("__class__",S.Symbol.createWithType(68,r)),!(n.length<2)){{const t=n[1];if(0!==t.argumentCategory||!t.valueExpression||49!==t.valueExpression.nodeType)return;t.valueExpression.strings.map(e=>e.value).join("").split(" ").forEach(n=>{if(n=n.trim()){const s=x.UnknownType.create(),i=S.Symbol.createWithType(4,s),r=t.valueExpression;a.assert(49===r.nodeType);const l=Jt(e),c={type:1,node:r,path:l.filePath,range:p.convertOffsetsToRange(r.start,d.TextRange.getEnd(r),l.lines),moduleName:l.moduleName};i.addDeclaration(c),o.set(n,i)}})}return r}}(e,n,t):"TypedDict"===i?u=function(e,t,n){const s=Jt(e);let i="TypedDict";if(0===n.length)be(h.Localizer.Diagnostic.typedDictFirstArg(),e);else{const t=n[0];0===t.argumentCategory&&t.valueExpression&&49===t.valueExpression.nodeType?i=t.valueExpression.strings.map(e=>e.value).join(""):be(h.Localizer.Diagnostic.typedDictFirstArg(),n[0].valueExpression||e)}const r=x.ClassType.create(i,Qe(e,s.moduleName,i),s.moduleName,16,e.id,void 0,t.details.effectiveMetaclass);r.details.baseClasses.push(t),F.computeMroLinearization(r);const o=r.details.fields;o.set("__class__",S.Symbol.createWithType(68,r));let a=!1;if(n.length<2)be(h.Localizer.Diagnostic.typedDictSecondArgDict(),e);else{const t=n[1],i=new Map;if(0===t.argumentCategory&&t.valueExpression&&15===t.valueExpression.nodeType)a=!0,t.valueExpression.entries.forEach(e=>{if(17!==e.nodeType)return void be(h.Localizer.Diagnostic.typedDictSecondArgDictEntry(),e);if(49!==e.keyExpression.nodeType)return void be(h.Localizer.Diagnostic.typedDictEntryName(),e.keyExpression);const t=e.keyExpression.strings.map(e=>e.value).join("");if(!t)return void be(h.Localizer.Diagnostic.typedDictEmptyName(),e.keyExpression);if(i.has(t))return void be(h.Localizer.Diagnostic.typedDictEntryUnique(),e.keyExpression);i.set(t,!0),ie(e.valueExpression,!0);const n=new S.Symbol(8),r={type:1,node:e.keyExpression,path:s.filePath,typeAnnotationNode:e.valueExpression,range:p.convertOffsetsToRange(e.keyExpression.start,d.TextRange.getEnd(e.keyExpression),s.lines),moduleName:s.moduleName};n.addDeclaration(r),o.set(t,n)});else if(t.name)for(let t=1;t<n.length;t++){const s=n[t];if(!s.name||!s.valueExpression)continue;if(i.has(s.name.value)){be(h.Localizer.Diagnostic.typedDictEntryUnique(),s.valueExpression);continue}i.set(s.name.value,!0),ie(s.valueExpression,!0);const r=new S.Symbol(8),a=Jt(e),l={type:1,node:s.name,path:a.filePath,typeAnnotationNode:s.valueExpression,range:p.convertOffsetsToRange(s.name.start,d.TextRange.getEnd(s.valueExpression),a.lines),moduleName:a.moduleName};r.addDeclaration(l),o.set(s.name.value,r)}else be(h.Localizer.Diagnostic.typedDictSecondArgDict(),e)}return a&&(n.length>=3&&(!n[2].name||"total"!==n[2].name.value||!n[2].valueExpression||11!==n[2].valueExpression.nodeType||14!==n[2].valueExpression.constType&&31!==n[2].valueExpression.constType?be(h.Localizer.Diagnostic.typedDictTotalParam(),n[2].valueExpression||e):14===n[2].valueExpression.constType&&(r.details.flags|=32)),n.length>3&&be(h.Localizer.Diagnostic.typedDictExtraArgs(),n[3].valueExpression||e)),me(e,r),r}(e,n,t):"auto"===i&&0===t.length&&(u=$t(e,"int"))}else if(x.isClass(n)&&!m&&x.ClassType.hasAbstractMethods(n)){const t=Cn(n),s=new l.DiagnosticAddendum,i=2;t.forEach((e,n)=>{if(n===i)s.addMessage(h.Localizer.DiagnosticAddendum.memberIsAbstractMore().format({count:t.length-i}));else if(n<i&&x.isClass(e.classType)){const t=e.classType.details.name;s.addMessage(h.Localizer.DiagnosticAddendum.memberIsAbstract().format({type:t,name:e.symbolName}))}}),Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeAbstract().format({type:n.details.name})+s.getString(),e)}if(u||(u=je(e,t,n,r,s).returnType),u&&x.isObject(u)&&u.classType.details.mro.some(e=>x.isClass(e)&&x.ClassType.isBuiltIn(e,"type"))){const t="__class_"+u.classType.details.name;u=x.ClassType.create(t,"","",0,e.id,u.classType,u.classType)}break;case 5:if("namedtuple"===n.details.builtInName)Ie(Jt(e).diagnosticRuleSet.reportUntypedNamedTuple,c.DiagnosticRule.reportUntypedNamedTuple,h.Localizer.Diagnostic.namedTupleNoTypes(),e),u=Je(e,t,!1);else if("NewType"===n.details.builtInName){const i=Ge(e,t,n,new P.TypeVarMap,r,!0,s);u=i.argumentErrors?i.returnType:function(e,t){const n=Jt(e);let s="_";if(t.length>=1){const e=t[0];0===e.argumentCategory&&e.valueExpression&&49===e.valueExpression.nodeType&&(s=e.valueExpression.strings.map(e=>e.value).join(""))}if(t.length>=2){const i=qt(t[1],Jt(e));if(x.isClass(i)){const t=-4&i.details.flags,r=x.ClassType.create(s,Qe(e,n.moduleName,s),n.moduleName,t,e.id,void 0,i.details.effectiveMetaclass);r.details.baseClasses.push(i),F.computeMroLinearization(r);const o=x.FunctionType.createInstance("__init__","",64);x.FunctionType.addParameter(o,{category:0,name:"self",type:x.ObjectType.create(r),hasDeclaredType:!0}),x.FunctionType.addParameter(o,{category:0,name:"_x",type:x.ObjectType.create(i),hasDeclaredType:!0}),o.details.declaredReturnType=x.NoneType.createInstance(),r.details.fields.set("__init__",S.Symbol.createWithType(4,o));const a=x.FunctionType.createInstance("__new__","",65);return x.FunctionType.addParameter(a,{category:0,name:"cls",type:r,hasDeclaredType:!0}),x.FunctionType.addDefaultParameters(a),a.details.declaredReturnType=x.ObjectType.create(r),r.details.fields.set("__new__",S.Symbol.createWithType(4,a)),r}}}(e,t)}else u=Ge(e,t,n,new P.TypeVarMap,r,!0,s).returnType,"__import__"===n.details.builtInName&&(u=x.AnyType.create());u||(u=x.UnknownType.create());break;case 6:{const i=Ve(e,t,n,s);if(i)if("cast"===i.details.builtInName&&2===t.length){const n=qt(t[0],Jt(e)),s=Wt(t[1]);x.isClass(n)&&x.isObject(s)&&x.isTypeSame(n,s.classType)&&Ie(Jt(e).diagnosticRuleSet.reportUnnecessaryCast,c.DiagnosticRule.reportUnnecessaryCast,h.Localizer.Diagnostic.unnecessaryCast().format({type:Fn(s)}),e),u=F.convertToInstance(n)}else u=Ge(e,t,i,new P.TypeVarMap,r,!0,s).returnType,u||(u=x.UnknownType.create());else{const s=v.printExpression(e),i=new l.DiagnosticAddendum,r=t.map(e=>Fn(Wt(e)));9!==e.nodeType&&n.overloads[0].details.name&&i.addMessage(h.Localizer.DiagnosticAddendum.overloadCallName().format({name:n.overloads[0].details.name})),i.addMessage(h.Localizer.DiagnosticAddendum.argumentTypes().format({types:r.join(", ")})),Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.noOverload().format({expression:s})+i.getString(),e),u=x.UnknownType.create()}break}case 8:{const i=oe(e,n,"__call__",{method:"get"},new l.DiagnosticAddendum,9);i&&(u=Ge(e,t,i,new P.TypeVarMap,r,!0,s).returnType,u||(u=x.UnknownType.create()));break}case 3:return void Ie(Jt(e).diagnosticRuleSet.reportOptionalCall,c.DiagnosticRule.reportOptionalCall,h.Localizer.Diagnostic.noneNotCallable(),e);case 2:case 1:t.forEach(e=>Wt(e)),u=n}return u?0==(2&i)&&x.isClass(u)&&(u=Bt(u,void 0,i,e)):o.addMessage(h.Localizer.DiagnosticAddendum.typeNotCallable().format({type:Fn(n)})),u});if(!o.isEmpty()||x.isNever(u)){const s=Jt(e),i=13===e.nodeType?e:e.leftExpression;Ie(s.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotCallable().format({expression:v.printExpression(i),type:Fn(n.type)})+o.getString(),i),u=x.UnknownType.create(),t.forEach(e=>{!e.type&&e.valueExpression&&ne(e.valueExpression)})}return{type:u,node:n.node}}function Ve(e,t,n,s){let i;for(const r of n.overloads)if(x.FunctionType.isOverloaded(r)&&(Yt(e,()=>{Ge(e,t,r,new P.TypeVarMap,!0,!1,s).argumentErrors||(i=r)}),i))break;return i}function je(e,t,n,s,i){let r,o=!1,a=!1;const p=e=>5===e.category&&x.FunctionType.isSkipConstructorCheck(e),u=oe(e,x.ObjectType.create(n),"__init__",{method:"get"},new l.DiagnosticAddendum,13);if(u&&!p(u)){if(i&&(r=F.doForSubtypes(i,i=>{const r=new P.TypeVarMap;if(qe(n,i,r)&&!Ge(e,t,u,r,s,!0,x.NoneType.createInstance()).argumentErrors)return Be(F.specializeType(F.specializeType(n,r,!0),r,!0),i)}),x.isNever(r)&&(r=void 0)),!r){const o=new P.TypeVarMap;Ge(e,t,u,o,s,!0,x.NoneType.createInstance()).argumentErrors?a=!0:r=We(F.specializeType(F.specializeType(n,o,!0),o,!0),i)}o=!0,s=!0}if(!a){const c=Oe(e,n,"__new__",{method:"get"},new l.DiagnosticAddendum,13);if(c&&!p(c.type)){const l=In(n,c.type,!0,e),p=new P.TypeVarMap;if(l){const c=Ge(e,t,l,p,s,!0,i);if(c.argumentErrors)a=!0;else{let e=c.returnType;e&&x.isObject(e)&&x.ClassType.isSameGenericClass(e.classType,n)&&((F.isPartlyUnknown(e)||F.requiresSpecialization(e))&&void 0!==r||(x.isObject(e)&&x.ClassType.isBuiltIn(e.classType,"tuple")&&e.classType.typeArguments&&1===e.classType.typeArguments.length&&(e=x.ObjectType.create(Me(e.classType,[e.classType.typeArguments[0],x.AnyType.create(!0)],!0))),r=e))}r||(r=We(F.specializeType(n,p,!0),i)),o=!0}}}return o||t.forEach(e=>{e.valueExpression&&ne(e.valueExpression)}),!o&&t.length>0?Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.constructorNoArgs().format({type:n.details.name}),e):r||(r=We(n,i)),{argumentErrors:a,returnType:r}}function Be(e,t){const n=x.ObjectType.create(e);if(gn(t,n,new l.DiagnosticAddendum)){if(2===t.category)return t;const s=new P.TypeVarMap;if(qe(e,t,s))return F.specializeType(n,s)}}function We(e,t){if(t){const n=F.doForSubtypes(t,t=>Be(e,t));if(!x.isNever(n))return n}return x.ObjectType.create(e)}function qe(e,t,n){if(!x.isObject(t))return!1;const s=t.classType.effectiveTypeArguments||t.classType.typeArguments;if(!s)return gn(e,t.classType,new l.DiagnosticAddendum,n);if(x.ClassType.isSameGenericClass(t.classType,e)){const e=F.buildTypeVarMapFromSpecializedClass(t.classType);return e.getTypeVars().forEach(t=>{n.setTypeVar(t.typeVar,t.type,e.isNarrowable(t.typeVar))}),!0}const i=x.ClassType.getTypeParameters(t.classType).map((e,t)=>x.TypeVarType.createInstance("__dest"+t,!1,!0)),r=x.ClassType.cloneForSpecialization(t.classType,i,!0),o=x.ClassType.getTypeParameters(e).map((e,t)=>{const n=x.TypeVarType.createInstance("__source"+t,!1,!0);return n.details.synthesizedIndex=t,n}),a=x.ClassType.cloneForSpecialization(e,o,!0),c=new P.TypeVarMap;return!!gn(r,a,new l.DiagnosticAddendum,c)&&(i.forEach((e,t)=>{const i=c.getTypeVar(e);if(i&&x.isTypeVar(i)&&i.details.isSynthesized&&void 0!==i.details.synthesizedIndex){const e=x.ClassType.getTypeParameters(a)[i.details.synthesizedIndex];t<s.length&&n.setTypeVar(e,s[t],!1)}}),!0)}function Ge(e,t,n,s,i,r=!0,o){let a={argumentErrors:!1};switch(n.category){case 1:case 2:t.forEach(e=>Wt(e)),a.returnType=n;break;case 5:a=$e(e,t,n,s,i,r,o);break;case 6:{const p=Ve(e,t,n,o);if(p)a=$e(e,t,p,s,i,r,o);else{const s=v.printExpression(e),i=new l.DiagnosticAddendum,r=t.map(e=>Fn(Wt(e)));9!==e.nodeType&&n.overloads[0].details.name&&i.addMessage(h.Localizer.DiagnosticAddendum.overloadCallName().format({name:n.overloads[0].details.name})),i.addMessage(h.Localizer.DiagnosticAddendum.argumentTypes().format({types:r.join(", ")})),Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.noOverload().format({expression:s})+i.getString(),e),a.argumentErrors=!0}break}case 7:x.ClassType.isSpecialBuiltIn(n)?(Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotIntantiable().format({type:n.details.name}),e),a.argumentErrors=!0):a=je(e,t,n,i,o);break;case 8:{const p=oe(e,n,"__call__",{method:"get"},new l.DiagnosticAddendum,9);p&&5===p.category?a=Ge(e,t,F.stripFirstParameter(p),s,i,r,o):(Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.objectNotCallable().format({type:Fn(n)}),e),a.argumentErrors=!0);break}case 10:{const l=[];for(const a of n.subtypes)if(x.isNone(a))Ie(Jt(e).diagnosticRuleSet.reportOptionalCall,c.DiagnosticRule.reportOptionalCall,h.Localizer.Diagnostic.noneNotCallable(),e);else{const n=Ge(e,t,a,s,i,r,o);n.returnType&&l.push(n.returnType)}l.length>0?a.returnType=x.combineTypes(l):a.argumentErrors=!0;break}}return a.returnType||t.forEach(e=>Wt(e)),a}function $e(e,t,n,s,i,r=!0,o){let p=0;const u=n.details.parameters;o&&!F.requiresSpecialization(o)&&n.details.declaredReturnType&&gn(n.details.declaredReturnType,o,new l.DiagnosticAddendum,s);const d=u.find(e=>2===e.category);let m=!1;const y=new Map;u.forEach(e=>{e.name&&y.set(e.name,{argsNeeded:0!==e.category||e.hasDefault?0:1,argsReceived:0})});let g=u.findIndex(e=>1===e.category&&!e.name);const f=u.findIndex(e=>0===e.category&&!e.name);g<0&&(g=u.findIndex(e=>1===e.category),g>=0&&g++),g<0&&(g=u.findIndex(e=>2===e.category)),g<0&&(g=u.length);let _=t.findIndex(e=>2===e.argumentCategory||void 0!==e.name);if(_<0&&(_=t.length),f>=0&&_<f){const e=u.findIndex(e=>e.hasDefault),n=e>=0&&e<f?e:f;_=Math.min(n,t.length)}const T=[];let v;function b(e,t){e.active&&(v=t)}let C=void 0!==t.find(e=>1===e.argumentCategory),S=0,I=0;for(;p<_;){if(S===f){S++;continue}if(p<f&&t[p].name&&Ie(Jt(t[p].name).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.argPositional(),t[p].name),S>=g){if(!C||1!==t[p].argumentCategory){const n=g;Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,1===n?h.Localizer.Diagnostic.argPositionalExpectedOne():h.Localizer.Diagnostic.argPositionalExpectedCount().format({expected:n}),t[p].valueExpression||e),m=!0}break}const s=x.FunctionType.getEffectiveParameterType(n,S);if(1===t[p].argumentCategory){if(!t[p].valueExpression)break;const n=Wt(t[p]);let i,r=!1;x.isObject(n)&&F.isTupleClass(n.classType)&&n.classType.typeArguments&&n.classType.typeArguments.length>0&&!F.isEllipsisType(n.classType.typeArguments[n.classType.typeArguments.length-1])?(i=n.classType.typeArguments[I],C=void 0!==t.find((e,t)=>t>p&&1===e.argumentCategory),I++,I>=n.classType.typeArguments.length&&(I=0,r=!0)):i=he(n,!1,t[p].valueExpression,!1);const o={argumentCategory:0,type:i},a=u[S].name;T.push({paramType:s,requiresTypeVarMatching:F.requiresSpecialization(s),argument:o,errorNode:t[p].valueExpression||e,paramName:u[S].isNameSynthesized?void 0:a}),b(t[p],u[S]),a&&y.get(a).argsReceived++,(r||1===u[S].category)&&p++,1!==u[S].category&&S++}else if(1===u[S].category)T.push({paramType:s,requiresTypeVarMatching:F.requiresSpecialization(s),argument:t[p],errorNode:t[p].valueExpression||e,paramName:u[S].name}),b(t[p],u[S]),p++;else{const n=u[S].name;T.push({paramType:s,requiresTypeVarMatching:F.requiresSpecialization(s),argument:t[p],errorNode:t[p].valueExpression||e,paramName:u[S].isNameSynthesized?void 0:n}),b(t[p],u[S]),n&&y.get(n).argsReceived++,p++,S++}}if(!m){let s=!1;for(;p<t.length;){if(2===t[p].argumentCategory)Wt(t[p]),s=!0;else{const s=t[p].name;if(s){const i=s.value,r=y.get(i);if(r)if(r.argsReceived>0)Ie(Jt(s).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.paramAlreadyAssigned().format({name:i}),s),m=!0;else{y.get(s.value).argsReceived++;const r=u.findIndex(e=>e.name===i);a.assert(r>=0);const o=x.FunctionType.getEffectiveParameterType(n,r);T.push({paramType:o,requiresTypeVarMatching:F.requiresSpecialization(o),argument:t[p],errorNode:t[p].valueExpression||e,paramName:i}),b(t[p],u[r])}else d?(T.push({paramType:d.type,requiresTypeVarMatching:F.requiresSpecialization(d.type),argument:t[p],errorNode:t[p].valueExpression||e,paramName:i}),b(t[p],d)):(Ie(Jt(s).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.paramNameMissing().format({name:s.value}),s),m=!0)}}p++}if(!s&&!C&&!x.FunctionType.isDefaultParameterCheckDisabled(n)){const t=[...y.keys()].filter(e=>{const t=y.get(e);return t.argsReceived<t.argsNeeded});if(t.length>0){const n=t.map(e=>`"${e}"`).join(", ");Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,1===t.length?h.Localizer.Diagnostic.argMissingForParam().format({name:n}):h.Localizer.Diagnostic.argMissingForParams().format({names:n}),e),m=!0}u.forEach(t=>{if(0===t.category&&t.name){const n=y.get(t.name);0===n.argsNeeded&&0===n.argsReceived&&t.defaultType&&F.requiresSpecialization(t.type)&&T.push({paramType:t.type,requiresTypeVarMatching:!0,argument:{argumentCategory:0,type:t.defaultType},errorNode:e,paramName:t.isNameSynthesized?void 0:t.name})}})}}["cast","isinstance","issubclass"].some(e=>e===n.details.builtInName)&&(i=!0);const D=T.filter(e=>e.requiresTypeVarMatching).length;if(D>0){const t=Math.min(D,2);for(let r=0;r<t;r++)Yt(e,()=>{T.forEach(e=>{e.requiresTypeVarMatching&&Ke(e,s,n.details.name,i)})});s.lock()}T.forEach(e=>{Ke(e,s,n.details.name,i)||(m=!0)}),Qt(void 0)||U.isIncompleteTypeMode()||t.forEach(e=>{e.valueExpression&&(T.some(t=>t.argument===e)||ne(e.valueExpression))});const k=on(n,T,r&&!m),P=F.specializeType(k,s);return{argumentErrors:m,returnType:P,activeParam:v}}function Ke(e,t,n,s){let i,r;if(e.argument.valueExpression){let n=F.specializeType(e.paramType,t);x.isUnknown(n)&&(n=void 0);const s=ne(e.argument.valueExpression,n);i=s.type,r=s.expectedTypeDiagAddendum,e.argument&&e.argument.name&&!Qt(e.errorNode)&&K(e.argument.name,n||i)}else i=Wt(e.argument);let o=new l.DiagnosticAddendum;if(i=F.makeTypeVarsConcrete(i),!gn(e.paramType,i,o.createAddendum(),t)){if(!Se(e.errorNode)){const t=Jt(e.errorNode),s=Fn(i),a=Fn(e.paramType);let l;l=e.paramName?n?h.Localizer.Diagnostic.argAssignmentParamFunction().format({argType:s,paramType:a,functionName:n,paramName:e.paramName}):h.Localizer.Diagnostic.argAssignmentParam().format({argType:s,paramType:a,paramName:e.paramName}):n?h.Localizer.Diagnostic.argAssignmentFunction().format({argType:s,paramType:a,functionName:n}):h.Localizer.Diagnostic.argAssignment().format({argType:s,paramType:a}),r&&(o=r),Ie(t.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,l+o.getString(),e.errorNode)}return!1}if(!s){const t=x.removeUnboundFromUnion(i),s=Jt(e.errorNode),r=new l.DiagnosticAddendum;e.paramName&&r.addMessage((n?h.Localizer.DiagnosticAddendum.argParamFunction().format({paramName:e.paramName,functionName:n}):h.Localizer.DiagnosticAddendum.argParam().format({paramName:e.paramName}))+r.getString()),x.isUnknown(t)?Ie(s.diagnosticRuleSet.reportUnknownArgumentType,c.DiagnosticRule.reportUnknownArgumentType,h.Localizer.Diagnostic.argTypeUnknown()+r.getString(),e.errorNode):F.isPartlyUnknown(t,!0)&&(F.isPartlyUnknown(e.paramType)||x.isClass(t)||(r.addMessage(h.Localizer.DiagnosticAddendum.argumentType().format({type:Fn(t,!0)})),Ie(s.diagnosticRuleSet.reportUnknownArgumentType,c.DiagnosticRule.reportUnknownArgumentType,h.Localizer.Diagnostic.argTypePartiallyUnknown()+r.getString(),e.errorNode)))}return!0}function He(e,t,n){let s,i="";if(n){const t=Jt(e);!t.isStubFile&&t.executionEnvironment.pythonVersion<u.PythonVersion.V3_9&&be(h.Localizer.Diagnostic.paramSpecIllegal(),e)}if(0===t.length)return void be(n?h.Localizer.Diagnostic.paramSpecFirstArg():h.Localizer.Diagnostic.typeVarFirstArg(),e);const r=t[0];r.valueExpression&&49===r.valueExpression.nodeType?i=r.valueExpression.strings.map(e=>e.value).join(""):be(n?h.Localizer.Diagnostic.paramSpecFirstArg():h.Localizer.Diagnostic.typeVarFirstArg(),r.valueExpression||e);const o=x.TypeVarType.createInstantiable(i,n);for(let i=1;i<t.length;i++){const r=t[i].name,a=r?r.value:void 0,l=new Map;if(a){if(l.get(a)&&be(h.Localizer.Diagnostic.duplicateParam().format({name:a}),t[i].valueExpression||e),"bound"!==a||n)"covariant"!==a||n?"contravariant"!==a||n?be(n?h.Localizer.Diagnostic.paramSpecUnknownParam().format({name:a}):h.Localizer.Diagnostic.typeVarUnknownParam().format({name:a}),t[i].valueExpression||e):t[i].valueExpression&&Ye(t[i].valueExpression)&&(o.details.isContravariant?be(h.Localizer.Diagnostic.typeVarVariance(),t[i].valueExpression):o.details.isContravariant=!0):t[i].valueExpression&&Ye(t[i].valueExpression)&&(o.details.isContravariant?be(h.Localizer.Diagnostic.typeVarVariance(),t[i].valueExpression):o.details.isCovariant=!0);else if(o.details.constraints.length>0)be(h.Localizer.Diagnostic.typeVarBoundAndConstrained(),t[i].valueExpression||e);else{const n=qt(t[i],Jt(e),!0);F.requiresSpecialization(n)&&be(h.Localizer.Diagnostic.typeVarGeneric(),t[i].valueExpression||e),o.details.boundType=F.convertToInstance(n)}l.set(a,a)}else{if(n){be(h.Localizer.Diagnostic.paramSpecUnknownArg(),t[i].valueExpression||e);break}if(o.details.boundType)be(h.Localizer.Diagnostic.typeVarBoundAndConstrained(),t[i].valueExpression||e);else{const n=qt(t[i],Jt(e));F.requiresSpecialization(n)&&be(h.Localizer.Diagnostic.typeVarGeneric(),t[i].valueExpression||e),x.TypeVarType.addConstraint(o,F.convertToInstance(n)),void 0===s&&(s=t[i])}}}return!n&&1===o.details.constraints.length&&s&&Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeVarSingleConstraint(),s.valueExpression||e),o}function Ye(e){if(11===e.nodeType){if(14===e.constType)return!1;if(31===e.constType)return!0}return be(h.Localizer.Diagnostic.expectedBoolLiteral(),e),!1}function Qe(e,t,n){const s=[n];let i=e;for(;i;)i=v.getEnclosingClass(i),i&&s.push(i.name.value);return s.push(t),s.reverse().join(".")}function Je(e,t,n){const s=Jt(e);let i="namedtuple";if(0===t.length)be(h.Localizer.Diagnostic.namedTupleFirstArg(),e);else{const n=t[0];0!==n.argumentCategory?be(h.Localizer.Diagnostic.namedTupleFirstArg(),t[0].valueExpression||e):n.valueExpression&&49===n.valueExpression.nodeType&&(i=n.valueExpression.strings.map(e=>e.value).join(""))}const r=ye(e,"NamedTuple")||x.UnknownType.create(),o=x.ClassType.create(i,Qe(e,s.moduleName,i),s.moduleName,0,e.id,void 0,x.isClass(r)?r.details.effectiveMetaclass:x.UnknownType.create());o.details.baseClasses.push(r);const a=o.details.fields;a.set("__class__",S.Symbol.createWithType(68,o));const l=x.FunctionType.createInstance("__new__","",65);l.details.declaredReturnType=x.ObjectType.create(o),v.isAssignmentToDefaultsFollowingNamedTuple(e)&&(l.details.flags|=32),x.FunctionType.addParameter(l,{category:0,name:"cls",type:o,hasDeclaredType:!0});const c={category:0,name:"self",type:x.ObjectType.create(o),hasDeclaredType:!0};let u=!1;const m=[];if(t.length<2)be(h.Localizer.Diagnostic.namedTupleSecondArg(),e),u=!0;else{const e=t[1];if(0!==e.argumentCategory)u=!0;else if(!n&&e.valueExpression&&49===e.valueExpression.nodeType)e.valueExpression.strings.map(e=>e.value).join("").split(/[,\s]+/).forEach(t=>{if(t=t.trim()){const i=x.UnknownType.create(),r={category:0,name:t,type:i,hasDeclaredType:n};x.FunctionType.addParameter(l,r);const o=S.Symbol.createWithType(8,i),c=e.valueExpression,u={type:1,node:c,path:s.filePath,range:p.convertOffsetsToRange(c.start,d.TextRange.getEnd(c),s.lines),moduleName:s.moduleName};o.addDeclaration(u),a.set(t,o),m.push(i)}});else if(e.valueExpression&&32===e.valueExpression.nodeType){const t=e.valueExpression,i=new Map;t.entries.forEach((e,t)=>{let r,o,c,u="";if(n)if(53===e.nodeType&&2===e.expressions.length){c=e.expressions[0],r=e.expressions[1];const t=ne(r,void 0,416);t&&(o=F.convertToInstance(t.type))}else be(h.Localizer.Diagnostic.namedTupleNameType(),e);else c=e,o=x.UnknownType.create();c&&49===c.nodeType?(u=c.strings.map(e=>e.value).join(""),u||be(h.Localizer.Diagnostic.namedTupleEmptyName(),c)):be(h.Localizer.Diagnostic.namedTupleNameString(),c||e),u||(u="_"+t.toString()),i.has(u)&&be(h.Localizer.Diagnostic.namedTupleNameUnique(),c||e),i.set(u,u),o||(o=x.UnknownType.create());const y={category:0,name:u,type:o,hasDeclaredType:n};x.FunctionType.addParameter(l,y),m.push(o);const g=S.Symbol.createWithType(8,o);if(c&&49===c.nodeType){const e={type:1,node:c,path:s.filePath,typeAnnotationNode:r,range:p.convertOffsetsToRange(c.start,d.TextRange.getEnd(c),s.lines),moduleName:s.moduleName};g.addDeclaration(e)}a.set(u,g)})}else u=!0}u&&(x.FunctionType.addDefaultParameters(l),m.push(x.AnyType.create(!1)),m.push(x.AnyType.create(!0)));const y=x.FunctionType.createInstance("__init__","",192);x.FunctionType.addParameter(y,c),x.FunctionType.addDefaultParameters(y),y.details.declaredReturnType=x.NoneType.createInstance(),a.set("__new__",S.Symbol.createWithType(4,l)),a.set("__init__",S.Symbol.createWithType(4,y));const g=x.FunctionType.createInstance("keys","",64),f=x.FunctionType.createInstance("items","",64);g.details.declaredReturnType=$t(e,"List",[$t(e,"str")]),f.details.declaredReturnType=g.details.declaredReturnType,a.set("keys",S.Symbol.createWithType(8,g)),a.set("items",S.Symbol.createWithType(8,f));const _=x.FunctionType.createInstance("__len__","",64);if(_.details.declaredReturnType=$t(e,"int"),x.FunctionType.addParameter(_,c),a.set("__len__",S.Symbol.createWithType(4,_)),u){const t=x.FunctionType.createInstance("__getattribute__","",64);t.details.declaredReturnType=x.AnyType.create(),x.FunctionType.addParameter(t,c),x.FunctionType.addParameter(t,{category:0,name:"name",type:$t(e,"str")}),a.set("__getattribute__",S.Symbol.createWithType(4,t))}return F.computeMroLinearization(o),Ue(o,m,!u),o}function Xe(e,t){const n={1:["__iadd__",0],34:["__isub__",33],27:["__imul__",26],14:["__ifloordiv__",13],11:["__itruediv__",10],25:["__imod__",24],30:["__ipow__",29],23:["__imatmul__",22],4:["__iand__",3],7:["__ior__",6],9:["__ixor__",8],18:["__ilshift__",17],32:["__irshift__",31]};let s;const i=F.makeTypeVarsConcrete(ne(e.leftExpression).type),r=F.makeTypeVarsConcrete(ne(e.rightExpression).type);return s=F.doForSubtypes(i,s=>F.doForSubtypes(r,i=>{if(x.isAnyOrUnknown(s)||x.isAnyOrUnknown(i))return x.isUnknown(s)||x.isUnknown(i)?x.UnknownType.create():x.AnyType.create();const r=n[e.operator][0];return et(s,[i],r,e,t)})),(!s||x.isNever(s))&&(s=Ze(n[e.operator][1],i,r,e,t)),s}function Ze(e,t,n,s,i){let r;const o=new l.DiagnosticAddendum;if(A[e])r=F.doForSubtypes(t,t=>F.doForSubtypes(n,n=>{if(x.isAnyOrUnknown(t)||x.isAnyOrUnknown(n))return x.isUnknown(t)||x.isUnknown(n)?x.UnknownType.create():x.AnyType.create();const r=A[e][0];let a=et(t,[n],r,s,i);if(a)return a;const l=A[e][1];return a=et(n,[t],l,s,i),a||o.addMessage(h.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:v.printOperator(e),leftType:Fn(t),rightType:Fn(n)})),a}));else if(w[e])r=F.doForSubtypes(t,t=>F.doForSubtypes(n,n=>{if(x.isAnyOrUnknown(t)||x.isAnyOrUnknown(n))return x.isUnknown(t)||x.isUnknown(n)?x.UnknownType.create():x.AnyType.create();const r=w[e][0],a=et(t,[n],r,s,i);return a||o.addMessage(h.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:v.printOperator(e),leftType:Fn(t),rightType:Fn(n)})),a}));else if(E[e])r=F.doForSubtypes(t,t=>F.doForSubtypes(n,n=>{if(x.isAnyOrUnknown(t)||x.isAnyOrUnknown(n))return x.isUnknown(t)||x.isUnknown(n)?x.UnknownType.create():x.AnyType.create();const r=E[e][0];let a=et(t,[n],r,s,i);if(a)return a;const l=E[e][1];return a=et(n,[t],l,s,i),a||o.addMessage(h.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:v.printOperator(e),leftType:Fn(t),rightType:Fn(n)})),a}));else if(N[e]){if(36===e){if(t=F.removeTruthinessFromType(t),x.isNever(t))return n}else if(37===e&&(t=F.removeFalsinessFromType(t),x.isNever(t)))return n;41===e||42===e?(r=F.doForSubtypes(n,n=>F.doForSubtypes(t,t=>{if(x.isAnyOrUnknown(n)||x.isAnyOrUnknown(t))return x.isUnknown(t)||x.isUnknown(n)?x.UnknownType.create():x.AnyType.create();let i=et(n,[t],"__contains__",s,void 0);if(!i){const e=he(n,!1,void 0,!1);e&&gn(e,t,new l.DiagnosticAddendum)&&(i=$t(s,"bool"))}return i||o.addMessage(h.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:v.printOperator(e),leftType:Fn(t),rightType:Fn(n)})),i})),r&&!x.isNever(r)&&(r=$t(s,"bool"))):r=F.doForSubtypes(t,t=>F.doForSubtypes(n,n=>36===e||37===e?x.combineTypes([t,n]):$t(s,"bool")))}return o.isEmpty()&&r&&!x.isNever(r)||(Ie(Jt(s).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:v.printOperator(e),leftType:Fn(t),rightType:Fn(n)})+o.getString(),s),r=x.UnknownType.create()),r}function et(e,t,n,s,i){let r=!0;const o=(e,o)=>{let a=9;o&&(a|=32);const c=oe(s,e,n,{method:"get"},new l.DiagnosticAddendum,a,o);if(c){const e=t.map(e=>({argumentCategory:0,type:e}));let n;return Ht(()=>{n=Ge(s,e,c,new P.TypeVarMap,!0,!0,i)}),n.argumentErrors&&(r=!1),n.returnType}r=!1},a=F.doForSubtypes(e,e=>{if(x.isAnyOrUnknown(e))return e;if(x.isObject(e))return o(e);if(x.isClass(e)){const t=e.details.effectiveMetaclass;if(t&&x.isClass(t))return o(x.ObjectType.create(t),e)}else if(x.isNone(e)){const e=$t(s,"object");if(x.isObject(e))return o(e)}r=!1});if(r)return a}function tt(e,t,n){const s=[],i=[];if(!x.isObject(t))return;if(x.ClassType.isTypedDictClass(t.classType))return nt(e,s,i,!!t,void 0,void 0,Sn(t.classType)),x.ClassType.isTypedDictClass(t.classType)&&function(e,t,n,s){a.assert(x.ClassType.isTypedDictClass(e)),a.assert(t.length===n.length);let i=!0;const r=Sn(e);return t.forEach((t,o)=>{if(x.isObject(t)&&x.ClassType.isBuiltIn(t.classType,"str")&&void 0!==t.classType.literalValue){const a=t.classType.literalValue,c=r.get(a);if(c){const e=new l.DiagnosticAddendum;gn(c.valueType,n[o],e)||(s.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldTypeMismatch().format({name:t.classType.literalValue,type:Fn(n[o])})),i=!1),c.isProvided=!0}else i=!1,s.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldUndefined().format({name:t.classType.literalValue,type:Fn(x.ObjectType.create(e))}))}else i=!1}),!!i&&(r.forEach((t,n)=>{t.isRequired&&!t.isProvided&&(s.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldRequired().format({name:n,type:Fn(x.ObjectType.create(e))})),i=!1)}),i)}(t.classType,s,i,n)?{type:t,node:e}:void 0;const r=$t(e,"Dict");if(!x.isObject(r))return;const o=new P.TypeVarMap;if(!qe(r.classType,t,o))return;const c=F.specializeType(r.classType,o);if(!c.typeArguments||2!==c.typeArguments.length)return;const p=F.specializeType(c.typeArguments[0],void 0),u=F.specializeType(c.typeArguments[1],void 0);nt(e,s,i,!!t,p,u);const d=x.isObject(t)&&x.ClassType.isBuiltIn(x.ClassType.getAliasClass(t.classType),"dict"),m=it(p,s,!1),y=it(u,i,!d);return m&&y?{type:$t(e,"Dict",[m,y]),node:e}:void 0}function nt(e,t,n,s,i,r,o){e.entries.forEach((e,a)=>{if(s&&a>=64)return;let c=!0;if(17===e.nodeType){let s,a=ne(e.keyExpression,i).type;if(i){const e=F.makeTypeVarsConcrete(i);x.isAnyOrUnknown(e)||gn(e,a,new l.DiagnosticAddendum,void 0)&&(a=e)}s=o&&x.isObject(a)&&x.ClassType.isBuiltIn(a.classType,"str")&&a.classType.literalValue&&o.has(a.classType.literalValue)?ne(e.valueExpression,o.get(a.classType.literalValue).valueType).type:ne(e.valueExpression,r).type,t.push(a),n.push(s),c=!1}else if(16===e.nodeType){const s=ne(e.expandExpression).type;if(x.isAnyOrUnknown(s))c=!1;else if(x.isObject(s)){const e=s.classType,i=x.ClassType.getAliasClass(e);if(x.ClassType.isBuiltIn(i,"dict")){const s=e.typeArguments;s&&s.length>=2&&(t.push(s[0]),n.push(s[1]),c=!1)}}}else if(33===e.nodeType){const s=ot(e);if(x.isObject(s)){const e=s.classType;if(F.isTupleClass(e)){const s=e.typeArguments;s&&2===s.length&&(t.push(s[0]),n.push(s[1]),c=!1)}}}c&&(t.push(x.UnknownType.create()),n.push(x.UnknownType.create()))})}function st(e,t){if(t=F.transformPossibleRecursiveTypeAlias(t),!x.isObject(t))return;const n=$t(e,"List");if(!x.isObject(n))return;const s=new P.TypeVarMap;if(!qe(n.classType,t,s))return;const i=F.specializeType(n.classType,s);if(!i.typeArguments||1!==i.typeArguments.length)return;const r=F.specializeType(i.typeArguments[0],void 0),o=[];e.entries.forEach((e,n)=>{(n<64||void 0!==t)&&(33===e.nodeType?o.push(ot(e,r)):o.push(ne(e,r).type))});const a=x.isObject(t)&&x.ClassType.isBuiltIn(x.ClassType.getAliasClass(t.classType),"list"),l=it(r,o,!a);return l?{type:$t(e,"List",[l]),node:e}:void 0}function it(e,t,n){const s=new l.DiagnosticAddendum,i=x.TypeVarType.createInstance("__typeArg",!1,!0);i.details.boundType=e;let r=new P.TypeVarMap;if(r.setTypeVar(i,e,n),!t.some(e=>!gn(i,F.stripLiteralValue(e),s,r))||(r=new P.TypeVarMap,r.setTypeVar(i,e,n),!t.some(e=>!gn(i,e,s,r))))return F.specializeType(F.specializeType(i,r),r)}function rt(e,t,n,s,i){if("none"===e)return;const r=n.value,o=x.removeUnboundFromUnion(s);if(x.isUnknown(o))Ie(e,t,h.Localizer.Diagnostic.typeUnknown().format({name:r}),i);else if(F.isPartlyUnknown(o)){const n=new l.DiagnosticAddendum;n.addMessage(h.Localizer.DiagnosticAddendum.typeOfSymbol().format({name:r,type:Fn(o,!0)})),Ie(e,t,h.Localizer.Diagnostic.typePartiallyUnknown().format({name:r})+n.getString(),i)}}function ot(e,t){for(const t of e.comprehensions)if(34===t.nodeType){const e=he(F.stripLiteralValue(ne(t.iterableExpression).type),!!t.isAsync,t.iterableExpression,!1);Fe(t.targetExpression,e,t.iterableExpression)}else a.assert(35===t.nodeType),Qt(t.testExpression)||ne(t.testExpression);let n=x.UnknownType.create();if(17===e.expression.nodeType){const t=F.stripLiteralValue(ne(e.expression.keyExpression).type),s=F.stripLiteralValue(ne(e.expression.valueExpression).type);n=Gt(e,"Tuple"),x.isClass(n)&&(n=F.convertToInstance(Me(n,[t,s],!0)))}else 16===e.expression.nodeType?ne(e.expression.expandExpression):m.isExpressionNode(e)&&(n=F.stripLiteralValue(ne(e.expression,t).type));return n}function at(e,t,n){const s=$t(e,t);return x.isObject(s)?x.ObjectType.create(x.ClassType.cloneWithLiteral(s.classType,n)):x.UnknownType.create()}function lt(e,t,n){const s=$t(e,t);return x.isObject(s)?x.ClassType.cloneWithLiteral(s.classType,n):x.UnknownType.create()}function ct(e,t,n,s=!1){const i=F.isTupleClass(e);t&&(t.forEach((e,n)=>{F.isEllipsisType(e.type)?i?2===t.length&&1===n||be(h.Localizer.Diagnostic.ellipsisSecondArg(),e.node):be(h.Localizer.Diagnostic.ellipsisContext(),e.node):x.isModule(e.type)?be(h.Localizer.Diagnostic.moduleContext(),e.node):!s&&F.isParamSpecType(e.type)&&be(h.Localizer.Diagnostic.paramSpecContext(),e.node)}),i&&1===t.length&&x.isObject(t[0].type)&&F.isTupleClass(t[0].type.classType)&&t[0].type.classType.typeArguments&&0===t[0].type.classType.typeArguments.length&&(t=[]));let r=t?t.map(e=>F.convertToInstance(e.type)):[];if(void 0!==n)if(t&&r.length>n)be(h.Localizer.Diagnostic.typeArgsTooMany().format({name:e.details.name,expected:n,received:r.length}),t[n].node),r=r.slice(0,n);else if(r.length<n)for(;r.length<n;)r.push(x.UnknownType.create());return i?(t||(r.push(x.AnyType.create(!1)),r.push(x.AnyType.create(!0))),Me(e,r,void 0!==t)):x.ClassType.cloneForSpecialization(e,r,void 0!==t)}function pt(e,t){const n=v.getEnclosingClass(e,!0);if(n){const s=yt(n);if(s&&x.ClassType.isEnumClass(s.classType)){if(x.ClassType.isBuiltIn(s.classType)){const e=s.classType.details.name;if(["Enum","IntEnum","Flag","IntFlag"].find(t=>t===e))return t}return x.ObjectType.create(x.ClassType.cloneWithLiteral(s.classType,new x.EnumLiteral(s.classType.details.name,e.value)))}}return t}function ut(e,t){if(!x.TypeBase.isInstantiable(e))return e;if(F.isTypeAliasPlaceholder(e))return e;let n=[];return x.isTypeVar(e)||F.doForSubtypes(e,e=>{F.addTypeVarsToListIfUnique(n,F.getTypeVarArgumentsRecursive(e))}),n=n.filter(e=>!e.details.isSynthesized),x.TypeBase.cloneForTypeAlias(e,t.value,n.length>0?n:void 0)}function dt(t,n,s){const i=Jt(t),r=x.ClassType.create(n,Qe(t,i.moduleName,n),i.moduleName,3,t.id,void 0,void 0);i.isTypingExtensionsStubFile&&(r.details.flags|=16384);const o=s.alias?s.alias:"object";let a;if("builtins"===s.module)a=Gt(t,o);else if("collections"===s.module){if(i.collectionsModulePath){const t=e(i.collectionsModulePath);if(t){const e=t.symbolTable.get(o);e&&(a=nn(e))}}}else if("self"===s.module){const e=Kt(t,o,!1);e&&(a=nn(e.symbol))}return a&&x.isClass(a)?(r.details.baseClasses.push(a),s.alias&&(r.details.aliasClass=a),r.details.effectiveMetaclass=a.details.effectiveMetaclass):(r.details.baseClasses.push(x.UnknownType.create()),r.details.effectiveMetaclass=x.UnknownType.create()),F.computeMroLinearization(r),r}function ht(e){var t;const n=Jt(e);if($(e))return;let s,i=$(e.rightExpression),r=!1;if(!i&&((n.isTypingStubFile||n.isTypingExtensionsStubFile)&&(i=function(e){if(39!==e.leftExpression.nodeType)return;const t=e.leftExpression.value;if("Any"===t)return x.AnyType.create();const n={overload:{alias:"",module:"builtins"},TypeVar:{alias:"",module:"builtins"},_promote:{alias:"",module:"builtins"},no_type_check:{alias:"",module:"builtins"},NoReturn:{alias:"",module:"builtins"},Counter:{alias:"Counter",module:"collections"},List:{alias:"list",module:"builtins"},Dict:{alias:"dict",module:"builtins"},DefaultDict:{alias:"defaultdict",module:"collections"},Set:{alias:"set",module:"builtins"},FrozenSet:{alias:"frozenset",module:"builtins"},Deque:{alias:"deque",module:"collections"},ChainMap:{alias:"ChainMap",module:"collections"},OrderedDict:{alias:"OrderedDict",module:"collections"}}[t];return n?dt(e,t,n):void 0}(e),i&&K(e.rightExpression,i)),!i)){const o=ue(e.leftExpression);let a,p=2;n.isStubFile&&(p|=1024);let u,d=!1;pe(e.leftExpression)?(p|=416,a=e.leftExpression.valueExpression):function(e){if(39===e.nodeType){const t=Kt(e,e.value,!1);if(t)return void 0!==t.symbol.getDeclarations().find(e=>T.isPossibleTypeAliasDeclaration(e))}return!1}(e.leftExpression)&&39===e.leftExpression.nodeType&&(a=e.leftExpression,d=!0),a&&(u=x.TypeVarType.createInstantiable("__type_alias_"+a.value,!1,!0),u.details.recursiveTypeAliasName=a.value,K(e,u),K(e.leftExpression,u));const m=ne(e.rightExpression,o,p);let y=m.type;s=m.expectedTypeDiagAddendum,m.isResolutionCyclical&&(r=!0);const g=C.evaluateStaticBoolExpression(e.rightExpression,n.executionEnvironment);if(void 0!==g){const t=$t(e,"bool");x.isObject(t)&&(y=x.ObjectType.create(x.ClassType.cloneWithLiteral(t.classType,g)))}o&&gn(o,y,new l.DiagnosticAddendum,new P.TypeVarMap)&&(y=bn(o,y)),i=y,39!==e.leftExpression.nodeType||e.typeAnnotationComment||(i=pt(e.leftExpression,i)),a&&(H(e),H(e.leftExpression),(!d||x.TypeBase.isInstantiable(i)&&!x.isAnyOrUnknown(i))&&(i=ut(i,a),F.isTypeAliasRecursive(u,i)&&Ie(n.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeAliasIsRecursive().format({name:a.value}),e.rightExpression),u.details.boundType=i,u.details.recursiveTypeParameters=null===(t=i.typeAliasInfo)||void 0===t?void 0:t.typeParameters))}r||(Fe(e.leftExpression,i,e.rightExpression,s),K(e,i))}function mt(e){if($(e))return;const t=Xe(e,void 0);Fe(e.destExpression,t,e.rightExpression),K(e,t)}function yt(e){const t=$(e.name);if(t){if(!x.isClass(t))return;return{classType:t,decoratedType:$(e)||x.UnknownType.create()}}const n=b.getScopeForNode(e),s=Jt(e);let i=0;(4===(null==n?void 0:n.type)||s.isTypingStubFile||s.isTypingExtensionsStubFile||s.isBuiltInStubFile)&&(i|=1,s.isTypingExtensionsStubFile&&(i|=16384),"property"===e.name.value&&(i|=512));const r=x.ClassType.create(e.name.value,Qe(e,s.moduleName,e.name.value),s.moduleName,i,e.id,void 0,void 0,v.getDocString(e.suite.statements)),o=null==n?void 0:n.lookUpSymbol(e.name.value);let p;const d=f.getDeclaration(e);d&&(p=d),p&&Z(o,p,r),r.details.flags|=32768,K(e,r),K(e.name,r);const m=[];let y,g=!1;const _=[];e.arguments.forEach(e=>{if(e.name&&"metaclass"!==e.name.value)if("total"===e.name.value&&x.ClassType.isTypedDictClass(r)){const t=C.evaluateStaticBoolExpression(e.valueExpression,s.executionEnvironment);void 0===t?be(h.Localizer.Diagnostic.typedDictTotalParam(),e.valueExpression):t||(r.details.flags|=32)}else _.push({argumentCategory:0,node:e,name:e.name,valueExpression:e.valueExpression});else{let t=43264;s.isStubFile&&(t|=4);let n=ne(e.valueExpression,void 0,t).type;const i=!!e.name;if(i&&(g&&be(h.Localizer.Diagnostic.metaclassDuplicate(),e),g=!0),10===n.category&&(n=x.removeUnboundFromUnion(n)),x.isAnyOrUnknown(n)||x.isUnbound(n)||(n=F.transformTypeObjectToClass(n),x.isClass(n)?(x.ClassType.isBuiltIn(n,"Protocol")&&(!s.isStubFile&&!x.ClassType.isTypingExtensionClass(n)&&s.executionEnvironment.pythonVersion<u.PythonVersion.V3_7&&be(h.Localizer.Diagnostic.protocolIllegal(),e.valueExpression),r.details.flags|=2048),x.ClassType.isBuiltIn(n,"property")&&(r.details.flags|=512),s.executionEnvironment.pythonVersion>=u.PythonVersion.V3_6&&x.ClassType.isBuiltIn(n,"NamedTuple")&&(r.details.flags|=4),x.ClassType.isBuiltIn(n,"TypedDict")||x.ClassType.isTypedDictClass(n)?r.details.flags|=16:x.ClassType.isTypedDictClass(r)&&!x.ClassType.isTypedDictClass(n)&&be(h.Localizer.Diagnostic.typedDictBaseClass(),e),F.derivesFromClassRecursive(n,r,!0)&&(be(h.Localizer.Diagnostic.baseClassCircular(),e),n=x.UnknownType.create())):(Ie(s.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.baseClassInvalid(),e),n=x.UnknownType.create())),x.isUnknown(n)&&Ie(s.diagnosticRuleSet.reportUntypedBaseClass,c.DiagnosticRule.reportUntypedBaseClass,h.Localizer.Diagnostic.baseClassUnknown(),e),i)(x.isClass(n)||x.isUnknown(n))&&(r.details.declaredMetaclass=n,x.isClass(n)&&(x.ClassType.isBuiltIn(n,"EnumMeta")?r.details.flags|=64:x.ClassType.isBuiltIn(n,"ABCMeta")&&(r.details.flags|=128)));else if(r.details.baseClasses.some(e=>x.isClass(e)&&x.isClass(n)&&x.ClassType.isSameGenericClass(n,e))&&Ie(s.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.duplicateBaseClass(),e.name||e),r.details.baseClasses.push(n),x.isClass(n)&&(x.ClassType.isEnumClass(n)&&(r.details.flags|=64),x.ClassType.supportsAbstractMethods(n)&&(r.details.flags|=128),x.ClassType.isPropertyClass(n)&&(r.details.flags|=512),x.ClassType.isFinal(n))){const t=kn(n);be(h.Localizer.Diagnostic.baseClassFinal().format({type:t}),e.valueExpression)}F.addTypeVarsToListIfUnique(m,F.getTypeVarArgumentsRecursive(n)),x.isClass(n)&&x.ClassType.isBuiltIn(n,"Generic")&&(y||(y=[],F.addTypeVarsToListIfUnique(y,F.getTypeVarArgumentsRecursive(n))))}}),x.ClassType.isBuiltIn(r,"object")||r.details.baseClasses.push(Gt(e,"object")),r.details.typeParameters=y||m,F.computeMroLinearization(r)||be(h.Localizer.Diagnostic.methodOrdering(),e.name);let T=r.details.declaredMetaclass,I=!1;if(!T||x.isClass(T))for(const t of r.details.baseClasses){if(!x.isClass(t)){T=x.UnknownType.create();break}{const n=t.details.effectiveMetaclass;if(!n||!x.isClass(n)){T=x.UnknownType.create();break}T?F.derivesFromClassRecursive(n,T,!0)?T=n:F.derivesFromClassRecursive(T,n,!0)||I||(Ie(s.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.metaclassConflict(),e.name),I=!0):T=n}}if(!T){const t=Gt(e,"type");T=t&&x.isClass(t)?t:x.UnknownType.create()}r.details.effectiveMetaclass=T;const D=b.getScopeForNode(e.suite);if(r.details.fields=(null==D?void 0:D.symbolTable)||new Map,x.ClassType.isTypedDictClass(r)&&me(e,r),!s.isStubFile&&0===r.details.typeParameters.length){const t=r.details.fields.get("__init__");if(t){const n=t.getTypedDeclarations();if(1===n.length&&3===n[0].type){const t=n[0].node,s=t.parameters;if(s.length>1&&!s.some((e,n)=>!!ce(t,n))){const t=s.filter((e,t)=>t>0&&e.name&&0===e.category);t.length>0&&(r.details.flags|=4096,r.details.typeParameters=t.map(t=>{const n=x.TypeVarType.createInstance("__type_of_"+t.name.value,!1,!0);return x.TypeVarType.cloneForScopeId(n,e.id)}))}}}}x.ClassType.supportsAbstractMethods(r)&&Cn(r).length>0&&(r.details.flags|=256);let k=r,A=!1;for(let t=e.decorators.length-1;t>=0;t--){const n=e.decorators[t],i=gt(k,r,n);x.isUnknown(i)?A||(Ie(s.diagnosticRuleSet.reportUntypedClassDecorator,c.DiagnosticRule.reportUntypedClassDecorator,h.Localizer.Diagnostic.classDecoratorTypeUnknown(),e.decorators[t].expression),A=!0):k=i}if(x.ClassType.isDataClass(r)){let t=x.ClassType.isSkipSynthesizedInit(r);if(!t){const e=F.lookUpClassMember(r,"__init__",2);if(e){const n=cn(e);5===n.category&&x.FunctionType.isSynthesizedMethod(n)||(t=!0)}}!function(e,t,n){a.assert(x.ClassType.isDataClass(t));const s=x.FunctionType.createInstance("__new__","",65),i=x.FunctionType.createInstance("__init__","",64);x.FunctionType.addParameter(s,{category:0,name:"cls",type:t,hasDeclaredType:!0}),x.FunctionType.addDefaultParameters(s),s.details.declaredReturnType=x.ObjectType.create(t);const r={category:0,name:"self",type:x.ObjectType.create(t),hasDeclaredType:!0};x.FunctionType.addParameter(i,r),i.details.declaredReturnType=x.NoneType.createInstance();const o=[],l=[],c=function(e,t){let n=!0;for(let s=e.details.mro.length-1;s>=0;s--){const i=e.details.mro[s];x.isClass(i)?x.ClassType.getDataClassEntries(i).forEach(e=>{const n=t.findIndex(t=>t.name===e.name);n>=0?t[n]=e:t.push(e)}):n=!1}return n}(t,l);c||x.FunctionType.addDefaultParameters(i);const p=[];e.suite.statements.forEach(n=>{48===n.nodeType&&n.statements.forEach(n=>{let s,i,r=!1,a=!0;if(3===n.nodeType){if(55===n.leftExpression.nodeType&&39===n.leftExpression.valueExpression.nodeType&&(s=n.leftExpression.valueExpression,i=()=>ie(n.leftExpression.typeAnnotation,!0)),r=!0,9===n.rightExpression.nodeType){const t=ne(n.rightExpression.leftExpression).type;if(6===t.category&&"field"===t.overloads[0].details.builtInName){const t=n.rightExpression.arguments.find(e=>{var t;return"init"===(null===(t=e.name)||void 0===t?void 0:t.value)});t&&t.valueExpression&&!1===C.evaluateStaticBoolExpression(t.valueExpression,Jt(e).executionEnvironment)&&(a=!1),r=n.rightExpression.arguments.some(e=>{var t,n;return"default"===(null===(t=e.name)||void 0===t?void 0:t.value)||"default_factory"===(null===(n=e.name)||void 0===n?void 0:n.value)})}}}else 55===n.nodeType&&39===n.valueExpression.nodeType&&(s=n.valueExpression,i=()=>ie(n.typeAnnotation,!0));if(s&&i){const e=s.value,n=t.details.fields.get(e);if(!(null==n?void 0:n.isClassVar())){const t={name:e,hasDefault:r,includeInInit:a,type:x.UnknownType.create()};p.push({entry:t,evaluator:i});let n=o.findIndex(t=>t.name===e);n>=0?o[n]=t:o.push(t),n=l.findIndex(t=>t.name===e),n>=0?l[n]=t:(l.push(t),n=l.length-1);const c=l.findIndex(e=>e.hasDefault&&e.includeInInit);a&&!r&&c>=0&&c<n&&be(h.Localizer.Diagnostic.dataClassFieldWithDefault(),s)}}})}),t.details.dataClassEntries=o,p.forEach(e=>{e.entry.type=e.evaluator()});const u=t.details.fields;!n&&c&&(l.forEach(e=>{if(e.includeInInit){const t={category:0,name:e.name,hasDefault:e.hasDefault,type:e.type,hasDeclaredType:!0};x.FunctionType.addParameter(i,t)}}),u.set("__init__",S.Symbol.createWithType(4,i)),u.set("__new__",S.Symbol.createWithType(4,s))),["__eq__","__ne__","__lt__","__le__","__gt__","__ge__"].forEach(n=>{const s=x.FunctionType.createInstance(n,"",64);x.FunctionType.addParameter(s,r),x.FunctionType.addParameter(s,{category:0,name:"x",type:"__eq__"===n||"__ne__"===n?$t(e,"object"):x.ObjectType.create(t),hasDeclaredType:!0}),s.details.declaredReturnType=$t(e,"bool"),u.set(n,S.Symbol.createWithType(4,s))});let d=Gt(e,"Dict");x.isClass(d)&&(d=x.ObjectType.create(x.ClassType.cloneForSpecialization(d,[$t(e,"str"),x.AnyType.create()],!1))),u.set("__dataclass_fields__",S.Symbol.createWithType(4,d)),Ue(t,l.map(e=>e.type),!0)}(e,r,t)}return r.details.flags&=-32769,K(e.name,r),K(e,k),_.length>0&&function(e,t,n){const s=n[0].node.name,i=Oe(s,t,"__init_subclass__",{method:"get"},new l.DiagnosticAddendum,13);if(i){const e=In(t,i.type,!0,s),r=new P.TypeVarMap;e&&Ge(s,n,e,r,!1,!0,x.NoneType.createInstance())}}(0,r,_),{classType:r,decoratedType:k}}function gt(e,t,n){const s=ne(n.expression).type;if(6===s.category)"dataclass"===s.overloads[0].details.builtInName&&(t.details.flags|=4);else if(5===s.category){if(9===n.expression.nodeType){const s=ne(n.expression.leftExpression).type;if(6===s.category&&"dataclass"===s.overloads[0].details.builtInName){let s=!1;return n.expression.arguments&&n.expression.arguments.forEach(e=>{if(e.name&&"init"===e.name.value&&e.valueExpression){const t=Jt(n);C.evaluateStaticBoolExpression(e.valueExpression,t.executionEnvironment)||(s=!0)}}),t.details.flags|=4,s&&(t.details.flags|=8),e}}"final"===s.details.builtInName?t.details.flags|=1024:"runtime_checkable"===s.details.builtInName&&(t.details.flags|=8192)}return re(n,e)}function ft(e){const n=Jt(e),s=$(e.name);if(s){if(!x.isFunction(s))return;return{functionType:s,decoratedType:$(e)||x.UnknownType.create()}}let i;const r=f.getDeclaration(e);r&&(i=r);const o=v.getEnclosingClass(e,!0);let a;if(o){const e=yt(o);if(!e)return;a=e.classType}let p=vt(e,!!o);(null==i?void 0:i.isGenerator)&&(p|=16),n.isStubFile?p|=2048:n.isInPyTypedPackage&&t.disableInferenceForPyTypedSources&&(p|=4096),e.isAsync&&(p|=512);const u=x.FunctionType.createInstance(e.name.value,n.moduleName,p,v.getDocString(e.suite.statements));(n.isBuiltInStubFile||n.isTypingStubFile||n.isTypingExtensionsStubFile)&&(u.details.builtInName=e.name.value),u.details.declaration=i;const d=b.getScopeForNode(e),m=null==d?void 0:d.lookUpSymbol(e.name.value);i&&Z(m,i,u),K(e,u),K(e.name,u);const y=a&&x.ClassType.isPseudoGenericClass(a)&&"__init__"===e.name.value,g=[];let _=0,T=0;if(a&&0==(4&u.details.flags)&&(T=1),e.functionAnnotationComment&&!e.functionAnnotationComment.isParamListEllipsis){const t=e.parameters.length-T,n=e.functionAnnotationComment.paramTypeAnnotations.length;T>0&&n===e.parameters.length?T=0:n!==t&&be(h.Localizer.Diagnostic.annotatedParamCountMismatch().format({expected:t,received:n}),e.functionAnnotationComment)}if(e.parameters.forEach((t,s)=>{let i,r,o,p,d,m=!1;if(t.typeAnnotation)p=t.typeAnnotation;else if(t.typeAnnotationComment)p=t.typeAnnotationComment;else if(e.functionAnnotationComment&&!e.functionAnnotationComment.isParamListEllipsis){const t=s-T;t>=0&&t<e.functionAnnotationComment.paramTypeAnnotations.length&&(p=e.functionAnnotationComment.paramTypeAnnotations[t])}if(p&&(r=ie(p,!1,!0)),!r&&y&&s>0&&0===t.category&&t.name&&(r=a.details.typeParameters[_],_++),r&&(t.defaultValue&&11===t.defaultValue.nodeType&&24===t.defaultValue.constType&&(m=!0,n.diagnosticRuleSet.strictParameterNoneValue||(r=x.combineTypes([r,x.NoneType.createInstance()]))),o=F.specializeType(r,void 0)),t.defaultValue&&(d=ne(t.defaultValue,r,1).type),r){if(t.defaultValue&&d&&o){const e=new l.DiagnosticAddendum;if(!gn(o,d,e)){const s=Ie(n.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.paramAssignmentMismatch().format({sourceType:Fn(d),paramType:Fn(r)})+e.getString(),t.defaultValue);if(m&&p){const e={action:"pyright.addoptionalforparam",offsetOfTypeNode:p.start+1};s&&s.addAction(e)}}}i=r}const f={category:t.category,name:t.name?t.name.value:void 0,hasDefault:!!t.defaultValue,defaultType:d,type:i||x.UnknownType.create(),hasDeclaredType:!!p};if(x.FunctionType.addParameter(u,f),t.name){const n=Tt(e,t.category,f.type);g.push(n)}else g.push(f.type)}),o&&a&&u.details.parameters.length>0&&!ce(e,0)){const e=_t(u.details.flags,a,o);e&&(u.details.parameters[0].type=e,x.isAnyOrUnknown(e)||(u.details.parameters[0].isTypeInferred=!0),g[0]=e)}if(g.forEach((t,n)=>{const s=e.parameters[n].name;s&&(x.isUnknown(t)&&(u.details.flags|=16384),K(s,t))}),e.returnTypeAnnotation){u.details.declaredReturnType=x.UnknownType.create();const t=ie(e.returnTypeAnnotation,!1,!0);u.details.declaredReturnType=t}else if(e.functionAnnotationComment){u.details.declaredReturnType=x.UnknownType.create();const t=ie(e.functionAnnotationComment.returnTypeAnnotation,!1,!0);u.details.declaredReturnType=t}else n.isStubFile&&("__init__"===e.name.value?u.details.declaredReturnType=x.NoneType.createInstance():u.details.declaredReturnType=x.UnknownType.create());let C=e.isAsync?function(e,t){const n=x.FunctionType.clone(t);return t.details.declaredReturnType&&(n.details.declaredReturnType=St(e,t.details.declaredReturnType)),n.details.flags|=1024,n}(e,u):u,S=!1;for(let t=e.decorators.length-1;t>=0;t--){const s=bt(C,0,e.decorators[t],e);x.isUnknown(s)?S||(Ie(n.diagnosticRuleSet.reportUntypedFunctionDecorator,c.DiagnosticRule.reportUntypedFunctionDecorator,h.Localizer.Diagnostic.functionDecoratorTypeUnknown(),e.decorators[t].expression),S=!0):C=s}return 5===C.category&&(C=function(e,t){let n;const s=f.getDeclaration(e);s&&(n=s);const i=Kt(e,e.name.value,!1);if(i){const s=i.symbol.getDeclarations();let r=s.findIndex(e=>e===n);if(r>0){const n=[t];for(;r>0;){const e=s[r-1];if(3!==e.type)break;const t=ft(e.node);if(!t)break;if(5===t.decoratedType.category){if(!x.FunctionType.isOverloaded(t.decoratedType))break;n.unshift(t.decoratedType)}else{if(6!==t.decoratedType.category)break;{const e=t.decoratedType.overloads[t.decoratedType.overloads.length-1];if(!x.FunctionType.isOverloaded(e))break;n.unshift(e)}}r--}if(n.length>1){const s=x.OverloadedFunctionType.create();s.overloads=n;const i=n[n.length-2];return x.FunctionType.isAbstractMethod(i)!==x.FunctionType.isAbstractMethod(t)&&Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.overloadAbstractMismatch().format({name:e.name.value}),e.name),s}}}return t}(e,C)),K(e.name,u),K(e,C),{functionType:u,decoratedType:C}}function _t(e,t,n){if(0==(4&e)&&t){if(3&e){const e=x.TypeVarType.createInstance("__type_of_cls_"+t.details.name,!1,!0);return e.scopeId=x.TypeVarType.makeScopeId(e.details.name,n.id),e.details.boundType=F.selfSpecializeClassType(t,!0),e}if(0==(4&e)){const e=x.TypeVarType.createInstance("__type_of_self_"+t.details.name,!1,!0);return e.scopeId=x.TypeVarType.makeScopeId(e.details.name,n.id),e.details.boundType=x.ObjectType.create(F.selfSpecializeClassType(t,!0)),e}}}function Tt(e,t,n){switch(t){case 0:return n;case 1:{const t=ye(e,"Tuple");return t&&x.isClass(t)?x.ObjectType.create(x.ClassType.cloneForSpecialization(t,[n,x.AnyType.create(!0)],!1)):x.UnknownType.create()}case 2:{const t=Gt(e,"Dict"),s=$t(e,"str");return x.isClass(t)&&x.isObject(s)?x.ObjectType.create(x.ClassType.cloneForSpecialization(t,[s,n],!1)):x.UnknownType.create()}}}function vt(e,t){const n=Jt(e);let s=0;"__new__"===e.name.value&&t&&(s|=1),"__init_subclass__"===e.name.value&&t&&(s|=2);for(const i of e.decorators){let e=2;n.isStubFile&&(e|=4);const r=ne(i.expression,void 0,e).type;5===r.category?"abstractmethod"===r.details.builtInName?t&&(s|=8):"final"===r.details.builtInName&&(s|=8192):x.isClass(r)&&(x.ClassType.isBuiltIn(r,"staticmethod")?t&&(s|=4):x.ClassType.isBuiltIn(r,"classmethod")&&t&&(s|=2))}return s}function bt(e,t,n,s){let i=2;Jt(n).isStubFile&&(i|=4);const r=ne(n.expression,void 0,i).type;if(x.isClass(r)&&x.ClassType.isSpecialBuiltIn(r,"overload")&&5===e.category)return e.details.flags|=256,e;const o=re(n,e);if(5===r.category){if("abstractmethod"===r.details.builtInName)return e;if(36===n.expression.nodeType){const t=ne(n.expression.leftExpression).type;if(F.isProperty(t)){const i=n.expression.memberName.value;if("setter"===i)return x.isFunction(e)?(Ct(e,n),function(e,t,n){if(!F.isProperty(e))return e;const s=e.classType,i=x.ClassType.create(s.details.name,s.details.fullName,s.details.moduleName,s.details.flags,s.details.typeSourceId,s.details.declaredMetaclass,s.details.effectiveMetaclass);F.computeMroLinearization(i);const r=x.ObjectType.create(i),o=i.details.fields;if(s.details.fields.forEach((e,t)=>{e.isIgnoredForProtocolMatch()||o.set(t,e)}),n.parameters.length>=2){const e=ce(n,1);if(e){const t=hn(s,!1);if(t&&!x.isAnyOrUnknown(t)){const s=ie(e),i=new l.DiagnosticAddendum;gn(t,s,i,void 0,32)||Ie(Jt(n).diagnosticRuleSet.reportPropertyTypeMismatch,c.DiagnosticRule.reportPropertyTypeMismatch,h.Localizer.Diagnostic.setterGetterTypeMismatch()+i.getString(),e)}}}const a=S.Symbol.createWithType(4,t);o.set("fset",a);const p=x.FunctionType.createInstance("__set__","",64);p.details.parameters.push({category:0,name:"self",type:e,hasDeclaredType:!0}),p.details.parameters.push({category:0,name:"obj",type:t.details.parameters.length>0?t.details.parameters[0].type:x.AnyType.create(),hasDeclaredType:!0}),p.details.declaredReturnType=x.NoneType.createInstance();let u=x.UnknownType.create();t.details.parameters.length>=2&&0===t.details.parameters[1].category&&t.details.parameters[1].name&&(u=t.details.parameters[1].type),p.details.parameters.push({category:0,name:"value",type:u,hasDeclaredType:!0});const d=S.Symbol.createWithType(4,p);return o.set("__set__",d),r}(t,e,s)):e;if("deleter"===i)return x.isFunction(e)?(Ct(e,n),function(e,t){if(!F.isProperty(e))return e;const n=e.classType,s=x.ClassType.create(n.details.name,n.details.fullName,n.details.moduleName,n.details.flags,n.details.typeSourceId,n.details.declaredMetaclass,n.details.effectiveMetaclass);F.computeMroLinearization(s);const i=x.ObjectType.create(s),r=s.details.fields;n.details.fields.forEach((e,t)=>{e.isIgnoredForProtocolMatch()||r.set(t,e)});const o=S.Symbol.createWithType(4,t);r.set("fdel",o);const a=x.FunctionType.createInstance("__delete__","",64);a.details.parameters.push({category:0,name:"self",type:e,hasDeclaredType:!0}),a.details.parameters.push({category:0,name:"obj",type:t.details.parameters.length>0?t.details.parameters[0].type:x.AnyType.create(),hasDeclaredType:!0}),a.details.declaredReturnType=x.NoneType.createInstance();const l=S.Symbol.createWithType(4,a);return r.set("__delete__",l),i}(t,e)):e}}}else if(x.isClass(r)){if(x.ClassType.isBuiltIn(r))switch(r.details.name){case"classmethod":case"staticmethod":return e}if(x.ClassType.isPropertyClass(r))return 5===e.category?(Ct(e,n),function(e,t,n,s){const i=Jt(e),r=Gt(e,"type"),o=x.ClassType.create(t,Qe(e,i.moduleName,t),i.moduleName,512,s,void 0,x.isClass(r)?r:x.UnknownType.create());F.computeMroLinearization(o);const a=x.ObjectType.create(o),l=o.details.fields,c=S.Symbol.createWithType(4,n);l.set("fget",c);const p=x.FunctionType.createInstance("__get__","",320);p.details.parameters.push({category:0,name:"self",type:a,hasDeclaredType:!0}),p.details.parameters.push({category:0,name:"obj",type:x.NoneType.createInstance(),hasDeclaredType:!0}),p.details.parameters.push({category:0,name:"type",type:x.AnyType.create(),hasDeclaredType:!0,hasDefault:!0,defaultType:x.AnyType.create()}),p.details.declaredReturnType=a,p.details.declaration=n.details.declaration;const u=x.FunctionType.createInstance("__get__","",320);u.details.parameters.push({category:0,name:"self",type:a,hasDeclaredType:!0}),u.details.parameters.push({category:0,name:"obj",type:n.details.parameters.length>0?n.details.parameters[0].type:x.AnyType.create(),hasDeclaredType:!0}),u.details.parameters.push({category:0,name:"type",type:x.AnyType.create(),hasDeclaredType:!0,hasDefault:!0,defaultType:x.AnyType.create()}),u.details.declaredReturnType=n.details.declaredReturnType,u.details.declaration=n.details.declaration;const d=x.OverloadedFunctionType.create([p,u]),h=S.Symbol.createWithType(4,d);return l.set("__get__",h),["getter","setter","deleter"].forEach(e=>{const t=x.FunctionType.createInstance(e,"",64);t.details.parameters.push({category:0,name:"self",type:a,hasDeclaredType:!0}),t.details.parameters.push({category:0,name:"accessor",type:x.AnyType.create(),hasDeclaredType:!0}),t.details.declaredReturnType=a;const n=S.Symbol.createWithType(4,t);l.set(e,n)}),a}(n,r.details.name,e,n.id)):x.UnknownType.create()}return 5===e.category&&5===o.category&&x.FunctionType.isOverloaded(e)&&(o.details.flags|=256),o}function Ct(e,t){(x.FunctionType.isStaticMethod(e)||x.FunctionType.isClassMethod(e))&&Ie(Jt(t).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.propertyStaticOrClassMethod(),t)}function St(e,t){let n;if(x.isObject(t)){const s=t.classType;if(x.ClassType.isBuiltIn(s))if("Generator"===s.details.name){const t=ye(e,"AsyncGenerator");if(t&&x.isClass(t)){const e=[],i=s.typeArguments;i&&i.length>0&&e.push(i[0]),i&&i.length>1&&e.push(i[1]),n=x.ObjectType.create(x.ClassType.cloneForSpecialization(t,e,!1))}}else["AsyncGenerator","AsyncIterator","AsyncIterable"].some(e=>e===s.details.name)&&(n=t)}if(!n){const s=ye(e,"Coroutine");s&&x.isClass(s)?(F.isNoReturnType(t)&&(t=x.AnyType.create()),n=x.ObjectType.create(x.ClassType.cloneForSpecialization(s,[x.AnyType.create(),x.AnyType.create(),t],!0))):n=x.UnknownType.create()}return n}function It(e,t){var n;const s=e.returnTypeAnnotation||(null===(n=e.functionAnnotationComment)||void 0===n?void 0:n.returnTypeAnnotation);a.assert(!s);let r=$(e.suite);if(r)return r;if(!i.has(e.id)){i.set(e.id,!0);try{let n;const s=f.getDeclaration(e);s&&(n=s);const o=!_e(e),a=_e(e.suite);if(Jt(e).isStubFile)r=x.UnknownType.create();else{if(o)if(t||function(e){if(!e||!e.isMethod||e.returnStatements||e.yieldStatements||!e.raiseStatements)return!1;for(const t of e.raiseStatements){if(!t.typeExpression||t.valueExpression)return!1;const e=ne(t.typeExpression).type,n=x.isClass(e)?e:x.isObject(e)?e.classType:void 0;if(!n||!x.ClassType.isBuiltIn(n,"NotImplementedError"))return!1}return!0}(n))r=x.UnknownType.create();else{const t=ye(e,"NoReturn");r=t&&x.isClass(t)?x.ObjectType.create(t):x.UnknownType.create()}else{const e=[];(null==n?void 0:n.returnStatements)&&n.returnStatements.forEach(t=>{if(fe(t))if(t.returnExpression){const n=ne(t.returnExpression).type;e.push(n||x.UnknownType.create())}else e.push(x.NoneType.createInstance())}),!o&&a&&e.push(x.NoneType.createInstance()),r=x.combineTypes(e),r=x.removeUnboundFromUnion(r)}if(null==n?void 0:n.yieldStatements){const t=[];n.yieldStatements.forEach(e=>{if(fe(e))if(62===e.nodeType){const n=he(ne(e.expression).type,!1,e,!1);t.push(n||x.UnknownType.create())}else if(e.expression){const n=ne(e.expression).type;t.push(n||x.UnknownType.create())}else t.push(x.NoneType.createInstance())}),0===t.length&&t.push(x.NoneType.createInstance());const s=x.combineTypes(t),i=ye(e,"Generator");r=i&&x.isClass(i)?x.ObjectType.create(x.ClassType.cloneForSpecialization(i,[s,x.NoneType.createInstance(),F.isNoReturnType(r)?x.NoneType.createInstance():r],!1)):x.UnknownType.create()}}K(e.suite,r)}finally{i.delete(e.id)}}return r}function Dt(e){if($(e))return;const t=he(ne(e.iterableExpression).type,!!e.isAsync,e.iterableExpression,!e.isAsync);Fe(e.targetExpression,t,e.targetExpression),K(e,t)}function kt(e){if(a.assert(void 0!==e.typeExpression),$(e))return;const t=ne(e.typeExpression).type;function n(e,t){if(x.isAnyOrUnknown(e))return e;if(x.isObject(e)&&(e=F.transformTypeObjectToClass(e)),x.isClass(e))return x.ObjectType.create(e);if(x.isObject(e)){const n=he(e,!1,t,!1);return F.doForSubtypes(n,e=>{if(x.isAnyOrUnknown(e))return e;const t=F.transformTypeObjectToClass(e);return x.isClass(t)?x.ObjectType.create(t):x.UnknownType.create()})}return x.UnknownType.create()}const s=F.doForSubtypes(t,t=>{const s=F.getSpecializedTupleType(t);if(s&&s.typeArguments){const t=s.typeArguments.map(t=>n(t,e.typeExpression));return x.combineTypes(t)}return n(t,e.typeExpression)});e.name&&Fe(e.name,s),K(e,s)}function xt(e){if($(e))return;let t=ne(e.expression).type;const n=e.parent&&59===e.parent.nodeType&&!!e.parent.isAsync;F.isOptionalType(t)&&(Ie(Jt(e).diagnosticRuleSet.reportOptionalContextManager,c.DiagnosticRule.reportOptionalContextManager,h.Localizer.Diagnostic.noneNotUsableWith(),e.expression),t=x.removeNoneFromUnion(t));const s=n?"__aenter__":"__enter__",i=F.doForSubtypes(t,t=>{if(t=F.makeTypeVarsConcrete(t),x.isAnyOrUnknown(t))return t;const i=new l.DiagnosticAddendum,r=new l.DiagnosticAddendum;if(x.isObject(t)){const o=oe(e.expression,t,s,{method:"get"},i,0);if(o){let t;return t=5===o.category?on(o):x.UnknownType.create(),n&&(t=de(t,e)),t}n||oe(e.expression,t,"__aenter__",{method:"get"},i,0)&&r.addMessage(h.Localizer.DiagnosticAddendum.asyncHelp())}return Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotUsableWith().format({type:Fn(t),method:s})+r.getString(),e.expression),x.UnknownType.create()}),r=n?"__aexit__":"__exit__";F.doForSubtypes(t,t=>{if(t=F.makeTypeVarsConcrete(t),x.isAnyOrUnknown(t))return;const n=new l.DiagnosticAddendum;x.isObject(t)&&oe(e.expression,t,r,{method:"get"},n,0)||Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeNotUsableWith().format({type:Fn(t),method:r}),e.expression)}),e.target&&Fe(e.target,i,e.target),K(e,i)}function Ft(e){if($(e))return;let t;if(t=e.alias?e.alias:e.module.nameParts[0],!t)return;let n=wt(e,t.value)||x.UnknownType.create();const s=$(e);s&&x.isModule(s)&&n&&x.isTypeSame(n,s)&&(n=s),ke(t,n),K(e,n)}function Pt(t){if($(t))return;const n=t.alias||t.name;let s=wt(t,n.value);if(!s){const n=t.parent;a.assert(n&&22===n.nodeType),a.assert(!n.isWildcardImport);const i=f.getImportInfo(n.module);if(i&&i.isImportFound&&!i.isNativeLib){const n=i.resolvedPaths[i.resolvedPaths.length-1],s=e(n),r=Jt(t);let o=!1;s?(r.executionEnvironment.pythonVersion<u.PythonVersion.V3_7||!s.symbolTable.get("__getattr__"))&&(o=!0):n||(o=!0),o&&Ie(r.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.importSymbolUnknown().format({name:t.name.value}),t.name)}s=x.UnknownType.create()}ke(n,s),K(t,s)}function At(e){if($(e))return;const t=e.module.nameParts[0];let n=wt(e,t.value)||x.UnknownType.create();const s=$(e);s&&x.isModule(s)&&n&&x.isTypeSame(n,s)&&(n=s),ke(t,n),K(e,n)}function wt(e,t){const n=Kt(e,t,!0);if(!n)return;let s=n.symbol.getDeclarations().find(t=>t.node===e);if(s||(s=n.symbol.getDeclarations().find(e=>6===e.type)),!s)return;a.assert(6===s.type);const i=tn(s,!0);return i?en(s):i}function Et(e){let t=e,n=e;function s(e){return!(42!==e.nodeType||!e.parent||31!==e.parent.nodeType)||!(1!==e.nodeType||!e.parent||9!==e.parent.nodeType)||9===e.nodeType||15===e.nodeType||28===e.nodeType||32===e.nodeType||31===e.nodeType||36===e.nodeType||46===e.nodeType||50===e.nodeType||53===e.nodeType||57===e.nodeType||17===e.nodeType||16===e.nodeType||33===e.nodeType}for(;n;){const e=s(n);if(!e&&!m.isExpressionNode(n))break;e&&(t=n),n=n.parent}const i=t.parent;if(3===i.nodeType)return void(t===i.typeAnnotationComment?ie(t,v.isFinalAllowedForAssignmentTarget(i.leftExpression)):ht(i));if(5===i.nodeType)return void mt(i);const r=e=>{const t=e.parent;if(3===(null==t?void 0:t.nodeType)&&t.leftExpression===i)ht(t);else{const t=ie(e.typeAnnotation,v.isFinalAllowedForAssignmentTarget(e.valueExpression));t&&K(e.valueExpression,t)}};if(55===i.nodeType)return void r(i);if(38===i.nodeType)return;if(1===i.nodeType&&t===i.name)return;if(45===i.nodeType&&i.returnExpression){const t=v.getEnclosingFunction(e),n=t?ln(t):void 0;return void ne(i.returnExpression,n,0)}const o=m.isExpressionNode(i)&&0!==i.nodeType?i:t;55===o.nodeType?r(o):ne(o)}function Nt(e){a.assert(void 0!==e.name);const t=e.parent;if(31===t.nodeType)return void Et(t);a.assert(29===t.nodeType);const n=t,s=n.parameters.findIndex(t=>t===e),i=ce(n,s);if(i)K(e.name,Tt(e,e.category,ie(i,!1,!0)));else{if(0===s){const t=v.getEnclosingClass(n,!0);if(t){const s=yt(t);if(s){const i=_t(vt(n,!0),s.classType,t);return void K(e.name,i||x.UnknownType.create())}}}K(e.name,Tt(e,e.category,x.UnknownType.create()))}}function Ot(e){let t=e;for(;t;){switch(t.nodeType){case 3:if(!t.parent||3!==t.parent.nodeType&&4!==t.parent.nodeType&&5!==t.parent.nodeType||t.parent.rightExpression!==t)return void ht(t);break;case 4:return void ne(t);case 5:return void mt(t);case 10:return void yt(t);case 42:return void Nt(t);case 31:return void Et(t);case 29:return void ft(t);case 27:return void Dt(t);case 26:return void kt(t);case 60:return void xt(t);case 34:{const e=t.parent;return a.assert(33===e.nodeType),void Et(e)}case 21:return void Ft(t);case 23:return void Pt(t);case 22:return void At(t)}t=t.parent}a.fail("Unexpected assignment target")}function Rt(e,t){const n=f.getImportInfo(e.node.module);a.assert(void 0!==n&&n.isImportFound),a.assert(e.node.isWildcardImport);const s=Kt(e.node,t,!1);a.assert(void 0!==s);const i=s.symbol.getDeclarations().find(t=>t.node===e.node);return i&&en(i)||x.UnknownType.create()}function Lt(e){if(r.has(e.id))return r.get(e.id);r.set(e.id,!1);let t=!1;const n=function e(t){if(39===t.nodeType){const e=Kt(t,t.value,!1);if(!e)return;const n=e.symbol,s=rn(n);if(s)return s;const i=n.getDeclarations();if(0===i.length)return;const r=i[i.length-1];return 2===r.type?(Nt(r.node),$(r.node.name)):6===r.type?en(r):void 0}if(36===t.nodeType){const n=t.memberName.value;let s,i=e(t.leftExpression);if(!i)return;if(i=F.makeTypeVarsConcrete(i),x.isModule(i))s=x.ModuleType.getField(i,n);else if(x.isClass(i)){const e=F.lookUpClassMember(i,n);s=e?e.symbol:void 0}else if(x.isObject(i)){const e=F.lookUpClassMember(i.classType,n);s=e?e.symbol:void 0}if(!s)return;return rn(s)}}(e.leftExpression);if(n){let e;if(5===n.category)e=n;else if(6===n.category){const t=n;e=t.overloads[t.overloads.length-1]}e&&!x.FunctionType.isAsync(e)&&(e.details.declaredReturnType?t=F.isNoReturnType(e.details.declaredReturnType):e.inferredReturnType?t=F.isNoReturnType(e.inferredReturnType):e.details.declaration&&(e.details.declaration.yieldStatements||x.FunctionType.isAbstractMethod(e)||x.FunctionType.isStubDefinition(e)||x.FunctionType.isPyTypedDefinition(e)||(t=!_e(e.details.declaration.node))))}return r.set(e.id,t),t}function Mt(e,t,n){const s=_.createKeyForReference(e),i=v.getExecutionScopeNode(e),r=f.getCodeFlowExpressions(i);if(a.assert(void 0!==r),!r.has(s))return;const o=v.getExecutionScopeNode(e);let l;Y(o)?l=function(){const e=W.length;return a.assert(e>0),W[e-1].codeFlowAnalyzer}():(l=R.get(o.id),l||(l=Ut(),R.set(o.id,l)));const c=U.isIncompleteTypeMode(),p=l.getTypeFromCodeFlow(e,t,n);return p.isIncomplete?U.enterIncompleteTypeMode():c||U.leaveIncompleteTypeMode(),p.type}function Ut(){const e=new Map;return{getTypeFromCodeFlow:function(t,n,s){const i=f.getFlowNode(t),r=_.createKeyForReference(t)+"."+n.toString();let o=e.get(r);function l(e,t,n){if(n){const n=o.get(e.id);if(void 0===n)B++;else if(t&&n.isIncompleteType){const e=n;e.type&&!x.isTypeSame(e.type,t)&&B++}}else B++;const s=n?{isIncompleteType:!0,type:t,incompleteSubtypes:[],generationCount:B}:t;return o.set(e.id,s),M.trackEntry(o,e.id),{type:t,isIncomplete:n,generationCount:B,incompleteSubtypes:n?[]:void 0}}function c(e,t,n){const s=o.get(e.id);void 0!==s&&k.isIncompleteType(s)||a.fail("setIncompleteSubtype can be called only on a valid incomplete cache entry");const i=s.incompleteSubtypes;return t<i.length?i[t]=n:(a.assert(i.length===t),i.push(n)),B++,u(e)}function p(e){o.delete(e.id)}function u(e){if(!o.has(e.id))return;const t=o.get(e.id);if(void 0===t)return{type:t,isIncomplete:!1};if(!k.isIncompleteType(t))return{type:t,isIncomplete:!1};let n=t.type;if(t.incompleteSubtypes.length>0){const e=[];t.incompleteSubtypes.forEach(t=>{t&&e.push(t)}),n=e.length>0?x.combineTypes(e):void 0}return{type:n,isIncomplete:!0,incompleteSubtypes:t.incompleteSubtypes,generationCount:t.generationCount}}function d(e){let t=e.node;const n=e.node.parent;n&&(29!==n.nodeType&&10!==n.nodeType||(t=n));let s=$(t);return s||(Ot(e.node),s=$(t)),s}return o||(o=new Map,e.set(r,o)),i?function e(t,n,s,i){let r=t;for(G();;){const t=u(r);if(t&&(!t.isIncomplete||t.generationCount===B))return t;if(r.flags&_.FlowFlags.Unreachable)return l(r,void 0,!1);if(r.flags&_.FlowFlags.Call){const e=r;if(Lt(e.node))return l(r,void 0,!1);r=e.antecedent}else if(r.flags&_.FlowFlags.Assignment){const e=r;if(s===e.targetSymbolId&&v.isMatchingExpression(n,e.node)){if(r.flags&_.FlowFlags.Unbind)return l(r,x.UnboundType.create(),!1);if(t)return{type:void 0,isIncomplete:!0};l(r,void 0,!0);let n=d(e);return n&&F.isTypeAliasPlaceholder(n)&&(n=void 0),l(r,n,!1)}r=e.antecedent}else if(r.flags&_.FlowFlags.AssignmentAlias){const e=r;s===e.targetSymbolId&&(s=e.aliasSymbolId),r=e.antecedent}else{if(r.flags&_.FlowFlags.BranchLabel){const t=[];let o=!1;r.antecedents.forEach(r=>{const a=e(r,n,s,i);a.isIncomplete&&(o=!0),a.type&&t.push(a.type)});const a=x.combineTypes(t);return l(r,a,o)}if(r.flags&_.FlowFlags.LoopLabel){const t=r;let o=!1,a=!1,d=u(r);return void 0===d&&(a=!0,d=l(r,void 0,!0)),t.antecedents.forEach((t,a)=>{if(a>=d.incompleteSubtypes.length){d=c(r,a,void 0);const l=e(t,n,s,i);l.isIncomplete&&0===a&&(o=!0),d=c(r,a,l.type)}}),a?o?(p(r),{type:d.type,isIncomplete:!0}):l(r,d.type,!1):d}if(r.flags&(_.FlowFlags.TrueCondition|_.FlowFlags.FalseCondition)){const t=r,o=Vt(n,t);if(o){const a=e(t.antecedent,n,s,i);let c=a.type;return c&&(c=o(c)),l(r,c,a.isIncomplete)}r=t.antecedent}else if(r.flags&_.FlowFlags.PreFinallyGate){const e=r;if(e.isGateClosed)return{type:void 0,isIncomplete:!1};r=e.antecedent}else{if(r.flags&_.FlowFlags.PostFinally){const t=r,o=t.preFinallyGate.isGateClosed;try{t.preFinallyGate.isGateClosed=!0;const a=e(t.antecedent,n,s,i);return a.isIncomplete?a:l(r,a.type,!1)}finally{t.preFinallyGate.isGateClosed=o}}if(r.flags&_.FlowFlags.Start)return l(r,i,!1);if(!(r.flags&_.FlowFlags.WildcardImport))return a.fail("Unexpected flow node flags"),l(r,void 0,!1);{const e=r;if(39===n.nodeType){const t=n.value;if(e.names.some(e=>e===t)){const n=Rt(e,t);return l(r,n,!1)}}r=e.antecedent}}}}}(i,t,n,s):{type:s,isIncomplete:!1}}}}function zt(e,t){const n=new Map;if(s.has(e.id))return!0;s.set(e.id,!0);try{return function e(t,s){let i=t;for(;;){if(n.has(i.id))return!1;if(n.set(i.id,!0),i.flags&_.FlowFlags.Unreachable)return!1;if(i===s)return!0;if(i.flags&_.FlowFlags.Call){const e=i;if(void 0===s&&Lt(e.node))return!1;i=e.antecedent}else if(i.flags&_.FlowFlags.Assignment)i=i.antecedent;else if(i.flags&_.FlowFlags.AssignmentAlias)i=i.antecedent;else{if(i.flags&(_.FlowFlags.BranchLabel|_.FlowFlags.LoopLabel)){const t=i;for(const n of t.antecedents)if(e(n,s))return!0;return!1}if(i.flags&(_.FlowFlags.TrueCondition|_.FlowFlags.FalseCondition))i=i.antecedent;else if(i.flags&_.FlowFlags.PreFinallyGate){const e=i;if(e.isGateClosed)return!1;i=e.antecedent}else{if(i.flags&_.FlowFlags.PostFinally){const t=i,n=t.preFinallyGate.isGateClosed;try{return t.preFinallyGate.isGateClosed=!0,e(t.antecedent,s)}finally{t.preFinallyGate.isGateClosed=n}}if(i.flags&_.FlowFlags.Start)return!s;if(!(i.flags&_.FlowFlags.WildcardImport))return a.fail("Unexpected flow node flags"),!1;i=i.antecedent}}}}(e,t)}finally{s.delete(e.id)}}function Vt(e,t){let n=t.expression;const s=!!(t.flags&_.FlowFlags.TrueCondition);if(4===n.nodeType&&(v.isMatchingExpression(e,n.rightExpression)?n=n.rightExpression:v.isMatchingExpression(e,n.name)&&(n=n.name)),7===n.nodeType){const t=39===n.operator||40===n.operator,i=12===n.operator||28===n.operator;if(t||i){const r=39===n.operator||12===n.operator?s:!s;if(11===n.rightExpression.nodeType&&24===n.rightExpression.constType){let t=n.leftExpression;if(4===t.nodeType&&(t=t.name),v.isMatchingExpression(e,t))return e=>{if(10===e.category){const t=e.subtypes.filter(e=>!!x.isAnyOrUnknown(e)||x.isNone(e)===r);return x.combineTypes(t)}return x.isNone(e)&&!r?x.NeverType.create():e}}if(t&&9===n.leftExpression.nodeType){const t=ne(n.leftExpression.leftExpression).type;if(x.isClass(t)&&x.ClassType.isBuiltIn(t,"type")&&1===n.leftExpression.arguments.length&&0===n.leftExpression.arguments[0].argumentCategory){const t=n.leftExpression.arguments[0].valueExpression;if(v.isMatchingExpression(e,t)){const e=ne(n.rightExpression).type;if(x.isClass(e))return t=>F.doForSubtypes(t,t=>{if(x.isObject(t)){const n=x.ClassType.isSameGenericClass(t.classType,e);return r?n?t:void 0:n?void 0:t}return x.isNone(t)&&r?void 0:t})}}}if(t&&v.isMatchingExpression(e,n.leftExpression)){const e=ne(n.rightExpression).type;if(x.isObject(e)&&x.ClassType.isEnumClass(e.classType)&&void 0!==e.classType.literalValue)return t=>jt(t,e,r)}if(i){const t=12===n.operator?s:!s;if(v.isMatchingExpression(e,n.leftExpression)){const e=ne(n.rightExpression).type;if(x.isObject(e)&&void 0!==e.classType.literalValue)return n=>jt(n,e,t)}if(v.isMatchingExpression(e,n.rightExpression)){const e=ne(n.leftExpression).type;if(x.isObject(e)&&void 0!==e.classType.literalValue)return n=>jt(n,e,t)}if(36===n.leftExpression.nodeType&&v.isMatchingExpression(e,n.leftExpression.leftExpression)){const e=ne(n.rightExpression).type,s=n.leftExpression.memberName;if(x.isObject(e)&&void 0!==e.classType.literalValue)return n=>function(e,t,n,s){let i=!0;const r=F.doForSubtypes(e,e=>{let r;if(e=F.transformTypeObjectToClass(e),x.isObject(e)?r=F.lookUpObjectMember(e,t):x.isClass(e)&&(r=F.lookUpClassMember(e,t)),r&&r.isTypeDeclared){const t=cn(r);if(F.isLiteralType(t,!1))return gn(t,n,new l.DiagnosticAddendum)===s?e:void 0}return i=!1,e});return i?r:e}(n,s.value,e,t)}}}if(41===n.operator&&s&&v.isMatchingExpression(e,n.leftExpression)){const e=ne(n.rightExpression).type;return t=>function(e,t){if(!x.isObject(t)||!x.ClassType.isBuiltIn(t.classType))return e;const n=t.classType,s=x.ClassType.getAliasClass(n).details.name;if(!["list","set","frozenset","deque"].some(e=>e===s))return e;if(!n.typeArguments||1!==n.typeArguments.length)return e;const i=n.typeArguments[0];let r=!0;const o=F.doForSubtypes(e,e=>x.isAnyOrUnknown(e)?(r=!1,e):gn(i,e,new l.DiagnosticAddendum)?e:void 0);return r?o:e}(t,e)}if((41===n.operator||42===n.operator)&&v.isMatchingExpression(e,n.rightExpression)){const e=ne(n.leftExpression).type;if(x.isObject(e)&&x.ClassType.isBuiltIn(e.classType,"str")&&void 0!==e.classType.literalValue){const t=41===n.operator?s:!s;return n=>function(e,t,n){return F.doForSubtypes(e,e=>{if(x.isObject(e)&&x.ClassType.isTypedDictClass(e.classType)){const s=Sn(e.classType).get(t.literalValue);return n?void 0===s?void 0:e:void 0!==s&&s.isRequired?void 0:e}return e})}(n,e.classType,t)}}}if(9===n.nodeType){if(39===n.leftExpression.nodeType)if("isinstance"!==n.leftExpression.value&&"issubclass"!==n.leftExpression.value||2!==n.arguments.length){if("callable"===n.leftExpression.value&&1===n.arguments.length){const t=n.arguments[0].valueExpression;if(v.isMatchingExpression(e,t))return e=>function(e,t,n){return F.doForSubtypes(e,e=>{switch(e.category){case 5:case 6:case 7:return t?e:void 0;case 3:case 9:return t?void 0:e;case 8:{const s=Ne(e);return s&&x.isClass(s)||oe(n,e,"__call__",{method:"get"},new l.DiagnosticAddendum,9)?t?e:void 0:t?void 0:e}default:return e}})}(e,s,n)}}else{const t="isinstance"===n.leftExpression.value,i=n.arguments[0].valueExpression,r=n.arguments[1].valueExpression;if(v.isMatchingExpression(e,i)){const e=function(e){if(x.isClass(e))return[e];if(x.isObject(e)){const t=e.classType;if(F.isTupleClass(t)&&t.typeArguments){let e=!1;const n=[];if(t.typeArguments.forEach(t=>{x.isClass(t)?n.push(t):e=!0}),!e)return n}}}(ne(r,void 0,160).type);if(e)return n=>function(e,t,n,s){let i=F.doForSubtypes(e,e=>(e=F.transformPossibleRecursiveTypeAlias(e),F.transformTypeObjectToClass(e)));i=F.makeTypeVarsConcrete(i);const r=e=>{const i=[];let r=!1,o=!1;for(const n of t){const t=x.ClassType.isDerivedFrom(e,n),a=x.ClassType.isDerivedFrom(n,e);t&&(r=!0),a&&t&&!x.ClassType.isSameGenericClass(e,n)&&(o=!0),s&&(t?i.push(e):a&&i.push(n))}return s||r&&!o||i.push(e),n?i.map(e=>x.ObjectType.create(e)):i};if(n&&x.isObject(i)){const e=r(i.classType);return x.combineTypes(e)}if(!n&&x.isClass(i)){const e=r(i);return x.combineTypes(e)}if(10===i.category){let e=[];return i.subtypes.forEach(t=>{x.isAnyOrUnknown(t)?e.push(t):n&&x.isObject(t)?e=e.concat(r(t.classType)):!n&&x.isClass(t)?e=e.concat(r(t)):s||e.push(t)}),x.combineTypes(e)}return n&&s&&x.isAnyOrUnknown(i)&&(e=x.combineTypes(t.map(e=>x.ObjectType.create(e)))),e}(n,e,t,s)}}if(n.arguments.length>=1){const t=ne(n.leftExpression).type;if(x.isFunction(t)&&t.details.declaredReturnType&&x.isObject(t.details.declaredReturnType)&&x.ClassType.isBuiltIn(t.details.declaredReturnType.classType,"TypeGuard")){const t=n.arguments[0].valueExpression;if(v.isMatchingExpression(e,t)){const e=ne(n).type;if(x.isObject(e)&&x.ClassType.isBuiltIn(e.classType,"TypeGuard")){const t=e.classType.typeArguments,n=t&&t.length>0?t[0]:x.UnknownType.create();return e=>s?n:e}}}}}if(v.isMatchingExpression(e,n))return e=>F.doForSubtypes(e,e=>{if(s){if(F.canBeTruthy(e))return F.removeFalsinessFromType(e)}else if(F.canBeFalsy(e))return F.removeTruthinessFromType(e)})}function jt(e,t,n){let s=!0;const i=F.doForSubtypes(e,e=>{if(x.isObject(e)&&x.ClassType.isSameGenericClass(t.classType,e.classType)){if(void 0!==e.classType.literalValue){const s=x.ClassType.isLiteralValueSame(e.classType,t.classType);if(s&&!n||!s&&n)return;return e}if(n)return t;{const n=F.enumerateLiteralsForType(e);if(n)return x.combineTypes(n.filter(e=>!x.ClassType.isLiteralValueSame(e.classType,t.classType)))}}return s=!1,e});return s?i:e}function Bt(e,t,n,s){if(x.ClassType.isSpecialBuiltIn(e))switch(e.details.name){case"Callable":return function(e){const t=x.FunctionType.createInstantiable("","",0);if(t.details.declaredReturnType=x.AnyType.create(),e&&e.length>0)if(e[0].typeList)e[0].typeList.forEach((e,n)=>{F.isEllipsisType(e.type)?be(h.Localizer.Diagnostic.ellipsisContext(),e.node):x.isModule(e.type)?be(h.Localizer.Diagnostic.moduleContext(),e.node):F.isParamSpecType(e.type)&&be(h.Localizer.Diagnostic.paramSpecContext(),e.node),x.FunctionType.addParameter(t,{category:0,name:"p"+n.toString(),isNameSynthesized:!0,type:F.convertToInstance(e.type),hasDeclaredType:!0})});else if(F.isEllipsisType(e[0].type))x.FunctionType.addDefaultParameters(t),t.details.flags|=32768;else if(F.isParamSpecType(e[0].type))t.details.paramSpec=e[0].type;else if(x.isClass(e[0].type)&&x.ClassType.isBuiltIn(e[0].type,"Concatenate")){const n=e[0].type.typeArguments;n&&n.length>0&&n.forEach((e,s)=>{s===n.length-1?F.isParamSpecType(e)&&(t.details.paramSpec=e):x.FunctionType.addParameter(t,{category:0,name:"__p"+s,isNameSynthesized:!0,hasDeclaredType:!0,type:e})})}else be(h.Localizer.Diagnostic.callableFirstArg(),e[0].node);else x.FunctionType.addDefaultParameters(t,!0),t.details.flags|=32768;return e&&e.length>1?(F.isEllipsisType(e[1].type)?be(h.Localizer.Diagnostic.ellipsisContext(),e[1].node):x.isModule(e[1].type)?be(h.Localizer.Diagnostic.moduleContext(),e[1].node):F.isParamSpecType(e[1].type)&&be(h.Localizer.Diagnostic.paramSpecContext(),e[1].node),t.details.declaredReturnType=F.convertToInstance(e[1].type)):t.details.declaredReturnType=x.UnknownType.create(),e&&e.length>2&&be(h.Localizer.Diagnostic.callableExtraArgs(),e[2].node),t}(t);case"Optional":return function(e,t){return t&&1===t.length?(F.isEllipsisType(t[0].type)?be(h.Localizer.Diagnostic.ellipsisContext(),t[0].node):x.isModule(t[0].type)?be(h.Localizer.Diagnostic.moduleContext(),t[0].node):F.isParamSpecType(t[0].type)?be(h.Localizer.Diagnostic.paramSpecContext(),t[0].node):x.TypeBase.isInstantiable(t[0].type)||De(t[0].type,t[0].node),x.combineTypes([t[0].type,x.NoneType.createType()])):(be(h.Localizer.Diagnostic.optionalExtraArgs(),e),x.UnknownType.create())}(s,t);case"Type":return ct(e,t,1);case"ClassVar":return function(e,t){if(!t||0===t.length)return be(h.Localizer.Diagnostic.classVarFirstArgMissing(),e),x.UnknownType.create();if(t.length>1)return be(h.Localizer.Diagnostic.classVarTooManyArgs(),t[1].node),x.UnknownType.create();let n=t[0].type;return F.requiresSpecialization(n)&&(n=F.specializeType(n,void 0)),n}(s,t);case"Deque":case"List":case"FrozenSet":case"Set":return ct(e,t,1);case"ChainMap":case"Dict":case"DefaultDict":return ct(e,t,2);case"Protocol":case"Tuple":return ct(e,t,void 0);case"Union":return function(e){const t=[];if(e)for(const n of e)t.push(n.type),F.isEllipsisType(n.type)?be(h.Localizer.Diagnostic.ellipsisContext(),n.node):x.isModule(n.type)?be(h.Localizer.Diagnostic.moduleContext(),n.node):F.isParamSpecType(n.type)?be(h.Localizer.Diagnostic.paramSpecContext(),n.node):x.TypeBase.isInstantiable(n.type)||De(n.type,n.node);return t.length>0?x.combineTypes(t):x.NeverType.create()}(t);case"Generic":return function(e,t,n){n&&0!==n.length||be(h.Localizer.Diagnostic.genericTypeArgMissing(),e);const s=[];return n&&n.forEach(e=>{if(x.isTypeVar(e.type)){for(const t of s)if(t===e.type){be(h.Localizer.Diagnostic.genericTypeArgUnique(),e.node);break}s.push(e.type)}else be(h.Localizer.Diagnostic.genericTypeArgTypeVar(),e.node)}),ct(t,n,void 0,!0)}(s,e,t);case"Final":return function(e,t,n){return 64&n?(be(h.Localizer.Diagnostic.finalContext(),e),x.AnyType.create()):t&&0!==t.length?(t.length>1&&be(h.Localizer.Diagnostic.finalTooManyArgs(),e),t[0].type):x.AnyType.create()}(s,t,n);case"Annotated":return function(e,t){return!t||t.length<1?(be(h.Localizer.Diagnostic.annotatedTypeArgMissing(),e),x.AnyType.create()):(F.isEllipsisType(t[0].type)?be(h.Localizer.Diagnostic.ellipsisContext(),t[0].node):x.isModule(t[0].type)?be(h.Localizer.Diagnostic.moduleContext(),t[0].node):F.isParamSpecType(t[0].type)&&be(h.Localizer.Diagnostic.paramSpecContext(),t[1].node),t[0].type)}(s,t);case"Concatenate":return function(e,t,n){return n&&0!==n.length?n.forEach((e,t)=>{t===n.length-1?F.isParamSpecType(e.type)||be(h.Localizer.Diagnostic.concatenateParamSpecMissing(),e.node):F.isParamSpecType(e.type)&&be(h.Localizer.Diagnostic.paramSpecContext(),e.node)}):be(h.Localizer.Diagnostic.concatenateTypeArgsMissing(),e),ct(t,n,void 0,!0)}(s,e,t);case"TypeGuard":return function(e,t,n){let s;return 0===t.details.typeParameters.length&&t.details.typeParameters.push(x.TypeVarType.createInstance("_T",!1,!0)),n&&1===n.length||be(h.Localizer.Diagnostic.typeGuardArgCount(),e),n&&n.length>0?(s=n[0].type,F.isEllipsisType(s)?be(h.Localizer.Diagnostic.ellipsisContext(),n[0].node):x.isModule(s)?be(h.Localizer.Diagnostic.moduleContext(),n[0].node):F.isParamSpecType(s)&&be(h.Localizer.Diagnostic.paramSpecContext(),n[0].node)):s=x.UnknownType.create(),x.ClassType.cloneForSpecialization(t,[F.convertToInstance(s)],!!n)}(s,e,t)}if(x.ClassType.isBuiltIn(e,"tuple"))return ct(e,t,void 0);let i=t?t.length:0;const r=x.ClassType.getTypeParameters(e);if(0===r.length&&0===i)return e;if(t&&i>r.length){if(!x.ClassType.isPartiallyConstructed(e)){const n=Jt(s);0===r.length?Ie(n.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeArgsExpectingNone(),t[r.length].node):Ie(n.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeArgsTooMany().format({name:e.details.name,expected:r.length,received:i}),t[r.length].node)}i=r.length}else t&&i<r.length&&Ie(Jt(s).diagnosticRuleSet.reportMissingTypeArgument,c.DiagnosticRule.reportMissingTypeArgument,h.Localizer.Diagnostic.typeArgsTooFew().format({name:e.details.name,expected:r.length,received:i}),t[0].node.parent);t&&t.forEach(e=>{F.isEllipsisType(e.type)?be(h.Localizer.Diagnostic.ellipsisContext(),e.node):x.isModule(e.type)&&be(h.Localizer.Diagnostic.moduleContext(),e.node)});const o=t?t.map(e=>F.convertToInstance(e.type)):[],a=x.ClassType.getTypeParameters(e);for(let e=o.length;e<a.length;e++)o.push(F.getConcreteTypeFromTypeVar(a[e]));return o.forEach((e,n)=>{if(n<i){const s=new l.DiagnosticAddendum;(function(e,t,n,s=0,i=0){if(i>x.maxTypeRecursionCount)return!0;if(x.isAnyOrUnknown(t))return!0;let r=t;if(x.isTypeVar(t)){if(x.isTypeSame(t,e))return!0;r=t.details.boundType?F.getConcreteTypeFromTypeVar(t,!1,i+1):t.details.constraints?x.combineTypes(t.details.constraints):x.AnyType.create()}const o=e.details.boundType;if(o&&!gn(o,r,n.createAddendum(),void 0,s,i+1))return e.details.isSynthesized||n.addMessage(h.Localizer.DiagnosticAddendum.typeBound().format({sourceType:Fn(r),destType:Fn(o),name:e.details.name})),!1;const a=e.details.constraints;if(0===a.length)return!0;for(const e of a){if(x.isAnyOrUnknown(e))return!0;if(10===r.category){if(r.subtypes.find(t=>x.isSameWithoutLiteralValue(e,t)))return!0}else if(x.isSameWithoutLiteralValue(e,r))return!0}return n.addMessage(h.Localizer.DiagnosticAddendum.typeConstrainedTypeVar().format({type:Fn(r),name:e.details.name})),!1})(r[n],e,s)||Ie(Jt(t[n].node).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.typeVarAssignmentMismatch().format({type:Fn(e),name:r[n].details.name})+s.getString(),t[n].node)}}),x.ClassType.cloneForSpecialization(e,o,void 0!==t)}function Wt(e){return e.type?e.type:ne(e.valueExpression).type}function qt(e,t,n=!1){if(e.type)return e.type;let s=416;return t.isStubFile&&(s|=4),n&&(s|=4096),ne(e.valueExpression,void 0,s).type}function Gt(e,t){const n=b.getScopeForNode(e);if(n){const e=b.getBuiltInScope(n).lookUpSymbol(t);if(e)return nn(e)}return x.UnknownType.create()}function $t(e,t,n){const s=Gt(e,t);if(x.isClass(s)){let e=s;return n&&(e=x.ClassType.cloneForSpecialization(e,n,!1)),x.ObjectType.create(e)}return s}function Kt(e,t,n){const s=b.getScopeForNode(e);let i=null==s?void 0:s.lookUpSymbolRecursive(t);return i&&n&&0===i.symbol.getDeclarations().filter(t=>{if(6!==t.type){const n=v.getExecutionScopeNode(e),s=4===t.type||3===t.type?t.node.name:t.node;if(n===v.getExecutionScopeNode(s)&&!Te(s,e)){const t=f.getFlowNode(e);return!(t&&zt(t))}}return!0}).length&&(i=i.scope.parent?i.scope.parent.lookUpSymbolRecursive(t):void 0),i}function Ht(e){const t=j;j=!0;try{return e()}finally{j=t}}function Yt(e,t){M.enterSpeculativeContext(e);try{return t()}finally{M.leaveSpeculativeContext()}}function Qt(e){const t=M.getSpeculativeRootNode();return!!t&&(void 0===e||v.isNodeContainedWithin(e,t))}function Jt(e){for(;37!==e.nodeType;)e=e.parent;return f.getFileInfo(e)}function Xt(e,t){if(5===e.category&&e.details.declaration){const n=e.details.declaration;if(3===n.type){const e=n.node,s=f.getScope(e);if(s){const e=s.lookUpSymbol(t);if(e)return e.getDeclarations().find(e=>2===e.type)}}}}function Zt(e){var t;switch(e.type){case 0:{if("Any"===e.intrinsicType)return x.AnyType.create();if("class"===e.intrinsicType){const t=yt(v.getEnclosingClass(e.node));return t?t.classType:void 0}const t=$t(e.node,"str"),n=$t(e.node,"int");if(x.isObject(n)&&x.isObject(t)){if("str"===e.intrinsicType)return t;if("int"===e.intrinsicType)return n;if("List[str]"===e.intrinsicType){const n=Gt(e.node,"List");if(x.isClass(n))return x.ObjectType.create(x.ClassType.cloneForSpecialization(n,[t],!1))}if("Dict[str, Any]"===e.intrinsicType){const n=Gt(e.node,"Dict");if(x.isClass(n))return x.ObjectType.create(x.ClassType.cloneForSpecialization(n,[t,x.AnyType.create()],!1))}}return x.UnknownType.create()}case 4:{const t=yt(e.node);return t?t.decoratedType:void 0}case 5:return ie(e.node.typeAnnotation);case 3:{const t=ft(e.node);return t?t.decoratedType:void 0}case 2:{let n=e.node.typeAnnotation||e.node.typeAnnotationComment;if(!n&&29===(null===(t=e.node.parent)||void 0===t?void 0:t.nodeType)){const t=e.node.parent;if(t.functionAnnotationComment&&!t.functionAnnotationComment.isParamListEllipsis){const s=t.parameters.findIndex(t=>t===e.node);n=ce(t,s)}}if(n){const t=ie(n,!1,!0);return Tt(e.node,e.node.category,t)}return}case 1:{const t=e.typeAnnotationNode;if(t){const n=pe(t)?v.getTypeAnnotationNode(t):void 0;let s=ie(t);if(s)return 39===e.node.nodeType&&(s=pt(e.node,s)),n&&39===n.valueExpression.nodeType&&(s=ut(s,n.valueExpression)),s}return}case 6:return}}function en(n){const s=tn(n,!0);if(!s)return x.UnknownType.create();function i(e,t,n){if(t.path){const s=n(t.path);if(!s)return x.UnknownType.create();e.fields=s.symbolTable,e.docString=s.docString}return t.implicitImports&&t.implicitImports.forEach((t,s)=>{const r=e.moduleName?e.moduleName+"."+s:"",o=i(x.ModuleType.create(r),t,n),a=S.Symbol.createWithType(0,o);e.loaderFields.set(s,a)}),e}if(6===s.type){const t=x.ModuleType.create(s.moduleName);if(!s.symbolName)return i(t,s,e);if(s.submoduleFallback)return i(t,s.symbolName&&s.submoduleFallback?s.submoduleFallback:s,e)}const r=Zt(s);if(r)return r;const o=Jt(s.node);let a=!1;if(o.isInPyTypedPackage&&!o.isStubFile&&t.disableInferenceForPyTypedSources){if(1!==s.type)return x.UnknownType.create();const e=v.getEnclosingClass(s.node,!0);let t=!1;if(e){const n=yt(e);n&&x.ClassType.isEnumClass(n.classType)&&(t=!0)}if(!s.isFinal&&!s.isConstant&&!t){if(!s.typeAliasName)return x.UnknownType.create();s.typeAliasAnnotation||(a=!0)}}if(2===s.type){return $(s.node.name)||(Nt(s.node),$(s.node.name))}if(1===s.type&&s.inferredTypeSource){let e=$(s.node);if(e||(Ot(s.typeAliasName&&s.inferredTypeSource.parent?s.inferredTypeSource.parent:s.inferredTypeSource),e=$(s.node)),e&&39===s.node.nodeType&&(e=pt(s.node,e)),e&&s.typeAliasName)if(x.TypeBase.isInstantiable(e)&&!x.isAnyOrUnknown(e))e=ut(e,s.typeAliasName);else if(a)return x.UnknownType.create();return e}}function tn(t,n){return g.resolveAliasDeclaration(e,t,n)}function nn(e){return sn(e).type}function sn(e,t){if(e.hasTypedDeclarations())return{type:rn(e)||x.UnknownType.create(),isResolutionCyclical:!1};const n=[],s=e.isPrivateMember(),i=e.getDeclarations(),r=D.isFinalVariable(e);let o=!1;return i.forEach(i=>{var a,l;let c=!0;if(void 0!==t&&6!==i.type&&v.getExecutionScopeNode(t)===v.getExecutionScopeNode(i.node)&&(Te(i.node,t)||(c=!1)),c){const t=T.isExplicitTypeAliasDeclaration(i)||T.isPossibleTypeAliasDeclaration(i);if(t&&1===i.type&&3===(null===(l=null===(a=i.inferredTypeSource)||void 0===a?void 0:a.parent)||void 0===l?void 0:l.nodeType)&&(ht(i.inferredTypeSource.parent),i.typeAliasAnnotation&&ne(i.typeAliasAnnotation)),J(e,i))try{let a=en(i);if(X(e)&&(o=!0),a){const e=1===i.type&&!!i.isConstant;if(a=F.stripLiteralTypeArgsValue(a),1===i.type){const n=x.isObject(a)&&x.ClassType.isEnumClass(a.classType);!x.TypeBase.isInstance(a)||t||s||e||n||r||(a=F.stripLiteralValue(a))}n.push(a)}}catch(t){throw X(e),t}else o=!0}}),n.length>0?{type:x.combineTypes(n),isResolutionCyclical:!1}:{type:x.UnboundType.create(),isResolutionCyclical:o}}function rn(e){const t=e.getSynthesizedType();if(t)return t;const n=e.getTypedDeclarations();if(0===n.length)return;let s=n.length-1;for(;s>=0;){const t=n[s],i=ee(e,t);if(i)return i;if(Q(e,t)<0){if(J(e,t))try{const n=Zt(t);if(!X(e))return;return n}catch(t){throw X(e),t}break}s--}}function on(e,t,n=!0){return x.FunctionType.getSpecializedReturnType(e)||(n?an(e,t):x.UnknownType.create())}function an(e,t){let n;if(x.FunctionType.isStubDefinition(e)||x.FunctionType.isPyTypedDefinition(e))return x.UnknownType.create();if(e.inferredReturnType)n=e.inferredReturnType;else{if(e.details.declaration){const t=e.details.declaration.node;!function(s){const i=M.disableSpeculativeMode();try{n=It(t,x.FunctionType.isAbstractMethod(e))}finally{M.enableSpeculativeMode(i)}}(),n&&x.FunctionType.isWrapReturnTypeInAwait(e)&&(n=St(t,n))}n||(n=x.UnknownType.create()),e.inferredReturnType=n}if(F.isPartlyUnknown(n)&&x.FunctionType.hasUnannotatedParams(e)&&!x.FunctionType.isStubDefinition(e)&&!x.FunctionType.isPyTypedDefinition(e)&&t){const s=function(e,t){let n;if(!e.details.declaration)return;const s=e.details.declaration.node;if(t.some(e=>!e.paramName))return;if(W.some(e=>e.functionNode===s))return;const i=ft(s);return!i||W.length>=3?void 0:(Ht(()=>{const r=q;W.push({functionNode:s,codeFlowAnalyzer:Ut()});try{q=new Map;let o=!0;s.parameters.forEach((e,n)=>{if(e.name){let r;const a=t.find(t=>e.name.value===t.paramName);a&&a.argument.valueExpression?(r=ne(a.argument.valueExpression).type,o=!1):e.defaultValue?(r=ne(e.defaultValue).type,o=!1):0===n&&(x.FunctionType.isInstanceMethod(i.functionType)||x.FunctionType.isClassMethod(i.functionType))&&i.functionType.details.parameters.length>0&&s.parameters[0].name&&(r=i.functionType.details.parameters[0].type),r||(r=x.UnknownType.create()),K(e.name,r)}}),o||(n=It(s,x.FunctionType.isAbstractMethod(e)))}finally{W.pop(),q=r}}),n?(x.FunctionType.isWrapReturnTypeInAwait(e)&&!F.isNoReturnType(n)&&(n=St(s,n)),n):void 0)}(e,t);s&&(n=s)}return n}function ln(e){const t=ft(e);return t?x.FunctionType.isAbstractMethod(t.functionType)?x.AnyType.create():x.FunctionType.isGenerator(t.functionType)?F.getDeclaredGeneratorReturnType(t.functionType):t.functionType.details.declaredReturnType:x.AnyType.create()}function cn(e){return x.isClass(e.classType)?F.partiallySpecializeType(nn(e.symbol),e.classType):x.UnknownType.create()}function pn(e,t,n,s,i,r){const o=e.details.fields;if(x.isTypeSame(t,e))return!0;const a=x.ClassType.cloneForSpecialization(e,void 0,!1),l=new P.TypeVarMap;let c=!0;const p=F.buildTypeVarMapFromSpecializedClass(t);if(o.forEach((e,s)=>{if(e.isClassMember()&&!e.isIgnoredForProtocolMatch()){const i=F.lookUpClassMember(t,s);if(i){const t=rn(e);t&&(gn(t,F.specializeType(cn(i),p,!1),n.createAddendum(),l,0,r+1)||(n.addMessage(h.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:s})),c=!1)),e.isClassVar()&&!i.symbol.isClassMember()&&(n.addMessage(h.Localizer.DiagnosticAddendum.protocolMemberClassVar().format({name:s})),c=!1)}else n.addMessage(h.Localizer.DiagnosticAddendum.protocolMemberMissing().format({name:s})),c=!1}}),e.details.baseClasses.forEach(o=>{!x.isClass(o)||x.ClassType.isBuiltIn(o,"object")||x.ClassType.isBuiltIn(o,"Protocol")||pn(dn(e,o,r+1),t,n,s,i,r+1)||(c=!1)}),c&&e.details.typeParameters.length>0&&e.typeArguments){const t=F.specializeType(a,l,!1);mn(e,t,n,s,i,r)||(c=!1)}return c}function un(e,t,n,s,i,r,o){if(x.ClassType.isProtocolClass(e))return pn(e,t,n,s,i,r);if(x.ClassType.isTypedDictClass(e)&&x.ClassType.isTypedDictClass(t))return function(e,t,n,s){let i=!0;const r=Sn(e),o=Sn(t);return r.forEach((r,a)=>{const l=o.get(a);l?(r.isRequired&&!l.isRequired?(n.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldRequired().format({name:a,type:Fn(e)})),i=!1):!r.isRequired&&l.isRequired&&(n.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldNotRequired().format({name:a,type:Fn(e)})),i=!1),x.isTypeSame(r.valueType,l.valueType,s+1)||(n.addMessage(h.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:a})),i=!1)):(n.addMessage(h.Localizer.DiagnosticAddendum.typedDictFieldMissing().format({name:a,type:Fn(t)})),i=!1)}),i}(e,t,n,r);if(x.ClassType.isPropertyClass(e)&&x.ClassType.isPropertyClass(t)){let s=!0;const i=hn(e,!0),o=hn(t,!0);return i&&o&&(gn(i,o,n,void 0,0,r+1)||(s=!1)),s}if(x.ClassType.isBuiltIn(e,"float")&&x.ClassType.isBuiltIn(t,"int")&&0==(1&i))return!0;if(x.ClassType.isBuiltIn(e,"complex")&&(x.ClassType.isBuiltIn(t,"int")||x.ClassType.isBuiltIn(t,"float"))&&0==(1&i))return!0;if(0==(1&i)||x.ClassType.isSameGenericClass(t,e)){const o=[];if(x.ClassType.isDerivedFrom(t,e,o))return a.assert(o.length>0),function(e,t,n,s,i,r,o){let a=t,l=i;for(let t=n.length-1;t>=0;t--){const i=n[t];if(x.isUnknown(i))return!0;if(x.ClassType.isBuiltIn(i,"object"))return!0;if(t<n.length-1&&(a=dn(a,i,o+1)),0===t&&x.ClassType.isBuiltIn(e)&&F.isTupleClass(e)){if(e.typeArguments&&a.typeArguments){const t=e.typeArguments;let n=t.length;const i=2===n&&F.isEllipsisType(t[1]);i&&(n=1);const c=a.typeArguments;let p=c.length;const u=2===p&&F.isEllipsisType(c[1]);if(u&&(p=1),(c.length!==n||u)&&!i)return s.addMessage(h.Localizer.DiagnosticAddendum.tupleSizeMismatch().format({expected:n,received:c.length})),!1;for(let e=0;e<Math.max(n,p);e++){const n=(i?t[0]:t[e])||x.AnyType.create(),a=(u?c[0]:c[e])||x.AnyType.create(),p=s.createAddendum();if(!gn(n,a,p.createAddendum(),l,r,o+1))return p.addMessage(h.Localizer.DiagnosticAddendum.tupleEntryTypeMismatch().format({entry:e+1})),!1}}return!0}if(0!==x.ClassType.getTypeParameters(i).length){if(!i.typeArguments)return!0;if(!mn(i,a,s,l,r,o))return!1;l=new P.TypeVarMap}}if(e.typeArguments){if(!mn(e,a,s,i,r,o))return!1}else if(i&&e.details.typeParameters.length>0&&a.typeArguments&&!i.isLocked()){const t=a.effectiveTypeArguments||a.typeArguments;for(let n=0;n<e.details.typeParameters.length;n++){const s=n<t.length?t[n]:x.UnknownType.create();i.setTypeVar(e.details.typeParameters[n],s,!0)}}return!0}(e,t,o,n,s,i,r+1)}if(x.ClassType.isBuiltIn(e,"object"))return!0;const l=o?x.ObjectType.create(e):e,c=o?x.ObjectType.create(t):t;return n.addMessage(h.Localizer.DiagnosticAddendum.typeIncompatible().format({sourceType:Fn(c),destType:Fn(l)})),!1}function dn(e,t,n){if(0===x.ClassType.getTypeParameters(t).length)return t;const s=F.buildTypeVarMapFromSpecializedClass(e),i=F.specializeType(t,s,!1,n+1);return a.assert(x.isClass(i)),i}function hn(e,t){if(!x.ClassType.isPropertyClass(e))return;const n=e.details.fields.get("fget");if(n){const e=rn(n);if(e&&5===e.category)return on(e,void 0,t)}}function mn(e,t,n,s,i,r){a.assert(x.ClassType.isSameGenericClass(e,t));const o=x.ClassType.getTypeParameters(e),c=e.effectiveTypeArguments||e.typeArguments;a.assert(void 0!==c);const p=t.effectiveTypeArguments||t.typeArguments;if(p&&(x.ClassType.isSpecialBuiltIn(t)||p.length===o.length))for(let e=0;e<p.length;e++){const t=p[e],a=e>=c.length?c.length-1:e,u=a>=0?c[a]:x.UnknownType.create(),d=a<o.length?o[a]:void 0,m=new l.DiagnosticAddendum;if(!d||d.details.isCovariant){if(!gn(u,t,m,s,i,r+1)){if(d){const e=n.createAddendum();e.addMessage(h.Localizer.DiagnosticAddendum.typeVarIsCovariant().format({name:d.details.name})),e.addAddendum(m)}return!1}}else if(d.details.isContravariant){if(!gn(t,u,m,s,2|i,r+1)){const e=n.createAddendum();return e.addMessage(h.Localizer.DiagnosticAddendum.typeVarIsContravariant().format({name:d.details.name})),e.addAddendum(m),!1}}else if(!gn(u,t,m,s,1|i,r+1)){const e=n.createAddendum();return e.addMessage(h.Localizer.DiagnosticAddendum.typeVarIsInvariant().format({name:d.details.name})),e.addAddendum(m),!1}}return!0}function yn(e,t,n,s,i,r=0,o=0){const a=i.getTypeVar(e);if(e.details.isParamSpec)return s.addMessage(h.Localizer.DiagnosticAddendum.typeParamSpec().format({type:Fn(t),name:e.details.name})),!1;if(e.details.constraints.length>0){let n;if(e.details.constraints.forEach(e=>{gn(e,t,new l.DiagnosticAddendum)&&(n&&!gn(n,e,new l.DiagnosticAddendum)||(n=e))}),!n)return s.addMessage(h.Localizer.DiagnosticAddendum.typeConstraint().format({type:Fn(t),name:e.details.name})),!1;const r=x.isTypeVar(t)&&!t.details.isSynthesized;if(!a||x.isAnyOrUnknown(a)||r)i.isLocked()||i.setTypeVar(e,r?t:n,!1);else if(!gn(a,n,new l.DiagnosticAddendum)){if(!gn(n,a,new l.DiagnosticAddendum))return s.addMessage(h.Localizer.DiagnosticAddendum.typeConstraint().format({type:Fn(n),name:Fn(a)})),!1;i.isLocked()||i.setTypeVar(e,n,!1)}return!0}let c=t;const p=i.isNarrowable(e)&&!i.isLocked(),u=n&&p;if(a){const e=new l.DiagnosticAddendum;if(n){if(p&&gn(t,a,e,i,r,o+1))x.isAnyOrUnknown(a)||x.isUnknown(t)||(c=a);else if(!gn(a,t,new l.DiagnosticAddendum,i,r,o+1))return s.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:Fn(t),destType:Fn(a)})),!1}else if(gn(a,t,e,i,r,o+1))p||x.isUnknown(a)||(c=a);else{if(i.isLocked())return s.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:Fn(a),destType:Fn(t)})),!1;gn(t,a,new l.DiagnosticAddendum,i,r,o+1)||(c=x.combineTypes([a,t]))}}return e.details.boundType&&!gn(e.details.boundType,c,s.createAddendum(),void 0,0,o+1)?(e.details.isSynthesized||s.addMessage(h.Localizer.DiagnosticAddendum.typeBound().format({sourceType:Fn(c),destType:Fn(e.details.boundType),name:e.details.name})),!1):(i.isLocked()||i.setTypeVar(e,c,u),!0)}function gn(e,t,n,s,i=0,r=0){if(e=F.transformPossibleRecursiveTypeAlias(e),t=F.transformPossibleRecursiveTypeAlias(t),r>x.maxTypeRecursionCount)return!0;if(e===t)return!0;if(x.isUnbound(e)||x.isUnbound(t))return!0;const o=0!=(2&i);if(i&=-3,x.isTypeVar(e))if(4&i){if(x.isTypeVar(t)&&e.details.name===t.details.name)return!0}else if(!o)return!!yn(e,t,!1,n,s||new P.TypeVarMap,i,r+1)||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:Fn(t),destType:Fn(e)})),!1);if(x.isTypeVar(t)&&4&i)return!(!x.isTypeVar(e)||e.details.name!==t.details.name)||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:Fn(t),destType:Fn(e)})),!1);if(x.isAnyOrUnknown(e))return!0;if(x.isAnyOrUnknown(t)){if(s){const n=F.isEllipsisType(t)?x.AnyType.create():t;F.setTypeArgumentsRecursive(e,n,s)}if(0==(8&i))return!0}if(x.isNever(t))return s&&F.setTypeArgumentsRecursive(e,x.UnknownType.create(),s),!0;if(x.isTypeVar(t)){if(o)return yn(t,e,!0,n,s||new P.TypeVarMap,i,r+1);if(32&i)return e===t||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:Fn(t),destType:Fn(e)})),!1);const a=F.getConcreteTypeFromTypeVar(t);return gn(e,a,n,void 0,i,r+1)}if(r>x.maxTypeRecursionCount)return!0;if(1&i&&(10===t.category||10===e.category))return!!x.isTypeSame(t,e)||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:Fn(t),destType:Fn(e)})),!1);if(10===t.category){let o=!1;return t.subtypes.forEach(t=>{gn(e,t,n.createAddendum(),s,i,r+1)||(o=!0)}),!o||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:Fn(t),destType:Fn(e)})),!1)}if(10===e.category){const o=new l.DiagnosticAddendum;let a=!1;if(3===t.category&&e.subtypes.some(e=>3===e.category))a=!0;else{let n,l;e.subtypes.forEach(e=>{const c=null==s?void 0:s.clone();if(gn(e,t,o,c,i,r+1)&&(a=!0,c)){const e=c.getScore();(void 0===l||l<=e)&&(l=e,n=c)}}),s&&n&&s.copyFromClone(n)}return!!a||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:Fn(t),destType:Fn(e)})),n.addAddendum(o),!1)}if(3===e.category&&3===t.category)return!0;if(x.isObject(t)&&x.ClassType.isBuiltIn(t.classType,"Type")){const o=t.classType.typeArguments;if(o&&o.length>=1){if(x.isAnyOrUnknown(o[0]))return!0;if(x.isObject(o[0]))return!!gn(e,o[0].classType,n.createAddendum(),s,i,r+1)||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:Fn(t),destType:Fn(e)})),!1)}}if(x.isClass(e)&&x.isClass(t))return!!un(e,t,n,s,i,r+1,!1)||(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:Fn(t),destType:Fn(e)})),!1);if(x.isObject(e)){const o=e.classType;if(x.ClassType.isBuiltIn(o,"type")&&(x.isClass(t)||5===t.category||6===t.category))return!0;if(x.ClassType.isBuiltIn(o,"Type")){const e=o.typeArguments;if(e&&e.length>=1){if(x.isAnyOrUnknown(e[0]))return!0;if(x.isObject(e[0]))return gn(e[0].classType,t,n,s,i,r+1);if(x.isTypeVar(e[0])){if(x.isClass(t)||x.isNone(t)&&x.TypeBase.isInstantiable(t))return gn(e[0],F.convertToInstance(t),n,s,i,r+1);if(5===t.category||6===t.category)return gn(e[0],t,n,s,i,r+1);if(x.isObject(t)&&x.ClassType.isProtocolClass(t.classType))return!0}}}if(x.isObject(t))return void 0===e.classType.literalValue||void 0!==t.classType.literalValue&&x.ClassType.isLiteralValueSame(t.classType,e.classType)?!!un(o,t.classType,n,s,i,r+1,!0):(n.addMessage(h.Localizer.DiagnosticAddendum.literalAssignmentMismatch().format({sourceType:Fn(t),destType:Fn(e)})),!1);if(5===t.category){const o=fn(e);if(o)return Tn(o,t,n,s,i,r+1);if(x.ClassType.isBuiltIn(e.classType)&&"object"===e.classType.details.name)return!0}else if(x.isModule(t)){if(x.ClassType.isBuiltIn(o,"ModuleType"))return!0}else if(x.isClass(t)){if(x.ClassType.isBuiltIn(e.classType,"object"))return!0;const a=t.details.effectiveMetaclass;if(a){if(x.isAnyOrUnknown(a))return!0;if(x.isClass(a)&&!x.ClassType.isBuiltIn(a,"type"))return un(o,a,n,s,i,r+1,!1)}}const a=fn(e);a&&(e=a)}if(5===e.category){let o;if(6===t.category){const a=t.overloads,l=a.findIndex(t=>{const o=s?s.clone():void 0;return gn(e,t,n.createAddendum(),o,i,r+1)});if(l<0)return n.addMessage(h.Localizer.DiagnosticAddendum.noOverloadAssignable().format({type:Fn(e)})),!1;o=a[l]}else if(5===t.category)o=t;else if(x.isObject(t)){const e=F.lookUpObjectMember(t,"__call__");if(e){const t=cn(e);5===t.category&&(o=F.stripFirstParameter(t))}}else if(x.isClass(t)){const e=x.FunctionType.createInstance("__init__","",69);e.details.declaredReturnType=x.ObjectType.create(t);let n=F.lookUpClassMember(t,"__init__",12);n||(n=F.lookUpClassMember(t,"__new__",12));const s=n?cn(n):void 0;s&&5===s.category?s.details.parameters.forEach((t,n)=>{n>0&&x.FunctionType.addParameter(e,t)}):x.FunctionType.addDefaultParameters(e),o=e}if(o&&Tn(e,o,n.createAddendum(),s,i,r+1))return!0}if(6===e.category){const s=n.createAddendum();return!e.overloads.some(e=>!gn(e,t,s.createAddendum(),new P.TypeVarMap,i,r+1))||(s.addMessage(h.Localizer.DiagnosticAddendum.overloadNotAssignable().format({name:e.overloads[0].details.name})),!1)}return!(!x.isObject(e)||!x.ClassType.isBuiltIn(e.classType,"object"))||(x.isNone(t)&&x.isObject(e)&&x.ClassType.isProtocolClass(e.classType)&&V&&x.isClass(V)?pn(e.classType,V,n,s,i,r):x.isNone(e)?(n.addMessage(h.Localizer.DiagnosticAddendum.assignToNone()),!1):(n.addMessage(h.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:Fn(t),destType:Fn(e)})),!1))}function fn(e){if(!x.ClassType.isProtocolClass(e.classType))return;const t=F.lookUpObjectMember(e,"__call__");if(!t)return;const n=cn(t);if(5===n.category){const t=In(e,n,!1,void 0);if(t)return t}}function _n(e,t,n,s,i,r,o){gn(t,e,new l.DiagnosticAddendum,i,2|r,o+1);const a=F.specializeType(e,i,!1,o+1);return!!gn(t,a,s.createAddendum(),void 0,r,o+1)||(s.addMessage(h.Localizer.DiagnosticAddendum.paramAssignment().format({index:n+1,sourceType:Fn(a),destType:Fn(t)})),!1)}function Tn(e,t,n,s,i,r){let o=!0;const a=0==(16&i);i&=-17;const l=t.details.parameters,c=e.details.parameters,p=l.findIndex((e,t)=>2===e.category||1===e.category&&!e.name||t>0&&1===l[t-1].category);let u=p<0?l:l.slice(0,p);const d=u.findIndex(e=>1===e.category&&e.name);u=u.filter(e=>0===e.category&&e.name);const m=c.findIndex((e,t)=>2===e.category||1===e.category&&!e.name||t>0&&1===c[t-1].category);let y=m<0?c:c.slice(0,m);const g=y.findIndex(e=>1===e.category&&e.name);y=y.filter(e=>0===e.category&&e.name);const f=Math.min(u.length,y.length);if(!x.FunctionType.shouldSkipParamCompatibilityCheck(e)){for(let a=0;a<f;a++){const p=x.FunctionType.getEffectiveParameterType(t,l.findIndex(e=>e===u[a]));_n(x.FunctionType.getEffectiveParameterType(e,c.findIndex(e=>e===y[a])),p,a+1,n.createAddendum(),s,i,r)||(o=!1)}if(y.length<u.length){if(!e.details.paramSpec){const a=l.filter(e=>!!e.name&&!e.hasDefault).length;if(g<0)y.length<a&&(n.createAddendum().addMessage(h.Localizer.DiagnosticAddendum.functionTooFewParams().format({expected:a,received:y.length})),o=!1);else{const a=x.FunctionType.getEffectiveParameterType(e,g);if(!x.isAnyOrUnknown(a))for(let e=y.length;e<u.length;e++)_n(a,x.FunctionType.getEffectiveParameterType(t,l.findIndex(t=>t===u[e])),e+1,n.createAddendum(),s,i,r)||(o=!1)}}}else if(u.length<y.length)if(d>=0){const a=x.FunctionType.getEffectiveParameterType(t,d);if(!x.isAnyOrUnknown(a))for(let t=u.length;t<y.length;t++)_n(x.FunctionType.getEffectiveParameterType(e,c.findIndex(e=>e===y[t])),a,t+1,n.createAddendum(),s,i,r)||(o=!1)}else n.addMessage(h.Localizer.DiagnosticAddendum.functionTooManyParams().format({expected:u.length,received:y.length})),o=!1;if(d>=0&&g>=0){const a=x.FunctionType.getEffectiveParameterType(t,d);_n(x.FunctionType.getEffectiveParameterType(e,g),a,g+1,n.createAddendum(),s,i,r)||(o=!1)}d<0&&g>=0&&(n.createAddendum().addMessage(h.Localizer.DiagnosticAddendum.argsParamMissing().format({paramName:c[g].name})),o=!1);const a=new Map;let _=!1;m>=0&&c.forEach((e,t)=>{t>=m&&(2===e.category?_=!0:e.name&&0===e.category&&a.set(e.name,e))}),p>=0&&l.forEach((e,t)=>{if(t>=p&&e.name&&0===e.category){const t=a.get(e.name),l=n.createAddendum();if(t){const n=F.specializeType(t.type,s,!1,r+1);gn(e.type,n,l.createAddendum(),void 0,i,r+1)||(l.addMessage(h.Localizer.DiagnosticAddendum.namedParamTypeMismatch().format({name:e.name,sourceType:Fn(n),destType:Fn(e.type)})),o=!1),a.delete(e.name)}else _||e.hasDefault||(l.addMessage(h.Localizer.DiagnosticAddendum.namedParamMissingInDest().format({name:e.name})),o=!1)}}),a.forEach((e,t)=>{n.createAddendum().addMessage(h.Localizer.DiagnosticAddendum.namedParamMissingInSource().format({name:t})),o=!1})}if(s&&!s.isLocked()&&s.getTypeVars().forEach(e=>{const t=F.specializeType(e.type,s,!1);t!==e.type&&s.setTypeVar(e.typeVar,t,s.isNarrowable(e.typeVar))}),a){const a=on(e);if(!x.isAnyOrUnknown(a)){let e=on(t);s&&(e=F.specializeType(e,s,!1));const l=n.createAddendum();gn(a,e,l.createAddendum(),s,i,r+1)||(l.addMessage(h.Localizer.DiagnosticAddendum.functionReturnTypeMismatch().format({sourceType:Fn(e),destType:Fn(a)})),o=!1)}e.details.paramSpec&&s&&!s.isLocked()&&s.setParamSpec(e.details.paramSpec,t.details.parameters.map((e,t)=>({name:e.name||"__p"+t,type:e.type})).slice(e.details.parameters.length,t.details.parameters.length))}return o}function vn(e,t){const n=x.ClassType.getAliasClass(t);if(n.details.typeParameters.length>0&&t.typeArguments&&t.typeArguments.length<=n.details.typeParameters.length){const s=new P.TypeVarMap;qe(x.ClassType.cloneForSpecialization(n,void 0,!1),x.ObjectType.create(e),s);let i=!1;const r=t.typeArguments.map((e,t)=>{const r=n.details.typeParameters[t],o=s.getTypeVar(r);return o&&(2===o.category||x.isAnyOrUnknown(e))?(i=!0,o):e});if(i)return x.ClassType.cloneForSpecialization(t,r,!0)}}function bn(e,t){const n=new l.DiagnosticAddendum,s=F.doForSubtypes(t,t=>{const s=F.doForSubtypes(e,s=>{if(x.isAnyOrUnknown(e))return e;if(gn(s,t,n)){if(x.isClass(s)&&x.isClass(t)){const e=vn(s,t);e&&(t=e)}else if(x.isObject(s)&&x.isObject(t)){const e=vn(s.classType,t.classType);e&&(t=x.ObjectType.create(e))}return t}});return x.isNever(s)?t:s});return x.isAnyOrUnknown(t)?e:s}function Cn(e){const t=new Map;e.details.mro.forEach(e=>{x.isClass(e)&&e.details.fields.forEach((n,s)=>{if(n.isClassMember()){let i;const r=D.getLastTypedDeclaredForSymbol(n);i=!(!r||3!==r.type)&&!!(8&vt(r.node,!0)),t.has(s)||t.set(s,{symbol:n,symbolName:s,isAbstract:i,classType:e})}})});const n=[];return t.forEach(e=>{e.isAbstract&&n.push(e)}),n}function Sn(e){if(!e.details.typedDictEntries){const t=new Map;!function e(t,n,s=0){a.assert(x.ClassType.isTypedDictClass(t)),s>x.maxTypeRecursionCount||(t.details.baseClasses.forEach(t=>{x.isClass(t)&&x.ClassType.isTypedDictClass(t)&&e(t,n,s+1)}),t.details.fields.forEach((e,s)=>{if(!e.isIgnoredForProtocolMatch()){const i=D.getLastTypedDeclaredForSymbol(e);i&&1===i.type&&n.set(s,{valueType:rn(e)||x.UnknownType.create(),isRequired:!x.ClassType.isCanOmitDictValues(t),isProvided:!1})}}))}(e,t),e.details.typedDictEntries=t}const t=new Map;return e.details.typedDictEntries.forEach((e,n)=>{t.set(n,Object.assign({},e))}),t}function In(e,t,n,s){if(5===t.category){if(!e)return F.stripFirstParameter(t);if(x.FunctionType.isInstanceMethod(t)&&!n){if(x.isObject(e))return Dn(e,t,s)}else if(x.FunctionType.isClassMethod(t)||n)return Dn(x.isClass(e)?e:e.classType,t,s)}else if(6===t.category){const i=x.OverloadedFunctionType.create();return t.overloads.forEach(t=>{const s=In(e,t,n,void 0);s&&x.OverloadedFunctionType.addOverload(i,s)}),1===i.overloads.length?i.overloads[0]:0===i.overloads.length?void t.overloads.forEach(t=>{In(e,t,n,s)}):i}return t}function Dn(e,t,n){const s=x.isClass(e)?e:e.classType,i=s.typeArguments?F.buildTypeVarMapFromSpecializedClass(s):new P.TypeVarMap;t.details.parameters.length>0&&gn(t.details.parameters[0].type,e,new l.DiagnosticAddendum,i),on(t);const r=F.specializeType(t,i,!1);if(t.details.parameters.length>0){const s=t.details.parameters[0];if(s.name&&!s.isNameSynthesized&&s.hasDeclaredType){const i=F.makeTypeVarsConcrete(x.FunctionType.getEffectiveParameterType(t,0)),r=new l.DiagnosticAddendum;if(!gn(i,e,r)){if(!n)return;Ie(Jt(n).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.bindTypeMismatch().format({type:Fn(e),methodName:t.details.name,paramName:s.name})+r.getString(),n)}}}return F.stripFirstParameter(r)}function kn(e,n=0){let s=e.details.name;if(!x.ClassType.isPseudoGenericClass(e))if(e.typeArguments)e.typeArguments.length>0?(0==(2&t.printTypeFlags)||e.typeArguments.some(e=>!x.isAnyOrUnknown(e)))&&(s+="["+e.typeArguments.map(e=>Fn(e,!1,n+1)).join(", ")+"]"):F.isTupleClass(e)&&(s+="[()]");else{const i=x.ClassType.getTypeParameters(e);i.length>0&&(0==(2&t.printTypeFlags)||i.some(e=>!x.isAnyOrUnknown(e)))&&(s+="["+i.map(e=>Fn(e,!1,n+1)).join(", ")+"]")}return s}function xn(e,n=0){const s=e.details.parameters.map((s,i)=>{let r="";1===s.category?r+="*":2===s.category&&(r+="**"),s.name&&(r+=s.name);let o="=";if(s.name)if(s.hasDeclaredType||s.isTypeInferred){const t=x.FunctionType.getEffectiveParameterType(e,i);r+=": "+(n<x.maxTypeRecursionCount?Fn(t,!1,n+1):""),o=" = "}else 0==(2&t.printTypeFlags)&&(r+=": Unknown",o=" = ");else 0===s.category&&(r+="/");if(e.details.declaration){const t=e.ignoreFirstParamOfDeclaration?i+1:i,n=e.details.declaration.node.parameters[t];n.defaultValue&&(r+=o+v.printExpression(n.defaultValue))}return r}),i=on(e);let r=n<x.maxTypeRecursionCount?Fn(i,!1,n+1):"";return 8&t.printTypeFlags&&10===i.category&&n>0&&(r=`(${r})`),[s,r]}function Fn(e,n=!1,s=0){if(s>=x.maxTypeRecursionCount)return"...";if(e.typeAliasInfo&&!n){let n=e.typeAliasInfo.aliasName;return e.typeAliasInfo.typeArguments?(0==(2&t.printTypeFlags)||e.typeAliasInfo.typeArguments.some(e=>!x.isAnyOrUnknown(e)))&&(n+="["+e.typeAliasInfo.typeArguments.map(e=>Fn(e,!1,s+1)).join(", ")+"]"):e.typeAliasInfo.typeParameters&&(0==(2&t.printTypeFlags)||e.typeAliasInfo.typeParameters.some(e=>!x.isAnyOrUnknown(e)))&&(n+="["+e.typeAliasInfo.typeParameters.map(e=>Fn(e,!1,s+1)).join(", ")+"]"),n}switch(e.category){case 0:return"Unbound";case 1:return 0!=(1&t.printTypeFlags)?"Any":"Unknown";case 9:return`Module("${e.moduleName}")`;case 7:return void 0!==e.literalValue?`Type[Literal[${F.printLiteralValue(e)}]]`:`Type[${kn(e,s+1)}]`;case 8:return void 0!==e.classType.literalValue?`Literal[${F.printLiteralValue(e.classType)}]`:kn(e.classType,s+1);case 5:{const t=xn(e,s);return e.details.paramSpec?e.details.parameters.length>0?`Callable[Concatenate[${e.details.parameters.map(e=>Fn(e.type)).join(", ")}, ${e.details.paramSpec.details.name}], ${t[1]}]`:`Callable[${e.details.paramSpec.details.name}, ${t[1]}]`:`(${t[0].join(", ")}) -> ${t[1]}`}case 6:return`Overload[${e.overloads.map(e=>Fn(e,!1,s+1)).join(", ")}]`;case 10:{const n=e;let i=n.subtypes;if(void 0!==i.find(e=>3===e.category)){const e=Fn(x.removeNoneFromUnion(n),!1,s+1);return 8&t.printTypeFlags?e+" | None":"Optional["+e+"]"}i=[],i=i.concat(...n.subtypes),0!=(1&t.printTypeFlags)&&i.some(e=>2===e.category)&&(i=i.filter(e=>!x.isUnknown(e)));const r=e=>x.isClass(e)&&x.ClassType.isPseudoGenericClass(e)||x.isObject(e)&&x.ClassType.isPseudoGenericClass(e.classType);if(i.some(e=>r(e))){const e=[];i.forEach(t=>{r(t)?x.isClass(t)?e.some(e=>x.isClass(e)&&x.ClassType.isSameGenericClass(e,t))||e.push(t):x.isObject(t)&&(e.some(e=>x.isObject(e)&&x.ClassType.isSameGenericClass(e.classType,t.classType))||e.push(t)):e.push(t)}),i=e}const o=e=>x.isObject(e)&&void 0!==e.classType.literalValue,a=e=>x.isClass(e)&&void 0!==e.literalValue,l=[];for(;i.length>0;){const e=i.shift();if(o(e)){const t=i.filter(e=>o(e));t.unshift(e);const n=t.map(e=>F.printLiteralValue(e.classType));l.push(`Literal[${n.join(", ")}]`),t.length>1&&(i=i.filter(e=>!o(e)))}else if(a(e)){const t=i.filter(e=>a(e));t.unshift(e);const n=t.map(e=>F.printLiteralValue(e));l.push(`Type[Literal[${n.join(", ")}]]`),t.length>1&&(i=i.filter(e=>!a(e)))}else l.push(Fn(e,!1,s+1))}return 1===l.length?l[0]:8&t.printTypeFlags?l.join(" | "):`Union[${l.join(", ")}]`}case 11:return e.details.isSynthesized?e.details.recursiveTypeAliasName?n&&e.details.boundType?Fn(e.details.boundType,n,s+1):e.details.recursiveTypeAliasName:e.details.boundType?Fn(e.details.boundType,!1,s+1):0!=(1&t.printTypeFlags)?"Any":"Unknown":e.details.isParamSpec?`ParamSpec('${e.details.name}')`:`TypeVar('${e.details.name}')`;case 3:return x.TypeBase.isInstantiable(e)?"NoneType":"None";case 4:return"Never";case 2:return e.isEllipsis?"...":"Any"}return""}return{runWithCancellationToken:function(e,t){try{return z=e,t()}finally{z=void 0}},getType:te,getTypeOfClass:yt,getTypeOfFunction:ft,evaluateTypesForStatement:Ot,getDeclaredTypeForExpression:ue,verifyRaiseExceptionType:function(e){const t=Gt(e,"BaseException");if(e.typeExpression){const n=te(e.typeExpression);if(n&&t&&x.isClass(t)){const s=new l.DiagnosticAddendum;F.doForSubtypes(n,n=>{if(!x.isAnyOrUnknown(n))if(x.isClass(n))if(F.derivesFromClassRecursive(n,t,!1)){let t;Ht(()=>{t=je(e.typeExpression,[],n,!1,void 0)}),t&&t.argumentErrors&&s.addMessage(h.Localizer.Diagnostic.exceptionTypeNotInstantiable().format({type:Fn(n,!1)}))}else s.addMessage(h.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:Fn(n,!1)}));else x.isObject(n)&&F.derivesFromClassRecursive(n.classType,t,!1)||s.addMessage(h.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:Fn(n,!1)}));return n}),s.isEmpty()||Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.expectedExceptionClass()+s.getString(),e.typeExpression)}}},verifyDeleteExpression:function(e){switch(e.nodeType){case 39:ne(e);break;case 36:{const t=ne(e.leftExpression),n=Ee(e,t,{method:"del"},0);K(e.memberName,n.type);break}case 24:{const t=ne(e.baseExpression,void 0,2);Re(e,t.type,{method:"del"},0),K(e,x.UnboundType.create());break}case 0:Ht(()=>{e.child&&ne(e.child)});break;default:Ie(Jt(e).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,h.Localizer.Diagnostic.delTargetExpr(),e)}},isAfterNodeReachable:_e,isNodeReachable:fe,suppressDiagnostics:Ht,getDeclarationsForNameNode:function(e){if(f.isCodeUnreachable(e))return;const t=[];if(e.parent&&23===e.parent.nodeType&&e.parent.alias&&e===e.parent.name){const n=b.getScopeForNode(e);if(n){const s=n.lookUpSymbolRecursive(e.parent.alias.value);if(s){const n=s.symbol.getDeclarations().filter(t=>6===t.type&&t.node===e.parent).map(e=>{if(6===e.type){const t=Object.assign({},e);return t.usesLocalName=!1,t}return e});t.push(...n)}}}else if(e.parent&&36===e.parent.nodeType&&e===e.parent.memberName){let n=te(e.parent.leftExpression);if(n){n=F.specializeType(n,void 0);const s=e.parent.memberName.value;F.doForSubtypes(n,e=>{let n;if(x.isClass(e)){let t=F.lookUpClassMember(e,s,16);t||(t=F.lookUpClassMember(e,s)),t&&(n=t.symbol)}else if(x.isObject(e)){let t=F.lookUpObjectMember(e,s,16);t||(t=F.lookUpObjectMember(e,s)),t&&(n=t.symbol)}else x.isModule(e)&&(n=x.ModuleType.getField(e,s));if(n){const e=n.getTypedDeclarations();e.length>0?t.push(...e):t.push(...n.getDeclarations())}return e})}}else if(e.parent&&38===e.parent.nodeType){const n=e.parent.nameParts.findIndex(t=>t===e),s=f.getImportInfo(e.parent);if(n>=0&&s&&!s.isNativeLib&&n<s.resolvedPaths.length&&s.resolvedPaths[n]){Ot(e);const i={type:6,node:void 0,path:s.resolvedPaths[n],range:d.getEmptyRange(),implicitImports:new Map,usesLocalName:!1,moduleName:""};t.push(i)}}else if(e.parent&&1===e.parent.nodeType&&e===e.parent.name){const n=e.parent,s=e.value;if(n.parent&&9===n.parent.nodeType){const e=te(n.parent.leftExpression);if(e)if(5===e.category&&e.details.declaration){const n=Xt(e,s);n&&t.push(n)}else if(x.isClass(e)){const i=oe(n.parent.leftExpression,x.ObjectType.create(e),"__init__",{method:"get"},new l.DiagnosticAddendum,13);if(i&&5===i.category){const n=Xt(i,s);if(n)t.push(n);else if(x.ClassType.isDataClass(e)){const n=F.lookUpClassMember(e,s);n&&t.push(...n.symbol.getDeclarations())}}}}}else{let n=!1;v.isWithinTypeAnnotation(e,!se(Jt(e)))&&(n=!0);const s=Kt(e,e.value,!n);s&&t.push(...s.symbol.getDeclarations())}return t},getTypeForDeclaration:Zt,resolveAliasDeclaration:tn,getTypeFromIterable:he,getTypedDictMembersForClass:Sn,getGetterTypeFromProperty:hn,markNamesAccessed:function(e,t){const n=Jt(e),s=b.getScopeForNode(e);s&&t.forEach(t=>{const i=s.lookUpSymbolRecursive(t);i&&Pe(n,i.symbol,e)})},getEffectiveTypeOfSymbol:nn,getFunctionDeclaredReturnType:ln,getFunctionInferredReturnType:an,getBuiltInType:Gt,getTypeOfMember:cn,bindFunctionToClassOrObject:In,getBoundMethod:le,getCallSignatureInfo:function(e,t,n){let s,i=e;for(;void 0!==i;){if(9===i.nodeType){s=i;break}i=i.parent}if(!s||!s.arguments)return;if(t>=d.TextRange.getEnd(s))return;const r=s.leftExpression,o=te(r);if(void 0===o)return;const a=[];let l=!1,c=0;function p(){a.push({argumentCategory:c,type:x.UnknownType.create(),active:!0})}s.arguments.forEach(e=>{let s=!1;if(!l){let i=e.start;const r=n.getItemAtPosition(i);r>=0&&(i=d.TextRange.getEnd(n.getItemAt(r-1)));let o=d.TextRange.getEnd(e);const a=n.getItemAtPosition(o);if(a>=0)for(let e=a;e<n.count;e++){const t=n.getItemAt(e);switch(t.type){case 12:case 14:break;default:continue}o=d.TextRange.getEnd(t);break}t<o&&(t>=i?s=!0:p(),l=!0)}c=e.argumentCategory,a.push({valueExpression:e.valueExpression,argumentCategory:e.argumentCategory,name:e.name,active:s})}),l||p();const u=[];function h(e){let t;Yt(s,()=>{t=$e(r,a,e,new P.TypeVarMap,!0,!0,void 0)}),u.push({type:e,activeParam:null==t?void 0:t.activeParam})}function m(e){5===e.category?h(e):e.overloads.forEach(h)}return F.doForSubtypes(o,e=>{switch(e.category){case 5:case 6:m(e);break;case 7:{let t;t=le(e,"__init__",!1),t||(t=le(e,"__new__",!0)),t&&m(t);break}case 8:{const t=le(e.classType,"__call__",!1);t&&m(t);break}}}),0!==u.length?{callNode:s,signatures:u}:void 0},getTypeAnnotationForParameter:ce,canAssignType:gn,canOverrideMethod:function(e,t,n){if(6===e.category&&(e=e.overloads[e.overloads.length-1]),5!==e.category)return n.addMessage(h.Localizer.DiagnosticAddendum.overrideType().format({type:Fn(e)})),!1;let s=!0;const i=e.details.parameters,r=t.details.parameters;let o=!1;if(r.length<i.length)o=!0;else if(r.length>i.length)for(let e=i.length;e<r.length;e++){const t=r[e];0===t.category&&t.name&&!t.hasDefault&&(o=!0)}o&&(n.addMessage(h.Localizer.DiagnosticAddendum.overrideParamCount().format({baseCount:i.length,overrideCount:r.length})),s=!1);const a=Math.min(i.length,r.length),l=i.findIndex(e=>!e.name&&0===e.category);for(let o=0;o<a;o++){const a=i[o],c=r[o];if(o>l&&!I.isPrivateOrProtectedName(a.name||"")&&0===a.category&&a.name!==c.name)n.addMessage(h.Localizer.DiagnosticAddendum.overrideParamName().format({index:o+1,baseName:a.name||"*",overrideName:c.name||"*"})),s=!1;else{const i=x.FunctionType.getEffectiveParameterType(e,o),r=x.FunctionType.getEffectiveParameterType(t,o),l=x.isTypeVar(i)&&i.details.isSynthesized,p=x.isTypeVar(r)&&r.details.isSynthesized;l||p||a.category===c.category&&gn(r,i,n.createAddendum())||(n.addMessage(h.Localizer.DiagnosticAddendum.overrideParamType().format({index:o+1,baseType:Fn(i),overrideType:Fn(r)})),s=!1)}}const c=on(e),p=on(t);return gn(c,p,n.createAddendum())||(n.addMessage(h.Localizer.DiagnosticAddendum.overrideReturnType().format({baseType:Fn(c),overrideType:Fn(p)})),s=!1),s},addError:be,addWarning:function(e,t,n){return Ce("warning",e,t,n)},addInformation:ve,addUnusedCode:function(e,t){Se(e)||Jt(e).diagnosticSink.addUnusedCodeWithTextRange(h.Localizer.Diagnostic.unreachableCode(),t)},addDiagnostic:Ie,addDiagnosticForTextRange:function(e,t,n,s,i){if("none"===t)return;const r=e.diagnosticSink.addDiagnosticWithTextRange(t,s,i);return r.setRule(n),r},printType:Fn,printFunctionParts:xn,getTypeCacheSize:function(){return L.size}}}},2590:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.TypeStubWriter=void 0;const o=r(n(563)),a=r(n(8494)),l=n(427),c=n(5083),p=r(n(1766));class u{constructor(e){this.importName=e,this.isAccessed=!1}}class d extends u{constructor(e,t,n){super(e),this.alias=t,this.symbol=n}}class h extends u{constructor(e,t,n){super(e),this.isWildcardImport=t,this.node=n,this.symbols=[]}addSymbol(e,t,n,s=!1){this.symbols.find(e=>e.name===t)||this.symbols.push({symbol:e,name:t,alias:n,isAccessed:s})}}class m extends l.ParseTreeWalker{constructor(e,t){super(),this._accessedImportedSymbols=e,this._treatStringsAsSymbols=t}analyze(e){this.walk(e)}walk(e){o.isCodeUnreachable(e)||super.walk(e)}visitName(e){return this._accessedImportedSymbols.set(e.value,!0),!0}visitString(e){return this._treatStringsAsSymbols&&this._accessedImportedSymbols.set(e.value,!0),!0}}class y extends l.ParseTreeWalker{constructor(e,t,n){super(),this._stubPath=e,this._sourceFile=t,this._evaluator=n,this._indentAmount=0,this._includeAllImports=!1,this._typeStubText="",this._lineEnd="\n",this._tab="    ",this._classNestCount=0,this._functionNestCount=0,this._ifNestCount=0,this._emittedSuite=!1,this._emitDocString=!0,this._trackedImportAs=new Map,this._trackedImportFrom=new Map,this._accessedImportedSymbols=new Map,this._stubPath.endsWith("__init__.pyi")&&(this._includeAllImports=!0)}write(){const e=this._sourceFile.getParseResults();this._lineEnd=e.tokenizerOutput.predominantEndOfLineSequence,this._tab=e.tokenizerOutput.predominantTabSequence,this.walk(e.parseTree),this._writeFile()}walk(e){o.isCodeUnreachable(e)||super.walk(e)}visitClass(e){const t=e.name.value;this._emittedSuite=!0,this._emitDocString=!0,this._emitDecorators(e.decorators);let n="class "+t;return e.arguments.length>0&&(n+=`(${e.arguments.map(e=>{let t="";return e.name&&(t=e.name.value+"="),t+=this._printExpression(e.valueExpression),t}).join(", ")})`),n+=":",this._emitLine(n),this._emitSuite(()=>{this._classNestCount++,this.walk(e.suite),this._classNestCount--}),this._emitLine(""),this._emitLine(""),!1}visitFunction(e){const t=e.name.value;if(0===this._functionNestCount&&!p.isPrivateOrProtectedName(t)){this._emittedSuite=!0,this._emitDocString=!0,this._emitDecorators(e.decorators);let n,s=e.isAsync?"async ":"";s+="def "+t,s+=`(${e.parameters.map((t,n)=>this._printParameter(t,e,n)).join(", ")})`,e.returnTypeAnnotation?n=this._printExpression(e.returnTypeAnnotation,!0):e.functionAnnotationComment?n=this._printExpression(e.functionAnnotationComment.returnTypeAnnotation,!0):"__init__"===e.name.value?n="None":"__str__"===e.name.value?n="str":["__int__","__hash__"].some(t=>t===e.name.value)?n="int":["__eq__","__ne__","__gt__","__lt__","__ge__","__le__"].some(t=>t===e.name.value)&&(n="bool"),n&&(s+=" -> "+n),s+=":",this._emitLine(s),this._emitSuite(()=>{this._functionNestCount++,this.walk(e.suite),this._functionNestCount--}),this._emitLine("")}return!1}visitWhile(e){return this._emitDocString=!1,!1}visitFor(e){return this._emitDocString=!1,!1}visitTry(e){return this._emitDocString=!1,!1}visitWith(e){return this._emitDocString=!1,!1}visitIf(e){if(this._emitDocString=!1,0===this._functionNestCount&&0===this._ifNestCount){this._ifNestCount++,this._emittedSuite=!0,this._emitLine("if "+this._printExpression(e.testExpression)+":"),this._emitSuite(()=>{this.walkMultiple(e.ifSuite.statements)});const t=e.elseSuite;t&&(this._emitLine("else:"),this._emitSuite(()=>{19===t.nodeType?this.walkMultiple([t.testExpression,t.ifSuite,t.elseSuite]):this.walkMultiple(t.statements)})),this._ifNestCount--}return!1}visitAssignment(e){let t="";if(39===e.leftExpression.nodeType){if("__all__"===e.leftExpression.value)return!1;0===this._functionNestCount&&(t=this._printExpression(e.leftExpression))}if(t){const n=0===this._functionNestCount&&0===this._classNestCount;this._emittedSuite=!0,t+=" = ",t+=n?this._printExpression(e.rightExpression):"...",this._emitLine(t)}return!1}visitAugmentedAssignment(e){return!1}visitTypeAnnotation(e){if(0===this._functionNestCount){let t="";if(39===e.valueExpression.nodeType)t=this._printExpression(e.valueExpression);else if(36===e.valueExpression.nodeType){const n=e.valueExpression.leftExpression;if(39===n.nodeType&&"self"===n.value){const n=e.valueExpression.memberName.value;p.isPrivateOrProtectedName(n)||(t=this._printExpression(e.valueExpression))}}t&&(t+=": "+this._printExpression(e.typeAnnotation,!0),this._emitLine(t))}return!1}visitImport(e){if(this._functionNestCount>0||this._classNestCount>0)return!1;const t=c.getScopeForNode(e);return t&&e.list.forEach(e=>{const n=this._printModuleName(e.module);if(!this._trackedImportAs.has(n)){const s=e.alias?e.alias.value:e.module.nameParts.length>0?e.module.nameParts[0].value:"",i=t.lookUpSymbolRecursive(s);if(i){const t=new d(n,e.alias?e.alias.value:void 0,i.symbol);this._trackedImportAs.set(n,t)}}}),!1}visitImportFrom(e){if(this._functionNestCount>0||this._classNestCount>0)return!1;const t=c.getScopeForNode(e);if(t){const n=this._printModuleName(e.module);let s=this._trackedImportFrom.get(n);s||(s=new h(n,e.isWildcardImport,e),this._trackedImportFrom.set(n,s)),e.imports.forEach(e=>{const n=e.alias?e.alias.value:e.name.value,i=t.lookUpSymbolRecursive(n);i&&s.addSymbol(i.symbol,e.name.value,e.alias?e.alias.value:void 0,!1)})}return!1}visitStatementList(e){return e.statements.length>0&&49===e.statements[0].nodeType&&!this._emittedSuite&&this._emitDocString&&this._emitLine(this._printExpression(e.statements[0])),this._emitDocString=!1,this.walkMultiple(e.statements),!1}_emitSuite(e){this._increaseIndent(()=>{const t=this._emittedSuite;this._emittedSuite=!1,e(),this._emittedSuite||this._emitLine("..."),this._emittedSuite=t})}_increaseIndent(e){this._indentAmount++,e(),this._indentAmount--}_emitDecorators(e){e.forEach(e=>{this._emitLine("@"+this._printExpression(e.expression))})}_printHeaderDocString(){return'"""'+this._lineEnd+"This type stub file was generated by pyright."+this._lineEnd+'"""'+this._lineEnd+this._lineEnd}_emitLine(e){for(let e=0;e<this._indentAmount;e++)this._typeStubText+=this._tab;this._typeStubText+=e+this._lineEnd}_printModuleName(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+=e.nameParts.map(e=>e.value).join("."),t}_printParameter(e,t,n){let s="";1===e.category?s+="*":2===e.category&&(s+="**"),e.name&&(s+=e.name.value);const i=this._evaluator.getTypeAnnotationForParameter(t,n);let r="";return i&&(r=this._printExpression(i,!0)),r&&(s+=": "+r),e.defaultValue&&(s+=r?" = ...":"=..."),s}_printArgument(e){let t="";return 1===e.argumentCategory?t+="*":2===e.argumentCategory&&(t+="**"),e.name&&(t+=e.name.value+"="),t+this._printExpression(e.valueExpression)}_printExpression(e,t=!1,n=!1){return new m(this._accessedImportedSymbols,n).analyze(e),a.printExpression(e,t?1:0)}_printTrackedImports(){let e="",t=!1;return this._trackedImportAs.forEach(n=>{this._accessedImportedSymbols.get(n.alias||n.importName)&&(n.isAccessed=!0),(n.isAccessed||this._includeAllImports)&&(e+="import "+n.importName,n.alias&&(e+=" as "+n.alias),e+=this._lineEnd,t=!0)}),this._trackedImportFrom.forEach(n=>{n.symbols.forEach(e=>{this._accessedImportedSymbols.get(e.alias||e.name)&&(e.isAccessed=!0)}),n.isWildcardImport&&(e+=`from ${n.importName} import *`+this._lineEnd,t=!0);const s=n.symbols.filter(e=>e.isAccessed||this._includeAllImports).sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0);s.length>0&&(e+=`from ${n.importName} import `,e+=s.map(e=>{let t=e.name;return e.alias&&(t+=" as "+e.alias),t}).join(", "),e+=this._lineEnd,t=!0)}),t&&(e+=this._lineEnd),e}_writeFile(){let e=this._printHeaderDocString();e+=this._printTrackedImports(),e+=this._typeStubText,this._sourceFile.fileSystem.writeFileSync(this._stubPath,e,"utf8")}}t.TypeStubWriter=y},5168:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDeclaringModulesForType=t.printLiteralValue=t.computeMroLinearization=t.requiresSpecialization=t.requiresTypeArguments=t.getConcreteTypeFromTypeVar=t.isPartlyUnknown=t.getMembersForModule=t.getMembersForClass=t.convertToInstantiable=t.convertToInstance=t.getDeclaredGeneratorReturnType=t.getDeclaredGeneratorSendType=t.getDeclaredGeneratorYieldType=t.removeTruthinessFromType=t.removeFalsinessFromType=t.derivesFromClassRecursive=t.buildTypeVarMap=t.buildTypeVarMapFromSpecializedClass=t.setTypeArgumentsRecursive=t.stripFirstParameter=t.selfSpecializeClassType=t.getTypeVarArgumentsRecursive=t.addTypeVarsToListIfUnique=t.lookUpClassMember=t.lookUpObjectMember=t.specializeType=t.makeTypeVarsConcrete=t.partiallySpecializeType=t.isTupleClass=t.isProperty=t.isParamSpecType=t.isNoReturnType=t.isEllipsisType=t.isLiteralType=t.getSpecializedTupleType=t.canBeTruthy=t.canBeFalsy=t.transformPossibleRecursiveTypeAlias=t.isTypeAliasRecursive=t.isTypeAliasPlaceholder=t.transformTypeObjectToClass=t.stripLiteralTypeArgsValue=t.enumerateLiteralsForType=t.stripLiteralValue=t.derivesFromAnyOrUnknown=t.areTypesSame=t.doForSubtypes=t.isOptionalType=void 0;const s=n(817),i=n(2917),r=n(1133),o=n(1659),a=/'/g,l=/'''/g;function c(e,t){if(10===e.category){const n=[];return e.subtypes.forEach(e=>{const s=t(e);s&&n.push(s)}),r.combineTypes(n)}return t(e)||r.NeverType.create()}function p(e){return r.isObject(e)?(void 0!==e.classType.literalValue&&(e=r.ObjectType.create(r.ClassType.cloneWithLiteral(e.classType,void 0))),e):r.isClass(e)?(void 0!==e.literalValue&&(e=r.ClassType.cloneWithLiteral(e,void 0)),e):10===e.category?c(e,e=>p(e)):e}function u(e){if(!r.isObject(e))return e;const t=e.classType;if(!r.ClassType.isBuiltIn(t,"Type"))return e;if(!t.typeArguments||t.typeArguments.length<1)return e;const n=t.typeArguments[0];return r.isObject(n)?n.classType:e}function d(e,t=0){if(t>r.maxTypeRecursionCount)return!0;switch(e.category){case 0:case 1:case 2:case 4:case 3:return!0;case 10:return e.subtypes.some(e=>d(e,t+1));case 5:case 6:case 7:case 9:case 11:return!1;case 8:return y(e.classType)&&e.classType.typeArguments?0===e.classType.typeArguments.length||!!m(e.classType.typeArguments[e.classType.typeArguments.length-1]):!!_(e,"__len__")||(!!_(e,"__bool__")||!(!r.ClassType.isBuiltIn(e.classType,"bool")||!1!==e.classType.literalValue))}}function h(e,t=0){if(t>r.maxTypeRecursionCount)return!0;switch(e.category){case 1:case 5:case 6:case 7:case 9:case 11:case 4:case 2:return!0;case 10:return e.subtypes.some(e=>h(e,t+1));case 0:case 3:return!1;case 8:return!(y(e.classType)&&e.classType.typeArguments&&0===e.classType.typeArguments.length||r.ClassType.isBuiltIn(e.classType,"bool")&&!1===e.classType.literalValue)}}function m(e){return!(2!==e.category||!e.isEllipsis)||r.isClass(e)&&r.ClassType.isBuiltIn(e,"ellipsis")}function y(e){return r.ClassType.isBuiltIn(e)&&("Tuple"===e.details.name||"tuple"===e.details.name)}function g(e,t){return r.ClassType.isGeneric(t)?e:f(e,b(t),!1)}function f(e,t,n=!1,s=0){var i;if(s>r.maxTypeRecursionCount)return e;if(!P(e))return e;if(t&&!n&&0===t.typeVarCount())return e;if(r.isAnyOrUnknown(e))return e;if(r.isNone(e))return e;if(r.isTypeVar(e)){if(e.details.recursiveTypeAliasName){if(!(null===(i=e.typeAliasInfo)||void 0===i?void 0:i.typeArguments))return e;const n=e.typeAliasInfo.typeArguments.map(e=>f(e,t,!1,s+1));return r.TypeBase.cloneForTypeAlias(e,e.typeAliasInfo.aliasName,e.typeAliasInfo.typeParameters,n)}if(!t)return e.details.boundType?f(e.details.boundType,void 0,!1,s+1):n?r.UnknownType.create():e;{const n=t.getTypeVar(e);if(n)return r.TypeBase.isInstantiable(e)&&!r.TypeBase.isInstantiable(n)?I(n):n}return e}if(10===e.category){const i=[];return e.subtypes.forEach(e=>{i.push(f(e,t,n,s+1))}),r.combineTypes(i)}if(r.isObject(e)){const i=D(e.classType,t,n,s+1);if(r.ClassType.isBuiltIn(i,"Type")){const e=i.typeArguments;if(e&&e.length>=1){const i=e[0];if(r.isObject(i))return f(i.classType,t,n,s+1);if(r.isTypeVar(i)&&t){const e=t.getTypeVar(i);if(e&&r.isObject(e))return e.classType}}}return i===e.classType?e:r.ObjectType.create(i)}return r.isClass(e)?D(e,t,n,s+1):5===e.category?x(e,t,n,s+1):6===e.category?function(e,t,n,s){const i=e.overloads.map(e=>x(e,t,n,s)),o=r.OverloadedFunctionType.create();return i.forEach(e=>{r.OverloadedFunctionType.addOverload(o,e)}),o}(e,t,n,s+1):e}function _(e,t,n=0){if(r.isObject(e))return T(e.classType,t,n)}function T(e,t,n=0){const i=0!=(16&n);if(r.isClass(e)){let o=!1;for(const s of e.details.mro){if(!r.isClass(s)){o=!0;continue}const a=g(s,e);if(r.isClass(a)&&!(4&n&&r.ClassType.isBuiltIn(a,"object"))){if(0==(1&n)||a.details!==e.details){const e=a.details.fields;if(0==(8&n)){const n=e.get(t);if(n&&n.isInstanceMember()){const e=n.hasTypedDeclarations();if(!i||e)return{symbol:n,isInstanceMember:!0,classType:a,isTypeDeclared:e}}}const s=e.get(t);if(s&&s.isClassMember()){const e=s.hasTypedDeclarations();if(!i||e){let t=!1;if(r.ClassType.isDataClass(a)||r.ClassType.isTypedDictClass(a)){const e=s.getDeclarations();e.length>0&&1===e[0].type&&(t=!0)}return{symbol:s,isInstanceMember:t,classType:a,isTypeDeclared:e}}}}if(0!=(2&n))break}}if(o&&!i)return{symbol:s.Symbol.createWithType(0,r.UnknownType.create()),isInstanceMember:!1,classType:r.UnknownType.create(),isTypeDeclared:!1}}else if(r.isAnyOrUnknown(e))return{symbol:s.Symbol.createWithType(0,r.UnknownType.create()),isInstanceMember:!1,classType:r.UnknownType.create(),isTypeDeclared:!1}}function v(e,t){for(const n of t)e.find(e=>r.isTypeSame(e,n))||e.push(n)}function b(e,t=!0){const n=r.ClassType.getTypeParameters(e);let s=e.typeArguments;return s||t||(s=n),C(n,s)}function C(e,t){const n=new o.TypeVarMap;return e.forEach((e,s)=>{let i;i=t?s>=t.length?r.AnyType.create():t[s]:k(e),n.setTypeVar(e,i,!1)}),n}function S(e){let t=c(e,e=>{switch((e=u(e)).category){case 7:return r.ObjectType.create(e);case 3:return r.NoneType.createInstance();case 5:if(r.TypeBase.isInstantiable(e))return r.FunctionType.cloneAsInstance(e);break;case 11:if(r.TypeBase.isInstantiable(e))return r.TypeVarType.cloneAsInstance(e)}return e});return e.typeAliasInfo&&e!==t&&(t=r.TypeBase.cloneForTypeAlias(t,e.typeAliasInfo.aliasName,e.typeAliasInfo.typeParameters,e.typeAliasInfo.typeArguments)),t}function I(e){let t=c(e,e=>{switch(e.category){case 8:return e.classType;case 3:return r.NoneType.createType();case 5:if(r.TypeBase.isInstance(e))return r.FunctionType.cloneAsInstantiable(e);break;case 11:if(r.TypeBase.isInstance(e))return r.TypeVarType.cloneAsInstantiable(e)}return e});return e.typeAliasInfo&&e!==t&&(t=r.TypeBase.cloneForTypeAlias(t,e.typeAliasInfo.aliasName,e.typeAliasInfo.typeParameters,e.typeAliasInfo.typeArguments)),t}function D(e,t,n,s){if(0===r.ClassType.getTypeParameters(e).length&&!r.ClassType.isSpecialBuiltIn(e))return e;let i,o=[],a=!1;return e.typeArguments?(o=e.typeArguments.map(e=>{const i=f(e,t,n,s+1);return i!==e&&(a=!0),i}),e.effectiveTypeArguments&&(i=e.effectiveTypeArguments.map(e=>{const i=f(e,t,n,s+1);return i!==e&&(a=!0),i}))):r.ClassType.getTypeParameters(e).forEach(e=>{let i;t&&t.hasTypeVar(e)?(i=t.getTypeVar(e),a=!0):(i=n?k(e,void 0,s+1):e,i!==e&&(a=!0)),o.push(i)}),a?r.ClassType.cloneForSpecialization(e,o,!1,void 0,i):e}function k(e,t=!1,n=0){return e.details.boundType?e.details.recursiveTypeAliasName?e.details.boundType:f(e.details.boundType,void 0,!1,n+1):t&&e.details.constraints.length>0?r.combineTypes(e.details.constraints):r.UnknownType.create()}function x(e,t,n,s){let i=e;if(i.details.paramSpec){let e=null==t?void 0:t.getParamSpec(i.details.paramSpec);!e&&n&&(e=[{name:"args",type:r.AnyType.create()},{name:"kwargs",type:r.AnyType.create()}]),e&&(i=r.FunctionType.cloneForParamSpec(i,e))}const o=i.specializedTypes&&i.specializedTypes.returnType?i.specializedTypes.returnType:i.details.declaredReturnType,a=o?f(o,t,n,s+1):void 0;let l=o!==a;const c={parameterTypes:[],returnType:a};for(let e=0;e<i.details.parameters.length;e++){const o=r.FunctionType.getEffectiveParameterType(i,e),a=f(o,t,n,s+1);c.parameterTypes.push(a),o!==a&&(l=!0)}if(!l)return i;let p;return i.inferredReturnType&&(p=f(i.inferredReturnType,t,n,s+1)),r.FunctionType.cloneForSpecialization(i,c,p)}function F(e){if(r.isObject(e)){const t=e.classType;if(r.ClassType.isBuiltIn(t)){const e=t.details.name;if("Generator"===e||"AsyncGenerator"===e)return t.typeArguments;if("Iterator"===e||"AsyncIterator"===e||"AsyncIterable"===e)return t.typeArguments}}}function P(e,t=0){var n;switch(e.category){case 7:return e.typeArguments?!(t>r.maxTypeRecursionCount)&&void 0!==e.typeArguments.find(e=>P(e,t+1)):r.ClassType.getTypeParameters(e).length>0;case 8:return!(t>r.maxTypeRecursionCount)&&P(e.classType,t+1);case 5:{if(t>r.maxTypeRecursionCount)return!1;for(let n=0;n<e.details.parameters.length;n++)if(P(r.FunctionType.getEffectiveParameterType(e,n),t+1))return!0;const n=e.specializedTypes&&e.specializedTypes.returnType?e.specializedTypes.returnType:e.details.declaredReturnType;if(n){if(P(n,t+1))return!0}else if(e.inferredReturnType&&P(e.inferredReturnType,t+1))return!0;return!1}case 6:return void 0!==e.overloads.find(e=>P(e,t+1));case 10:return void 0!==e.subtypes.find(e=>P(e,t+1));case 11:if(!e.details.recursiveTypeAliasName)return!0;if(null===(n=e.typeAliasInfo)||void 0===n?void 0:n.typeArguments)return e.typeAliasInfo.typeArguments.some(e=>P(e,t+1))}return!1}t.isOptionalType=function(e){return 10===e.category&&e.subtypes.some(e=>r.isNone(e))},t.doForSubtypes=c,t.areTypesSame=function(e){if(e.length<2)return!0;for(let t=1;t<e.length;t++)if(!r.isTypeSame(e[0],e[t]))return!1;return!0},t.derivesFromAnyOrUnknown=function(e){let t=!1;return c(e,n=>{r.isAnyOrUnknown(e)?t=!0:r.isClass(n)?r.ClassType.hasUnknownBaseClass(n)&&(t=!0):r.isObject(n)&&r.ClassType.hasUnknownBaseClass(n.classType)&&(t=!0)}),t},t.stripLiteralValue=p,t.enumerateLiteralsForType=function(e){if(r.ClassType.isBuiltIn(e.classType,"bool"))return[r.ObjectType.create(r.ClassType.cloneWithLiteral(e.classType,!0)),r.ObjectType.create(r.ClassType.cloneWithLiteral(e.classType,!1))];if(r.ClassType.isEnumClass(e.classType)){const t=[];return e.classType.details.fields.forEach((n,s)=>{n.isIgnoredForProtocolMatch()||n.isInstanceMember()||t.push(r.ObjectType.create(r.ClassType.cloneWithLiteral(e.classType,new r.EnumLiteral(e.classType.details.name,s))))}),t}},t.stripLiteralTypeArgsValue=function e(t,n=0){if(n>r.maxTypeRecursionCount)return t;if(r.isClass(t)){if(t.typeArguments){const s=t.typeArguments.map(t=>e(p(t),n+1));return r.ClassType.cloneForSpecialization(t,s,!!t.isTypeArgumentExplicit,t.skipAbstractClassTest)}return t}if(r.isObject(t))return t.classType.typeArguments&&(t=r.ObjectType.create(e(t.classType,n+1))),t;if(10===t.category){let s=!1;const i=c(t,t=>{const i=e(t,n+1);return i!==t&&(s=!0),i});return s?i:t}if(5===t.category){if(t.specializedTypes){const s={parameterTypes:t.specializedTypes.parameterTypes.map(t=>e(p(t),n+1)),returnType:t.specializedTypes.returnType?e(p(t.specializedTypes.returnType),n+1):void 0};t=r.FunctionType.cloneForSpecialization(t,s,t.inferredReturnType)}return t}if(6===t.category){const s=r.OverloadedFunctionType.create();let i=!1;return s.overloads=t.overloads.map(t=>{const s=e(t,n+1);return s!==t&&(i=!0),s}),i?s:t}return t},t.transformTypeObjectToClass=u,t.isTypeAliasPlaceholder=function(e){return!!r.isTypeVar(e)&&!!e.details.recursiveTypeAliasName&&!e.details.boundType},t.isTypeAliasRecursive=function(e,t){if(10!==t.category)return 0===t.category&&t.typeAliasInfo&&t.typeAliasInfo.aliasName===e.details.recursiveTypeAliasName;for(const n of t.subtypes)if(r.isTypeSame(e,n))return!0;return!1},t.transformPossibleRecursiveTypeAlias=function(e){var t;if(e&&r.isTypeVar(e)&&e.details.recursiveTypeAliasName&&e.details.boundType){const n=r.TypeBase.isInstance(e)?S(e.details.boundType):e.details.boundType;return(null===(t=e.typeAliasInfo)||void 0===t?void 0:t.typeArguments)&&e.details.recursiveTypeParameters?f(n,C(e.details.recursiveTypeParameters,e.typeAliasInfo.typeArguments)):n}return e},t.canBeFalsy=d,t.canBeTruthy=h,t.getSpecializedTupleType=function(e){let t;if(r.isClass(e)?t=e:r.isObject(e)&&(t=e.classType),!t)return;const n=t.details.mro.find(e=>r.isClass(e)&&y(e));return n&&r.isClass(n)?r.ClassType.isSameGenericClass(t,n)?t:f(n,b(t)):void 0},t.isLiteralType=function(e,t=!0){return r.isObject(e)?void 0!==e.classType.literalValue:!(!t||10!==e.category||e.subtypes.some(e=>!r.isObject(e)||void 0===e.classType.literalValue))},t.isEllipsisType=m,t.isNoReturnType=function(e){if(r.isObject(e)){const t=e.classType;if(r.ClassType.isBuiltIn(t,"NoReturn"))return!0}return!1},t.isParamSpecType=function(e){return!!r.isTypeVar(e)&&e.details.isParamSpec},t.isProperty=function(e){return r.isObject(e)&&r.ClassType.isPropertyClass(e.classType)},t.isTupleClass=y,t.partiallySpecializeType=g,t.makeTypeVarsConcrete=function(e){return c(e,e=>r.isTypeVar(e)?e.details.boundType?e.details.boundType:e.details.recursiveTypeAliasName?e:r.AnyType.create():e)},t.specializeType=f,t.lookUpObjectMember=_,t.lookUpClassMember=T,t.addTypeVarsToListIfUnique=v,t.getTypeVarArgumentsRecursive=function e(t,n=0){if(n>r.maxTypeRecursionCount)return[];const s=t=>{const s=[];return t.typeArguments&&t.typeArguments.forEach(t=>{v(s,e(t,n+1))}),s};if(r.isTypeVar(t))return t.details.recursiveTypeAliasName?[]:[t];if(r.isClass(t))return s(t);if(r.isObject(t))return s(t.classType);if(10===t.category){const s=[];for(const i of t.subtypes)v(s,e(i,n+1));return s}if(5===t.category){const s=[];return t.details.parameters.forEach(t=>{v(s,e(t.type,n+1))}),t.details.declaredReturnType&&v(s,e(t.details.declaredReturnType,n+1)),s}return[]},t.selfSpecializeClassType=function(e,t=!1){if(!r.ClassType.isGeneric(e)&&!t)return e;const n=r.ClassType.getTypeParameters(e);return r.ClassType.cloneForSpecialization(e,n,!1,t)},t.stripFirstParameter=function(e){return e.details.parameters.length>0&&0===e.details.parameters[0].category?r.FunctionType.clone(e,!0):e},t.setTypeArgumentsRecursive=function e(t,n,s,i=0){if(!(i>r.maxTypeRecursionCount||s.isLocked()))switch(t.category){case 10:t.subtypes.forEach(t=>{e(t,n,s,i+1)});break;case 7:t.typeArguments&&t.typeArguments.forEach(t=>{e(t,n,s,i+1)}),t.effectiveTypeArguments&&t.effectiveTypeArguments.forEach(t=>{e(t,n,s,i+1)});break;case 8:e(t.classType,n,s,i+1);break;case 5:t.specializedTypes?(t.specializedTypes.parameterTypes.forEach(t=>{e(t,n,s,i+1)}),t.specializedTypes.returnType&&e(t.specializedTypes.returnType,n,s,i+1)):(t.details.parameters.forEach(t=>{e(t.type,n,s,i+1)}),t.details.declaredReturnType&&e(t.details.declaredReturnType,n,s,i+1));break;case 6:t.overloads.forEach(t=>{e(t,n,s,i+1)});break;case 11:s.hasTypeVar(t)||s.setTypeVar(t,n,s.isNarrowable(t))}},t.buildTypeVarMapFromSpecializedClass=b,t.buildTypeVarMap=C,t.derivesFromClassRecursive=function e(t,n,s){if(r.ClassType.isSameGenericClass(t,n))return!0;for(const i of t.details.baseClasses)if(r.isClass(i)){if(e(i,n,s))return!0}else if(!s&&r.isAnyOrUnknown(i))return!0;return!1},t.removeFalsinessFromType=function(e){return c(e,e=>{if(r.isObject(e)){if(void 0!==e.classType.literalValue)return e.classType.literalValue?e:void 0;if(r.ClassType.isBuiltIn(e.classType,"bool"))return r.ObjectType.create(r.ClassType.cloneWithLiteral(e.classType,!0))}if(h(e))return e})},t.removeTruthinessFromType=function(e){return c(e,e=>{if(r.isObject(e)){if(void 0!==e.classType.literalValue)return e.classType.literalValue?void 0:e;if(r.ClassType.isBuiltIn(e.classType,"bool"))return r.ObjectType.create(r.ClassType.cloneWithLiteral(e.classType,!1))}if(d(e))return e})},t.getDeclaredGeneratorYieldType=function(e,t){const n=r.FunctionType.getSpecializedReturnType(e);if(n){const e=F(n);return e&&e.length>=1&&r.isClass(t)?r.ObjectType.create(r.ClassType.cloneForSpecialization(t,[e[0]],!1)):n}},t.getDeclaredGeneratorSendType=function(e){const t=r.FunctionType.getSpecializedReturnType(e);if(t){const e=F(t);return e&&e.length>=2?e[1]:r.UnknownType.create()}},t.getDeclaredGeneratorReturnType=function(e){const t=r.FunctionType.getSpecializedReturnType(e);if(t){const e=F(t);return e&&e.length>=3?e[2]:r.UnknownType.create()}},t.convertToInstance=S,t.convertToInstantiable=I,t.getMembersForClass=function(e,t,n){for(let s=e.details.mro.length-1;s>=0;s--){const o=e.details.mro[s];if(r.isClass(o)){const e=r.ClassType.isTypedDictClass(o);o.details.fields.forEach((s,r)=>{(s.isClassMember()||n&&s.isInstanceMember())&&(e&&i.isTypedDictMemberAccessedThroughIndex(s)||t.get(r)||t.set(r,s))})}}if(!n){const n=e.details.effectiveMetaclass;if(n&&r.isClass(n))for(const e of n.details.mro){if(!r.isClass(e))break;e.details.fields.forEach((e,n)=>{t.get(n)||t.set(n,e)})}}},t.getMembersForModule=function(e,t){e.loaderFields&&e.loaderFields.forEach((e,n)=>{t.set(n,e)}),e.fields.forEach((e,n)=>{t.set(n,e)})},t.isPartlyUnknown=function e(t,n=!1,s=0){if(s>r.maxTypeRecursionCount)return!1;if(r.isUnknown(t))return!0;if(10===t.category){for(const i of t.subtypes)if(e(i,n,s+1))return!0;return!1}if(r.isObject(t))return e(t.classType,!1,s+1);if(r.isClass(t)){if(t.typeArguments&&!n&&!r.ClassType.isPseudoGenericClass(t))for(const i of t.typeArguments)if(e(i,n,s+1))return!0;return!1}if(6===t.category)return t.overloads.some(t=>e(t,!1,s+1));if(5===t.category){for(let n=0;n<t.details.parameters.length;n++)if(t.details.parameters[n].name&&e(r.FunctionType.getEffectiveParameterType(t,n),!1,s+1))return!0;return!(!t.details.declaredReturnType||!e(t.details.declaredReturnType,!1,s+1))}return!1},t.getConcreteTypeFromTypeVar=k,t.requiresTypeArguments=function(e){return e.details.typeParameters.length>0?!e.details.typeParameters[0].details.isSynthesized:!(!r.ClassType.isBuiltIn(e)||!["Tuple","Callable","Generic","Type","Optional","Union","Final","Literal","Annotated","TypeGuard"].some(t=>t===e.details.name))},t.requiresSpecialization=P,t.computeMroLinearization=function(e){let t=!0;const n=[],s=e.details.baseClasses.filter(e=>!r.isClass(e)||!r.ClassType.isBuiltIn(e,"Generic"));s.forEach(e=>{if(r.isClass(e)){const t=b(e,!1);n.push(e.details.mro.map(e=>f(e,t)))}else n.push([e])}),n.push(s.map(t=>f(t,b(e,!1))));const i=b(e,!1);e.details.mro.push(f(e,i));const o=(e,t)=>t.some(t=>t.findIndex(t=>r.isClass(t)&&r.ClassType.isSameGenericClass(t,e,!1))>0),a=(e,t)=>{for(let n=0;n<t.length;n++)t[n]=t[n].filter(t=>!r.isClass(t)||!r.ClassType.isSameGenericClass(t,e,!1))};for(;;){let s=!1,i=void 0;for(let t=0;t<n.length;t++){const l=n[t];if(l.length>0){if(void 0===i&&(i=l),!r.isClass(l[0])){s=!0,e.details.mro.push(l[0]),l.shift();break}if(!o(l[0],n)){s=!0,e.details.mro.push(l[0]),a(l[0],n);break}}}if(!i)break;s||(t=!1,r.isClass(i[0])?(e.details.mro.push(i[0]),a(i[0],n)):(e.details.mro.push(i[0]),i.shift()))}return t},t.printLiteralValue=function(e){const t=e.literalValue;if(void 0===t)return"";let n;if("string"==typeof t){const s="bytes"===e.details.name?"b":"";n=t.toString(),n=n.indexOf("\n")>=0?`${s}'''${n.replace(l,"\\'\\'\\'")}'''`:`${s}'${n.replace(a,"\\'")}'`}else n="boolean"==typeof t?t?"True":"False":t instanceof r.EnumLiteral?`${t.className}.${t.itemName}`:t.toString();return n},t.getDeclaringModulesForType=function(e){const t=[];return function e(t,n,s=0){if(s>r.maxTypeRecursionCount)return;const i=e=>{e&&!n.some(t=>t===e)&&n.push(e)};switch(t.category){case 7:i(t.details.moduleName);break;case 8:i(t.classType.details.moduleName);break;case 5:i(t.details.moduleName);break;case 6:t.overloads.forEach(t=>{e(t,n,s+1)});break;case 10:t.subtypes.forEach(t=>{e(t,n,s+1)});break;case 9:i(t.moduleName)}}(e,t),t}},1659:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeVarMap=void 0;const s=n(5839),i=n(1133);class r{constructor(){this._isLocked=!1,this._typeVarMap=new Map,this._paramSpecMap=new Map,this._isNarrowableMap=new Map}clone(){const e=new r;return this._typeVarMap.forEach(t=>{e.setTypeVar(t.typeVar,t.type,this.isNarrowable(t.typeVar))}),this._paramSpecMap.forEach(t=>{e.setParamSpec(t.paramSpec,t.type)}),e._isLocked=this._isLocked,e}copyFromClone(e){this._typeVarMap=e._typeVarMap,this._paramSpecMap=e._paramSpecMap,this._isNarrowableMap=e._isNarrowableMap,this._isLocked=e._isLocked}getScore(){let e=0;return this._typeVarMap.forEach(t=>{e+=1,e+=this._getComplexityScoreForType(t.type)}),e+=this._paramSpecMap.size,e}hasTypeVar(e){return this._typeVarMap.has(this._getKey(e))}getTypeVar(e){var t;return null===(t=this._typeVarMap.get(this._getKey(e)))||void 0===t?void 0:t.type}setTypeVar(e,t,n){s.assert(!this._isLocked);const i=this._getKey(e);this._typeVarMap.set(i,{typeVar:e,type:t}),this._isNarrowableMap.set(i,n)}getTypeVars(){const e=[];return this._typeVarMap.forEach(t=>{e.push(t)}),e}hasParamSpec(e){return this._paramSpecMap.has(this._getKey(e))}getParamSpec(e){var t;return null===(t=this._paramSpecMap.get(this._getKey(e)))||void 0===t?void 0:t.type}setParamSpec(e,t){s.assert(!this._isLocked),this._paramSpecMap.set(this._getKey(e),{paramSpec:e,type:t})}typeVarCount(){return this._typeVarMap.size}isNarrowable(e){const t=this._getKey(e);return this._isNarrowableByKey(t)}lock(){s.assert(!this._isLocked),this._isLocked=!0}isLocked(){return this._isLocked}_getKey(e){return e.scopeId||e.details.name}_isNarrowableByKey(e){const t=this._isNarrowableMap.get(e);return void 0===t||t}_getComplexityScoreForType(e,t=0){if(t>i.maxTypeRecursionCount)return 0;switch(e.category){case 5:case 6:return.5;case 10:{let n=1;return e.subtypes.forEach(e=>{const s=this._getComplexityScoreForType(e,t+1);s<n&&(n=s)}),n/2}case 7:return this._getComplexityScoreForClass(e,t+1);case 8:return this._getComplexityScoreForClass(e.classType,t+1)}return 0}_getComplexityScoreForClass(e,t){let n=0,s=0;e.typeArguments&&e.typeArguments.forEach(e=>{n+=this._getComplexityScoreForType(e,t+1),s++});let i=.5;return s>0&&(i+=n/s*.5),i}}t.TypeVarMap=r},1133:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSameWithoutLiteralValue=t.combineTypes=t.isUnionableType=t.removeFromUnion=t.removeNoneFromUnion=t.removeUnboundFromUnion=t.removeUnknownFromUnion=t.removeAnyFromUnion=t.isTypeSame=t.getTypeAliasInfo=t.isOverloadedFunction=t.isFunction=t.isTypeVar=t.isModule=t.isObject=t.isClass=t.isPossiblyUnbound=t.isUnbound=t.isAnyOrUnknown=t.isUnknown=t.isNone=t.isNever=t.TypeVarType=t.UnionType=t.AnyType=t.NeverType=t.NoneType=t.OverloadedFunctionType=t.FunctionType=t.ObjectType=t.ClassType=t.ModuleType=t.UnknownType=t.UnboundType=t.TypeBase=t.maxTypeRecursionCount=t.EnumLiteral=void 0;const s=n(5839);class i{constructor(e,t){this.className=e,this.itemName=t}}var r,o,a,l,c,p,u,d,h,m;function y(e){return 2===e.category||1===e.category||10===e.category&&void 0===e.subtypes.find(e=>!y(e))}function g(e){return 0===e.category}function f(e){return 7===e.category}function _(e){return 8===e.category}function T(e){return 11===e.category}function v(e,n,s=0){if(e.category!==n.category)return!1;if(s>t.maxTypeRecursionCount)return!0;switch(e.category){case 7:{const t=n;if(!a.isSameGenericClass(e,t,!0,s+1))return!1;const i=e.typeArguments||[],r=t.typeArguments||[],o=Math.max(i.length,r.length);for(let e=0;e<o;e++)if(!v(e<i.length?i[e]:u.create(),e<r.length?r[e]:u.create(),s+1))return!1;return!!a.isLiteralValueSame(e,t)}case 8:{const t=n;return v(e.classType,t.classType,s+1)}case 5:{const t=n,i=e.details.parameters,r=t.details.parameters;if(i.length!==r.length)return!1;for(let n=0;n<i.length;n++){const o=i[n],a=r[n];if(o.category!==a.category)return!1;if(o.name!==a.name)return!1;if(!v(c.getEffectiveParameterType(e,n),c.getEffectiveParameterType(t,n),s+1))return!1}let o=e.details.declaredReturnType;e.specializedTypes&&e.specializedTypes.returnType&&(o=e.specializedTypes.returnType);let a=t.details.declaredReturnType;return t.specializedTypes&&t.specializedTypes.returnType&&(a=t.specializedTypes.returnType),!!(!o&&!a||o&&a&&v(o,a,s+1))&&e.details.declaration===t.details.declaration}case 6:{const t=n;if(e.overloads.length!==t.overloads.length)return!1;for(let n=0;n<e.overloads.length;n++)if(!v(e.overloads[n],t.overloads[n]))return!1;return!0}case 10:{const t=n,i=e.subtypes,r=t.subtypes;return i.length===r.length&&void 0===i.find(e=>!d.containsType(t,e,s+1))}case 11:{const t=n;if(e.scopeId!==t.scopeId)return!1;if(e.details===t.details)return!0;if(e.details.name!==t.details.name)return!1;const i=e.details.boundType,r=t.details.boundType;if(i){if(!r||!v(i,r,s+1))return!1}else if(r)return!1;if(e.details.isContravariant!==t.details.isContravariant)return!1;if(e.details.isCovariant!==t.details.isCovariant)return!1;const o=e.details.constraints,a=t.details.constraints;if(o.length!==a.length)return!1;for(let e=0;e<o.length;e++)if(!v(o[e],a[e],s+1))return!1;return!0}case 9:{const t=n;return e.fields===t.fields||0===e.fields.size&&0===t.fields.size}}return!0}function b(e,t){if(10===e.category){const n=e.subtypes.filter(e=>!t(e));if(n.length<e.subtypes.length)return C(n)}return e}function C(e,t){if(0===(e=e.filter(e=>4!==e.category)).length)return p.create();if(1===e.length)return e[0];let n=[];for(const t of e)10===t.category?n=n.concat(t.subtypes):n.push(t);n=n.sort((e,t)=>_(e)&&void 0!==e.classType.literalValue||f(e)&&void 0!==e.literalValue?1:_(t)&&void 0!==t.classType.literalValue||f(t)&&void 0!==t.literalValue?-1:0);const s=e=>_(e)&&a.isBuiltIn(e.classType,"NoReturn");if(n.find(e=>s(e))&&(n=n.filter(e=>!s(e))),0===n.length)return o.create();const i=d.create();let r=!1;return n.forEach((e,n)=>{0===n?d.addType(i,e):void 0===t||i.subtypes.length<t?function(e,t){if(_(t)){if(a.isBuiltIn(t.classType,"str")&&void 0!==t.classType.literalValue&&void 0!==e.literalStrMap)return void(e.literalStrMap.has(t.classType.literalValue)||d.addType(e,t));if(a.isBuiltIn(t.classType,"int")&&void 0!==t.classType.literalValue&&void 0!==e.literalIntMap)return void(e.literalIntMap.has(t.classType.literalValue)||d.addType(e,t))}for(let n=0;n<e.subtypes.length;n++){const s=e.subtypes[n];if(v(s,t))return;if(_(s)&&_(t)){if(S(s,t)&&void 0===s.classType.literalValue)return;if(a.isBuiltIn(s.classType,"bool")&&void 0!==t.classType.literalValue&&!t.classType.literalValue===s.classType.literalValue)return void(e.subtypes[n]=l.create(a.cloneWithLiteral(s.classType,void 0)))}}d.addType(e,t)}(i,e):r=!0}),r?u.create():1===i.subtypes.length?i.subtypes[0]:i}function S(e,t){return!!v(e,t)||(f(t)&&void 0!==t.literalValue?v(e,t=a.cloneWithLiteral(t,void 0)):!(!_(t)||void 0===t.classType.literalValue)&&v(e,t=l.create(a.cloneWithLiteral(t.classType,void 0))))}t.EnumLiteral=i,t.maxTypeRecursionCount=16,function(e){e.isInstantiable=function(e){return 0!=(1&e.flags)},e.isInstance=function(e){return 0!=(2&e.flags)},e.cloneForTypeAlias=function(e,t,n,s){const i=Object.assign({},e);return i.typeAliasInfo={aliasName:t,typeParameters:n,typeArguments:s},i}}(r=t.TypeBase||(t.TypeBase={})),function(e){const t={category:0,flags:3};e.create=function(){return t}}(t.UnboundType||(t.UnboundType={})),function(e){const t={category:1,flags:3};e.create=function(){return t}}(o=t.UnknownType||(t.UnknownType={})),(m=t.ModuleType||(t.ModuleType={})).create=function(e,t){return{category:9,fields:t||new Map,loaderFields:new Map,flags:1,moduleName:e}},m.getField=function(e,t){let n=e.fields.get(t);return!n&&e.loaderFields&&(n=e.loaderFields.get(t)),n},function(e){function n(e,t,n,s,i,r,o,a){return{category:7,details:{name:e,fullName:t,moduleName:n,flags:s,typeSourceId:i,baseClasses:[],declaredMetaclass:r,effectiveMetaclass:o,mro:[],fields:new Map,typeParameters:[],docString:a},skipAbstractClassTest:!1,flags:1}}function s(e,t){return!!(1&e.details.flags)&&(void 0===t||e.details.name===t)}function r(e){return e.details.aliasClass||e}function a(e,n,s=!0,i=0){if(i>t.maxTypeRecursionCount)return!0;if(e.details===n.details)return!0;const r=s&&e.details.aliasClass?e.details.aliasClass.details:e.details,a=s&&n.details.aliasClass?n.details.aliasClass.details:n.details;if(r===a)return!0;if(r.name!==a.name||r.flags!==a.flags||r.typeSourceId!==a.typeSourceId||r.baseClasses.length!==a.baseClasses.length||r.typeParameters.length!==a.typeParameters.length)return!1;for(let e=0;e<r.baseClasses.length;e++)if(!v(r.baseClasses[e],a.baseClasses[e],i+1))return!1;if((r.declaredMetaclass||a.declaredMetaclass)&&(!r.declaredMetaclass||!a.declaredMetaclass||!v(r.declaredMetaclass,a.declaredMetaclass)))return!1;for(let e=0;e<r.typeParameters.length;e++)if(!v(r.typeParameters[e],a.typeParameters[e],i+1))return!1;const l=r.dataClassEntries||[],c=a.dataClassEntries||[];if(l.length!==c.length)return!1;for(let e=0;e<l.length;e++)if(l[e].name!==c[e].name||l[e].hasDefault!==c[e].hasDefault||!v(l[e].type,c[e].type,i+1))return!1;if(r.fields!==a.fields){if(r.fields.size!==a.fields.size)return!1;let e=!0;if(r.fields.forEach((t,n)=>{const s=a.fields.get(n);s&&v(t.getSynthesizedType()||o.create(),s.getSynthesizedType()||o.create(),i+1)||(e=!1)}),!e)return!1}return!0}e.create=n,e.cloneForSpecialization=function(e,t,s,i=!1,r){const o=n(e.details.name,e.details.fullName,e.details.moduleName,e.details.flags,e.details.typeSourceId,e.details.declaredMetaclass,e.details.effectiveMetaclass);return o.details=e.details,t&&(o.typeArguments=t),o.isTypeArgumentExplicit=s,r&&(o.effectiveTypeArguments=r),void 0!==e.literalValue&&(o.literalValue=e.literalValue),void 0!==e.typeAliasInfo&&(o.typeAliasInfo=e.typeAliasInfo),i&&(o.skipAbstractClassTest=!0),o},e.cloneWithLiteral=function(e,t){const s=n(e.details.name,e.details.fullName,e.details.moduleName,e.details.flags,e.details.typeSourceId,e.details.declaredMetaclass,e.details.effectiveMetaclass);return s.details=e.details,e.typeArguments&&(s.typeArguments=e.typeArguments),void 0!==t&&(s.literalValue=t),void 0!==e.typeAliasInfo&&(s.typeAliasInfo=e.typeAliasInfo),e.skipAbstractClassTest&&(s.skipAbstractClassTest=!0),s},e.isLiteralValueSame=function(e,t){return void 0===e.literalValue?void 0===t.literalValue:void 0!==t.literalValue&&(e.literalValue instanceof i?t.literalValue instanceof i&&e.literalValue.itemName===t.literalValue.itemName:e.literalValue===t.literalValue)},e.isGeneric=function(e){return e.details.typeParameters.length>0&&void 0===e.typeArguments},e.isSpecialBuiltIn=function(e,t){return!!(2&e.details.flags)&&(void 0===t||e.details.name===t)},e.isBuiltIn=s,e.hasAbstractMethods=function(e){return!!(256&e.details.flags)&&!e.skipAbstractClassTest},e.supportsAbstractMethods=function(e){return!!(128&e.details.flags)},e.isDataClass=function(e){return!!(4&e.details.flags)},e.isSkipSynthesizedInit=function(e){return!!(8&e.details.flags)},e.isTypedDictClass=function(e){return!!(16&e.details.flags)},e.isCanOmitDictValues=function(e){return!!(32&e.details.flags)},e.isEnumClass=function(e){return!!(64&e.details.flags)},e.isPropertyClass=function(e){return!!(512&e.details.flags)},e.isFinal=function(e){return!!(1024&e.details.flags)},e.isProtocolClass=function(e){return!!(2048&e.details.flags)},e.isPseudoGenericClass=function(e){return!!(4096&e.details.flags)},e.getDataClassEntries=function(e){return e.details.dataClassEntries||[]},e.isRuntimeCheckable=function(e){return!!(8192&e.details.flags)},e.isTypingExtensionClass=function(e){return!!(16384&e.details.flags)},e.isPartiallyConstructed=function(e){return!!(32768&e.details.flags)},e.getAliasClass=r,e.getTypeParameters=function(e){return r(e).details.typeParameters},e.hasUnknownBaseClass=function(e){return e.details.mro.some(e=>y(e))},e.isSameGenericClass=a,e.isDerivedFrom=function e(t,n,i){if(a(t,n))return i&&i.push(t),!0;if(s(t)&&s(n,"object"))return i&&i.push(n),!0;const r=t.details.aliasClass||t;for(const s of r.details.baseClasses)if(f(s)){if(e(s,n,i))return i&&i.push(t),!0}else if(y(s))return i&&i.push(o.create()),!0;return!1}}(a=t.ClassType||(t.ClassType={})),function(e){e.create=function(e){return{category:8,classType:e,flags:2}}}(l=t.ObjectType||(t.ObjectType={})),function(e){function t(e,t,n,s,i){return{category:5,details:{name:e,moduleName:t,flags:n,parameters:[],docString:i},flags:s}}e.createInstance=function(e,n,s,i){return t(e,n,s,2,i)},e.createInstantiable=function(e,n,s,i){return t(e,n,s,1,i)},e.clone=function(e,n=!1){const s=t(e.details.name,e.details.moduleName,e.details.flags,e.flags,e.details.docString),i=n?1:0;return s.details={name:e.details.name,moduleName:e.details.moduleName,flags:e.details.flags,parameters:e.details.parameters.slice(i),declaredReturnType:e.details.declaredReturnType,declaration:e.details.declaration,builtInName:e.details.builtInName,docString:e.details.docString},n&&(s.details.flags&=-4,s.details.flags|=4,s.ignoreFirstParamOfDeclaration=!0),void 0!==e.typeAliasInfo&&(s.typeAliasInfo=e.typeAliasInfo),e.specializedTypes&&(s.specializedTypes={parameterTypes:e.specializedTypes.parameterTypes.slice(i),returnType:e.specializedTypes.returnType}),s.inferredReturnType=e.inferredReturnType,s},e.cloneAsInstance=function(e){s.assert(r.isInstantiable(e));const t=Object.assign({},e);return t.flags&=-2,t.flags|=2,t},e.cloneAsInstantiable=function(e){s.assert(r.isInstance(e));const t=Object.assign({},e);return t.flags&=-3,t.flags|=1,t},e.cloneForSpecialization=function(e,n,i){const r=t(e.details.name,e.details.moduleName,e.details.flags,e.flags,e.details.docString);return r.details=e.details,s.assert(n.parameterTypes.length===e.details.parameters.length),r.specializedTypes=n,i&&(r.inferredReturnType=i),r},e.cloneForParamSpec=function(e,n){const s=t(e.details.name,e.details.moduleName,e.details.flags,e.flags,e.details.docString);return s.details=Object.assign({},e.details),delete s.details.paramSpec,n&&(s.details.parameters=n.map((e,t)=>({category:0,name:e.name,isNameSynthesized:!0,hasDeclaredType:!0,type:e.type}))),s},e.addDefaultParameters=function(t,n=!1){e.addParameter(t,{category:1,name:"args",type:n?o.create():u.create(),hasDeclaredType:!n}),e.addParameter(t,{category:2,name:"kwargs",type:n?o.create():u.create(),hasDeclaredType:!n})},e.isInstanceMethod=function(e){return 0==(7&e.details.flags)},e.isConstructorMethod=function(e){return 0!=(1&e.details.flags)},e.isStaticMethod=function(e){return 0!=(4&e.details.flags)},e.isClassMethod=function(e){return 0!=(2&e.details.flags)},e.isAbstractMethod=function(e){return 0!=(8&e.details.flags)},e.isGenerator=function(e){return 0!=(16&e.details.flags)},e.isSynthesizedMethod=function(e){return 0!=(64&e.details.flags)},e.isSkipConstructorCheck=function(e){return 0!=(128&e.details.flags)},e.isOverloaded=function(e){return 0!=(256&e.details.flags)},e.isDefaultParameterCheckDisabled=function(e){return 0!=(32&e.details.flags)},e.isAsync=function(e){return 0!=(512&e.details.flags)},e.isWrapReturnTypeInAwait=function(e){return 0!=(1024&e.details.flags)},e.isStubDefinition=function(e){return 0!=(2048&e.details.flags)},e.isPyTypedDefinition=function(e){return 0!=(4096&e.details.flags)},e.isFinal=function(e){return 0!=(8192&e.details.flags)},e.hasUnannotatedParams=function(e){return 0!=(16384&e.details.flags)},e.shouldSkipParamCompatibilityCheck=function(e){return 0!=(32768&e.details.flags)},e.getEffectiveParameterType=function(e,t){return s.assert(t<e.details.parameters.length),e.specializedTypes?e.specializedTypes.parameterTypes[t]:e.details.parameters[t].type},e.addParameter=function(e,t){e.details.parameters.push(t)},e.getSpecializedReturnType=function(e){return e.specializedTypes&&e.specializedTypes.returnType?e.specializedTypes.returnType:e.details.declaredReturnType}}(c=t.FunctionType||(t.FunctionType={})),(h=t.OverloadedFunctionType||(t.OverloadedFunctionType={})).create=function(e=[]){return{category:6,overloads:e,flags:2}},h.addOverload=function(e,t){e.overloads.push(t)},function(e){const t={category:3,flags:2},n={category:3,flags:1};e.createInstance=function(){return t},e.createType=function(){return n}}(t.NoneType||(t.NoneType={})),function(e){const t={category:4,flags:3};e.create=function(){return t}}(p=t.NeverType||(t.NeverType={})),function(e){const t={category:2,isEllipsis:!1,flags:3},n={category:2,isEllipsis:!0,flags:3};e.create=function(e=!1){return e?n:t}}(u=t.AnyType||(t.AnyType={})),function(e){e.create=function(){return{category:10,subtypes:[],flags:3}},e.addType=function(e,t){s.assert(10!==t.category),s.assert(4!==t.category),_(t)&&a.isBuiltIn(t.classType,"str")&&void 0!==t.classType.literalValue?(void 0===e.literalStrMap&&(e.literalStrMap=new Map),e.literalStrMap.set(t.classType.literalValue,t)):_(t)&&a.isBuiltIn(t.classType,"int")&&void 0!==t.classType.literalValue&&(void 0===e.literalIntMap&&(e.literalIntMap=new Map),e.literalIntMap.set(t.classType.literalValue,t)),e.flags&=t.flags,e.subtypes.push(t)},e.containsType=function(e,t,n=0){if(_(t)){if(a.isBuiltIn(t.classType,"str")&&void 0!==t.classType.literalValue&&void 0!==e.literalStrMap)return e.literalStrMap.has(t.classType.literalValue);if(a.isBuiltIn(t.classType,"int")&&void 0!==t.classType.literalValue&&void 0!==e.literalIntMap)return e.literalIntMap.has(t.classType.literalValue)}return void 0!==e.subtypes.find(e=>v(e,t,n+1))}}(d=t.UnionType||(t.UnionType={})),function(e){function t(e,t){return`${e}.${t.toString()}`}function n(e,t,n,s){return{category:11,details:{name:e,constraints:[],isCovariant:!1,isContravariant:!1,isParamSpec:t,isSynthesized:n},flags:s}}e.createInstance=function(e,t,s=!1){return n(e,t,s,2)},e.createInstantiable=function(e,t,s=!1){return n(e,t,s,1)},e.cloneAsInstance=function(e){s.assert(r.isInstantiable(e));const t=Object.assign({},e);return t.flags&=-2,t.flags|=2,t},e.cloneAsInstantiable=function(e){s.assert(r.isInstance(e));const t=Object.assign({},e);return t.flags&=-3,t.flags|=1,t},e.cloneForScopeId=function(e,n){const s=Object.assign({},e);return s.scopeId=t(e.details.name,n),s},e.makeScopeId=t,e.addConstraint=function(e,t){e.details.constraints.push(t)}}(t.TypeVarType||(t.TypeVarType={})),t.isNever=function(e){return 4===e.category},t.isNone=function(e){return 3===e.category},t.isUnknown=function(e){return 1===e.category},t.isAnyOrUnknown=y,t.isUnbound=g,t.isPossiblyUnbound=function e(t){return 0===t.category||10===t.category&&void 0!==t.subtypes.find(t=>e(t))},t.isClass=f,t.isObject=_,t.isModule=function(e){return 9===e.category},t.isTypeVar=T,t.isFunction=function(e){return 5===e.category},t.isOverloadedFunction=function(e){return 6===e.category},t.getTypeAliasInfo=function(e){return e.typeAliasInfo?e.typeAliasInfo:T(e)&&e.details.recursiveTypeAliasName&&e.details.boundType&&e.details.boundType.typeAliasInfo?e.details.boundType.typeAliasInfo:void 0},t.isTypeSame=v,t.removeAnyFromUnion=function(e){return b(e,e=>y(e))},t.removeUnknownFromUnion=function(e){return b(e,e=>1===e.category)},t.removeUnboundFromUnion=function(e){return b(e,e=>g(e))},t.removeNoneFromUnion=function(e){return b(e,e=>3===e.category)},t.removeFromUnion=b,t.isUnionableType=function(e){let t=3;for(const n of e)t&=n.flags;return 0!=(1&t)&&0==(2&t)},t.combineTypes=C,t.isSameWithoutLiteralValue=S},9560:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundAnalysisRunner=t.BackgroundAnalysis=void 0;const s=n(5013),i=n(4795),r=n(3213);class o extends i.BackgroundAnalysisBase{constructor(e){super(e);const t={rootDirectory:global.__rootDirectory,cancellationFolderName:r.getCancellationFolderName()},n=new s.Worker(__filename,{workerData:t});this.setup(n)}}t.BackgroundAnalysis=o;class a extends i.BackgroundAnalysisRunnerBase{constructor(){super()}}t.BackgroundAnalysisRunner=a},4795:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t},o=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,r){function o(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundAnalysisRunnerBase=t.BackgroundAnalysisBase=void 0;const a=n(5013),l=n(1241),c=n(2374),p=n(8408),u=n(5055),d=n(3213),h=n(2930),m=n(2211),y=r(n(5839)),g=n(1290);t.BackgroundAnalysisBase=class{constructor(e){this.console=e,this._onAnalysisCompletion=l.nullCallback}setup(e){this._worker=e,e.on("message",e=>{switch(e.requestType){case"log":{const t=e.data;this.log(t.level,t.message);break}case"analysisResult":this._onAnalysisCompletion(_(e.data));break;default:y.fail(e.requestType+" is not expected")}}),e.on("error",e=>{this.log(m.LogLevel.Error,"Error occurred on background thread: "+JSON.stringify(e))})}setCompletionCallback(e){this._onAnalysisCompletion=null!=e?e:l.nullCallback}setConfigOptions(e){this.enqueueRequest({requestType:"setConfigOptions",data:e})}setTrackedFiles(e){this.enqueueRequest({requestType:"setTrackedFiles",data:e})}setAllowedThirdPartyImports(e){this.enqueueRequest({requestType:"setAllowedThirdPartyImports",data:e})}setFileOpened(e,t,n){this.enqueueRequest({requestType:"setFileOpened",data:{filePath:e,version:t,contents:n}})}setFileClosed(e){this.enqueueRequest({requestType:"setFileClosed",data:e})}markAllFilesDirty(e){this.enqueueRequest({requestType:"markAllFilesDirty",data:e})}markFilesDirty(e,t){this.enqueueRequest({requestType:"markFilesDirty",data:{filePaths:e,evenIfContentsAreSame:t}})}startAnalysis(e,t){this._startOrResumeAnalysis("analyze",e,t)}_startOrResumeAnalysis(e,t,n){const{port1:s,port2:i}=new a.MessageChannel;s.on("message",e=>{switch(e.requestType){case"analysisResult":this._onAnalysisCompletion(_(e.data));break;case"analysisPaused":d.disposeCancellationToken(n),i.close(),s.close(),this._startOrResumeAnalysis("resumeAnalysis",t,n);break;case"indexResult":{const{path:n,indexResults:s}=e.data;null==t||t.setWorkspaceIndex(n,s);break}case"analysisDone":d.disposeCancellationToken(n),i.close(),s.close();break;default:y.fail(e.requestType+" is not expected")}});const r=d.getCancellationTokenId(n);this.enqueueRequest({requestType:e,data:r,port:i})}startIndexing(e,t){}refreshIndexing(e,t){}cancelIndexing(e){}getDiagnosticsForRange(e,t,n){return o(this,void 0,void 0,(function*(){d.throwIfCancellationRequested(n);const{port1:s,port2:i}=new a.MessageChannel,r=u.getBackgroundWaiter(s),o=d.getCancellationTokenId(n);this.enqueueRequest({requestType:"getDiagnosticsForRange",data:{filePath:e,range:t,cancellationId:o},port:i});const l=yield r;return i.close(),s.close(),T(l)}))}writeTypeStub(e,t,n,s){return o(this,void 0,void 0,(function*(){d.throwIfCancellationRequested(s);const{port1:i,port2:r}=new a.MessageChannel,o=u.getBackgroundWaiter(i),l=d.getCancellationTokenId(s);this.enqueueRequest({requestType:"writeTypeStub",data:{targetImportPath:e,targetIsSingleFile:t,stubPath:n,cancellationId:l},port:r}),yield o,r.close(),i.close()}))}invalidateAndForceReanalysis(){this.enqueueRequest({requestType:"invalidateAndForceReanalysis",data:null})}restart(){this.enqueueRequest({requestType:"restart",data:null})}enqueueRequest(e){this._worker&&this._worker.postMessage(e,e.port?[e.port]:void 0)}log(e,t){m.log(this.console,e,t)}};class f extends u.BackgroundThreadBase{constructor(e){super(a.workerData),this._extension=e;const t=a.workerData;this.log(m.LogLevel.Info,`Background analysis(${a.threadId}) root directory: ${t.rootDirectory}`),this._configOptions=new h.ConfigOptions(t.rootDirectory),this._importResolver=this.createImportResolver(this.fs,this._configOptions),this._program=new p.Program(this._importResolver,this._configOptions,this.getConsole(),this._extension,`BG(${a.threadId})`)}get program(){return this._program}start(){this.log(m.LogLevel.Info,`Background analysis(${a.threadId}) started`),null===a.parentPort||void 0===a.parentPort||a.parentPort.on("message",e=>this.onMessage(e)),null===a.parentPort||void 0===a.parentPort||a.parentPort.on("error",e=>y.fail("failed "+e)),null===a.parentPort||void 0===a.parentPort||a.parentPort.on("exit",e=>{0!==e&&y.fail("worker stopped with exit code "+e)})}onMessage(e){switch(this.log(m.LogLevel.Log,"Background analysis message: "+e.requestType),e.requestType){case"analyze":{const t=e.port,n=d.getCancellationTokenFromId(e.data),s=this.program.getFilesToAnalyzeCount();this._onAnalysisCompletion(t,{diagnostics:[],filesInProgram:this.program.getFileCount(),filesRequiringAnalysis:s,checkingOnlyOpenFiles:this.program.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:0}),this._analyzeOneChunk(t,n,e);break}case"resumeAnalysis":{const t=e.port,n=d.getCancellationTokenFromId(e.data);this._analyzeOneChunk(t,n,e);break}case"getDiagnosticsForRange":u.run(()=>{const{filePath:t,range:n,cancellationId:s}=e.data,i=d.getCancellationTokenFromId(s);return d.throwIfCancellationRequested(i),this.program.getDiagnosticsForRange(t,n)},e.port);break;case"writeTypeStub":u.run(()=>{const{targetImportPath:t,targetIsSingleFile:n,stubPath:s,cancellationId:i}=e.data,r=d.getCancellationTokenFromId(i);l.analyzeProgram(this.program,void 0,this._configOptions,l.nullCallback,this.getConsole(),r),this.program.writeTypeStub(t,n,s,r)},e.port);break;case"setConfigOptions":this._configOptions=u.createConfigOptionsFrom(e.data),this._importResolver=this.createImportResolver(this.fs,this._configOptions),this.program.setConfigOptions(this._configOptions),this.program.setImportResolver(this._importResolver);break;case"setTrackedFiles":{const t=this.program.setTrackedFiles(e.data);this._reportDiagnostics(t,this.program.getFilesToAnalyzeCount(),0);break}case"setAllowedThirdPartyImports":this.program.setAllowedThirdPartyImports(e.data);break;case"setFileOpened":{const{filePath:t,version:n,contents:s}=e.data;this.program.setFileOpened(t,n,s);break}case"setFileClosed":{const t=this.program.setFileClosed(e.data);this._reportDiagnostics(t,this.program.getFilesToAnalyzeCount(),0);break}case"markAllFilesDirty":this.program.markAllFilesDirty(e.data);break;case"markFilesDirty":{const{filePaths:t,evenIfContentsAreSame:n}=e.data;this.program.markFilesDirty(t,n);break}case"invalidateAndForceReanalysis":this._importResolver.invalidateCache(),this.program.markAllFilesDirty(!0);break;case"restart":this._importResolver=this.createImportResolver(this.fs,this._configOptions),this.program.setImportResolver(this._importResolver);break;default:y.fail(e.requestType+" is not expected")}}_analyzeOneChunk(e,t,n){l.analyzeProgram(this.program,{openFilesTimeInMs:50,noOpenFilesTimeInMs:200},this._configOptions,t=>this._onAnalysisCompletion(e,t),this.getConsole(),t)?this._analysisPaused(e,n.data):(this.processIndexing(e,t),this._analysisDone(e,n.data))}createImportResolver(e,t){return new c.ImportResolver(e,t)}processIndexing(e,t){}reportIndex(e,t){e.postMessage({requestType:"indexResult",data:t})}_reportDiagnostics(e,t,n){a.parentPort&&this._onAnalysisCompletion(a.parentPort,{diagnostics:e,filesInProgram:this.program.getFileCount(),filesRequiringAnalysis:t,checkingOnlyOpenFiles:this.program.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:n})}_onAnalysisCompletion(e,t){e.postMessage({requestType:"analysisResult",data:t})}_analysisPaused(e,t){e.postMessage({requestType:"analysisPaused",data:t})}_analysisDone(e,t){e.postMessage({requestType:"analysisDone",data:t})}}function _(e){return e.diagnostics=e.diagnostics.map(e=>({filePath:e.filePath,diagnostics:T(e.diagnostics)})),e}function T(e){return e.map(e=>{const t=new g.Diagnostic(e.category,e.message,e.range);if(e._actions)for(const n of e._actions)t.addAction(n);if(e._rule&&t.setRule(e._rule),e._relatedInfo)for(const n of e._relatedInfo)t.addRelatedInfo(n.message,n.filePath,n.range);return t})}t.BackgroundAnalysisRunnerBase=f},5055:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getBackgroundWaiter=t.run=t.createConfigOptionsFrom=t.BackgroundThreadBase=void 0;const o=n(5013),a=n(3213),l=n(2930),c=n(2211),p=r(n(5839)),u=n(7830);t.BackgroundThreadBase=class{constructor(e){a.setCancellationFolderName(e.cancellationFolderName),global.__rootDirectory=e.rootDirectory,this.fs=u.createFromRealFileSystem(this.getConsole())}log(e,t){null===o.parentPort||void 0===o.parentPort||o.parentPort.postMessage({requestType:"log",data:{level:e,message:t}})}getConsole(){return{log:e=>{this.log(c.LogLevel.Log,e)},info:e=>{this.log(c.LogLevel.Info,e)},warn:e=>{this.log(c.LogLevel.Warn,e)},error:e=>{this.log(c.LogLevel.Error,e)},level:c.LogLevel.Log}}},t.createConfigOptionsFrom=function(e){const t=new l.ConfigOptions(e.projectRoot),n=e=>({wildcardRoot:e.wildcardRoot,regExp:new RegExp(e.regExp.source)});return t.pythonPath=e.pythonPath,t.typeshedPath=e.typeshedPath,t.stubPath=e.stubPath,t.autoExcludeVenv=e.autoExcludeVenv,t.verboseOutput=e.verboseOutput,t.checkOnlyOpenFiles=e.checkOnlyOpenFiles,t.useLibraryCodeForTypes=e.useLibraryCodeForTypes,t.internalTestMode=e.internalTestMode,t.venvPath=e.venvPath,t.defaultVenv=e.defaultVenv,t.defaultPythonVersion=e.defaultPythonVersion,t.defaultPythonPlatform=e.defaultPythonPlatform,t.diagnosticRuleSet=e.diagnosticRuleSet,t.executionEnvironments=e.executionEnvironments,t.autoImportCompletions=e.autoImportCompletions,t.indexing=e.indexing,t.include=e.include.map(e=>n(e)),t.exclude=e.exclude.map(e=>n(e)),t.ignore=e.ignore.map(e=>n(e)),t.strict=e.strict.map(e=>n(e)),t},t.run=function(e,t){try{const n=e();t.postMessage({kind:"ok",data:n})}catch(e){if(a.OperationCanceledException.is(e))return void t.postMessage({kind:"cancelled",data:e.message});t.postMessage({kind:"failed",data:`Exception: ${e.message} in ${e.stack}`})}},t.getBackgroundWaiter=function(e){return new Promise((t,n)=>{e.on("message",e=>{switch(e.kind){case"ok":t(e.data);break;case"cancelled":n(new a.OperationCanceledException);break;case"failed":n(e.data);break;default:p.fail("unknown kind "+e.kind)}})})}},9926:function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,r){function o(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CommandController=void 0;const i=n(4494),r=n(739),o=n(7601),a=n(2719);t.CommandController=class{constructor(e){this._createStub=new r.CreateTypeStubCommand(e),this._restartServer=new a.RestartServerCommand(e),this._quickAction=new o.QuickActionCommand(e)}execute(e,t){return s(this,void 0,void 0,(function*(){switch(e.command){case"pyright.organizeimports":case"pyright.addoptionalforparam":return this._quickAction.execute(e,t);case"pyright.createtypestub":return this._createStub.execute(e,t);case"pyright.restartserver":return this._restartServer.execute(e);default:return new i.ResponseError(1,"Unsupported command")}}))}isLongRunningCommand(e){switch(e){case"pyright.createtypestub":return!0;default:return!1}}}},739:function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,r){function o(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CreateTypeStubCommand=void 0;const i=n(6708),r=n(3213),o=n(8304),a=n(6657),l=n(31);t.CreateTypeStubCommand=class{constructor(e){this._ls=e}execute(e,t){return s(this,void 0,void 0,(function*(){if(e.arguments&&e.arguments.length>=2){const n=e.arguments[0],s=e.arguments[1],i=e.arguments[2],c=yield this._createTypeStubService(i),p={workspaceName:"Create Type Stub "+s,rootPath:n,rootUri:a.convertPathToUri(n),serviceInstance:c,disableLanguageServices:!0,disableOrganizeImports:!0,isInitialized:o.createDeferred()},u=yield this._ls.getSettings(p);l.AnalyzerServiceExecutor.runWithOptions(this._ls.rootPath,p,u,s,!1);try{yield c.writeTypeStubInBackground(t),c.dispose();const e=`Type stub was successfully created for '${s}'.`;this._ls.window.showInformationMessage(e),this._handlePostCreateTypeStub()}catch(e){if(r.OperationCanceledException.is(e)){const e=`Type stub creation for '${s}' was canceled`;this._ls.console.error(e)}else{let t="";e instanceof Error&&(t=": "+e.message),t=`An error occurred when creating type stub for '${s}'`+t,this._ls.console.error(t),this._ls.window.showErrorMessage(t)}}}}))}_createTypeStubService(e){return s(this,void 0,void 0,(function*(){return e?(yield this._ls.getWorkspaceForFile(e)).serviceInstance.clone("Type stub",this._ls.createBackgroundAnalysis()):new i.AnalyzerService("Type stub",this._ls.fs,this._ls.console)}))}_handlePostCreateTypeStub(){this._ls.reanalyze()}}},7601:function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,r){function o(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.QuickActionCommand=void 0;const i=n(6657),r=n(743);t.QuickActionCommand=class{constructor(e){this._ls=e}execute(e,t){return s(this,void 0,void 0,(function*(){if(e.arguments&&e.arguments.length>=1){const n=e.arguments[0],s=e.arguments.slice(1),o=i.convertUriToPath(n),a=yield this._ls.getWorkspaceForFile(o);if("pyright.organizeimports"===e.command&&a.disableOrganizeImports)return[];const l=a.serviceInstance.performQuickAction(o,e.command,s,t);return r.convertTextEdits(n,l)}}))}}},2719:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,r){function o(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RestartServerCommand=void 0,t.RestartServerCommand=class{constructor(e){this._ls=e}execute(e){return n(this,void 0,void 0,(function*(){this._ls.restart()}))}}},3213:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CancelAfter=t.getCancellationTokenId=t.getCancellationTokenFromId=t.disposeCancellationToken=t.createBackgroundThreadCancellationTokenSource=t.getCancellationStrategyFromArgv=t.setCancellationFolderName=t.getCancellationFolderName=t.throwIfCancellationRequested=t.OperationCanceledException=void 0;const o=r(n(5747)),a=r(n(2087)),l=r(n(5622)),c=n(6744),p=n(4494);class u{static shouldCheck(){const e=Date.now().valueOf();return e-this._lastCheckTimestamp>=5&&(this._lastCheckTimestamp=e,!0)}}u._lastCheckTimestamp=0;class d{constructor(e){this.cancellationFilePath=e,this.isCancelled=!1}cancel(){this.isCancelled||(this.isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this._disposeEmitter()))}get isCancellationRequested(){return!!this.isCancelled||(u.shouldCheck()&&this._pipeExists()&&this.cancel(),this.isCancelled)}get onCancellationRequested(){return this._emitter||(this._emitter=new p.Emitter),this._emitter.event}dispose(){this._disposeEmitter()}_disposeEmitter(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}_pipeExists(){try{return o.statSync(this.cancellationFilePath),!0}catch(e){return!1}}}class h extends d{constructor(e){super(e),this._disposed=!1}cancel(){this._disposed||this.isCancelled||(this._createPipe(),super.cancel())}get isCancellationRequested(){return this.isCancelled}dispose(){this._disposed=!0,super.dispose(),this._removePipe()}_createPipe(){try{o.writeFileSync(this.cancellationFilePath,"",{flag:"w"})}catch(e){}}_removePipe(){try{o.unlinkSync(this.cancellationFilePath)}catch(e){}}}class m{constructor(e,t=!1){this._cancellationFilePath=e,this._ownFile=t}get token(){return this._token||(this._token=this._ownFile?new h(this._cancellationFilePath):new d(this._cancellationFilePath)),this._token}cancel(){this._token?this._token.cancel():this._token=p.CancellationToken.Cancelled}dispose(){this._token?this._token instanceof d&&this._token.dispose():this._token=p.CancellationToken.None}}function y(e,t){return l.join(function(e){return l.join(a.tmpdir(),"python-languageserver-cancellation",e)}(e),`cancellation-${String(t)}.tmp`)}class g{constructor(e){this.folderName=e}createCancellationTokenSource(e){return new m(y(this.folderName,e))}}class f extends p.ResponseError{constructor(){super(p.ErrorCodes.RequestCancelled,"request cancelled")}static is(e){return e.code===p.ErrorCodes.RequestCancelled}}let _;function T(e){_=e}t.OperationCanceledException=f,t.throwIfCancellationRequested=function(e){if(e.isCancellationRequested)throw new f},t.getCancellationFolderName=function(){return _},t.setCancellationFolderName=T,t.getCancellationStrategyFromArgv=function(e){let t;for(let s=0;s<e.length;s++){const i=e[s];if("--cancellationReceive"===i)t=n(e[s+1]);else{const e=i.split("=");"--cancellationReceive"===e[0]&&(t=n(e[1]))}}return t&&!_&&T(t.folderName),t=t||p.CancellationReceiverStrategy.Message,{receiver:t,sender:p.CancellationSenderStrategy.Message};function n(e){const t=function(e){const t=e.match(/^file:(.+)$/);return t?t[1]:void 0}(e);return t?new g(t):void 0}};let v=0;t.createBackgroundThreadCancellationTokenSource=function(){return _?new m(y(_,"source-"+String(v++)),!0):new c.CancellationTokenSource},t.disposeCancellationToken=function(e){e instanceof d&&e.dispose()},t.getCancellationTokenFromId=function(e){return e?new d(e):p.CancellationToken.None},t.getCancellationTokenId=function(e){return e instanceof d?e.cancellationFilePath:void 0},t.CancelAfter=function(...e){const t=new c.CancellationTokenSource,n=[];for(const s of e)n.push(s.onCancellationRequested(e=>{t.cancel()}));return n.push(t.token.onCancellationRequested(e=>{n.forEach(e=>e.dispose())})),t}},9489:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNestedProperty=t.flatten=t.binarySearchKey=t.binarySearch=t.every=t.some=t.map=t.stableSort=t.cloneAndSort=t.insertAt=t.addRange=t.find=t.append=t.contains=t.emptyArray=void 0;const s=n(2489);function i(e,t){return t<0?e.length+t:t}function r(e,t,n,s){if(void 0===t||0===t.length)return e;if(void 0===e)return t.slice(n,s);n=void 0===n?0:i(t,n),s=void 0===s?t.length:i(t,s);for(let i=n;i<s&&i<t.length;i++)void 0!==t[i]&&e.push(t[i]);return e}function o(e,t){return t}function a(e,t){return!!e&&(t?e.some(t):e.length>0)}function l(e,t,n,s,i){if(!a(e))return-1;let r=i||0,o=e.length-1;for(;r<=o;){const i=r+(o-r>>1);switch(s(n(e[i]),t)){case-1:r=i+1;break;case 0:return i;case 1:o=i-1}}return~r}t.emptyArray=[],t.contains=function(e,t,n=s.equateValues){if(e)for(const s of e)if(n(s,t))return!0;return!1},t.append=function(e,t){return void 0===t?e:void 0===e?[t]:(e.push(t),e)},t.find=function(e,t){for(let n=0;n<e.length;n++){const s=e[n];if(t(s,n))return s}},t.addRange=r,t.insertAt=function(e,t,n){if(0===t)e.unshift(n);else if(t===e.length)e.push(n);else{for(let n=e.length;n>t;n--)e[n]=e[n-1];e[t]=n}return e},t.cloneAndSort=function(e,t){return 0===e.length?e:e.slice().sort(t)},t.stableSort=function(e,t){const n=function(e){return e.map(o)}(e);return function(e,t,n){t.sort((t,i)=>n(e[t],e[i])||s.compareValues(t,i))}(e,n,t),n.map(t=>e[t])},t.map=function(e,t){if(e)return e.map(t)},t.some=a,t.every=function(e,t){return!e||e.every(t)},t.binarySearch=function(e,t,n,s,i){return l(e,n(t),n,s,i)},t.binarySearchKey=l,t.flatten=function(e){const t=[];for(const n of e)n&&(s.isArray(n)?r(t,n):t.push(n));return t},t.getNestedProperty=function(e,t){return t.split(".").reduce((e,t)=>e&&e[t],e)}},1775:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommandLineOptions=t.getDiagnosticSeverityOverrides=void 0,t.getDiagnosticSeverityOverrides=function(){return["error","warning","information","none"]},t.CommandLineOptions=class{constructor(e,t){this.fileSpecs=[],this.executionRoot=e,this.fromVsCodeExtension=t}}},2930:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigOptions=t.getStrictDiagnosticRuleSet=t.getBasicDiagnosticRuleSet=t.getOffDiagnosticRuleSet=t.getStrictModeNotOverriddenRules=t.getDiagLevelDiagnosticRules=t.getBooleanDiagnosticRules=t.cloneDiagnosticRuleSet=t.ExecutionEnvironment=void 0;const o=r(n(3129)),a=n(5622),l=r(n(3188)),c=n(9744),p=n(6657),u=n(6886);class d{constructor(e,t,n){this.extraPaths=[],this.root=e,this.pythonVersion=t||u.latestStablePythonVersion,this.pythonPlatform=n}}t.ExecutionEnvironment=d,t.cloneDiagnosticRuleSet=function(e){return Object.assign({},e)},t.getBooleanDiagnosticRules=function(){return[c.DiagnosticRule.strictListInference,c.DiagnosticRule.strictDictionaryInference,c.DiagnosticRule.strictParameterNoneValue]},t.getDiagLevelDiagnosticRules=function(){return[c.DiagnosticRule.reportGeneralTypeIssues,c.DiagnosticRule.reportPropertyTypeMismatch,c.DiagnosticRule.reportMissingImports,c.DiagnosticRule.reportMissingModuleSource,c.DiagnosticRule.reportMissingTypeStubs,c.DiagnosticRule.reportImportCycles,c.DiagnosticRule.reportUnusedImport,c.DiagnosticRule.reportUnusedClass,c.DiagnosticRule.reportUnusedFunction,c.DiagnosticRule.reportUnusedVariable,c.DiagnosticRule.reportDuplicateImport,c.DiagnosticRule.reportWildcardImportFromLibrary,c.DiagnosticRule.reportOptionalSubscript,c.DiagnosticRule.reportOptionalMemberAccess,c.DiagnosticRule.reportOptionalCall,c.DiagnosticRule.reportOptionalIterable,c.DiagnosticRule.reportOptionalContextManager,c.DiagnosticRule.reportOptionalOperand,c.DiagnosticRule.reportUntypedFunctionDecorator,c.DiagnosticRule.reportUntypedClassDecorator,c.DiagnosticRule.reportUntypedBaseClass,c.DiagnosticRule.reportUntypedNamedTuple,c.DiagnosticRule.reportPrivateUsage,c.DiagnosticRule.reportConstantRedefinition,c.DiagnosticRule.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,c.DiagnosticRule.reportInvalidStringEscapeSequence,c.DiagnosticRule.reportUnknownParameterType,c.DiagnosticRule.reportUnknownArgumentType,c.DiagnosticRule.reportUnknownLambdaType,c.DiagnosticRule.reportUnknownVariableType,c.DiagnosticRule.reportUnknownMemberType,c.DiagnosticRule.reportMissingTypeArgument,c.DiagnosticRule.reportCallInDefaultInitializer,c.DiagnosticRule.reportUnnecessaryIsInstance,c.DiagnosticRule.reportUnnecessaryCast,c.DiagnosticRule.reportAssertAlwaysTrue,c.DiagnosticRule.reportSelfClsParameterName,c.DiagnosticRule.reportImplicitStringConcatenation,c.DiagnosticRule.reportUndefinedVariable,c.DiagnosticRule.reportUnboundVariable,c.DiagnosticRule.reportInvalidStubStatement]},t.getStrictModeNotOverriddenRules=function(){return[c.DiagnosticRule.reportMissingModuleSource]},t.getOffDiagnosticRuleSet=function(){return{printUnknownAsAny:!0,omitTypeArgsIfAny:!0,omitUnannotatedParamType:!0,pep604Printing:!0,strictListInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!1,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"none",reportPropertyTypeMismatch:"none",reportMissingImports:"warning",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"none",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportInvalidStringEscapeSequence:"none",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingTypeArgument:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportAssertAlwaysTrue:"none",reportSelfClsParameterName:"none",reportImplicitStringConcatenation:"none",reportUnboundVariable:"warning",reportUndefinedVariable:"warning",reportInvalidStubStatement:"none"}},t.getBasicDiagnosticRuleSet=function(){return{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!0,pep604Printing:!0,strictListInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!1,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"error",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"warning",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportInvalidStringEscapeSequence:"warning",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingTypeArgument:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportAssertAlwaysTrue:"warning",reportSelfClsParameterName:"warning",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"none"}},t.getStrictDiagnosticRuleSet=function(){return{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!1,pep604Printing:!0,strictListInference:!0,strictDictionaryInference:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"error",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"error",reportImportCycles:"error",reportUnusedImport:"error",reportUnusedClass:"error",reportUnusedFunction:"error",reportUnusedVariable:"error",reportDuplicateImport:"error",reportWildcardImportFromLibrary:"error",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportUntypedFunctionDecorator:"error",reportUntypedClassDecorator:"error",reportUntypedBaseClass:"error",reportUntypedNamedTuple:"error",reportPrivateUsage:"error",reportConstantRedefinition:"error",reportIncompatibleMethodOverride:"error",reportIncompatibleVariableOverride:"error",reportInvalidStringEscapeSequence:"error",reportUnknownParameterType:"error",reportUnknownArgumentType:"error",reportUnknownLambdaType:"error",reportUnknownVariableType:"error",reportUnknownMemberType:"error",reportMissingTypeArgument:"error",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"error",reportUnnecessaryCast:"error",reportAssertAlwaysTrue:"error",reportSelfClsParameterName:"error",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"error"}};class h{constructor(e,t){this.include=[],this.exclude=[],this.ignore=[],this.strict=[],this.autoImportCompletions=!0,this.indexing=!1,this.disableInferenceForPyTypedSources=!0,this.executionEnvironments=[],this.projectRoot=e,this.diagnosticRuleSet=h.getDiagnosticRuleSet(t),"off"===t&&(this.disableInferenceForPyTypedSources=!1)}static getDiagnosticRuleSet(e){return"strict"===e?{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!1,pep604Printing:!0,strictListInference:!0,strictDictionaryInference:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"error",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"error",reportImportCycles:"error",reportUnusedImport:"error",reportUnusedClass:"error",reportUnusedFunction:"error",reportUnusedVariable:"error",reportDuplicateImport:"error",reportWildcardImportFromLibrary:"error",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportUntypedFunctionDecorator:"error",reportUntypedClassDecorator:"error",reportUntypedBaseClass:"error",reportUntypedNamedTuple:"error",reportPrivateUsage:"error",reportConstantRedefinition:"error",reportIncompatibleMethodOverride:"error",reportIncompatibleVariableOverride:"error",reportInvalidStringEscapeSequence:"error",reportUnknownParameterType:"error",reportUnknownArgumentType:"error",reportUnknownLambdaType:"error",reportUnknownVariableType:"error",reportUnknownMemberType:"error",reportMissingTypeArgument:"error",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"error",reportUnnecessaryCast:"error",reportAssertAlwaysTrue:"error",reportSelfClsParameterName:"error",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"error"}:"off"===e?{printUnknownAsAny:!0,omitTypeArgsIfAny:!0,omitUnannotatedParamType:!0,pep604Printing:!0,strictListInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!1,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"none",reportPropertyTypeMismatch:"none",reportMissingImports:"warning",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"none",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportInvalidStringEscapeSequence:"none",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingTypeArgument:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportAssertAlwaysTrue:"none",reportSelfClsParameterName:"none",reportImplicitStringConcatenation:"none",reportUnboundVariable:"warning",reportUndefinedVariable:"warning",reportInvalidStubStatement:"none"}:{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!0,pep604Printing:!0,strictListInference:!1,strictDictionaryInference:!1,strictParameterNoneValue:!1,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"error",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"warning",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportConstantRedefinition:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportInvalidStringEscapeSequence:"warning",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingTypeArgument:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportAssertAlwaysTrue:"warning",reportSelfClsParameterName:"warning",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"none"}}findExecEnvironment(e){let t=this.executionEnvironments.find(t=>{const n=p.ensureTrailingDirectorySeparator(p.normalizePath(p.combinePaths(this.projectRoot,t.root)));return e.startsWith(n)});return t||(t=new d(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform)),t}getDefaultExecEnvironment(){return new d(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform)}addExecEnvironmentForExtraPaths(e,t,n){const s=[];if(t){const t=p.resolvePaths(this.projectRoot,l.src);e.existsSync(t)&&!e.existsSync(p.resolvePaths(t,"__init__.py"))&&s.push(t)}if(n.length>0)for(const e of n)s.push(p.resolvePaths(this.projectRoot,e));if(s.length>0){const e=new d(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform);e.extraPaths.push(...s),this.executionEnvironments.push(e)}}initializeFromJson(e,t,n,s,i,r=!1){let o;r||(this.include=[],void 0===e.include)||(Array.isArray(e.include)?e.include.forEach((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "include" array should be a string.`):a.isAbsolute(e)?n.error(`Ignoring path "${e}" in "include" array because it is not relative.`):this.include.push(p.getFileSpec(this.projectRoot,e))}):n.error('Config "include" entry must must contain an array.')),this.exclude=[],void 0!==e.exclude&&(Array.isArray(e.exclude)?e.exclude.forEach((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "exclude" array should be a string.`):a.isAbsolute(e)?n.error(`Ignoring path "${e}" in "exclude" array because it is not relative.`):this.exclude.push(p.getFileSpec(this.projectRoot,e))}):n.error('Config "exclude" entry must contain an array.')),this.ignore=[],void 0!==e.ignore&&(Array.isArray(e.ignore)?e.ignore.forEach((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "ignore" array should be a string.`):a.isAbsolute(e)?n.error(`Ignoring path "${e}" in "ignore" array because it is not relative.`):this.ignore.push(p.getFileSpec(this.projectRoot,e))}):n.error('Config "ignore" entry must contain an array.')),this.strict=[],void 0!==e.strict&&(Array.isArray(e.strict)?e.strict.forEach((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "strict" array should be a string.`):a.isAbsolute(e)?n.error(`Ignoring path "${e}" in "strict" array because it is not relative.`):this.strict.push(p.getFileSpec(this.projectRoot,e))}):n.error('Config "strict" entry must contain an array.')),void 0!==e.typeCheckingMode&&("off"===e.typeCheckingMode||"basic"===e.typeCheckingMode||"strict"===e.typeCheckingMode?o=e.typeCheckingMode:n.error('Config "typeCheckingMode" entry must contain "off", "basic", or "strict".')),void 0!==e.useLibraryCodeForTypes&&("boolean"==typeof e.useLibraryCodeForTypes?this.useLibraryCodeForTypes=e.useLibraryCodeForTypes:n.error('Config "useLibraryCodeForTypes" entry must be true or false.'));const l=o||t,d=h.getDiagnosticRuleSet(l);if("off"===l&&(this.disableInferenceForPyTypedSources=!1),this.applyDiagnosticOverrides(s),this.diagnosticRuleSet={printUnknownAsAny:d.printUnknownAsAny,omitTypeArgsIfAny:d.omitTypeArgsIfAny,omitUnannotatedParamType:d.omitUnannotatedParamType,pep604Printing:d.pep604Printing,strictListInference:this._convertBoolean(e.strictListInference,c.DiagnosticRule.strictListInference,d.strictListInference),strictDictionaryInference:this._convertBoolean(e.strictDictionaryInference,c.DiagnosticRule.strictDictionaryInference,d.strictDictionaryInference),strictParameterNoneValue:this._convertBoolean(e.strictParameterNoneValue,c.DiagnosticRule.strictParameterNoneValue,d.strictParameterNoneValue),enableTypeIgnoreComments:this._convertBoolean(e.enableTypeIgnoreComments,c.DiagnosticRule.enableTypeIgnoreComments,d.enableTypeIgnoreComments),reportGeneralTypeIssues:this._convertDiagnosticLevel(e.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,d.reportGeneralTypeIssues),reportPropertyTypeMismatch:this._convertDiagnosticLevel(e.reportPropertyTypeMismatch,c.DiagnosticRule.reportPropertyTypeMismatch,d.reportPropertyTypeMismatch),reportMissingImports:this._convertDiagnosticLevel(e.reportMissingImports,c.DiagnosticRule.reportMissingImports,d.reportMissingImports),reportUnusedImport:this._convertDiagnosticLevel(e.reportUnusedImport,c.DiagnosticRule.reportUnusedImport,d.reportUnusedImport),reportUnusedClass:this._convertDiagnosticLevel(e.reportUnusedClass,c.DiagnosticRule.reportUnusedClass,d.reportUnusedClass),reportUnusedFunction:this._convertDiagnosticLevel(e.reportUnusedFunction,c.DiagnosticRule.reportUnusedFunction,d.reportUnusedFunction),reportUnusedVariable:this._convertDiagnosticLevel(e.reportUnusedVariable,c.DiagnosticRule.reportUnusedVariable,d.reportUnusedVariable),reportDuplicateImport:this._convertDiagnosticLevel(e.reportDuplicateImport,c.DiagnosticRule.reportDuplicateImport,d.reportDuplicateImport),reportWildcardImportFromLibrary:this._convertDiagnosticLevel(e.reportWildcardImportFromLibrary,c.DiagnosticRule.reportWildcardImportFromLibrary,d.reportWildcardImportFromLibrary),reportMissingModuleSource:this._convertDiagnosticLevel(e.reportMissingModuleSource,c.DiagnosticRule.reportMissingModuleSource,d.reportMissingModuleSource),reportMissingTypeStubs:this._convertDiagnosticLevel(e.reportMissingTypeStubs,c.DiagnosticRule.reportMissingTypeStubs,d.reportMissingTypeStubs),reportImportCycles:this._convertDiagnosticLevel(e.reportImportCycles,c.DiagnosticRule.reportImportCycles,d.reportImportCycles),reportOptionalSubscript:this._convertDiagnosticLevel(e.reportOptionalSubscript,c.DiagnosticRule.reportOptionalSubscript,d.reportOptionalSubscript),reportOptionalMemberAccess:this._convertDiagnosticLevel(e.reportOptionalMemberAccess,c.DiagnosticRule.reportOptionalMemberAccess,d.reportOptionalMemberAccess),reportOptionalCall:this._convertDiagnosticLevel(e.reportOptionalCall,c.DiagnosticRule.reportOptionalCall,d.reportOptionalCall),reportOptionalIterable:this._convertDiagnosticLevel(e.reportOptionalIterable,c.DiagnosticRule.reportOptionalIterable,d.reportOptionalIterable),reportOptionalContextManager:this._convertDiagnosticLevel(e.reportOptionalContextManager,c.DiagnosticRule.reportOptionalContextManager,d.reportOptionalContextManager),reportOptionalOperand:this._convertDiagnosticLevel(e.reportOptionalOperand,c.DiagnosticRule.reportOptionalOperand,d.reportOptionalOperand),reportUntypedFunctionDecorator:this._convertDiagnosticLevel(e.reportUntypedFunctionDecorator,c.DiagnosticRule.reportUntypedFunctionDecorator,d.reportUntypedFunctionDecorator),reportUntypedClassDecorator:this._convertDiagnosticLevel(e.reportUntypedClassDecorator,c.DiagnosticRule.reportUntypedClassDecorator,d.reportUntypedClassDecorator),reportUntypedBaseClass:this._convertDiagnosticLevel(e.reportUntypedBaseClass,c.DiagnosticRule.reportUntypedBaseClass,d.reportUntypedBaseClass),reportUntypedNamedTuple:this._convertDiagnosticLevel(e.reportUntypedNamedTuple,c.DiagnosticRule.reportUntypedNamedTuple,d.reportUntypedNamedTuple),reportPrivateUsage:this._convertDiagnosticLevel(e.reportPrivateUsage,c.DiagnosticRule.reportPrivateUsage,d.reportPrivateUsage),reportConstantRedefinition:this._convertDiagnosticLevel(e.reportConstantRedefinition,c.DiagnosticRule.reportConstantRedefinition,d.reportConstantRedefinition),reportIncompatibleMethodOverride:this._convertDiagnosticLevel(e.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,d.reportIncompatibleMethodOverride),reportIncompatibleVariableOverride:this._convertDiagnosticLevel(e.reportIncompatibleVariableOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,d.reportIncompatibleVariableOverride),reportInvalidStringEscapeSequence:this._convertDiagnosticLevel(e.reportInvalidStringEscapeSequence,c.DiagnosticRule.reportInvalidStringEscapeSequence,d.reportInvalidStringEscapeSequence),reportUnknownParameterType:this._convertDiagnosticLevel(e.reportUnknownParameterType,c.DiagnosticRule.reportUnknownParameterType,d.reportUnknownParameterType),reportUnknownArgumentType:this._convertDiagnosticLevel(e.reportUnknownArgumentType,c.DiagnosticRule.reportUnknownArgumentType,d.reportUnknownArgumentType),reportUnknownLambdaType:this._convertDiagnosticLevel(e.reportUnknownLambdaType,c.DiagnosticRule.reportUnknownLambdaType,d.reportUnknownLambdaType),reportUnknownVariableType:this._convertDiagnosticLevel(e.reportUnknownVariableType,c.DiagnosticRule.reportUnknownVariableType,d.reportUnknownVariableType),reportUnknownMemberType:this._convertDiagnosticLevel(e.reportUnknownMemberType,c.DiagnosticRule.reportUnknownMemberType,d.reportUnknownMemberType),reportMissingTypeArgument:this._convertDiagnosticLevel(e.reportMissingTypeArgument,c.DiagnosticRule.reportMissingTypeArgument,d.reportMissingTypeArgument),reportCallInDefaultInitializer:this._convertDiagnosticLevel(e.reportCallInDefaultInitializer,c.DiagnosticRule.reportCallInDefaultInitializer,d.reportCallInDefaultInitializer),reportUnnecessaryIsInstance:this._convertDiagnosticLevel(e.reportUnnecessaryIsInstance,c.DiagnosticRule.reportUnnecessaryIsInstance,d.reportUnnecessaryIsInstance),reportUnnecessaryCast:this._convertDiagnosticLevel(e.reportUnnecessaryCast,c.DiagnosticRule.reportUnnecessaryCast,d.reportUnnecessaryCast),reportAssertAlwaysTrue:this._convertDiagnosticLevel(e.reportAssertAlwaysTrue,c.DiagnosticRule.reportAssertAlwaysTrue,d.reportAssertAlwaysTrue),reportSelfClsParameterName:this._convertDiagnosticLevel(e.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,d.reportSelfClsParameterName),reportImplicitStringConcatenation:this._convertDiagnosticLevel(e.reportImplicitStringConcatenation,c.DiagnosticRule.reportImplicitStringConcatenation,d.reportImplicitStringConcatenation),reportUndefinedVariable:this._convertDiagnosticLevel(e.reportUndefinedVariable,c.DiagnosticRule.reportUndefinedVariable,d.reportUndefinedVariable),reportUnboundVariable:this._convertDiagnosticLevel(e.reportUnboundVariable,c.DiagnosticRule.reportUnboundVariable,d.reportUnboundVariable),reportInvalidStubStatement:this._convertDiagnosticLevel(e.reportInvalidStubStatement,c.DiagnosticRule.reportInvalidStubStatement,d.reportInvalidStubStatement)},this.venvPath=void 0,void 0!==e.venvPath&&("string"!=typeof e.venvPath?n.error('Config "venvPath" field must contain a string.'):this.venvPath=p.normalizePath(p.combinePaths(this.projectRoot,e.venvPath))),this.defaultVenv=void 0,void 0!==e.venv&&("string"!=typeof e.venv?n.error('Config "venv" field must contain a string.'):this.defaultVenv=e.venv),this.defaultPythonVersion=void 0,void 0!==e.pythonVersion)if("string"==typeof e.pythonVersion){const t=u.versionFromString(e.pythonVersion);t?this.defaultPythonVersion=t:n.error('Config "pythonVersion" field contains unsupported version.')}else n.error('Config "pythonVersion" field must contain a string.');this.ensureDefaultPythonVersion(i,n),this.defaultPythonPlatform=void 0,void 0!==e.pythonPlatform&&("string"!=typeof e.pythonPlatform?n.error('Config "pythonPlatform" field must contain a string.'):this.defaultPythonPlatform=e.pythonPlatform),this.ensureDefaultPythonPlatform(n),this.typeshedPath=void 0,void 0!==e.typeshedPath&&("string"!=typeof e.typeshedPath?n.error('Config "typeshedPath" field must contain a string.'):this.typeshedPath=e.typeshedPath?p.normalizePath(p.combinePaths(this.projectRoot,e.typeshedPath)):""),this.stubPath=void 0,void 0!==e.typingsPath&&("string"!=typeof e.typingsPath?n.error('Config "typingsPath" field must contain a string.'):(n.error('Config "typingsPath" is now deprecated. Please, use stubPath instead.'),this.stubPath=p.normalizePath(p.combinePaths(this.projectRoot,e.typingsPath)))),void 0!==e.stubPath&&("string"!=typeof e.stubPath?n.error('Config "stubPath" field must contain a string.'):this.stubPath=p.normalizePath(p.combinePaths(this.projectRoot,e.stubPath))),void 0!==e.verboseOutput&&("boolean"!=typeof e.verboseOutput?n.error('Config "verboseOutput" field must be true or false.'):this.verboseOutput=e.verboseOutput),void 0!==e.useLibraryCodeForTypes&&("boolean"!=typeof e.useLibraryCodeForTypes?n.error('Config "useLibraryCodeForTypes" field must be true or false.'):this.useLibraryCodeForTypes=e.useLibraryCodeForTypes),this.executionEnvironments=[],void 0!==e.executionEnvironments&&(Array.isArray(e.executionEnvironments)?e.executionEnvironments.forEach((e,t)=>{const s=this._initExecutionEnvironmentFromJson(e,t,n);s&&this.executionEnvironments.push(s)}):n.error('Config "executionEnvironments" field must contain an array.')),void 0!==e.autoImportCompletions&&("boolean"!=typeof e.autoImportCompletions?n.error('Config "autoImportCompletions" field must be true or false.'):this.autoImportCompletions=e.autoImportCompletions),void 0!==e.indexing&&("boolean"!=typeof e.indexing?n.error('Config "indexing" field must be true or false.'):this.indexing=e.indexing)}ensureDefaultPythonPlatform(e){void 0===this.defaultPythonPlatform&&("darwin"===process.platform?this.defaultPythonPlatform="Darwin":"linux"===process.platform?this.defaultPythonPlatform="Linux":"win32"===process.platform&&(this.defaultPythonPlatform="Windows"),void 0!==this.defaultPythonPlatform&&e.info("Assuming Python platform "+this.defaultPythonPlatform))}ensureDefaultPythonVersion(e,t){void 0===this.defaultPythonVersion&&(this.defaultPythonVersion=this._getPythonVersionFromPythonInterpreter(e,t),void 0!==this.defaultPythonVersion&&t.info("Assuming Python version "+u.versionToString(this.defaultPythonVersion)))}applyDiagnosticOverrides(e){if(e)for(const[t,n]of Object.entries(e))this.diagnosticRuleSet[t]=n}_convertBoolean(e,t,n){return void 0===e?n:"boolean"==typeof e?!!e:(console.log(`Config "${t}" entry must be true or false.`),n)}_convertDiagnosticLevel(e,t,n){return void 0===e?n:"boolean"==typeof e?e?"error":"none":"string"!=typeof e||"error"!==e&&"warning"!==e&&"information"!==e&&"none"!==e?(console.log(`Config "${t}" entry must be true, false, "error", "warning", "information" or "none".`),n):e}_initExecutionEnvironmentFromJson(e,t,n){try{const s=new d(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform);if(e.root&&"string"==typeof e.root?s.root=p.normalizePath(p.combinePaths(this.projectRoot,e.root)):n.error(`Config executionEnvironments index ${t}: missing root value.`),e.extraPaths&&(Array.isArray(e.extraPaths)?e.extraPaths.forEach((e,i)=>{"string"!=typeof e?n.error(`Config executionEnvironments index ${t}: extraPaths field ${i} must be a string.`):s.extraPaths.push(p.normalizePath(p.combinePaths(this.projectRoot,e)))}):n.error(`Config executionEnvironments index ${t}: extraPaths field must contain an array.`)),e.pythonVersion)if("string"==typeof e.pythonVersion){const i=u.versionFromString(e.pythonVersion);i?s.pythonVersion=i:n.warn(`Config executionEnvironments index ${t} contains unsupported pythonVersion.`)}else n.error(`Config executionEnvironments index ${t} pythonVersion must be a string.`);return e.pythonPlatform&&("string"==typeof e.pythonPlatform?s.pythonPlatform=e.pythonPlatform:n.error(`Config executionEnvironments index ${t} pythonPlatform must be a string.`)),e.venv&&("string"==typeof e.venv?s.venv=e.venv:n.error(`Config executionEnvironments index ${t} venv must be a string.`)),s}catch(e){n.error(`Config executionEnvironments index ${t} is not accessible.`)}}_getPythonVersionFromPythonInterpreter(e,t){try{const n=["-c","import sys, json; json.dump(dict(major=sys.version_info[0], minor=sys.version_info[1]), sys.stdout)"];let s;s=e?o.execFileSync(e,n,{encoding:"utf8"}):o.execFileSync("python",n,{encoding:"utf8"});const i=JSON.parse(s),r=u.versionFromMajorMinor(i.major,i.minor);return void 0===r?void t.warn(`Python version ${i.major}.${i.minor} from interpreter is unsupported`):r}catch(e){return void t.info("Unable to get Python version from interpreter")}}}t.ConfigOptions=h},2211:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.ConsoleWithLogLevel=t.StandardConsole=t.NullConsole=t.LogLevel=void 0;const o=r(n(5839));var a;function l(e,t,n){switch(t){case a.Log:e.log(n);break;case a.Info:e.info(n);break;case a.Warn:e.warn(n);break;case a.Error:e.error(n);break;default:o.fail(t+" is not expected")}}!function(e){e.Error="error",e.Warn="warn",e.Info="info",e.Log="log"}(a=t.LogLevel||(t.LogLevel={})),t.NullConsole=class{constructor(){this.logCount=0,this.infoCount=0,this.warnCount=0,this.errorCount=0}log(e){this.logCount++}info(e){this.infoCount++}warn(e){this.warnCount++}error(e){this.errorCount++}},t.StandardConsole=class{log(e){console.info(e)}info(e){console.info(e)}warn(e){console.warn(e)}error(e){console.error(e)}},t.ConsoleWithLogLevel=class{constructor(e){this._console=e,this._levelMap=new Map([[a.Error,0],[a.Warn,1],[a.Info,2],[a.Log,3]]),this._maxLevel=2}get level(){switch(this._maxLevel){case 0:return a.Error;case 1:return a.Warn;case 2:return a.Info}return a.Log}set level(e){let t=this._levelMap.get(e);void 0===t&&(t=this._levelMap.get(a.Info)),this._maxLevel=t}error(e){this._log(a.Error,e)}warn(e){this._log(a.Warn,e)}info(e){this._log(a.Info,e)}log(e){this._log(a.Log,e)}_log(e,t){this._getNumericalLevel(e)>this._maxLevel||l(this._console,e,t)}_getNumericalLevel(e){const t=this._levelMap.get(e);return o.assert(void 0!==t,"Logger: unknown log level."),void 0!==t?t:2}},t.log=l},2489:(e,t)=>{"use strict";function n(e,t){return e===t?0:void 0===e?-1:void 0===t?1:e<t?-1:1}Object.defineProperty(t,"__esModule",{value:!0}),t.isDebugMode=t.toBoolean=t.hasProperty=t.isNumber=t.isString=t.isArray=t.compareValues=t.compareComparableValues=t.equateValues=t.toLowerCase=t.identity=t.returnUndefined=t.returnTrue=t.returnFalse=void 0,t.returnFalse=function(){return!1},t.returnTrue=function(){return!0},t.returnUndefined=function(){},t.identity=function(e){return e},t.toLowerCase=function(e){return e.toLowerCase()},t.equateValues=function(e,t){return e===t},t.compareComparableValues=n,t.compareValues=function(e,t){return n(e,t)},t.isArray=function(e){return Array.isArray?Array.isArray(e):e instanceof Array},t.isString=function(e){return"string"==typeof e},t.isNumber=function(e){return"number"==typeof e};const s=Object.prototype.hasOwnProperty;t.hasProperty=function(e,t){return s.call(e,t)},t.toBoolean=function(e){return"TRUE"===(null==e?void 0:e.trim().toUpperCase())},t.isDebugMode=function(){const e=process.execArgv.join();return e.includes("inspect")||e.includes("debug")}},5839:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorString=t.formatEnum=t.getFunctionName=t.assertNever=t.assertEachDefined=t.assertDefined=t.fail=t.assert=void 0;const s=n(9489),i=n(2489);function r(e,t){const n=new Error(e?"Debug Failure. "+e:"Debug Failure.");throw Error.captureStackTrace&&Error.captureStackTrace(n,t||r),n}function o(e,t){return null==e?r(t):e}t.assert=function e(t,n,s,i){t||(s&&(n+="\r\nVerbose Debug Information: "+("string"==typeof s?s:s())),r(n?"False expression: "+n:"False expression.",i||e))},t.fail=r,t.assertDefined=o,t.assertEachDefined=function(e,t){for(const n of e)o(n,t);return e},t.assertNever=function e(t,n="Illegal value:",s){return r(`${n} ${JSON.stringify(t)}`,s||e)},t.getFunctionName=function(e){if("function"!=typeof e)return"";if(i.hasProperty(e,"name"))return e.name;{const t=Function.prototype.toString.call(e),n=/^function\s+([\w$]+)\s*\(/.exec(t);return n?n[1]:""}},t.formatEnum=function(e=0,t,n){const r=function(e){const t=[];for(const n of Object.keys(e)){const s=e[n];"number"==typeof s&&t.push([s,n])}return s.stableSort(t,(e,t)=>i.compareValues(e[0],t[0]))}(t);if(0===e)return r.length>0&&0===r[0][0]?r[0][1]:"0";if(n){let t="",n=e;for(const[s,i]of r){if(s>e)break;0!==s&&s&e&&(t=`${t}${t?"|":""}${i}`,n&=~s)}if(0===n)return t}else for(const[t,n]of r)if(t===e)return n;return e.toString()},t.getErrorString=function(e){return(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e)}},8304:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDeferredFromPromise=t.createDeferredFrom=t.createDeferred=void 0;class n{constructor(e=null){this.scope=e,this._resolved=!1,this._rejected=!1,this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}resolve(e){this._resolve.apply(this.scope?this.scope:this,arguments),this._resolved=!0}reject(e){this._reject.apply(this.scope?this.scope:this,arguments),this._rejected=!0}get promise(){return this._promise}get resolved(){return this._resolved}get rejected(){return this._rejected}get completed(){return this._rejected||this._resolved}}function s(e=null){return new n(e)}t.createDeferred=s,t.createDeferredFrom=function(...e){const t=s();return Promise.all(e).then(t.resolve.bind(t)).catch(t.reject.bind(t)),t},t.createDeferredFromPromise=function(e){const t=s();return e.then(t.resolve.bind(t)).catch(t.reject.bind(t)),t}},1290:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticAddendum=t.Diagnostic=t.convertLevelToCategory=void 0,t.convertLevelToCategory=function(e){switch(e){case"error":return 0;case"warning":return 1;case"information":return 2;default:throw new Error(e+" is not expected")}},t.Diagnostic=class{constructor(e,t,n){this.category=e,this.message=t,this.range=n,this._relatedInfo=[]}addAction(e){void 0===this._actions?this._actions=[e]:this._actions.push(e)}getActions(){return this._actions}setRule(e){this._rule=e}getRule(){return this._rule}addRelatedInfo(e,t,n){this._relatedInfo.push({filePath:t,message:e,range:n})}getRelatedInfo(){return this._relatedInfo}};class n{constructor(){this._messages=[],this._childAddenda=[]}addMessage(e){this._messages.push(e)}createAddendum(){const e=new n;return this.addAddendum(e),e}getString(e=5,t=8){let n=this._getLinesRecursive(e);n.length>t&&(n=n.slice(0,t),n.push("  ..."));const s=n.join("\n");return s.length>0?"\n"+s:""}isEmpty(){return 0===this._getMessageCount()}addAddendum(e){this._childAddenda.push(e)}getChildren(){return this._childAddenda}_getMessageCount(e=0){if(e>64)return 0;let t=this._messages.length;for(const n of this._childAddenda)t+=n._getMessageCount(e+1);return t}_getLinesRecursive(e,t=0){if(e<=0||t>64)return[];const n=[];for(const s of this._childAddenda){const i=this._messages.length>0?e-1:e;n.push(...s._getLinesRecursive(i,t+1))}const s=this._messages.length>0?"  ":"";return this._messages.concat(n).map(e=>s+e)}}t.DiagnosticAddendum=n},9744:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticRule=void 0,(n=t.DiagnosticRule||(t.DiagnosticRule={})).strictListInference="strictListInference",n.strictDictionaryInference="strictDictionaryInference",n.strictParameterNoneValue="strictParameterNoneValue",n.enableTypeIgnoreComments="enableTypeIgnoreComments",n.reportGeneralTypeIssues="reportGeneralTypeIssues",n.reportPropertyTypeMismatch="reportPropertyTypeMismatch",n.reportMissingImports="reportMissingImports",n.reportMissingModuleSource="reportMissingModuleSource",n.reportMissingTypeStubs="reportMissingTypeStubs",n.reportImportCycles="reportImportCycles",n.reportUnusedImport="reportUnusedImport",n.reportUnusedClass="reportUnusedClass",n.reportUnusedFunction="reportUnusedFunction",n.reportUnusedVariable="reportUnusedVariable",n.reportDuplicateImport="reportDuplicateImport",n.reportWildcardImportFromLibrary="reportWildcardImportFromLibrary",n.reportOptionalSubscript="reportOptionalSubscript",n.reportOptionalMemberAccess="reportOptionalMemberAccess",n.reportOptionalCall="reportOptionalCall",n.reportOptionalIterable="reportOptionalIterable",n.reportOptionalContextManager="reportOptionalContextManager",n.reportOptionalOperand="reportOptionalOperand",n.reportUntypedFunctionDecorator="reportUntypedFunctionDecorator",n.reportUntypedClassDecorator="reportUntypedClassDecorator",n.reportUntypedBaseClass="reportUntypedBaseClass",n.reportUntypedNamedTuple="reportUntypedNamedTuple",n.reportPrivateUsage="reportPrivateUsage",n.reportConstantRedefinition="reportConstantRedefinition",n.reportIncompatibleMethodOverride="reportIncompatibleMethodOverride",n.reportIncompatibleVariableOverride="reportIncompatibleVariableOverride",n.reportInvalidStringEscapeSequence="reportInvalidStringEscapeSequence",n.reportUnknownParameterType="reportUnknownParameterType",n.reportUnknownArgumentType="reportUnknownArgumentType",n.reportUnknownLambdaType="reportUnknownLambdaType",n.reportUnknownVariableType="reportUnknownVariableType",n.reportUnknownMemberType="reportUnknownMemberType",n.reportMissingTypeArgument="reportMissingTypeArgument",n.reportCallInDefaultInitializer="reportCallInDefaultInitializer",n.reportUnnecessaryIsInstance="reportUnnecessaryIsInstance",n.reportUnnecessaryCast="reportUnnecessaryCast",n.reportAssertAlwaysTrue="reportAssertAlwaysTrue",n.reportSelfClsParameterName="reportSelfClsParameterName",n.reportImplicitStringConcatenation="reportImplicitStringConcatenation",n.reportUndefinedVariable="reportUndefinedVariable",n.reportUnboundVariable="reportUnboundVariable",n.reportInvalidStubStatement="reportInvalidStubStatement"},3980:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextRangeDiagnosticSink=t.DiagnosticSink=void 0;const s=n(1290),i=n(1464);class r{constructor(e){this._diagnosticList=e||[],this._diagnosticMap=new Map}fetchAndClear(){const e=this._diagnosticList;return this._diagnosticList=[],this._diagnosticMap.clear(),e}addError(e,t){return this.addDiagnostic(new s.Diagnostic(0,e,t))}addWarning(e,t){return this.addDiagnostic(new s.Diagnostic(1,e,t))}addInformation(e,t){return this.addDiagnostic(new s.Diagnostic(2,e,t))}addUnusedCode(e,t,n){const i=new s.Diagnostic(3,e,t);return n&&i.addAction(n),this.addDiagnostic(i)}addDiagnostic(e){const t=`${e.range.start.line},${e.range.start.character}-${e.range.end.line}-${e.range.end.character}:${e.message.substr(0,25)}}`;return this._diagnosticMap.has(t)||(this._diagnosticList.push(e),this._diagnosticMap.set(t,e)),e}addDiagnostics(e){this._diagnosticList.push(...e)}getErrors(){return this._diagnosticList.filter(e=>0===e.category)}getWarnings(){return this._diagnosticList.filter(e=>1===e.category)}getInformation(){return this._diagnosticList.filter(e=>2===e.category)}getUnusedCode(){return this._diagnosticList.filter(e=>3===e.category)}}t.DiagnosticSink=r,t.TextRangeDiagnosticSink=class extends r{constructor(e,t){super(t),this._lines=e}addDiagnosticWithTextRange(e,t,n){const s=i.convertOffsetsToRange(n.start,n.start+n.length,this._lines);switch(e){case"error":return this.addError(t,s);case"warning":return this.addWarning(t,s);case"information":return this.addInformation(t,s);default:throw new Error(e+" is not expected value")}}addUnusedCodeWithTextRange(e,t,n){return this.addUnusedCode(e,i.convertOffsetsToRange(t.start,t.start+t.length,this._lines),n)}}},6755:()=>{"use strict";Promise.prototype.ignoreErrors=function(){this.catch(()=>{})}},7830:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ignoredWatchEventFunction=t.createFromRealFileSystem=void 0;const o=r(n(778)),a=r(n(5747)),l=r(n(1195));l.setGracefulCleanup();const c=n(2211),p=n(8304);t.createFromRealFileSystem=function(e,t){return new h(null!=t?t:new m(null!=e?e:new c.NullConsole))},t.ignoredWatchEventFunction=function(e){const t=e.map(e=>e.toLowerCase());return e=>{if(!e||e.indexOf("__pycache__")>=0)return!0;const n=e.toLowerCase();return t.every(e=>n.indexOf(e)<0)}};const u="darwin"===process.platform,d="linux"===process.platform;class h{constructor(e){this._fileWatcherProvider=e}existsSync(e){return a.existsSync(e)}mkdirSync(e,t){a.mkdirSync(e,t)}chdir(e){process.chdir(e)}readdirSync(e){return a.readdirSync(e)}readdirEntriesSync(e){return a.readdirSync(e,{withFileTypes:!0})}readFileSync(e,t=null){return a.readFileSync(e,{encoding:t})}writeFileSync(e,t,n){a.writeFileSync(e,t,{encoding:n})}statSync(e){return a.statSync(e)}unlinkSync(e){a.unlinkSync(e)}realpathSync(e){return a.realpathSync(e)}getModulePath(){return global.__rootDirectory}createFileSystemWatcher(e,t){return this._fileWatcherProvider.createFileWatcher(e,t)}createReadStream(e){return a.createReadStream(e)}createWriteStream(e){return a.createWriteStream(e)}copyFileSync(e,t){a.copyFileSync(e,t)}readFile(e){const t=p.createDeferred();return a.readFile(e,(e,n)=>{e?t.reject(e):t.resolve(n)}),t.promise}readFileText(e,t){const n=p.createDeferred();return a.readFile(e,{encoding:t},(e,t)=>{e?n.reject(e):n.resolve(t)}),n.promise}tmpdir(){if(!this._tmpdir){const e=l.dirSync({prefix:"pyright"});this._tmpdir=e.name}return this._tmpdir}tmpfile(e){return l.fileSync(Object.assign({dir:this.tmpdir(),discardDescriptor:!0},e)).name}}class m{constructor(e){this._console=e}createFileWatcher(e,t){return this._createFileSystemWatcher(e).on("all",t)}createReadStream(e){return a.createReadStream(e)}createWriteStream(e){return a.createWriteStream(e)}_createFileSystemWatcher(e){const t={ignoreInitial:!0,ignorePermissionErrors:!0,followSymlinks:!0,interval:1e3,binaryInterval:1e3,disableGlobbing:!0,awaitWriteFinish:{stabilityThreshold:1e3,pollInterval:1e3}};u&&(t.usePolling=!1);const n=["**/__pycache__/**"];(u||d)&&e.some(e=>""===e||"/"===e)&&(n.push("/dev/**"),d&&n.push("/proc/**","/sys/**")),t.ignored=n;const s=o.watch(e,t);return s.on("error",e=>{this._console.error("Error returned from file system watcher.")}),u&&!s.options.useFsEvents&&this._console.info("Watcher could not use native fsevents library. File system watcher disabled."),s}readFile(e){const t=p.createDeferred();return a.readFile(e,(e,n)=>{e?t.reject(e):t.resolve(n)}),t.promise}readFileText(e,t){const n=p.createDeferred();return a.readFile(e,{encoding:t},(e,t)=>{e?n.reject(e):n.resolve(t)}),n.promise}}},7345:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogTracker=void 0;const s=n(2211),i=n(8718);t.LogTracker=class{constructor(e,t){this._console=e,this._prefix=t,this._dummyState=new r,this._indentation="",this._previousTitles=[]}log(e,t){if(void 0===this._console)return t(this._dummyState);const n=this._console.level;if(void 0===n||n!==s.LogLevel.Log&&n!==s.LogLevel.Info)return t(this._dummyState);const o=new i.Duration,a=this._indentation;this._previousTitles.push(`${a}${e} ...`),this._indentation+="  ";const l=new r;try{return t(l)}finally{this._printPreviousTitles(),this._indentation=a;const t=o.getDurationInMilliseconds();l.isSuppressed()||(this._console.log(`[${this._prefix}] ${this._indentation}${e}${l.get()} (${t}ms)`),t>=2e3&&this._console.info(`[${this._prefix}] Long operation: ${e} (${t}ms)`))}}_printPreviousTitles(){if(this._previousTitles.pop(),!(this._previousTitles.length<=0)){for(const e of this._previousTitles)this._console.log(`[${this._prefix}] ${e}`);this._previousTitles.length=0}}};class r{add(e){this._addendum=e}get(){return this._addendum?` [${this._addendum}]`:""}suppress(){this._suppress=!0}isSuppressed(){return!!this._suppress}}},3188:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.src=t.sitePackages=t.lib=t.typeshedFallback=void 0,t.typeshedFallback="typeshed-fallback",t.lib="lib",t.sitePackages="site-packages",t.src="src"},6657:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isFileSystemCaseSensitiveInternal=t.isFileSystemCaseSensitive=t.normalizePathCase=t.convertPathToUri=t.convertUriToPath=t.isDiskPathRoot=t.isRootedDiskPath=t.getRegexEscapedSeparator=t.getFileSpec=t.getWildcardRoot=t.getWildcardRegexPattern=t.getFileSystemEntries=t.isFile=t.isDirectory=t.normalizePath=t.stripFileExtension=t.getFileName=t.getFileExtension=t.stripTrailingDirectorySeparator=t.hasTrailingDirectorySeparator=t.ensureTrailingDirectorySeparator=t.comparePathsCaseInsensitive=t.comparePathsCaseSensitive=t.getRelativePathComponentsFromDirectory=t.getRelativePathFromDirectory=t.getBaseFileName=t.getAnyExtensionFromPath=t.changeAnyExtension=t.containsPath=t.comparePaths=t.combinePaths=t.resolvePaths=t.normalizeSlashes=t.directoryExists=t.fileExists=t.getFileSize=t.makeDirectories=t.getRelativePath=t.combinePathComponents=t.reducePathComponents=t.getPathComponents=t.getRootLength=t.getDirectoryPath=t.forEachAncestorDirectory=t.FileSpec=void 0;const o=n(6417),a=r(n(5622)),l=n(472),c=n(9489),p=n(2489),u=r(n(5839)),d=n(7559);let h=void 0;function m(e){return e.substr(0,Math.max(y(e),e.lastIndexOf(a.sep)))}function y(e){if(e.charAt(0)===a.sep){if(e.charAt(1)!==a.sep)return 1;const t=e.indexOf(a.sep,2);if(t<0)return 2;const n=e.indexOf(a.sep,t+1);return n<0?t+1:n+1}return":"===e.charAt(1)&&e.charAt(2)===a.sep?3:0}function g(e){const t=T(e),n=y(t),s=t.substring(0,n),i=t.substring(n).split(a.sep);return i.length>0&&!i[i.length-1]&&i.pop(),f([s,...i])}function f(e){if(!c.some(e))return[];const t=[e[0]];for(let n=1;n<e.length;n++){const s=e[n];if(s&&"."!==s){if(".."===s)if(t.length>1){if(".."!==t[t.length-1]){t.pop();continue}}else if(t[0])continue;t.push(s)}}return t}function _(e){return 0===e.length?"":T((e[0]&&I(e[0]))+e.slice(1).join(a.sep))}function T(e){return e.replace(/[\\/]/g,a.sep)}function v(e,...t){e&&(e=T(e));for(let n of t)n&&(n=T(n),e=e&&0===y(n)?I(e)+n:n);return e}function b(e,t,n){if(t)return function(e,t,n){if("string"==typeof t)return O(e,t,n)||"";for(const s of t){const t=O(e,s,n);if(t)return t}return""}(k(e),t,n?d.equateStringsCaseInsensitive:d.equateStringsCaseSensitive);const s=C(e),i=s.lastIndexOf(".");return i>=0?s.substring(i):""}function C(e,t,n){if(y(e=T(e))===e.length)return"";const s=(e=k(e)).slice(Math.max(y(e),e.lastIndexOf(a.sep)+1)),i=void 0!==t&&void 0!==n?b(s,t,n):void 0;return i?s.slice(0,s.length-i.length):s}function S(e,t,n){u.assert(y(e)>0==y(t)>0,"Paths must either both be absolute or both be relative");const s="function"==typeof n?n:p.identity;return function(e,t,n,s){const i=g(e),r=g(t);let o;for(o=0;o<i.length&&o<r.length;o++){const e=s(i[o]),t=s(r[o]);if(!(0===o?d.equateStringsCaseInsensitive:n)(e,t))break}if(0===o)return r;const a=r.slice(o),l=[];for(;o<i.length;o++)l.push("..");return["",...l,...a]}(e,t,"boolean"==typeof n&&n?d.equateStringsCaseInsensitive:d.equateStringsCaseSensitive,s)}function I(e){return D(e)?e:e+a.sep}function D(e){if(0===e.length)return!1;const t=e.charCodeAt(e.length-1);return 47===t||92===t}function k(e){return D(e)?e.substr(0,e.length-1):e}function x(e,t=!1){if(!t)return a.extname(e);const n=(e=F(e)).indexOf(".");return e.substr(n)}function F(e){return a.basename(e)}function P(e){return T(a.normalize(e))}function A(e,t){let n=P(v(e,t));n.endsWith(".py")||n.endsWith(".pyi")||(n=I(n));const s=g(n),i=E(),r=`(${i}[^${i}.][^${i}]*)*?`,o=new RegExp(`[^\\w\\s${i}]`,"g");s.length>0&&(s[0]=k(s[0]));let a="",l=!0;for(let e of s)"**"===e?a+=r:(l||(e=i+e),a+=e.replace(o,e=>"*"===e?`[^${i}]*`:"?"===e?`[^${i}]`:"\\"+e),l=!1);return a}function w(e,t){let n=P(v(e,t));n.endsWith(".py")||n.endsWith(".pyi")||(n=I(n));const s=g(n);s.length>0&&(s[0]=k(s[0]));let i="",r=!0;for(let e of s){if("**"===e)break;if(e.match(/[*?]/))break;r||(e=a.sep+e),i+=e,r=!1}return i}function E(){return"/"===a.sep?"/":"\\\\"}function N(e,t,n){if(e===t)return 0;if(void 0===e)return-1;if(void 0===t)return 1;const s=e.substring(0,y(e)),i=t.substring(0,y(t)),r=d.compareStringsCaseInsensitive(s,i);if(0!==r)return r;const o=E(),a=new RegExp(`(^|${o}).{0,2}($|${o})`),l=e.substring(s.length),c=t.substring(i.length);if(!a.test(l)&&!a.test(c))return n(l,c);const u=g(e),h=g(t),m=Math.min(u.length,h.length);for(let e=1;e<m;e++){const t=n(u[e],h[e]);if(0!==t)return t}return p.compareValues(u.length,h.length)}function O(e,t,n){if(t.startsWith(".")||(t="."+t),e.length>=t.length&&46===e.charCodeAt(e.length-t.length)){const s=e.slice(e.length-t.length);if(n(s,t))return s}}function R(e,t,n){try{const s=e.statSync(t);switch(n){case 0:return s.isFile();case 1:return s.isDirectory();default:return!1}}catch(e){return!1}}function L(e){return void 0!==h||(h=M(e)),h}function M(e){let t=void 0;try{let n,s;do{n=o.randomBytes(21).toString("hex")+"-a",t=a.join(e.tmpdir(),n),s=a.join(e.tmpdir(),n.toUpperCase())}while(e.existsSync(t)||e.existsSync(s));return e.writeFileSync(t,"","utf8"),!e.existsSync(s)}catch(e){return!1}finally{t&&e.unlinkSync(t)}}(t.FileSpec||(t.FileSpec={})).is=function(e){const t=e;return t&&!!t.wildcardRoot&&!!t.regExp},t.forEachAncestorDirectory=function(e,t){for(;;){const n=t(e);if(void 0!==n)return n;const s=m(e);if(s===e)return;e=s}},t.getDirectoryPath=m,t.getRootLength=y,t.getPathComponents=g,t.reducePathComponents=f,t.combinePathComponents=_,t.getRelativePath=function(e,t){if(!e.startsWith(I(t)))return;const n=g(e);let s=".";for(let e=g(t).length;e<n.length;e++)s+=a.sep+n[e];return s},t.makeDirectories=function(e,t,n){if(!t.startsWith(n))return;const s=g(t);let i=n;for(let t=g(n).length;t<s.length;t++)i=v(i,s[t]),e.existsSync(i)||e.mkdirSync(i)},t.getFileSize=function(e,t){try{const n=e.statSync(t);if(n.isFile())return n.size}catch(e){}return 0},t.fileExists=function(e,t){return R(e,t,0)},t.directoryExists=function(e,t){return R(e,t,1)},t.normalizeSlashes=T,t.resolvePaths=function(e,...t){return P(c.some(t)?v(e,...t):T(e))},t.combinePaths=v,t.comparePaths=function(e,t,n,s){return e=P(e),t=P(t),"string"==typeof n?(e=v(n,e),t=v(n,t)):"boolean"==typeof n&&(s=n),N(e,t,d.getStringComparer(s))},t.containsPath=function(e,t,n,s){if("string"==typeof n?(e=v(n,e),t=v(n,t)):"boolean"==typeof n&&(s=n),void 0===e||void 0===t)return!1;if(e===t)return!0;const i=g(e),r=g(t);if(r.length<i.length)return!1;const o=s?d.equateStringsCaseInsensitive:d.equateStringsCaseSensitive;for(let e=0;e<i.length;e++)if(!(0===e?d.equateStringsCaseInsensitive:o)(i[e],r[e]))return!1;return!0},t.changeAnyExtension=function(e,t,n,s){const i=void 0!==n&&void 0!==s?b(e,n,s):b(e);return i?e.slice(0,e.length-i.length)+(t.startsWith(".")?t:"."+t):e},t.getAnyExtensionFromPath=b,t.getBaseFileName=C,t.getRelativePathFromDirectory=function(e,t,n){return _(S(e,t,n))},t.getRelativePathComponentsFromDirectory=S,t.comparePathsCaseSensitive=function(e,t){return N(e,t,d.compareStringsCaseSensitive)},t.comparePathsCaseInsensitive=function(e,t){return N(e,t,d.compareStringsCaseInsensitive)},t.ensureTrailingDirectorySeparator=I,t.hasTrailingDirectorySeparator=D,t.stripTrailingDirectorySeparator=k,t.getFileExtension=x,t.getFileName=F,t.stripFileExtension=function(e,t=!1){const n=x(e,t);return e.substr(0,e.length-n.length)},t.normalizePath=P,t.isDirectory=function(e,t){let n;try{n=e.statSync(t)}catch(e){return!1}return n.isDirectory()},t.isFile=function(e,t){let n;try{n=e.statSync(t)}catch(e){return!1}return n.isFile()},t.getFileSystemEntries=function(e,t){try{const n=e.readdirEntriesSync(t||".").sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0),s=[],i=[];for(const e of n)"."!==e.name&&".."!==e.name&&(e.isFile()?s.push(e.name):e.isDirectory()&&(e.isSymbolicLink()||i.push(e.name)));return{files:s,directories:i}}catch(e){return{files:[],directories:[]}}},t.getWildcardRegexPattern=A,t.getWildcardRoot=w,t.getFileSpec=function(e,t){let n=A(e,t);n=`^(${n})($|${E()})`;const s=new RegExp(n);return{wildcardRoot:w(e,t),regExp:s}},t.getRegexEscapedSeparator=E,t.isRootedDiskPath=function(e){return y(e)>0},t.isDiskPathRoot=function(e){const t=y(e);return t>0&&t===e.length},t.convertUriToPath=function(e){let t=P(l.URI.parse(e).path);return t.match(/^\\[a-zA-Z]:\\/)&&(t=t.substr(1)),t},t.convertPathToUri=function(e){return l.URI.file(e).toString()},t.normalizePathCase=function(e,t){return L(e)?t:t.toLowerCase()},t.isFileSystemCaseSensitive=L,t.isFileSystemCaseSensitiveInternal=M},1464:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertRangeToTextRange=t.convertPositionToOffset=t.convertOffsetsToRange=t.convertOffsetToPosition=void 0;const s=n(5839),i=n(3550);function r(e,t){if(0===t.end)return{line:0,character:0};let n=0;e>=t.end&&(e=t.end-1,n=1);const i=t.getItemContaining(e);s.assert(i>=0&&i<=t.length);const r=t.getItemAt(i);return s.assert(void 0!==r),{line:i,character:e-r.start+n}}function o(e,t){if(!(e.line>=t.count))return t.getItemAt(e.line).start+e.character}t.convertOffsetToPosition=r,t.convertOffsetsToRange=function(e,t,n){return{start:r(e,n),end:r(t,n)}},t.convertPositionToOffset=o,t.convertRangeToTextRange=function(e,t){const n=o(e.start,t);if(void 0===n)return;const s=o(e.end,t);return void 0!==s?i.TextRange.fromBounds(n,s):void 0}},2150:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressReportTracker=void 0,t.ProgressReportTracker=class{constructor(e){this._reporter=e,this._isDisplayingProgress=!1}isEnabled(e){var t,n;return!!this._isDisplayingProgress||null!==(n=null===(t=this._reporter)||void 0===t?void 0:t.isEnabled(e))&&void 0!==n&&n}begin(){var e;this._isDisplayingProgress||(this._isDisplayingProgress=!0,null===(e=this._reporter)||void 0===e||e.begin())}report(e){var t;this._isDisplayingProgress&&(null===(t=this._reporter)||void 0===t||t.report(e))}end(){var e;this._isDisplayingProgress&&(this._isDisplayingProgress=!1,null===(e=this._reporter)||void 0===e||e.end())}}},6886:(e,t)=>{"use strict";var n;function s(e,t){if(isNaN(e)||isNaN(t))return;if(e>255||t>255)return;const s=256*e+t;return void 0!==n[s]&&i(s)?s:void 0}function i(e){return e>>8==3}Object.defineProperty(t,"__esModule",{value:!0}),t.is3x=t.versionFromMajorMinor=t.versionFromString=t.versionToString=t.latestPythonVersion=t.latestStablePythonVersion=t.PythonVersion=void 0,function(e){e[e.V3_0=768]="V3_0",e[e.V3_1=769]="V3_1",e[e.V3_2=770]="V3_2",e[e.V3_3=771]="V3_3",e[e.V3_4=772]="V3_4",e[e.V3_5=773]="V3_5",e[e.V3_6=774]="V3_6",e[e.V3_7=775]="V3_7",e[e.V3_8=776]="V3_8",e[e.V3_9=777]="V3_9",e[e.V3_10=778]="V3_10"}(n=t.PythonVersion||(t.PythonVersion={})),t.latestStablePythonVersion=n.V3_9,t.latestPythonVersion=n.V3_9,t.versionToString=function(e){return`${e>>8&255}.${255&e}`},t.versionFromString=function(e){const t=e.split(".");if(!(t.length<2))return s(parseInt(t[0],10),parseInt(t[1],10))},t.versionFromMajorMinor=s,t.is3x=i},7559:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getCharacterCount=t.equateStringsCaseSensitive=t.equateStringsCaseInsensitive=t.getStringComparer=t.compareStringsCaseSensitive=t.compareStringsCaseInsensitive=t.hashString=t.computeCompletionSimilarity=void 0;const i=s(n(7588)),r=n(2489);function o(e,t){return e===t?0:void 0===e?-1:void 0===t?1:r.compareComparableValues(e.toUpperCase(),t.toUpperCase())}function a(e,t){return r.compareComparableValues(e,t)}t.computeCompletionSimilarity=function(e,t){if(t.startsWith(e))return 1;const n=t.toLocaleLowerCase(),s=e.toLocaleLowerCase();if(n.startsWith(s))return.75;let r=n.length,o=Number.MAX_VALUE;for(;r>0;){const e=i.default(n.substr(0,r),s);e<o&&(o=e),r--}return o>=e.length?0:(e.length-o)/e.length*.5},t.hashString=function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t},t.compareStringsCaseInsensitive=o,t.compareStringsCaseSensitive=a,t.getStringComparer=function(e){return e?o:a},t.equateStringsCaseInsensitive=function(e,t){return 0===o(e,t)},t.equateStringsCaseSensitive=function(e,t){return 0===a(e,t)},t.getCharacterCount=function(e,t){let n=0;for(let s=0;s<e.length;s++)e[s]===t&&n++;return n}},743:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertWorkspaceEdits=t.convertTextEdits=void 0;const s=n(6657);t.convertTextEdits=function(e,t){if(!t)return{};const n=[];return t.forEach(e=>{n.push({range:e.range,newText:e.replacementText})}),{changes:{[e]:n}}},t.convertWorkspaceEdits=function(e){const t={changes:{}};return e.forEach(e=>{const n=s.convertPathToUri(e.filePath);t.changes[n]=t.changes[n]||[],t.changes[n].push({range:e.range,newText:e.replacementText})}),t}},3550:(e,t)=>{"use strict";var n,s;function i(e,t){return e.line<t.line?-1:e.line>t.line?1:e.character<t.character?-1:e.character>t.character?1:0}function r(e){return 0===e.character&&0===e.line}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyRange=t.isEmptyPosition=t.getEmptyRange=t.rangesAreEqual=t.doesRangeContain=t.doRangesIntersect=t.doRangesOverlap=t.getEmptyPosition=t.comparePositions=t.TextRange=void 0,function(e){function t(e,t){if(e<0)throw new Error("start must be non-negative");if(t<0)throw new Error("length must be non-negative");return{start:e,length:t}}function n(e){return e.start+e.length}e.create=t,e.fromBounds=function(e,n){if(e<0)throw new Error("start must be non-negative");if(e>n)throw new Error("end must be greater than or equal to start");return t(e,n-e)},e.getEnd=n,e.contains=function(e,t){return t>=e.start&&t<n(e)},e.extend=function e(t,s){s&&(Array.isArray(s)?s.forEach(n=>{e(t,n)}):(s.start<t.start&&(t.length+=t.start-s.start,t.start=s.start),n(s)>n(t)&&(t.length+=n(s)-n(t))))}}(t.TextRange||(t.TextRange={})),function(e){e.is=function(e){const t=e;return t&&void 0!==t.line&&void 0!==t.character}}(n||(n={})),function(e){e.is=function(e){const t=e;return t&&void 0!==t.start&&void 0!==t.end}}(s||(s={})),t.comparePositions=i,t.getEmptyPosition=function(){return{line:0,character:0}},t.doRangesOverlap=function(e,t){return!(i(t.start,e.end)>=0||i(e.start,t.end)>=0)},t.doRangesIntersect=function(e,t){return!(i(t.start,e.end)>0||i(e.start,t.end)>0)},t.doesRangeContain=function e(t,s){return n.is(s)?i(t.start,s)<=0&&i(t.end,s)>=0:e(t,s.start)&&e(t,s.end)},t.rangesAreEqual=function(e,t){return 0===i(e.start,t.start)&&0===i(e.end,t.end)},t.getEmptyRange=function(){return{start:{line:0,character:0},end:{line:0,character:0}}},t.isEmptyPosition=r,t.isEmptyRange=function(e){return r(e.start)&&r(e.end)}},3420:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextRangeCollection=void 0;const s=n(3550);t.TextRangeCollection=class{constructor(e){this._items=e}get start(){return this._items.length>0?this._items[0].start:0}get end(){const e=this._items[this._items.length-1];return this._items.length>0?e.start+e.length:0}get length(){return this.end-this.start}get count(){return this._items.length}contains(e){return e>=this.start&&e<this.end}getItemAt(e){if(e<0||e>=this._items.length)throw new Error("index is out of range");return this._items[e]}getItemAtPosition(e){if(0===this.count)return-1;if(e<this.start)return-1;if(e>this.end)return-1;let t=0,n=this.count-1;for(;t<n;){const s=Math.floor(t+(n-t)/2),i=this._items[s];if(e>=i.start&&(s>=this.count-1||e<this._items[s+1].start))return s;e<i.start?n=s-1:t=s+1}return t}getItemContaining(e){if(0===this.count)return-1;if(e<this.start)return-1;if(e>this.end)return-1;let t=0,n=this.count-1;for(;t<=n;){const i=Math.floor(t+(n-t)/2),r=this._items[i];if(s.TextRange.contains(r,e))return i;if(i<this.count-1&&s.TextRange.getEnd(r)<=e&&e<this._items[i+1].start)return-1;e<r.start?n=i-1:t=i+1}return-1}}},8718:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timingStats=t.TimingStats=t.TimingStat=t.Duration=void 0;class n{constructor(){this._startTime=Date.now()}getDurationInMilliseconds(){return Date.now()-this._startTime}getDurationInSeconds(){return this.getDurationInMilliseconds()/1e3}}t.Duration=n;class s{constructor(){this.totalTime=0,this.isTiming=!1}timeOperation(e){if(this.isTiming)e();else{this.isTiming=!0;const t=new n;e(),this.totalTime+=t.getDurationInMilliseconds(),this.isTiming=!1}}subtractFromTime(e){if(this.isTiming){this.isTiming=!1;const t=new n;e(),this.totalTime-=t.getDurationInMilliseconds(),this.isTiming=!0}else e()}printTime(){const e=this.totalTime/1e3;return(Math.round(100*e)/100).toString()+"sec"}}t.TimingStat=s;class i{constructor(){this.totalDuration=new n,this.findFilesTime=new s,this.readFileTime=new s,this.tokenizeFileTime=new s,this.parseFileTime=new s,this.resolveImportsTime=new s,this.cycleDetectionTime=new s,this.bindTime=new s,this.typeCheckerTime=new s}printSummary(e){e.info(`Completed in ${this.totalDuration.getDurationInSeconds()}sec`)}printDetails(e){e.info(""),e.info("Timing stats"),e.info("Find Source Files:    "+this.findFilesTime.printTime()),e.info("Read Source Files:    "+this.readFileTime.printTime()),e.info("Tokenize:             "+this.tokenizeFileTime.printTime()),e.info("Parse:                "+this.parseFileTime.printTime()),e.info("Resolve Imports:      "+this.resolveImportsTime.printTime()),e.info("Bind:                 "+this.bindTime.printTime()),e.info("Check:                "+this.typeCheckerTime.printTime()),e.info("Detect Cycles:        "+this.cycleDetectionTime.printTime())}getTotalDuration(){return this.totalDuration.getDurationInSeconds()}}t.TimingStats=i,t.timingStats=new i},8992:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t},o=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,r){function o(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageServerBase=void 0,n(6755);const a=r(n(5747)),l=n(4714),c=n(5674),p=n(2374),u=n(6708),d=n(3213),h=n(9489),m=n(1775),y=n(2930),g=n(2211),f=n(8304),_=n(7830),T=n(6657),v=n(2150),b=n(743),C=n(31),S=n(3334),I=n(2122),D=n(214);t.LanguageServerBase=class{constructor(e){var t,n;this._serverOptions=e,this._connection=l.createConnection(this._GetConnectionOptions()),this._hasConfigurationCapability=!1,this._hasVisualStudioExtensionsCapability=!1,this._hasWorkspaceFoldersCapability=!1,this._hasWatchFileCapability=!1,this._hasActiveParameterCapability=!1,this._hasSignatureLabelOffsetCapability=!1,this._supportsUnnecessaryDiagnosticTag=!1,this._fileWatchers=[],this._lastTriggerKind=l.CompletionTriggerKind.Invoked,this.rootPath="",this.console=new g.ConsoleWithLogLevel(this._connection.console),this.console.info(`${e.productName} language server ${e.version&&e.version+" "}starting`),this.fs=_.createFromRealFileSystem(this.console,this);const s=this.fs.getModulePath();s&&this.fs.chdir(s),global.__rootDirectory=e.rootDirectory,this.console.info("Server root directory: "+e.rootDirectory),this._workspaceMap=new D.WorkspaceMap(this),this.setupConnection(null!==(t=e.supportedCommands)&&void 0!==t?t:[],null!==(n=e.supportedCodeActions)&&void 0!==n?n:[]),this._progressReporter=new v.ProgressReportTracker(this._serverOptions.progressReporterFactory?this._serverOptions.progressReporterFactory(this._connection):void 0),this._connection.listen()}isLongRunningCommand(e){return!0}getConfiguration(e,t){return o(this,void 0,void 0,(function*(){if(this._hasConfigurationCapability){const n={scopeUri:e,section:t};return this._connection.workspace.getConfiguration(n)}if(this._defaultClientConfig)return h.getNestedProperty(this._defaultClientConfig,t)}))}isOpenFilesOnly(e){return"workspace"!==e}getSeverityOverrides(e){const t=e;if(m.getDiagnosticSeverityOverrides().includes(t))return t}getDiagnosticRuleName(e){const t=e;if(y.getDiagLevelDiagnosticRules().includes(t))return t}createImportResolver(e,t){return new p.ImportResolver(e,t)}createBackgroundAnalysisProgram(e,t,n,s,i,r){return new c.BackgroundAnalysisProgram(e,t,n,s,i,r)}setExtension(e){this._serverOptions.extension=e}get window(){return this._connection.window}createAnalyzerService(e){this.console.log(`Starting service instance "${e}"`);const t=new u.AnalyzerService(e,this.fs,this.console,this.createImportResolver.bind(this),void 0,this._serverOptions.extension,this.createBackgroundAnalysis(),this._serverOptions.maxAnalysisTimeInForeground,this.createBackgroundAnalysisProgram.bind(this));return t.setCompletionCallback(e=>this.onAnalysisCompletedHandler(e)),t}getWorkspaceForFile(e){return o(this,void 0,void 0,(function*(){const t=this._workspaceMap.getWorkspaceForFile(e);return yield t.isInitialized.promise,t}))}reanalyze(){this._workspaceMap.forEach(e=>{e.serviceInstance.invalidateAndForceReanalysis()})}restart(){this._workspaceMap.forEach(e=>{e.serviceInstance.restart()})}createFileWatcher(e,t){const n=this,s=[],i=[],r=this._workspaceMap.getNonDefaultWorkspaces();e.forEach(e=>{r.some(t=>T.containsPath(t.rootPath,e))?s.push(e):i.push(e)});const o=i.map(e=>a.watch(e,{recursive:!0},(e,n)=>t(e,n))),l={close(){n._fileWatchers=n._fileWatchers.filter(e=>e!==l),o.forEach(e=>{e.close()})},workspacePaths:s,eventHandler:t};return this._fileWatchers.push(l),l}setupConnection(e,t){this._connection.onInitialize(n=>this.initialize(n,e,t)),this._connection.onDidChangeConfiguration(e=>{this.console.log("Received updated settings"),(null==e?void 0:e.settings)&&(this._defaultClientConfig=null==e?void 0:e.settings),this.updateSettingsForAllWorkspaces()}),this._connection.onCodeAction((e,t)=>this.executeCodeAction(e,t)),this._connection.onDefinition((e,t)=>o(this,void 0,void 0,(function*(){this.recordUserInteractionTime();const n=T.convertUriToPath(e.textDocument.uri),s={line:e.position.line,character:e.position.character},i=yield this.getWorkspaceForFile(n);if(i.disableLanguageServices)return;const r=i.serviceInstance.getDefinitionForPosition(n,s,t);return r?r.map(e=>l.Location.create(T.convertPathToUri(e.path),e.range)):void 0}))),this._connection.onReferences((e,t,n)=>o(this,void 0,void 0,(function*(){this._pendingFindAllRefsCancellationSource&&(this._pendingFindAllRefsCancellationSource.cancel(),this._pendingFindAllRefsCancellationSource=void 0);const s=yield this._getProgressReporter(e.workDoneToken,n,I.Localizer.CodeAction.findingReferences()),i=d.CancelAfter(t,s.token);this._pendingFindAllRefsCancellationSource=i;try{const t=T.convertUriToPath(e.textDocument.uri),n={line:e.position.line,character:e.position.character},r=yield this.getWorkspaceForFile(t);if(r.disableLanguageServices)return;const o=r.serviceInstance.getReferencesForPosition(t,n,e.context.includeDeclaration,i.token);if(!o)return;return o.map(e=>l.Location.create(T.convertPathToUri(e.path),e.range))}finally{s.reporter.done(),i.dispose()}}))),this._connection.onDocumentSymbol((e,t)=>o(this,void 0,void 0,(function*(){this.recordUserInteractionTime();const n=T.convertUriToPath(e.textDocument.uri),s=yield this.getWorkspaceForFile(n);if(s.disableLanguageServices)return;const i=[];return s.serviceInstance.addSymbolsForDocument(n,i,t),i}))),this._connection.onWorkspaceSymbol((e,t)=>o(this,void 0,void 0,(function*(){const n=[];for(const s of this._workspaceMap.values())yield s.isInitialized.promise,s.disableLanguageServices||s.serviceInstance.addSymbolsForWorkspace(n,e.query,t);return n}))),this._connection.onHover((e,t)=>o(this,void 0,void 0,(function*(){const n=T.convertUriToPath(e.textDocument.uri),s={line:e.position.line,character:e.position.character},i=(yield this.getWorkspaceForFile(n)).serviceInstance.getHoverForPosition(n,s,t);return S.convertHoverResults(i)}))),this._connection.onDocumentHighlight((e,t)=>o(this,void 0,void 0,(function*(){const n=T.convertUriToPath(e.textDocument.uri),s={line:e.position.line,character:e.position.character};return(yield this.getWorkspaceForFile(n)).serviceInstance.getDocumentHighlight(n,s,t)}))),this._connection.onSignatureHelp((e,t)=>o(this,void 0,void 0,(function*(){var n,s,i,r;const o=T.convertUriToPath(e.textDocument.uri),a={line:e.position.line,character:e.position.character},c=yield this.getWorkspaceForFile(o);if(c.disableLanguageServices)return;const p=c.serviceInstance.getSignatureHelpForPosition(o,a,t);if(!p)return;const u=p.signatures.map(e=>{let t=[];e.parameters&&(t=e.parameters.map(e=>l.ParameterInformation.create(this._hasSignatureLabelOffsetCapability?[e.startOffset,e.endOffset]:e.text,e.documentation)));const n=l.SignatureInformation.create(e.label,e.documentation,...t);return n.activeParameter=e.activeParameter,n}),d=e=>{var t;return void 0!==e.activeParameter||!p.callHasParameters&&!(null===(t=e.parameters)||void 0===t?void 0:t.length)};let h=u.findIndex(d);-1===h&&(h=null);let m=null!==h?u[h].activeParameter:null;if((null===(n=e.context)||void 0===n?void 0:n.isRetrigger)&&e.context.triggerKind!==l.SignatureHelpTriggerKind.Invoked){const t=null!==(i=null===(s=e.context.activeSignatureHelp)||void 0===s?void 0:s.activeSignature)&&void 0!==i?i:null;if(null!==t&&t<u.length){const e=u[t];d(e)&&(h=t,m=null!==(r=e.activeParameter)&&void 0!==r?r:null)}}return(this._hasActiveParameterCapability||null===h)&&(m=-1),{signatures:u,activeSignature:h,activeParameter:m}}))),this._connection.onCompletion((e,t)=>this.onCompletion(e,t)),this._connection.onCompletionResolve((e,t)=>o(this,void 0,void 0,(function*(){const n=e.data;return n&&n.filePath&&(yield this.getWorkspaceForFile(n.workspacePath)).serviceInstance.resolveCompletionItem(n.filePath,e,t),e}))),this._connection.onRenameRequest((e,t)=>o(this,void 0,void 0,(function*(){const n=T.convertUriToPath(e.textDocument.uri),s={line:e.position.line,character:e.position.character},i=yield this.getWorkspaceForFile(n);if(i.disableLanguageServices)return;const r=i.serviceInstance.renameSymbolAtPosition(n,s,e.newName,t);return r?b.convertWorkspaceEdits(r):void 0}))),this._connection.languages.callHierarchy.onPrepare((e,t)=>o(this,void 0,void 0,(function*(){const n=T.convertUriToPath(e.textDocument.uri),s={line:e.position.line,character:e.position.character},i=yield this.getWorkspaceForFile(n);if(i.disableLanguageServices)return null;const r=i.serviceInstance.getCallForPosition(n,s,t)||null;return r?(r.uri=T.convertPathToUri(r.uri),[r]):null}))),this._connection.languages.callHierarchy.onIncomingCalls((e,t)=>o(this,void 0,void 0,(function*(){const n=T.convertUriToPath(e.item.uri),s={line:e.item.range.start.line,character:e.item.range.start.character},i=yield this.getWorkspaceForFile(n);if(i.disableLanguageServices)return null;const r=i.serviceInstance.getIncomingCallsForPosition(n,s,t)||null;return r&&0!==r.length?(r.forEach(e=>{e.from.uri=T.convertPathToUri(e.from.uri)}),r):null}))),this._connection.languages.callHierarchy.onOutgoingCalls((e,t)=>o(this,void 0,void 0,(function*(){const n=T.convertUriToPath(e.item.uri),s={line:e.item.range.start.line,character:e.item.range.start.character},i=yield this.getWorkspaceForFile(n);if(i.disableLanguageServices)return null;const r=i.serviceInstance.getOutgoingCallsForPosition(n,s,t)||null;return r&&0!==r.length?(r.forEach(e=>{e.to.uri=T.convertPathToUri(e.to.uri)}),r):null}))),this._connection.onDidOpenTextDocument(e=>o(this,void 0,void 0,(function*(){const t=T.convertUriToPath(e.textDocument.uri);(yield this.getWorkspaceForFile(t)).serviceInstance.setFileOpened(t,e.textDocument.version,e.textDocument.text)}))),this._connection.onDidChangeTextDocument(e=>o(this,void 0,void 0,(function*(){this.recordUserInteractionTime();const t=T.convertUriToPath(e.textDocument.uri);(yield this.getWorkspaceForFile(t)).serviceInstance.updateOpenFileContents(t,e.textDocument.version,e.contentChanges[0].text)}))),this._connection.onDidCloseTextDocument(e=>o(this,void 0,void 0,(function*(){const t=T.convertUriToPath(e.textDocument.uri);(yield this.getWorkspaceForFile(t)).serviceInstance.setFileClosed(t)}))),this._connection.onDidChangeWatchedFiles(e=>{e.changes.forEach(e=>{const t=T.convertUriToPath(e.uri),n=1===e.type?"add":"change";this._fileWatchers.forEach(e=>{e.workspacePaths.some(e=>T.containsPath(e,t))&&e.eventHandler(n,t)})})}),this._connection.onInitialized(()=>{this._hasWorkspaceFoldersCapability&&this._connection.workspace.onDidChangeWorkspaceFolders(e=>{e.removed.forEach(e=>{const t=T.convertUriToPath(e.uri);this._workspaceMap.delete(t)}),e.added.forEach(e=>o(this,void 0,void 0,(function*(){const t=T.convertUriToPath(e.uri),n=this.createWorkspaceServiceInstance(e,t);this._workspaceMap.set(t,n),yield this.updateSettingsForWorkspace(n)})))}),this._hasWatchFileCapability&&this._connection.client.register(l.DidChangeWatchedFilesNotification.type,{watchers:[...u.configFileNames.map(e=>({globPattern:"**/"+e,kind:l.WatchKind.Create|l.WatchKind.Change|l.WatchKind.Delete})),{globPattern:"**/*.{py,pyi}",kind:l.WatchKind.Create|l.WatchKind.Change|l.WatchKind.Delete}]})}),this._connection.onExecuteCommand((e,t,n)=>o(this,void 0,void 0,(function*(){this._pendingCommandCancellationSource&&(this._pendingCommandCancellationSource.cancel(),this._pendingCommandCancellationSource=void 0);const s=t=>o(this,void 0,void 0,(function*(){const n=yield this.executeCommand(e,t);l.WorkspaceEdit.is(n)&&this._connection.workspace.applyEdit(n)}));if(this.isLongRunningCommand(e.command)){const i=yield this._getProgressReporter(e.workDoneToken,n,I.Localizer.CodeAction.executingCommand()),r=d.CancelAfter(t,i.token);this._pendingCommandCancellationSource=r;try{yield s(r.token)}finally{i.reporter.done(),r.dispose()}}else s(t)})))}getWorkspaceCompletionsForPosition(e,t,n,s,i){return e.serviceInstance.getCompletionsForPosition(t,n,s,i)}updateSettingsForAllWorkspaces(){this._workspaceMap.forEach(e=>{this.updateSettingsForWorkspace(e).ignoreErrors()})}initialize(e,t,n){var s,i,r,o,a,c,p,u,d,h,m,y,g,f;this.rootPath=e.rootPath||"";const _=e.capabilities;this._hasConfigurationCapability=!!(null===(s=_.workspace)||void 0===s?void 0:s.configuration),this._hasWatchFileCapability=!!(null===(r=null===(i=_.workspace)||void 0===i?void 0:i.didChangeWatchedFiles)||void 0===r?void 0:r.dynamicRegistration),this._hasWorkspaceFoldersCapability=!!(null===(o=_.workspace)||void 0===o?void 0:o.workspaceFolders),this._hasVisualStudioExtensionsCapability=!!_.supportsVisualStudioExtensions,this._hasActiveParameterCapability=!!(null===(p=null===(c=null===(a=_.textDocument)||void 0===a?void 0:a.signatureHelp)||void 0===c?void 0:c.signatureInformation)||void 0===p?void 0:p.activeParameterSupport),this._hasSignatureLabelOffsetCapability=!!(null===(m=null===(h=null===(d=null===(u=_.textDocument)||void 0===u?void 0:u.signatureHelp)||void 0===d?void 0:d.signatureInformation)||void 0===h?void 0:h.parameterInformation)||void 0===m?void 0:m.labelOffsetSupport);const v=(null===(f=null===(g=null===(y=_.textDocument)||void 0===y?void 0:y.publishDiagnostics)||void 0===g?void 0:g.tagSupport)||void 0===f?void 0:f.valueSet)||[];return this._supportsUnnecessaryDiagnosticTag=v.some(e=>e===l.DiagnosticTag.Unnecessary),e.workspaceFolders?e.workspaceFolders.forEach(e=>{const t=T.convertUriToPath(e.uri);this._workspaceMap.set(t,this.createWorkspaceServiceInstance(e,t))}):e.rootPath&&this._workspaceMap.set(e.rootPath,this.createWorkspaceServiceInstance(void 0,e.rootPath)),{capabilities:{textDocumentSync:l.TextDocumentSyncKind.Full,definitionProvider:{workDoneProgress:!0},referencesProvider:{workDoneProgress:!0},documentSymbolProvider:{workDoneProgress:!0},workspaceSymbolProvider:{workDoneProgress:!0},hoverProvider:{workDoneProgress:!0},documentHighlightProvider:{workDoneProgress:!0},renameProvider:{workDoneProgress:!0},completionProvider:{triggerCharacters:[".","["],resolveProvider:!0,workDoneProgress:!0},signatureHelpProvider:{triggerCharacters:["(",",",")"],workDoneProgress:!0},codeActionProvider:{codeActionKinds:n,workDoneProgress:!0},executeCommandProvider:{commands:t,workDoneProgress:!0},callHierarchyProvider:!0}}}createWorkspaceServiceInstance(e,t){var n,s,i;return{workspaceName:null!==(n=null==e?void 0:e.name)&&void 0!==n?n:"",rootPath:t,rootUri:null!==(s=null==e?void 0:e.uri)&&void 0!==s?s:"",serviceInstance:this.createAnalyzerService(null!==(i=null==e?void 0:e.name)&&void 0!==i?i:t),disableLanguageServices:!1,disableOrganizeImports:!1,isInitialized:f.createDeferred()}}onAnalysisCompletedHandler(e){if(e.diagnostics.forEach(e=>{this._connection.sendDiagnostics({uri:T.convertPathToUri(e.filePath),diagnostics:this._convertDiagnostics(e.diagnostics)})}),this._progressReporter.isEnabled(e))if(e.filesRequiringAnalysis>0){this._progressReporter.begin();const t=1===e.filesRequiringAnalysis?I.Localizer.CodeAction.filesToAnalyzeOne():I.Localizer.CodeAction.filesToAnalyzeCount().format({count:e.filesRequiringAnalysis});this._progressReporter.report(t)}else this._progressReporter.end();else this._progressReporter.end()}updateSettingsForWorkspace(e,t){var n;return o(this,void 0,void 0,(function*(){t=null!=t?t:yield this.getSettings(e),this.console.level=null!==(n=t.logLevel)&&void 0!==n?n:g.LogLevel.Info,this.updateOptionsAndRestartService(e,t),e.disableLanguageServices=!!t.disableLanguageServices,e.disableOrganizeImports=!!t.disableOrganizeImports,e.isInitialized.resolve(!0)}))}updateOptionsAndRestartService(e,t,n){C.AnalyzerServiceExecutor.runWithOptions(this.rootPath,e,t,n)}onCompletion(e,t){var n,s;return o(this,void 0,void 0,(function*(){const i=this._lastTriggerKind!==l.CompletionTriggerKind.TriggerForIncompleteCompletions||(null===(n=e.context)||void 0===n?void 0:n.triggerKind)!==l.CompletionTriggerKind.TriggerForIncompleteCompletions;this._lastTriggerKind=null===(s=e.context)||void 0===s?void 0:s.triggerKind;const r=T.convertUriToPath(e.textDocument.uri),o={line:e.position.line,character:e.position.character},a=yield this.getWorkspaceForFile(r);if(a.disableLanguageServices)return;const c=yield this.getWorkspaceCompletionsForPosition(a,r,o,a.rootPath,t);return c&&c.completionList&&(c.completionList.isIncomplete=i),null==c?void 0:c.completionList}))}convertLogLevel(e){if(!e)return g.LogLevel.Info;switch(e.toLowerCase()){case"error":return g.LogLevel.Error;case"warning":return g.LogLevel.Warn;case"information":return g.LogLevel.Info;case"trace":return g.LogLevel.Log;default:return g.LogLevel.Info}}_getProgressReporter(e,t,n){return o(this,void 0,void 0,(function*(){if(e)return{reporter:t,token:l.CancellationToken.None};const s=yield this._connection.window.createWorkDoneProgress();return s.begin(n,void 0,void 0,!0),{reporter:s,token:s.token}}))}_GetConnectionOptions(){return{cancellationStrategy:d.getCancellationStrategyFromArgv(process.argv)}}_convertDiagnostics(e){const t=[];return e.forEach(e=>{const n=function(e){switch(e){case 0:return l.DiagnosticSeverity.Error;case 1:return l.DiagnosticSeverity.Warning;case 2:return l.DiagnosticSeverity.Information;case 3:return l.DiagnosticSeverity.Hint}}(e.category);let s=this._serverOptions.productName;const i=e.getRule();i&&(s=`${s} (${i})`);const r=l.Diagnostic.create(e.range,e.message,n,void 0,s);if(3===e.category&&(r.tags=[l.DiagnosticTag.Unnecessary],r.severity=l.DiagnosticSeverity.Hint,!this._supportsUnnecessaryDiagnosticTag))return;const o=e.getRelatedInfo();o.length>0&&(r.relatedInformation=o.map(e=>l.DiagnosticRelatedInformation.create(l.Location.create(T.convertPathToUri(e.filePath),e.range),e.message))),t.push(r)}),t}recordUserInteractionTime(){this._workspaceMap.forEach(e=>{e.serviceInstance.recordUserInteractionTime()})}}},31:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyzerServiceExecutor=void 0;const s=n(1887),i=n(1775),r=n(6657);function o(e,t){return t.replace(/\$\{(.*?)\}/g,(t,n)=>"workspaceFolder"===n.trim()?e:t)}t.AnalyzerServiceExecutor=class{static runWithOptions(e,t,n,a,l=!0){const c=function(e,t,n,a,l){const c=new i.CommandLineOptions(t,!0);return c.checkOnlyOpenFiles=n.openFilesOnly,c.useLibraryCodeForTypes=n.useLibraryCodeForTypes,c.typeCheckingMode=n.typeCheckingMode,c.autoImportCompletions=n.autoImportCompletions,c.indexing=n.indexing,a?(c.watchForSourceChanges=n.watchForSourceChanges,c.watchForLibraryChanges=n.watchForLibraryChanges):(c.watchForSourceChanges=!1,c.watchForLibraryChanges=!1),n.venvPath&&(c.venvPath=r.combinePaths(t||e,r.normalizePath(o(e,n.venvPath)))),n.pythonPath&&(s.isPythonBinary(n.pythonPath)||(c.pythonPath=r.combinePaths(t||e,r.normalizePath(o(e,n.pythonPath))))),n.typeshedPath&&(c.typeshedPath=r.normalizePath(o(e,n.typeshedPath))),n.stubPath&&(c.stubPath=r.normalizePath(o(e,n.stubPath))),l&&(c.typeStubTargetImportName=l),c.autoSearchPaths=n.autoSearchPaths,c.extraPaths=n.extraPaths,c.diagnosticSeverityOverrides=n.diagnosticSeverityOverrides,c}(e,t.rootPath,n,l,a);t.serviceInstance.setOptions(c,l)}}},8566:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.AutoImporter=t.buildModuleSymbolsMap=void 0;const o=n(4494),a=r(n(563)),l=n(7012),c=r(n(1766)),p=n(3213),u=n(6657),d=r(n(7559)),h=n(2816);function m(e){return{forEach(t){e.symbols.forEach(e=>{e.externallyVisible&&t({importAlias:e.alias,kind:y(e.kind)},e.name)})}}}function y(e){switch(e){case o.SymbolKind.File:return o.CompletionItemKind.File;case o.SymbolKind.Module:case o.SymbolKind.Namespace:return o.CompletionItemKind.Module;case o.SymbolKind.Package:return o.CompletionItemKind.Folder;case o.SymbolKind.Class:return o.CompletionItemKind.Class;case o.SymbolKind.Method:return o.CompletionItemKind.Method;case o.SymbolKind.Property:return o.CompletionItemKind.Property;case o.SymbolKind.Field:return o.CompletionItemKind.Field;case o.SymbolKind.Constructor:return o.CompletionItemKind.Constructor;case o.SymbolKind.Enum:return o.CompletionItemKind.Enum;case o.SymbolKind.Interface:return o.CompletionItemKind.Interface;case o.SymbolKind.Function:return o.CompletionItemKind.Function;case o.SymbolKind.Variable:case o.SymbolKind.Array:return o.CompletionItemKind.Variable;case o.SymbolKind.String:return o.CompletionItemKind.Text;case o.SymbolKind.Number:case o.SymbolKind.Boolean:return o.CompletionItemKind.Value;case o.SymbolKind.Constant:case o.SymbolKind.Null:return o.CompletionItemKind.Constant;case o.SymbolKind.Object:case o.SymbolKind.Key:return o.CompletionItemKind.Value;case o.SymbolKind.EnumMember:return o.CompletionItemKind.EnumMember;case o.SymbolKind.Struct:return o.CompletionItemKind.Struct;case o.SymbolKind.Event:return o.CompletionItemKind.Event;case o.SymbolKind.Operator:return o.CompletionItemKind.Operator;case o.SymbolKind.TypeParameter:return o.CompletionItemKind.TypeParameter;default:return}}t.buildModuleSymbolsMap=function(e,t){const n=new Map;return e.forEach(e=>{if(p.throwIfCancellationRequested(t),e.shadows.length>0)return;const s=e.sourceFile.getFilePath(),i=e.sourceFile.getModuleSymbolTable();if(i){const t=u.stripFileExtension(u.getFileName(s));if(c.isPrivateOrProtectedName(t))return;const r=a.getFileInfo(e.sourceFile.getParseResults().parseTree);return void n.set(s,{forEach(e){i.forEach((t,n)=>{if(t.isExternallyHidden())return;const s=t.getDeclarations();if(!s||0===s.length)return;const i=s[0];if(!i)return;let a;if(6===i.type){if(!h.includeAliasDeclarationInIndex(i))return;a=h.getIndexAliasData(null==r?void 0:r.importLookup,i)}const l=1!==i.type||i.isConstant||i.isFinal?void 0:o.CompletionItemKind.Variable;e({importAlias:a,symbol:t,kind:l},n)})}})}const r=e.sourceFile.getCachedIndexResults();!r||r.privateOrProtected||n.set(s,m(r))}),n},t.AutoImporter=class{constructor(e,t,n,s,i,r,o){this._configOptions=e,this._importResolver=t,this._parseResults=n,this._invocationPosition=s,this._excludes=i,this._moduleSymbolMap=r,this._libraryMap=o,this._filePath=a.getFileInfo(this._parseResults.parseTree).filePath,this._importStatements=l.getTopLevelImports(this._parseResults.parseTree)}getAutoImportCandidates(e,t,n,s){const i=[],r=new Map;return this._addImportsFromModuleMap(e,t,n,r,i,s),this._addImportsFromLibraryMap(e,t,n,r,i,s),this._addImportsFromImportAliasMap(r,n,i,s),i}_addImportsFromLibraryMap(e,t,n,s,i,r){var o;null===(o=this._libraryMap)||void 0===o||o.forEach((o,a)=>{if(o.privateOrProtected)return;if(this._moduleSymbolMap.has(a))return;const l=this._isStubFileOrHasInit(this._libraryMap,a);this._processModuleSymbolTable(m(o),a,e,t,l,n,s,i,r)})}_addImportsFromModuleMap(e,t,n,s,i,r){this._moduleSymbolMap.forEach((o,a)=>{const l=this._isStubFileOrHasInit(this._moduleSymbolMap,a);this._processModuleSymbolTable(o,a,e,t,l,n,s,i,r)})}_isStubFileOrHasInit(e,t){const n=u.getDirectoryPath(t),s=u.combinePaths(n,"__init__.py"),i=s+"i";return{isStub:t.endsWith(".pyi"),hasInit:e.has(s)||e.has(i)}}_processModuleSymbolTable(e,t,n,s,i,r,a,l,c){p.throwIfCancellationRequested(c);const[u,h,m]=this._getImportPartsForSymbols(t);if(!u)return;const y=d.getCharacterCount(u,".");if(e.forEach((e,d)=>{if(p.throwIfCancellationRequested(c),!i.isStub&&e.kind===o.CompletionItemKind.Variable&&/[a-z]/.test(d))return;if(!this._isSimilar(n,d,s))return;if(this._containsName(d,void 0,l))return;if(e.importAlias)return void this._addToImportAliasMap(e.importAlias,{importParts:{symbolName:d,importName:d,importFrom:u,filePath:t,dotCount:y,moduleNameAndType:m},importGroup:h,symbol:e.symbol},a);const g=this._getTextEditsForAutoImportByFilePath(d,t,u,h,r);l.push({name:d,symbol:e.symbol,source:u,edits:g,alias:r,kind:e.kind})}),!i.isStub&&!i.hasInit)return;const g=this._getImportParts(t);g&&this._isSimilar(n,g.importName,s)&&(this._containsName(g.importName,g.importFrom,l)||this._addToImportAliasMap({modulePath:t,originalName:g.importName},{importParts:g,importGroup:h},a))}_addImportsFromImportAliasMap(e,t,n,s){p.throwIfCancellationRequested(s),e.forEach((e,i)=>{e.forEach((e,i)=>{var r;p.throwIfCancellationRequested(s);const o=this._getTextEditsForAutoImportByFilePath(e.importParts.symbolName,e.importParts.filePath,null!==(r=e.importParts.importFrom)&&void 0!==r?r:e.importParts.importName,e.importGroup,t);n.push({name:e.importParts.importName,alias:t,symbol:e.symbol,source:e.importParts.importFrom,edits:o})})})}_addToImportAliasMap(e,t,n){if(!n.has(e.modulePath)){const s=new Map;return s.set(e.originalName,t),void n.set(e.modulePath,s)}const s=n.get(e.modulePath);if(!s.has(e.originalName))return void s.set(e.originalName,t);const i=s.get(e.originalName);this._compareImportAliasData(i,t)<=0||s.set(e.originalName,t)}_compareImportAliasData(e,t){const n=e.importGroup-t.importGroup;if(0!==n)return n;const s=e.importParts.dotCount-t.importParts.dotCount;return 0!==s?s:e.symbol&&!t.symbol?-1:!e.symbol&&t.symbol?1:d.getStringComparer()(e.importParts.importName,t.importParts.importName)}_getImportPartsForSymbols(e){const t=this._importStatements.mapByFilePath.get(e);if(t)return[t.moduleName,l.getImportGroup(t),{importType:2,isLocalTypingsFile:!1,moduleName:t.moduleName}];{const t=this._getModuleNameAndTypeFromFilePath(e);return[t.moduleName,this._getImportGroupFromModuleNameAndType(t),t]}}_getImportParts(e){return function(t){const n=t.moduleName;if(!n)return;const s=n.lastIndexOf("."),i=s>0?n.substring(s+1):void 0,r=s>0?n.substring(0,s):void 0;return{symbolName:i,importName:null!=i?i:n,importFrom:r,filePath:e,dotCount:d.getCharacterCount(n,"."),moduleNameAndType:t}}("__init__"===u.stripFileExtension(u.getFileName(e))?this._getModuleNameAndTypeFromFilePath(u.getDirectoryPath(e)):this._getModuleNameAndTypeFromFilePath(e))}_isSimilar(e,t,n){return 1===n?e===t:e.length>2?d.computeCompletionSimilarity(e,t)>n:e.length>0&&t.startsWith(e)}_containsName(e,t,n){return!!this._excludes.find(t=>t===e)||!!n.find(n=>n.name===e&&n.source===t)}_getModuleNameAndTypeFromFilePath(e){const t=this._configOptions.findExecEnvironment(this._filePath);return this._importResolver.getModuleNameForImport(e,t)}_getImportGroupFromModuleNameAndType(e){let t=2;return e.isLocalTypingsFile||1===e.importType?t=1:0===e.importType&&(t=0),t}_getTextEditsForAutoImportByFilePath(e,t,n,s,i){if(e){const n=this._importStatements.mapByFilePath.get(t);if(n&&22===n.node.nodeType)return l.getTextEditsForAutoImportSymbolAddition(e,n,this._parseResults,i)}return l.getTextEditsForAutoImportInsertion(e,this._importStatements,n,s,this._parseResults,this._invocationPosition,i)}}},7087:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyProvider=void 0;const o=n(4494),a=r(n(5523)),l=r(n(8494)),c=n(427),p=n(1133),u=n(5168),d=n(5168),h=n(3213),m=n(6657),y=n(1464),g=n(3550);t.CallHierarchyProvider=class{static getCallForDeclaration(e,t,n,s){if(h.throwIfCancellationRequested(s),3===t.type||4===t.type)return{name:e,kind:T(t,n),uri:t.path,range:t.range,selectionRange:t.range}}static getIncomingCallsForDeclaration(e,t,n,s,i,r){h.throwIfCancellationRequested(r);const o=new _(e,t,n,s,i,r).findCalls();return o.length>0?o:void 0}static getOutgoingCallsForDeclaration(e,t,n,s){let i;if(h.throwIfCancellationRequested(s),3===e.type)i=e.node;else if(4===e.type){const t=n.getTypeForDeclaration(e);if(t&&p.isClass(t)){const e=d.lookUpClassMember(t,"__init__",14);if(e){const t=n.getTypeOfMember(e);if(t&&5===t.category){const t=e.symbol.getDeclarations();if(t&&t.length>0){const e=t[0];3===e.type&&(i=e.node)}}}}}if(!i)return;const r=new f(i,t,n,s).findCalls();return r.length>0?r:void 0}static getTargetDeclaration(e,t){let n=e[0];for(const s of e)if((a.hasTypeForDeclaration(s)||!a.hasTypeForDeclaration(n))&&(3===s.type||4===s.type)&&(n=s,s.node===t))break;return n}};class f extends c.ParseTreeWalker{constructor(e,t,n,s){super(),this._parseRoot=e,this._parseResults=t,this._evaluator=n,this._cancellationToken=s,this._outgoingCalls=[]}findCalls(){return this.walk(this._parseRoot),this._outgoingCalls}visitCall(e){let t;if(h.throwIfCancellationRequested(this._cancellationToken),39===e.leftExpression.nodeType?t=e.leftExpression:36===e.leftExpression.nodeType&&(t=e.leftExpression.memberName),t){const e=this._evaluator.getDeclarationsForNameNode(t);e&&e.forEach(e=>{this._addOutgoingCallForDeclaration(t,e)})}return!0}visitMemberAccess(e){h.throwIfCancellationRequested(this._cancellationToken);const t=this._evaluator.getType(e.leftExpression);return t&&d.doForSubtypes(t,t=>{let n=t;if(p.isTypeVar(n)&&(n=u.specializeType(n,void 0,!0)),!p.isObject(n))return;const s=d.lookUpObjectMember(n,e.memberName.value);if(!s)return;const i=this._evaluator.getTypeOfMember(s),r=s.symbol.getDeclarations();i&&p.isObject(i)&&p.ClassType.isPropertyClass(i.classType)&&r.forEach(t=>{this._addOutgoingCallForDeclaration(e.memberName,t)})}),!0}_addOutgoingCallForDeclaration(e,t){const n=this._evaluator.resolveAliasDeclaration(t,!0);if(!n)return;if(3!==n.type&&4!==n.type)return;const s={name:e.value,kind:T(n,this._evaluator),uri:n.path,range:n.range,selectionRange:n.range};let i=this._outgoingCalls.find(e=>e.to.uri===s.uri&&g.rangesAreEqual(e.to.range,s.range));i||(i={to:s,fromRanges:[]},this._outgoingCalls.push(i));const r=y.convertOffsetsToRange(e.start,e.start+e.length,this._parseResults.tokenizerOutput.lines);i.fromRanges.push(r)}}class _ extends c.ParseTreeWalker{constructor(e,t,n,s,i,r){super(),this._filePath=e,this._symbolName=t,this._declaration=n,this._parseResults=s,this._evaluator=i,this._cancellationToken=r,this._incomingCalls=[]}findCalls(){return this.walk(this._parseResults.parseTree),this._incomingCalls}visitCall(e){let t;if(h.throwIfCancellationRequested(this._cancellationToken),39===e.leftExpression.nodeType?t=e.leftExpression:36===e.leftExpression.nodeType&&(t=e.leftExpression.memberName),t&&t.value===this._symbolName){const e=this._evaluator.getDeclarationsForNameNode(t);e&&e.map(e=>this._evaluator.resolveAliasDeclaration(e,!0)).filter(e=>void 0!==e).some(e=>a.areDeclarationsSame(e,this._declaration))&&this._addIncomingCallForDeclaration(t)}return!0}visitMemberAccess(e){if(h.throwIfCancellationRequested(this._cancellationToken),e.memberName.value===this._symbolName){const t=this._evaluator.getType(e.leftExpression);t&&d.doForSubtypes(t,t=>{let n=t;if(p.isTypeVar(n)&&(n=u.specializeType(n,void 0,!0)),!p.isObject(n))return;const s=d.lookUpObjectMember(n,e.memberName.value);if(!s)return;const i=this._evaluator.getTypeOfMember(s),r=s.symbol.getDeclarations();i&&r.some(e=>a.areDeclarationsSame(e,this._declaration))&&this._addIncomingCallForDeclaration(e.memberName)})}return!0}_addIncomingCallForDeclaration(e){const t=l.getExecutionScopeNode(e);if(!t)return;let n;if(37===t.nodeType){const e=y.convertOffsetsToRange(0,0,this._parseResults.tokenizerOutput.lines),t=m.getFileName(this._filePath);n={name:"(module) "+t,kind:o.SymbolKind.Module,uri:this._filePath,range:e,selectionRange:e}}else if(31===t.nodeType){const e=y.convertOffsetsToRange(t.start,t.start+t.length,this._parseResults.tokenizerOutput.lines);n={name:"(lambda)",kind:o.SymbolKind.Function,uri:this._filePath,range:e,selectionRange:e}}else{const e=y.convertOffsetsToRange(t.name.start,t.name.start+t.name.length,this._parseResults.tokenizerOutput.lines);n={name:t.name.value,kind:o.SymbolKind.Function,uri:this._filePath,range:e,selectionRange:e}}let s=this._incomingCalls.find(e=>e.from.uri===n.uri&&g.rangesAreEqual(e.from.range,n.range));s||(s={from:n,fromRanges:[]},this._incomingCalls.push(s));const i=y.convertOffsetsToRange(e.start,e.start+e.length,this._parseResults.tokenizerOutput.lines);s.fromRanges.push(i)}}function T(e,t){let n;switch(e.type){case 4:case 5:n=o.SymbolKind.Class;break;case 3:if(e.isMethod){const s=t.getTypeForDeclaration(e);n=s&&d.isProperty(s)?o.SymbolKind.Property:o.SymbolKind.Method}else n=o.SymbolKind.Function;break;default:n=o.SymbolKind.Function}return n}},8590:function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,r){function o(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CodeActionProvider=void 0;const i=n(4494),r=n(3213),o=n(2122);t.CodeActionProvider=class{static getCodeActionsForPosition(e,t,n,a){return s(this,void 0,void 0,(function*(){r.throwIfCancellationRequested(a);const s=[];if(!e.disableLanguageServices){const r=yield e.serviceInstance.getDiagnosticsForRange(t,n,a),l=r.find(e=>{const t=e.getActions();return t&&t.find(e=>"pyright.createtypestub"===e.action)});if(l){const n=l.getActions().find(e=>"pyright.createtypestub"===e.action);if(n){const r=i.CodeAction.create(o.Localizer.CodeAction.createTypeStubFor().format({moduleName:n.moduleName}),i.Command.create(o.Localizer.CodeAction.createTypeStub(),"pyright.createtypestub",e.rootPath,n.moduleName,t),i.CodeActionKind.QuickFix);s.push(r)}}const c=r.find(e=>{const t=e.getActions();return t&&t.find(e=>"pyright.addoptionalforparam"===e.action)});if(c){const e=c.getActions().find(e=>"pyright.addoptionalforparam"===e.action);if(e){const t=i.CodeAction.create(o.Localizer.CodeAction.addOptionalToAnnotation(),i.Command.create(o.Localizer.CodeAction.addOptionalToAnnotation(),"pyright.addoptionalforparam",e.offsetOfTypeNode),i.CodeActionKind.QuickFix);s.push(t)}}}return s}))}}},9209:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CompletionProvider=void 0;const o=n(4494),a=r(n(563)),l=n(8434),c=r(n(8494)),p=r(n(1766)),u=n(2917),d=n(3371),h=n(1133),m=n(5168),y=n(3213),g=n(1464),f=r(n(7559)),_=n(3550),T=n(3550),v=n(5275),b=n(8566),C=["True","False","None","and","or","await","not","is","lambda","yield","assert","async","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","nonlocal","pass","raise","return","try","while","yield"];var S;!function(e){e[e.LikelyKeyword=0]="LikelyKeyword",e[e.RecentImportModuleName=1]="RecentImportModuleName",e[e.ImportModuleName=2]="ImportModuleName",e[e.LiteralValue=3]="LiteralValue",e[e.NamedParameter=4]="NamedParameter",e[e.RecentKeywordOrSymbol=5]="RecentKeywordOrSymbol",e[e.RecentAutoImport=6]="RecentAutoImport",e[e.Keyword=7]="Keyword",e[e.NormalSymbol=8]="NormalSymbol",e[e.PrivateSymbol=9]="PrivateSymbol",e[e.DunderSymbol=10]="DunderSymbol",e[e.AutoImport=11]="AutoImport"}(S||(S={}));const I=.25;class D{constructor(e,t,n,s,i,r,o,a,l,c,p,u,d){this._workspacePath=e,this._parseResults=t,this._fileContents=n,this._importResolver=s,this._position=i,this._filePath=r,this._configOptions=o,this._importLookup=a,this._evaluator=l,this._sourceMapper=c,this._libraryMap=p,this._moduleSymbolsCallback=u,this._cancellationToken=d}getCompletionsForPosition(){const e=g.convertPositionToOffset(this._position,this._parseResults.tokenizerOutput.lines);if(void 0===e)return;let t=c.findNodeByOffset(this._parseResults.parseTree,e);const n=t,s=t?c.getNodeDepth(t):0;if(!n||39!==n.nodeType){let i=e;for(;i>=0;){i--;const e=this._fileContents.substr(i,1);if("("===e||"\n"===e)break;const r=c.findNodeByOffset(this._parseResults.parseTree,i);if(r&&r!==n){c.getNodeDepth(r)>s&&(t=r);break}}}if(void 0===t)return;const i=this._parseResults.tokenizerOutput.lines.getItemAt(this._position.line),r=this._fileContents.substr(i.start,i.length),o=r.substr(0,this._position.character),a=r.substr(this._position.character),l=o.search(/\w+$/),p=l>=0?o.substr(l):"";if(this._isWithinComment(e,o))return;let u=t;for(;u&&0!==u.nodeType;)u=u.parent;let d=u||t;for(;;){if(y.throwIfCancellationRequested(this._cancellationToken),50===d.nodeType)return this._getStringLiteralCompletions(d,p,o,a);if(49===d.nodeType)return;if(38===d.nodeType)return this._getImportModuleCompletions(d);if(0===d.nodeType)return this._getExpressionErrorCompletions(d,p,o,a);if(36===d.nodeType)return this._getMemberAccessCompletions(d.leftExpression,p);if(39===d.nodeType){if(d.parent&&38===d.parent.nodeType)return this._getImportModuleCompletions(d.parent);if(d.parent&&23===d.parent.nodeType){const e=d.parent.parent;if(e&&22===e.nodeType)return d.parent.name===d?this._getImportFromCompletions(e,p):this._getImportFromCompletions(e,"")}else if(d.parent&&36===d.parent.nodeType&&d===d.parent.memberName)return this._getMemberAccessCompletions(d.parent.leftExpression,p)}if(22===d.nodeType)return this._getImportFromCompletions(d,p);if(v.isExpressionNode(d))return this._getExpressionCompletions(d,p,o,a);if(51===d.nodeType||37===d.nodeType)return this._getStatementCompletions(d,p,o,a);if(!d.parent)break;d=d.parent}}resolveCompletionItem(e){y.throwIfCancellationRequested(this._cancellationToken);const t=e.data,n=e.label;let s="";t.autoImportText&&(s=t.autoImportText);const i=D._mostRecentCompletions.findIndex(e=>e.label===n&&e.autoImportText===s);i>0&&(D._mostRecentCompletions=D._mostRecentCompletions.splice(i,1)),0!==i&&D._mostRecentCompletions.unshift({label:n,autoImportText:s}),D._mostRecentCompletions.length>128&&D._mostRecentCompletions.pop(),t.symbolLabel&&(this._itemToResolve=e,this.getCompletionsForPosition())}_isWithinComment(e,t){const n=this._parseResults.tokenizerOutput.tokens.getItemAtPosition(e);if(n<0)return!1;const s=this._parseResults.tokenizerOutput.tokens.getItemAt(n);return!(e>s.start&&e<T.TextRange.getEnd(s)||!t.match(/#/))}_getExpressionErrorCompletions(e,t,n,s){switch(e.category){case 0:return this._createSingleKeywordCompletionList("in");case 1:return this._createSingleKeywordCompletionList("else");case 2:case 3:case 4:return this._getExpressionCompletions(e,t,n,s);case 7:if(e.child&&v.isExpressionNode(e.child))return this._getMemberAccessCompletions(e.child,t);break;case 10:if(e.child&&39===e.child.nodeType)return this._getMethodOverrideCompletions(e.child)}}_createSingleKeywordCompletionList(e){const t=o.CompletionItem.create(e);return t.kind=o.CompletionItemKind.Keyword,t.sortText=this._makeSortText(S.LikelyKeyword,e),{completionList:o.CompletionList.create([t])}}_getMethodOverrideCompletions(e){const t=c.getEnclosingClass(e,!0);if(!t)return;const n=this._evaluator.getTypeOfClass(t);if(!n)return;const s=new Map;for(let e=n.classType.details.mro.length-1;e>0;e--){const t=n.classType.details.mro[e];h.isClass(t)&&m.getMembersForClass(t,s,!1)}const i=o.CompletionList.create();return s.forEach((t,n)=>{const s=u.getLastTypedDeclaredForSymbol(t);if(s&&3===s.type&&f.computeCompletionSimilarity(e.value,n)>I){const r={start:{line:this._position.line,character:this._position.character-e.length},end:{line:this._position.line,character:this._position.character}},a=this._printMethodSignature(s.node)+":",l=o.TextEdit.replace(r,a);this._addSymbol(n,t,e.value,i,void 0,l)}}),{completionList:i}}_printMethodSignature(e){const t=e.parameters.map((t,n)=>{let s="";1===t.category?s+="*":2===t.category&&(s+="**"),t.name&&(s+=t.name.value);const i=this._evaluator.getTypeAnnotationForParameter(e,n);return i&&(s+=": "+c.printExpression(i)),s}).join(", ");let n=e.name.value+"("+t+")";return e.returnTypeAnnotation?n+=" -> "+c.printExpression(e.returnTypeAnnotation):e.functionAnnotationComment&&(n+=" -> "+c.printExpression(e.functionAnnotationComment.returnTypeAnnotation)),n}_getMemberAccessCompletions(e,t){let n=this._evaluator.getType(e);const s=new Map,i=o.CompletionList.create();let r;if(n){h.isTypeVar(n)&&(n=m.getConcreteTypeFromTypeVar(n,!0)),m.doForSubtypes(n,t=>{const n=m.makeTypeVarsConcrete(t);if(h.isObject(n))m.getMembersForClass(n.classType,s,!0);else if(h.isClass(n))m.getMembersForClass(n,s,!1);else if(h.isModule(n))m.getMembersForModule(n,s);else if(5===n.category||6===n.category){const t=this._evaluator.getBuiltInType(e,"function");t&&h.isClass(t)&&m.getMembersForClass(t,s,!0)}else if(h.isNone(t)){const n=this._evaluator.getBuiltInType(e,"object");n&&h.isClass(n)&&m.getMembersForClass(n,s,h.TypeBase.isInstance(t))}});const o=m.makeTypeVarsConcrete(n),a=h.isObject(o)?o:void 0;this._addSymbolsForSymbolTable(s,e=>!0,t,a,i),(!n||h.isUnknown(n)||h.isUnbound(n))&&(r=this._getLastKnownModule(e,n))}return{completionList:i,moduleContext:r}}_getLastKnownModule(e,t){var n;let s=e,i=t,r=36===e.nodeType?null==e?void 0:e.memberName.value:void 0;for(;s&&(9===s.nodeType||36===s.nodeType?(s=s.leftExpression,void 0===r&&(r=36===s.nodeType&&null!==(n=null==s?void 0:s.memberName.value)&&void 0!==n?n:"")):s=void 0,!s||(i=this._evaluator.getType(s),void 0===i||h.isUnknown(i)||h.isUnbound(i))););const o={};if(i&&!h.isUnknown(i)&&!h.isUnbound(i)&&s){const e=m.getDeclaringModulesForType(i);o.lastKnownModule=e.find(e=>"typing"!==e),36===s.nodeType?o.lastKnownMemberName=s.memberName.value:39===s.nodeType&&h.isClass(i)?o.lastKnownMemberName=i.details.name:39===s.nodeType&&h.isObject(i)&&(o.lastKnownMemberName=i.classType.details.name),o.unknownMemberName=r}return o}_getStatementCompletions(e,t,n,s){return this._getExpressionCompletions(e,t,n,s)}_getExpressionCompletions(e,t,n,s){if(41===e.nodeType)return;const i=o.CompletionList.create();if(this._addCallArgumentCompletions(e,t,n,s,i),this._addSymbols(e,t,i),this._findMatchingKeywords(C,t).map(e=>{const t=o.CompletionItem.create(e);t.kind=o.CompletionItemKind.Keyword,i.items.push(t),t.sortText=this._makeSortText(S.Keyword,e)}),!this._configOptions.autoImportCompletions||t.startsWith("_")||this._itemToResolve||this._getAutoImportCompletions(t,i),0===e.nodeType)if(3===e.category)this._getIndexStringLiteral(e,i);else if(2===e.category&&e.parent&&3===e.parent.nodeType){const t=this._evaluator.getDeclaredTypeForExpression(e.parent.leftExpression);t&&this._addLiteralValuesForTargetType(t,n,s,i)}return{completionList:i}}_addCallArgumentCompletions(e,t,n,s,i){const r=g.convertPositionToOffset(this._position,this._parseResults.tokenizerOutput.lines),o=this._evaluator.getCallSignatureInfo(e,r,this._parseResults.tokenizerOutput.tokens);if(o){const e=g.convertOffsetToPosition(o.callNode.leftExpression.start+o.callNode.leftExpression.length,this._parseResults.tokenizerOutput.lines);_.comparePositions(this._position,e)>0&&(this._addNamedParameters(o,t,i),this._addLiteralValuesForArgument(o,n,s,i))}}_addLiteralValuesForArgument(e,t,n,s){e.signatures.forEach(e=>{if(!e.activeParam)return;const i=e.type,r=i.details.parameters.indexOf(e.activeParam);if(r<0)return;const o=i.details.parameters[r].type;this._addLiteralValuesForTargetType(o,t,n,s)})}_addLiteralValuesForTargetType(e,t,n,s){const i=this._getQuoteValueFromPriorText(t);m.doForSubtypes(e,e=>{h.isObject(e)&&h.ClassType.isBuiltIn(e.classType,"str")&&void 0!==e.classType.literalValue&&this._addStringLiteralToCompletionList(e.classType.literalValue,i.stringValue,n,i.quoteCharacter,s)})}_getStringLiteralCompletions(e,t,n,s){let i=e.parent;if(!i||49!==i.nodeType||i.strings.length>1)return;if(i=i.parent,!i)return;const r=o.CompletionList.create();if(25===i.nodeType){if(i=i.parent,!i||24!==i.nodeType)return;const e=this._evaluator.getType(i.baseExpression);if(!e||!h.isObject(e))return;const t=e.classType;if(!h.ClassType.isTypedDictClass(t))return;const o=this._evaluator.getTypedDictMembersForClass(t),a=this._getQuoteValueFromPriorText(n);o.forEach((e,t)=>{this._addStringLiteralToCompletionList(t,a.stringValue,s,a.quoteCharacter,r)})}else if(3===i.nodeType){const e=this._evaluator.getDeclaredTypeForExpression(i.leftExpression);e&&this._addLiteralValuesForTargetType(e,n,s,r)}else this._addCallArgumentCompletions(e,t,n,s,r);return{completionList:r}}_getQuoteValueFromPriorText(e){const t=e.lastIndexOf("'"),n=e.lastIndexOf('"');let s=this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter,i=void 0;return t>n?(s="'",i=e.substr(t+1)):n>t&&(s='"',i=e.substr(n+1)),{stringValue:i,quoteCharacter:s}}_getIndexStringLiteral(e,t){if(!e.parent||25!==e.parent.nodeType)return;const n=e.parent;if(!n.parent||24!==n.parent.nodeType)return;const s=this._evaluator.getType(n.parent.baseExpression);if(!s||!h.isObject(s))return;const i=s.classType;h.ClassType.isTypedDictClass(i)&&this._evaluator.getTypedDictMembersForClass(i).forEach((e,n)=>{this._addStringLiteralToCompletionList(n,void 0,void 0,this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter,t)})}_addStringLiteralToCompletionList(e,t,n,s,i){if(f.computeCompletionSimilarity(t||"",e)>I){const r=`${s}${e}${s}`,a=o.CompletionItem.create(r);a.kind=o.CompletionItemKind.Text,a.sortText=this._makeSortText(S.LiteralValue,r);let l=this._position.character;void 0!==t&&(l-=t.length+1);let c=this._position.character;void 0!==n&&n.startsWith(s)&&c++;const p={start:{line:this._position.line,character:l},end:{line:this._position.line,character:c}};a.textEdit=o.TextEdit.replace(p,r),i.items.push(a)}}_getAutoImportCompletions(e,t){var n;const s=this._moduleSymbolsCallback(),i=new b.AutoImporter(this._configOptions,this._importResolver,this._parseResults,this._position,t.items.filter(e=>{var t;return!(null===(t=e.data)||void 0===t?void 0:t.autoImport)}).map(e=>e.label),s,this._libraryMap);for(const s of i.getAutoImportCandidates(e,I,void 0,this._cancellationToken))s.symbol?this._addSymbol(s.name,s.symbol,e,t,s.source,void 0,s.edits):this._addNameToCompletionList(s.name,null!==(n=s.kind)&&void 0!==n?n:o.CompletionItemKind.Module,e,t,void 0,"",s.source?`\`\`\`\nfrom ${s.source} import ${s.name}\n\`\`\``:`\`\`\`\nimport ${s.name}\n\`\`\``,void 0,s.edits)}_getImportFromCompletions(e,t){if(e.isWildcardImport)return;const n=a.getImportInfo(e.module);if(!n)return;const s=o.CompletionList.create(),i=n.resolvedPaths.length>0?n.resolvedPaths[n.resolvedPaths.length-1]:"",r=this._importLookup(i);return r&&this._addSymbolsForSymbolTable(r.symbolTable,t=>!e.imports.find(e=>e.name.value===t),t,void 0,s),n.implicitImports.forEach(n=>{e.imports.find(e=>e.name.value===n.name)||this._addNameToCompletionList(n.name,o.CompletionItemKind.Module,t,s)}),{completionList:s}}_findMatchingKeywords(e,t){return e.filter(e=>!t||f.computeCompletionSimilarity(t,e)>I)}_addNamedParameters(e,t,n){const s=new Map;e.signatures.forEach(e=>{this._addNamedParametersToMap(e.type,s)}),e.callNode.arguments.forEach(e=>{e.name&&s.delete(e.name.value)}),s.forEach(e=>{if(f.computeCompletionSimilarity(t,e)>I){const t=o.CompletionItem.create(e+"=");t.kind=o.CompletionItemKind.Variable;const s={workspacePath:this._workspacePath,filePath:this._filePath,position:this._position};t.data=s,t.sortText=this._makeSortText(S.NamedParameter,e),n.items.push(t)}})}_addNamedParametersToMap(e,t){e.details.parameters.forEach(e=>{e.name&&!e.isNameSynthesized&&(p.isPrivateOrProtectedName(e.name)||t.set(e.name,e.name))})}_addSymbols(e,t,n){let s=e;for(;s;){let e=a.getScope(s);if(e){for(;e;)this._addSymbolsForSymbolTable(e.symbolTable,()=>!0,t,void 0,n),e=e.parent;if(10===s.nodeType){const e=this._evaluator.getTypeOfClass(s);e&&h.isClass(e.classType)&&e.classType.details.mro.forEach((e,s)=>{h.isClass(e)&&this._addSymbolsForSymbolTable(e.details.fields,t=>{const n=e.details.fields.get(t);return!(!n||!n.isClassMember())&&n.getDeclarations().some(e=>1===e.type)},t,void 0,n)})}break}s=s.parent}}_addSymbolsForSymbolTable(e,t,n,s,i){e.forEach((e,r)=>{!e.isExternallyHidden()&&t(r)&&(i.items.some(e=>e.label===r)||this._addSymbol(r,e,n,i,void 0,void 0,void 0,s))})}_addSymbol(e,t,n,s,i,r,a,c){let p=u.getLastTypedDeclaredForSymbol(t);if(!p){const e=t.getDeclarations();e.length>0&&(p=e[e.length-1])}if(p){let u,y=o.CompletionItemKind.Variable;if(p=this._evaluator.resolveAliasDeclaration(p,!0),p&&(y=this._convertDeclarationTypeToItemKind(p),this._itemToResolve)&&this._itemToResolve.data.symbolLabel===e){const n=this._evaluator.getEffectiveTypeOfSymbol(t);if(n){let t,s;switch(p.type){case 0:case 1:case 2:t=e+": "+this._evaluator.printType(n,!1);break;case 3:{const s=c?this._evaluator.bindFunctionToClassOrObject(c,n,!1):n;if(s)if(m.isProperty(s)&&c){const n=this._evaluator.getGetterTypeFromProperty(s.classType,!0)||h.UnknownType.create();t=e+": "+this._evaluator.printType(n,!1)+" (property)"}else t=6===s.category?s.overloads.map(t=>e+this._evaluator.printType(t,!1)).join("\n"):e+": "+this._evaluator.printType(s,!1);break}case 4:case 5:t="class "+e+"()";break;case 6:if(t=e,p.path){const e=this._importLookup(p.path);e&&(s=e.docString)}break;default:t=e}h.isModule(n)?s=d.getModuleDocString(n,p,this._sourceMapper):h.isClass(n)?s=d.getClassDocString(n,p,this._sourceMapper):5===n.category?s=d.getFunctionDocStringFromType(n,this._sourceMapper):6===n.category?s=d.getOverloadedFunctionDocStrings(n,p,this._sourceMapper).find(e=>e):3===p.type&&(s=d.getFunctionDocStringFromDeclaration(p,this._sourceMapper));let i="```python\n"+t+"\n```\n";s&&(i+="---\n",i+=l.convertDocStringToMarkdown(s)),i&&(this._itemToResolve.documentation={kind:o.MarkupKind.Markdown,value:i})}}i&&(u=`\`\`\`\nfrom ${i} import ${e}\n\`\`\``),this._addNameToCompletionList(e,y,n,s,void 0,void 0,u,r,a)}else if(t.getSynthesizedType()){const t=o.CompletionItemKind.Variable;this._addNameToCompletionList(e,t,n,s,void 0,void 0,void 0,r,a)}}_addNameToCompletionList(e,t,n,s,i,r,a,c,u){if(f.computeCompletionSimilarity(n,e)>I){const d=o.CompletionItem.create(e);d.kind=t;const h={workspacePath:this._workspacePath,filePath:this._filePath,position:this._position};d.data=h,a?(d.sortText=this._makeSortText(S.AutoImport,e,a),h.autoImportText=a,d.detail="Auto-import"):p.isDunderName(e)?d.sortText=this._makeSortText(S.DunderSymbol,e):""===n&&p.isPrivateOrProtectedName(e)?d.sortText=this._makeSortText(S.PrivateSymbol,e):d.sortText=this._makeSortText(S.NormalSymbol,e),h.symbolLabel=e;let m="";a&&(m+=a,m+="\n\n"),i&&(m+="```python\n"+i+"\n```\n"),r&&(m+="---\n",m+=l.convertDocStringToMarkdown(r)),m=m.trimEnd(),m&&(d.documentation={kind:o.MarkupKind.Markdown,value:m}),c&&(d.textEdit=c),u&&(d.additionalTextEdits=u.map(e=>({range:{start:{line:e.range.start.line,character:e.range.start.character},end:{line:e.range.end.line,character:e.range.end.character}},newText:e.replacementText}))),s.items.push(d)}}_getRecentListIndex(e,t){return D._mostRecentCompletions.findIndex(n=>n.label===e&&n.autoImportText===t)}_makeSortText(e,t,n=""){const s=this._getRecentListIndex(t,n);return s>=0&&(e===S.AutoImport?e=S.RecentAutoImport:e===S.ImportModuleName?e=S.RecentImportModuleName:e!==S.Keyword&&e!==S.NormalSymbol&&e!==S.PrivateSymbol&&e!==S.DunderSymbol||(e=S.RecentKeywordOrSymbol)),this._formatInteger(e,2)+"."+this._formatInteger(s,4)+"."+t}_formatInteger(e,t){const n="0".charCodeAt(0);let s="";for(let i=0;i<t;i++){let t=Math.floor(e%10);t<0&&(t=9),s=String.fromCharCode(t+n)+s,e=Math.floor(e/10)}return s}_convertDeclarationTypeToItemKind(e){const t=this._evaluator.resolveAliasDeclaration(e,!0);if(!t)return o.CompletionItemKind.Variable;switch(t.type){case 0:return"class"===t.intrinsicType?o.CompletionItemKind.Class:o.CompletionItemKind.Variable;case 2:return o.CompletionItemKind.Variable;case 1:return t.isConstant||t.isFinal?o.CompletionItemKind.Constant:o.CompletionItemKind.Variable;case 3:{const e=this._evaluator.getTypeOfFunction(t.node);return e&&m.isProperty(e.decoratedType)?o.CompletionItemKind.Property:t.isMethod?o.CompletionItemKind.Method:o.CompletionItemKind.Function}case 4:case 5:return o.CompletionItemKind.Class;case 6:return o.CompletionItemKind.Module}}_getImportModuleCompletions(e){const t=this._configOptions.findExecEnvironment(this._filePath),n={leadingDots:e.leadingDots,hasTrailingDot:e.hasTrailingDot,nameParts:e.nameParts.map(e=>e.value),importedSymbols:[]},s=this._importResolver.getCompletionSuggestions(this._filePath,t,n,I),i=o.CompletionList.create();if(!e.hasTrailingDot&&e.parent&&22===e.parent.nodeType&&e.parent.missingImportKeyword){const e="import",t=o.CompletionItem.create(e);t.kind=o.CompletionItemKind.Keyword,i.items.push(t),t.sortText=this._makeSortText(S.Keyword,e)}return s.forEach(e=>{const t=o.CompletionItem.create(e);t.kind=o.CompletionItemKind.Module,i.items.push(t),t.sortText=this._makeSortText(S.ImportModuleName,e)}),{completionList:i}}}t.CompletionProvider=D,D._mostRecentCompletions=[]},3778:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DefinitionProvider=void 0;const o=r(n(8494)),a=n(8816),l=n(3213),c=n(1464),p=n(3550);t.DefinitionProvider=class{static getDefinitionsForPosition(e,t,n,s,i){l.throwIfCancellationRequested(i);const r=c.convertPositionToOffset(n,t.tokenizerOutput.lines);if(void 0===r)return;const p=o.findNodeByOffset(t.parseTree,r);if(void 0===p)return;const u=[];if(39===p.nodeType){const t=s.getDeclarationsForNameNode(p);t&&t.forEach(t=>{const n=s.resolveAliasDeclaration(t,!0);if(n&&n.path&&(this._addIfUnique(u,{path:n.path,range:n.range}),a.isStubFile(n.path))){const t=e.findDeclarations(n);for(const e of t)e&&e.path&&this._addIfUnique(u,{path:e.path,range:e.range})}})}return u.length>0?u:void 0}static _addIfUnique(e,t){for(const n of e)if(n.path===t.path&&p.rangesAreEqual(n.range,t.range))return;e.push(t)}}},8221:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentHighlightProvider=void 0;const o=n(4494),a=n(563),l=n(5523),c=r(n(8494)),p=n(427),u=n(3213),d=n(1464),h=n(3550);class m extends p.ParseTreeWalker{constructor(e,t,n,s,i,r){super(),this._symbolName=e,this._declarations=t,this._parseResults=n,this._highlightResults=s,this._evaluator=i,this._cancellationToken=r}findHighlights(){this.walk(this._parseResults.parseTree)}walk(e){a.isCodeUnreachable(e)||super.walk(e)}visitModuleName(e){return!1}visitName(e){if(u.throwIfCancellationRequested(this._cancellationToken),e.value!==this._symbolName)return!1;if(this._declarations.length>0){const t=this._evaluator.getDeclarationsForNameNode(e);t&&t.length>0&&t.some(e=>this._resultsContainsDeclaration(e))&&this._addResult(e)}else this._addResult(e);return!0}_addResult(e){this._highlightResults.push({kind:this._isWriteAccess(e)?o.DocumentHighlightKind.Write:o.DocumentHighlightKind.Read,range:{start:d.convertOffsetToPosition(e.start,this._parseResults.tokenizerOutput.lines),end:d.convertOffsetToPosition(h.TextRange.getEnd(e),this._parseResults.tokenizerOutput.lines)}})}_isWriteAccess(e){let t=e,n=t.parent;for(;n;){switch(n.nodeType){case 3:case 5:return t===n.leftExpression;case 4:return t===n.name;case 14:return!0;case 27:return t===n.targetExpression;case 21:return t===n.alias||n.module.nameParts.length>0&&t===n.module.nameParts[0];case 23:return t===n.alias||!n.alias&&t===n.name;case 36:if(t!==n.memberName)return!1;break;case 26:return t===n.name;case 59:return n.withItems.some(e=>e===t);case 34:return t===n.targetExpression;case 55:if(t===n.typeAnnotation)return!1;break;case 29:case 10:case 37:return!1}t=n,n=n.parent}return!1}_resultsContainsDeclaration(e){const t=this._evaluator.resolveAliasDeclaration(e,!1);if(!t)return!1;if(this._declarations.some(e=>l.areDeclarationsSame(e,t)))return!0;const n=this._evaluator.resolveAliasDeclaration(t,!0);return!(!n||n===t)&&this._declarations.some(e=>l.areDeclarationsSame(e,n))}}p.ParseTreeWalker,t.DocumentHighlightProvider=class{static getDocumentHighlight(e,t,n,s){u.throwIfCancellationRequested(s);const i=d.convertPositionToOffset(t,e.tokenizerOutput.lines);if(void 0===i)return;const r=c.findNodeByOffset(e.parseTree,i);if(void 0===r)return;const o=[];if(39===r.nodeType){const t=n.getDeclarationsForNameNode(r)||[],i=[];t.forEach(e=>{const t=n.resolveAliasDeclaration(e,!0);t&&i.push(t)}),new m(r.value,i,e,o,n,s).findHighlights()}else r.nodeType;return o.length>0?o:void 0}}},2816:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentSymbolProvider=t.getIndexAliasData=t.includeAliasDeclarationInIndex=void 0;const o=n(4494),a=n(472),l=n(6673),c=r(n(563)),p=n(5523),u=n(2917),d=n(5168),h=n(3213),m=n(1464),y=r(n(7559));function g(e){return e.usesLocalName&&!!e.symbolName&&e.path.length>0}function f(e,t){if(!t.symbolName)return;const n={originalName:t.symbolName,modulePath:t.path};if(!e)return n;const s=l.resolveAliasDeclaration(e,t,!0),i=s?p.getNameFromDeclaration(s):void 0;return!i||s.path.length<=0?n:{originalName:i,modulePath:s.path}}t.includeAliasDeclarationInIndex=g,t.getIndexAliasData=f;class _{static addSymbolsForDocument(e,t,n,s,i,r){var o;(e||t)&&function e(t,n,s,i,r,o){h.throwIfCancellationRequested(o);for(const c of t)if(!c.alias){if(y.computeCompletionSimilarity(s,c.name)>=.5){const e={uri:a.URI.file(n).toString(),range:c.selectionRange},t={name:c.name,kind:c.kind,containerName:i.length>0?i:void 0,location:e};r.push(t)}e(c.children,n,s,l(i,c.name),r,o)}function l(e,t){return e.length>0?`${e}.${t}`:t}}(null!==(o=null==e?void 0:e.symbols)&&void 0!==o?o:_.indexSymbols(t,!1,r),n,s,"",i,r)}static addHierarchicalSymbolsForDocument(e,t,n,s){var i;(e||t)&&function e(t,n,s){h.throwIfCancellationRequested(s);for(const i of t){if(i.alias)continue;const t=[];e(i.children,t,s);const r={name:i.name,kind:i.kind,range:i.range,selectionRange:i.selectionRange,children:t};n.push(r)}}(null!==(i=null==e?void 0:e.symbols)&&void 0!==i?i:_.indexSymbols(t,!1,s),n,s)}static indexSymbols(e,t,n){const s=[];return function e(t,n,s,i,r){var a;h.throwIfCancellationRequested(r);const l=c.getScope(n);if(!l)return;const p=c.getFileInfo(t.parseTree);let y;s&&!(null==p?void 0:p.isStubFile)&&(y=new Set(null!==(a=c.getDunderAllNames(t.parseTree))&&void 0!==a?a:[])),l.symbolTable.forEach((n,a)=>{if(n.isIgnoredForProtocolMatch())return;if(y&&!y.has(a))return;let l=u.getLastTypedDeclaredForSymbol(n);if(!l&&n.hasDeclarations()&&(l=n.getDeclarations()[0]),l){if(6===l.type){if(l.path.length<=0)return;if(!y&&!g(l))return}!function(t,n,s,i,r,a,l){var p;if(s&&!i)return;const u=function(e,t,n){let s;switch(t.type){case 4:case 5:s=o.SymbolKind.Class;break;case 3:if(t.isMethod){const e=null==n?void 0:n.getTypeForDeclaration(t);s=e&&d.isProperty(e)?o.SymbolKind.Property:o.SymbolKind.Method}else s=o.SymbolKind.Function;break;case 6:s=o.SymbolKind.Module;break;case 2:if("self"===e||"cls"===e||"_"===e)return;s=o.SymbolKind.Variable;break;case 1:if("_"===e)return;s=t.isConstant||t.isFinal?o.SymbolKind.Constant:o.SymbolKind.Variable;break;default:s=o.SymbolKind.Variable}return s}(r,n);if(void 0===u)return;const h=n.range;let y=h;const g=[];4!==n.type&&3!==n.type||(s||e(t,n.node,!1,g,l),y=m.convertOffsetsToRange(n.node.start,n.node.name.start+n.node.length,t.tokenizerOutput.lines));const _={name:r,alias:6===n.type?f(null===(p=c.getFileInfo(t.parseTree))||void 0===p?void 0:p.importLookup,n):void 0,externallyVisible:i,kind:u,range:y,selectionRange:h,children:g};a.push(_)}(t,l,s,!n.isExternallyHidden(),a,i,r)}})}(e,e.parseTree,t,s,n),s}}t.DocumentSymbolProvider=_},3334:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.convertHoverResults=t.HoverProvider=void 0;const o=n(4494),a=n(8434),l=r(n(8494)),c=n(3371),p=n(1133),u=n(5168),d=n(3213),h=n(1464),m=n(3550);t.HoverProvider=class{static getHoverForPosition(e,t,n,s,i){d.throwIfCancellationRequested(i);const r=h.convertPositionToOffset(n,t.tokenizerOutput.lines);if(void 0===r)return;const o=l.findNodeByOffset(t.parseTree,r);if(void 0===o)return;const a={parts:[],range:{start:h.convertOffsetToPosition(o.start,t.tokenizerOutput.lines),end:h.convertOffsetToPosition(m.TextRange.getEnd(o),t.tokenizerOutput.lines)}};if(39===o.nodeType){const t=s.getDeclarationsForNameNode(o);if(t&&t.length>0)this._addResultsForDeclaration(e,a.parts,t[0],o,s);else if((!o.parent||38!==o.parent.nodeType)&&0===a.parts.length){const t=s.getType(o)||p.UnknownType.create();let n="";n=p.isModule(t)?"(module) "+o.value:o.value+": "+s.printType(t,!1),this._addResultsPart(a.parts,n,!0),this._addDocumentationPart(e,a.parts,o,s,void 0)}}return a.parts.length>0?a:void 0}static _addResultsForDeclaration(e,t,n,s,i){var r;const o=i.resolveAliasDeclaration(n,!0);if(o)switch(o.type){case 0:this._addResultsPart(t,s.value+this._getTypeText(s,i),!0),this._addDocumentationPart(e,t,s,i,o);break;case 1:{let a=o.isConstant||o.isFinal?"constant":"variable",l=s;21===n.node.nodeType||23===n.node.nodeType?n.node.alias&&s!==n.node.alias&&39===o.node.nodeType&&(l=o.node):1===(null===(r=s.parent)||void 0===r?void 0:r.nodeType)&&s.parent.name===s&&39===n.node.nodeType&&(l=n.node);const c=i.getType(l);let u=!1;if(c&&p.TypeBase.isInstantiable(c)){const e=p.getTypeAliasInfo(c);e&&(e.aliasName===l.value&&(u=!0),a="type alias")}this._addResultsPart(t,`(${a}) `+s.value+this._getTypeText(l,i,u),!0),this._addDocumentationPart(e,t,s,i,o);break}case 2:this._addResultsPart(t,"(parameter) "+s.value+this._getTypeText(s,i),!0),this._addDocumentationPart(e,t,s,i,o);break;case 4:case 5:if(this._addInitMethodInsteadIfCallNode(s,i,t,e,o))return;this._addResultsPart(t,"(class) "+s.value,!0),this._addDocumentationPart(e,t,s,i,o);break;case 3:{let n="function";if(o.isMethod){const e=i.getTypeForDeclaration(o);n=e&&u.isProperty(e)?"property":"method"}this._addResultsPart(t,`(${n}) `+s.value+this._getTypeText(s,i),!0),this._addDocumentationPart(e,t,s,i,o);break}case 6:this._addResultsPart(t,"(module) "+s.value,!0),this._addDocumentationPart(e,t,s,i,o)}else this._addResultsPart(t,"(import) "+s.value+this._getTypeText(s,i),!0)}static _addInitMethodInsteadIfCallNode(e,t,n,s,i){let r=e;if(r.parent&&36===r.parent.nodeType&&e===r.parent.memberName&&(r=e.parent),!r||!r.parent||9!==r.parent.nodeType||r.parent.leftExpression!==r)return!1;const o=t.getType(e);if(!o||!p.isClass(o))return!1;const a=u.lookUpClassMember(o,"__init__",12);if(!a)return!1;const l=t.getType(r.parent),c=t.getTypeOfMember(a);if(!l||!c||!p.isObject(l))return!1;const d=t.bindFunctionToClassOrObject(l,c,!1);if(!d||5!==d.category)return!1;const h=t.printFunctionParts(d),m=`${e.value}(${h[0].join(", ")})`;return this._addResultsPart(n,"(class) "+m,!0),this._addDocumentationPartForType(s,n,d,i)||this._addDocumentationPartForType(s,n,o,i),!0}static _getTypeText(e,t,n=!1){const s=t.getType(e)||p.UnknownType.create();return": "+t.printType(s,n)}static _addDocumentationPart(e,t,n,s,i){const r=s.getType(n);r&&this._addDocumentationPartForType(e,t,r,i)}static _addDocumentationPartForType(e,t,n,s){const i=[];p.isModule(n)?i.push(c.getModuleDocString(n,s,e)):p.isClass(n)?i.push(c.getClassDocString(n,s,e)):5===n.category?i.push(c.getFunctionDocStringFromType(n,e)):6===n.category?i.push(...c.getOverloadedFunctionDocStrings(n,s,e)):3===(null==s?void 0:s.type)&&i.push(c.getFunctionDocStringFromDeclaration(s,e));let r=!1;for(const e of i)e&&(r=!0,this._addDocumentationResultsPart(t,e));return r}static _addDocumentationResultsPart(e,t){t&&this._addResultsPart(e,a.convertDocStringToMarkdown(t))}static _addResultsPart(e,t,n=!1){e.push({python:n,text:t})}},t.convertHoverResults=function(e){if(!e)return;const t=e.parts.map(e=>e.python?"```python\n"+e.text+"\n```\n":e.text).join("");return{contents:{kind:o.MarkupKind.Markdown,value:t},range:e.range}}},4969:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImportSorter=void 0;const s=n(7012),i=n(3213),r=n(1464),o=n(3550);t.ImportSorter=class{constructor(e,t){this._parseResults=e,this._cancellationToken=t}sort(){i.throwIfCancellationRequested(this._cancellationToken);const e=[],t=s.getTopLevelImports(this._parseResults.parseTree),n=t.orderedImports.map(e=>e).sort((e,t)=>s.compareImportStatements(e,t));if(0===n.length)return[];const r=this._getPrimaryReplacementRange(t.orderedImports);return e.push({range:r,replacementText:this._generateSortedImportText(n)}),this._addSecondaryReplacementRanges(t.orderedImports,e),e}_getPrimaryReplacementRange(e){let t=e.findIndex(e=>e.followsNonImportStatement);t<0&&(t=e.length);const n=e[t-1].node;return{start:r.convertOffsetToPosition(e[0].node.start,this._parseResults.tokenizerOutput.lines),end:r.convertOffsetToPosition(o.TextRange.getEnd(n),this._parseResults.tokenizerOutput.lines)}}_addSecondaryReplacementRanges(e,t){let n=e.findIndex(e=>e.followsNonImportStatement);if(!(n<0))for(;;){let s=e.findIndex((e,t)=>t>n&&e.followsNonImportStatement);if(s<0&&(s=e.length),t.push({range:{start:r.convertOffsetToPosition(e[n].node.start,this._parseResults.tokenizerOutput.lines),end:r.convertOffsetToPosition(o.TextRange.getEnd(e[s-1].node),this._parseResults.tokenizerOutput.lines)},replacementText:""}),n=s,n>=e.length)break}}_generateSortedImportText(e){let t="",n=s.getImportGroup(e[0]);for(const i of e){const r=s.getImportGroup(i);let o;n!==r&&(t+=this._parseResults.tokenizerOutput.predominantEndOfLineSequence,n=r),o=20===i.node.nodeType?this._formatImportNode(i.subnode,i.moduleName):this._formatImportFromNode(i.node,i.moduleName),i!==e[e.length-1]&&(o+=this._parseResults.tokenizerOutput.predominantEndOfLineSequence),t+=o}return t}_formatImportNode(e,t){let n="import "+t;return e.alias&&(n+=" as "+e.alias.value),n}_formatImportFromNode(e,t){const n=e.imports.sort((e,t)=>this._compareSymbols(e,t)).map(e=>{let t=e.name.value;return e.alias&&(t+=" as "+e.alias.value),t});let s=`from ${t} import `;if(e.isWildcardImport)return s+"*";const i=n.join(", ");if(s.length+i.length<=88)return s+i;s+="("+this._parseResults.tokenizerOutput.predominantEndOfLineSequence;for(const e of n)s+=this._parseResults.tokenizerOutput.predominantTabSequence+e+","+this._parseResults.tokenizerOutput.predominantEndOfLineSequence;return s+=")",s}_compareSymbols(e,t){return e.name.value<t.name.value?-1:1}}},2858:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.performQuickAction=void 0;const o=n(7012),a=r(n(8494)),l=n(3213),c=n(1464),p=n(3550),u=n(4969);t.performQuickAction=function(e,t,n,s){return"pyright.organizeimports"===e?new u.ImportSorter(n,s).sort():"pyright.addoptionalforparam"===e&&t.length>=1?function(e,t,n){l.throwIfCancellationRequested(n);let s=a.findNodeByOffset(e.parseTree,t);for(;s&&42!==s.nodeType;)s=s.parent;if(!s)return[];const i=s.typeAnnotation||s.typeAnnotationComment;if(!i)return[];const r=[],u=c.convertOffsetToPosition(i.start,e.tokenizerOutput.lines),d=c.convertOffsetToPosition(p.TextRange.getEnd(i),e.tokenizerOutput.lines);r.push({range:{start:u,end:u},replacementText:"Optional["}),r.push({range:{start:d,end:d},replacementText:"]"});const h=o.getTopLevelImports(e.parseTree),m=h.orderedImports.find(e=>"typing"===e.moduleName);if(m&&22===m.node.nodeType){const t=o.getTextEditsForAutoImportSymbolAddition("Optional",m,e);r.push(...t)}else{const t=o.getTextEditsForAutoImportInsertion("Optional",h,"typing",0,e,u);r.push(...t)}return r}(n,parseInt(t[0],10),s):[]}},4952:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReferencesProvider=void 0;const o=r(n(563)),a=r(n(5523)),l=r(n(8494)),c=n(427),p=n(8816),u=n(3213),d=n(1464),h=n(3550);class m extends c.ParseTreeWalker{constructor(e,t,n,s,i,r){super(),this._parseResults=e,this._filePath=t,this._referencesResult=n,this._includeDeclaration=s,this._evaluator=i,this._cancellationToken=r}findReferences(){this.walk(this._parseResults.parseTree)}walk(e){o.isCodeUnreachable(e)||super.walk(e)}visitModuleName(e){return!1}visitName(e){if(u.throwIfCancellationRequested(this._cancellationToken),e.value!==this._referencesResult.symbolName)return!1;const t=this._evaluator.getDeclarationsForNameNode(e);return t&&t.length>0&&t.some(e=>this._resultsContainsDeclaration(e))&&(this._includeDeclaration||e!==this._referencesResult.nodeAtOffset)&&this._referencesResult.locations.push({path:this._filePath,range:{start:d.convertOffsetToPosition(e.start,this._parseResults.tokenizerOutput.lines),end:d.convertOffsetToPosition(h.TextRange.getEnd(e),this._parseResults.tokenizerOutput.lines)}}),!0}_resultsContainsDeclaration(e){const t=this._evaluator.resolveAliasDeclaration(e,!1);if(!t)return!1;if(this._referencesResult.declarations.some(e=>a.areDeclarationsSame(e,t)))return!0;const n=this._evaluator.resolveAliasDeclaration(t,!0);return!(!n||n===t)&&this._referencesResult.declarations.some(e=>a.areDeclarationsSame(e,n))}}t.ReferencesProvider=class{static getDeclarationForPosition(e,t,n,s,i,r){var o;u.throwIfCancellationRequested(r);const a=d.convertPositionToOffset(s,t.tokenizerOutput.lines);if(void 0===a)return;const c=l.findNodeByOffset(t.parseTree,a);if(void 0===c)return;if(39!==c.nodeType)return;if(38===(null===(o=c.parent)||void 0===o?void 0:o.nodeType))return;const h=i.getDeclarationsForNameNode(c);if(!h)return;const m=[];return h.forEach(t=>{const n=i.resolveAliasDeclaration(t,!1);if(n&&(m.push(n),p.isStubFile(n.path))){const t=e.findDeclarations(n);for(const e of t)e&&e.path&&this._addIfUnique(m,e)}}),0!==m.length?{requiresGlobalSearch:m.some(e=>{var t,s;if(e.path!==n)return!0;const i=l.getEvaluationScopeNode(e.node);return 37===i.nodeType||10===i.nodeType||36===(null===(s=null===(t=e.node)||void 0===t?void 0:t.parent)||void 0===s?void 0:s.nodeType)&&e.node===e.node.parent.memberName}),nodeAtOffset:c,symbolName:c.value,declarations:m,locations:[]}:void 0}static _addIfUnique(e,t){for(const n of e)if(a.areDeclarationsSame(n,t))return;e.push(t)}static addReferences(e,t,n,s,i,r){new m(e,t,n,s,i,r).findReferences()}}},9437:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.SignatureHelpProvider=void 0;const o=n(5678),a=r(n(8494)),l=n(3213),c=n(1464);t.SignatureHelpProvider=class{static getSignatureHelpForPosition(e,t,n,s){var i;l.throwIfCancellationRequested(s);const r=c.convertPositionToOffset(t,e.tokenizerOutput.lines);if(void 0===r)return;let o=a.findNodeByOffset(e.parseTree,r);const p=o,u=o?a.getNodeDepth(o):0;let d=r;for(;d>=0;){d--;const t=a.findNodeByOffset(e.parseTree,d);if(t&&t!==p){a.getNodeDepth(t)>u&&(o=t);break}}if(void 0===o)return;const h=n.getCallSignatureInfo(o,r,e.tokenizerOutput.tokens);return h?{signatures:h.signatures.map(e=>this._makeSignature(e,n)),callHasParameters:!!(null===(i=h.callNode.arguments)||void 0===i?void 0:i.length)}:void 0}static _makeSignature(e,t){const n=e.type,s=t.printFunctionParts(n),i=[],r=n.details.docString;let a,l="(";return s[0].forEach((e,t)=>{const a=n.details.parameters[t].name||"";i.push({startOffset:l.length,endOffset:l.length+e.length,text:e,documentation:o.extractParameterDocumentation(r||"",a)}),l+=e,t<s[0].length-1&&(l+=", ")}),l+=") -> "+s[1],e.activeParam&&(a=n.details.parameters.indexOf(e.activeParam),-1===a&&(a=void 0)),{label:l,parameters:i,documentation:r,activeParameter:a}}}},2122:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Localizer=t.ParameterizedString=void 0;const s=n(5839),i=n(6395),r=n(9890),o=n(6961),a=n(9356),l=n(886),c=n(7523),p=n(6853),u=n(3019);class d{constructor(e){this._formatString=e}format(e){let t=this._formatString;return Object.keys(e).forEach(n=>{t=t.replace(`{${n}}`,e[n].toString())}),t}getFormatString(){return this._formatString}}t.ParameterizedString=d;const h="en-us",m={de:r,"en-us":i,es:o,fr:a,ja:l,ru:c,"zh-cn":p,"zh-tw":u};let y=void 0,g={};function f(e){void 0===y&&(g=function(){const e=T(h);return e||(console.error("Could not load default strings"),{})}(),y=function(e){if(e===h)return{};let t=T(e);if(void 0!==t)return t;const n=e.split("-");return n.length>0&&n[0]&&(t=T(n[0]),void 0!==t)?t:{}}(function(){const e=process.env,t=e.VSCODE_NLS_CONFIG;if(t)try{return JSON.parse(t).locale}catch(e){}const n=e.LC_ALL||e.LC_MESSAGES||e.LANG||e.LANGUAGE;if(n){const e=n.split(".");if(e.length>0&&e[0])return e[0]}return h}()));const t=e.split("."),n=_(y,t)||_(g,t);if(n)return n;s.fail(`Missing localized string for key "${e}"`)}function _(e,t){let n=e;for(const e of t){if(!n[e])return;n=n[e]}return n}function T(e){return m[e]}!function(e){let t,n,s;!function(e){e.annotatedParamCountMismatch=()=>new d(f("Diagnostic.annotatedParamCountMismatch")),e.annotatedTypeArgMissing=()=>f("Diagnostic.annotatedTypeArgMissing"),e.annotationFormatString=()=>f("Diagnostic.annotationFormatString"),e.annotationNotSupported=()=>f("Diagnostic.annotationNotSupported"),e.annotationSpansStrings=()=>f("Diagnostic.annotationSpansStrings"),e.annotationStringEscape=()=>f("Diagnostic.annotationStringEscape"),e.annotationTripleQuote=()=>f("Diagnostic.annotationTripleQuote"),e.argAssignment=()=>new d(f("Diagnostic.argAssignment")),e.argAssignmentFunction=()=>new d(f("Diagnostic.argAssignmentFunction")),e.argAssignmentParam=()=>new d(f("Diagnostic.argAssignmentParam")),e.argAssignmentParamFunction=()=>new d(f("Diagnostic.argAssignmentParamFunction")),e.argMissingForParam=()=>new d(f("Diagnostic.argMissingForParam")),e.argMissingForParams=()=>new d(f("Diagnostic.argMissingForParams")),e.argPositional=()=>f("Diagnostic.argPositional"),e.argPositionalExpectedCount=()=>new d(f("Diagnostic.argPositionalExpectedCount")),e.argPositionalExpectedOne=()=>f("Diagnostic.argPositionalExpectedOne"),e.argTypePartiallyUnknown=()=>f("Diagnostic.argTypePartiallyUnknown"),e.argTypeUnknown=()=>f("Diagnostic.argTypeUnknown"),e.assertAlwaysTrue=()=>f("Diagnostic.assertAlwaysTrue"),e.assignmentExprContext=()=>f("Diagnostic.assignmentExprContext"),e.assignmentExprComprehension=()=>new d(f("Diagnostic.assignmentExprComprehension")),e.assignmentInProtocol=()=>f("Diagnostic.assignmentInProtocol"),e.assignmentTargetExpr=()=>f("Diagnostic.assignmentTargetExpr"),e.awaitIllegal=()=>f("Diagnostic.awaitIllegal"),e.awaitNotInAsync=()=>f("Diagnostic.awaitNotInAsync"),e.backticksIllegal=()=>f("Diagnostic.backticksIllegal"),e.baseClassCircular=()=>f("Diagnostic.baseClassCircular"),e.baseClassInvalid=()=>f("Diagnostic.baseClassInvalid"),e.baseClassFinal=()=>new d(f("Diagnostic.baseClassFinal")),e.baseClassUnknown=()=>f("Diagnostic.baseClassUnknown"),e.bindTypeMismatch=()=>new d(f("Diagnostic.bindTypeMismatch")),e.breakOutsideLoop=()=>f("Diagnostic.breakOutsideLoop"),e.callableExtraArgs=()=>f("Diagnostic.callableExtraArgs"),e.callableFirstArg=()=>f("Diagnostic.callableFirstArg"),e.classMethodClsParam=()=>f("Diagnostic.classMethodClsParam"),e.classNotRuntimeSubscriptable=()=>new d(f("Diagnostic.classNotRuntimeSubscriptable")),e.classDecoratorTypeUnknown=()=>f("Diagnostic.classDecoratorTypeUnknown"),e.classGetItemClsParam=()=>f("Diagnostic.classGetItemClsParam"),e.classVarFirstArgMissing=()=>f("Diagnostic.classVarFirstArgMissing"),e.classVarTooManyArgs=()=>f("Diagnostic.classVarTooManyArgs"),e.comprehensionInDict=()=>f("Diagnostic.comprehensionInDict"),e.comprehensionInSet=()=>f("Diagnostic.comprehensionInSet"),e.concatenateParamSpecMissing=()=>f("Diagnostic.concatenateParamSpecMissing"),e.concatenateTypeArgsMissing=()=>f("Diagnostic.concatenateTypeArgsMissing"),e.constantRedefinition=()=>new d(f("Diagnostic.constantRedefinition")),e.constructorNoArgs=()=>new d(f("Diagnostic.constructorNoArgs")),e.continueInFinally=()=>f("Diagnostic.continueInFinally"),e.continueOutsideLoop=()=>f("Diagnostic.continueOutsideLoop"),e.dataClassFieldWithDefault=()=>f("Diagnostic.dataClassFieldWithDefault"),e.declaredReturnTypePartiallyUnknown=()=>new d(f("Diagnostic.declaredReturnTypePartiallyUnknown")),e.declaredReturnTypeUnknown=()=>f("Diagnostic.declaredReturnTypeUnknown"),e.defaultValueContainsCall=()=>f("Diagnostic.defaultValueContainsCall"),e.defaultValueNotAllowed=()=>f("Diagnostic.defaultValueNotAllowed"),e.defaultValueNotEllipsis=()=>f("Diagnostic.defaultValueNotEllipsis"),e.dictInAnnotation=()=>f("Diagnostic.dictInAnnotation"),e.dictKeyValuePairs=()=>f("Diagnostic.dictKeyValuePairs"),e.delTargetExpr=()=>f("Diagnostic.delTargetExpr"),e.dictExpandIllegalInComprehension=()=>f("Diagnostic.dictExpandIllegalInComprehension"),e.duplicateArgsParam=()=>f("Diagnostic.duplicateArgsParam"),e.duplicateBaseClass=()=>f("Diagnostic.duplicateBaseClass"),e.duplicateCatchAll=()=>f("Diagnostic.duplicateCatchAll"),e.duplicateImport=()=>new d(f("Diagnostic.duplicateImport")),e.duplicateKwargsParam=()=>f("Diagnostic.duplicateKwargsParam"),e.duplicateNameOnly=()=>f("Diagnostic.duplicateNameOnly"),e.duplicateParam=()=>new d(f("Diagnostic.duplicateParam")),e.duplicatePositionOnly=()=>f("Diagnostic.duplicatePositionOnly"),e.duplicateUnpack=()=>f("Diagnostic.duplicateUnpack"),e.ellipsisContext=()=>f("Diagnostic.ellipsisContext"),e.ellipsisSecondArg=()=>f("Diagnostic.ellipsisSecondArg"),e.exceptionTypeIncorrect=()=>new d(f("Diagnostic.exceptionTypeIncorrect")),e.exceptionTypeNotClass=()=>new d(f("Diagnostic.exceptionTypeNotClass")),e.exceptionTypeNotInstantiable=()=>new d(f("Diagnostic.exceptionTypeNotInstantiable")),e.expectedAfterDecorator=()=>f("Diagnostic.expectedAfterDecorator"),e.expectedArrow=()=>f("Diagnostic.expectedArrow"),e.expectedAsAfterException=()=>f("Diagnostic.expectedAsAfterException"),e.expectedAssignRightHandExpr=()=>f("Diagnostic.expectedAssignRightHandExpr"),e.expectedBinaryRightHandExpr=()=>f("Diagnostic.expectedBinaryRightHandExpr"),e.expectedBoolLiteral=()=>f("Diagnostic.expectedBoolLiteral"),e.expectedClassName=()=>f("Diagnostic.expectedClassName"),e.expectedCloseBracket=()=>f("Diagnostic.expectedCloseBracket"),e.expectedCloseBrace=()=>f("Diagnostic.expectedCloseBrace"),e.expectedCloseParen=()=>f("Diagnostic.expectedCloseParen"),e.expectedColon=()=>f("Diagnostic.expectedColon"),e.expectedDecoratorExpr=()=>f("Diagnostic.expectedDecoratorExpr"),e.expectedDecoratorName=()=>f("Diagnostic.expectedDecoratorName"),e.expectedDecoratorNewline=()=>f("Diagnostic.expectedDecoratorNewline"),e.expectedDelExpr=()=>f("Diagnostic.expectedDelExpr"),e.expectedElse=()=>f("Diagnostic.expectedElse"),e.expectedExceptionClass=()=>f("Diagnostic.expectedExceptionClass"),e.expectedExceptionObj=()=>f("Diagnostic.expectedExceptionObj"),e.expectedExpr=()=>f("Diagnostic.expectedExpr"),e.expectedImport=()=>f("Diagnostic.expectedImport"),e.expectedImportAlias=()=>f("Diagnostic.expectedImportAlias"),e.expectedImportSymbols=()=>f("Diagnostic.expectedImportSymbols"),e.expectedIdentifier=()=>f("Diagnostic.expectedIdentifier"),e.expectedIndentedBlock=()=>f("Diagnostic.expectedIndentedBlock"),e.expectedIn=()=>f("Diagnostic.expectedIn"),e.expectedInExpr=()=>f("Diagnostic.expectedInExpr"),e.expectedFunctionAfterAsync=()=>f("Diagnostic.expectedFunctionAfterAsync"),e.expectedFunctionName=()=>f("Diagnostic.expectedFunctionName"),e.expectedMemberName=()=>f("Diagnostic.expectedMemberName"),e.expectedModuleName=()=>f("Diagnostic.expectedModuleName"),e.expectedNameAfterAs=()=>f("Diagnostic.expectedNameAfterAs"),e.expectedNamedArgument=()=>f("Diagnostic.expectedNamedArgument"),e.expectedNewlineOrSemicolon=()=>f("Diagnostic.expectedNewlineOrSemicolon"),e.expectedOpenParen=()=>f("Diagnostic.expectedOpenParen"),e.expectedParamName=()=>f("Diagnostic.expectedParamName"),e.expectedReturnExpr=()=>f("Diagnostic.expectedReturnExpr"),e.expectedSliceIndex=()=>f("Diagnostic.expectedSliceIndex"),e.expectedTypeNotString=()=>f("Diagnostic.expectedTypeNotString"),e.expectedYieldExpr=()=>f("Diagnostic.expectedYieldExpr"),e.finalContext=()=>f("Diagnostic.finalContext"),e.finalMethodOverride=()=>new d(f("Diagnostic.finalMethodOverride")),e.finalReassigned=()=>new d(f("Diagnostic.finalReassigned")),e.finalRedeclaration=()=>new d(f("Diagnostic.finalRedeclaration")),e.finalRedeclarationBySubclass=()=>new d(f("Diagnostic.finalRedeclarationBySubclass")),e.finalTooManyArgs=()=>f("Diagnostic.finalTooManyArgs"),e.finalUnassigned=()=>new d(f("Diagnostic.finalUnassigned")),e.formatStringBrace=()=>f("Diagnostic.formatStringBrace"),e.formatStringBytes=()=>f("Diagnostic.formatStringBytes"),e.formatStringEscape=()=>f("Diagnostic.formatStringEscape"),e.formatStringIllegal=()=>f("Diagnostic.formatStringIllegal"),e.formatStringUnicode=()=>f("Diagnostic.formatStringUnicode"),e.formatStringUnterminated=()=>f("Diagnostic.formatStringUnterminated"),e.functionDecoratorTypeUnknown=()=>f("Diagnostic.functionDecoratorTypeUnknown"),e.genericClassAssigned=()=>f("Diagnostic.genericClassAssigned"),e.genericClassDeleted=()=>f("Diagnostic.genericClassDeleted"),e.genericNotAllowed=()=>f("Diagnostic.genericNotAllowed"),e.genericTypeArgMissing=()=>f("Diagnostic.genericTypeArgMissing"),e.genericTypeArgTypeVar=()=>f("Diagnostic.genericTypeArgTypeVar"),e.genericTypeArgUnique=()=>f("Diagnostic.genericTypeArgUnique"),e.globalReassignment=()=>new d(f("Diagnostic.globalReassignment")),e.globalRedefinition=()=>new d(f("Diagnostic.globalRedefinition")),e.implicitStringConcat=()=>f("Diagnostic.implicitStringConcat"),e.importCycleDetected=()=>f("Diagnostic.importCycleDetected"),e.importDepthExceeded=()=>new d(f("Diagnostic.importDepthExceeded")),e.importResolveFailure=()=>new d(f("Diagnostic.importResolveFailure")),e.importSourceResolveFailure=()=>new d(f("Diagnostic.importSourceResolveFailure")),e.importSymbolUnknown=()=>new d(f("Diagnostic.importSymbolUnknown")),e.incompatibleMethodOverride=()=>new d(f("Diagnostic.incompatibleMethodOverride")),e.inconsistentIndent=()=>f("Diagnostic.inconsistentIndent"),e.inconsistentTabs=()=>f("Diagnostic.inconsistentTabs"),e.initSubclassClsParam=()=>f("Diagnostic.initSubclassClsParam"),e.instanceMethodSelfParam=()=>f("Diagnostic.instanceMethodSelfParam"),e.internalBindError=()=>new d(f("Diagnostic.internalBindError")),e.internalParseError=()=>new d(f("Diagnostic.internalParseError")),e.internalTypeCheckingError=()=>new d(f("Diagnostic.internalTypeCheckingError")),e.invalidIdentifierChar=()=>f("Diagnostic.invalidIdentifierChar"),e.invalidStubStatement=()=>f("Diagnostic.invalidStubStatement"),e.invalidTokenChars=()=>new d(f("Diagnostic.invalidTokenChars")),e.isInstanceInvalidType=()=>new d(f("Diagnostic.isInstanceInvalidType")),e.isSubclassInvalidType=()=>new d(f("Diagnostic.isSubclassInvalidType")),e.keyRequiredDeleted=()=>new d(f("Diagnostic.keyRequiredDeleted")),e.keyValueInSet=()=>f("Diagnostic.keyValueInSet"),e.lambdaReturnTypeUnknown=()=>f("Diagnostic.lambdaReturnTypeUnknown"),e.lambdaReturnTypePartiallyUnknown=()=>new d(f("Diagnostic.lambdaReturnTypePartiallyUnknown")),e.listInAnnotation=()=>f("Diagnostic.listInAnnotation"),e.literalUnsupportedType=()=>f("Diagnostic.literalUnsupportedType"),e.literalEmptyArgs=()=>f("Diagnostic.literalEmptyArgs"),e.memberAccess=()=>new d(f("Diagnostic.memberAccess")),e.memberDelete=()=>new d(f("Diagnostic.memberDelete")),e.memberSet=()=>new d(f("Diagnostic.memberSet")),e.metaclassConflict=()=>f("Diagnostic.metaclassConflict"),e.metaclassDuplicate=()=>f("Diagnostic.metaclassDuplicate"),e.methodNotDefined=()=>new d(f("Diagnostic.methodNotDefined")),e.methodNotDefinedOnType=()=>new d(f("Diagnostic.methodNotDefinedOnType")),e.methodOrdering=()=>f("Diagnostic.methodOrdering"),e.methodOverridden=()=>new d(f("Diagnostic.methodOverridden")),e.methodReturnsNonObject=()=>new d(f("Diagnostic.methodReturnsNonObject")),e.moduleContext=()=>f("Diagnostic.moduleContext"),e.moduleUnknownMember=()=>new d(f("Diagnostic.moduleUnknownMember")),e.namedExceptAfterCatchAll=()=>f("Diagnostic.namedExceptAfterCatchAll"),e.namedTupleEmptyName=()=>f("Diagnostic.namedTupleEmptyName"),e.namedTupleFirstArg=()=>f("Diagnostic.namedTupleFirstArg"),e.namedTupleNameString=()=>f("Diagnostic.namedTupleNameString"),e.namedTupleNameType=()=>f("Diagnostic.namedTupleNameType"),e.namedTupleNameUnique=()=>f("Diagnostic.namedTupleNameUnique"),e.namedTupleNoTypes=()=>f("Diagnostic.namedTupleNoTypes"),e.namedTupleSecondArg=()=>f("Diagnostic.namedTupleSecondArg"),e.newClsParam=()=>f("Diagnostic.newClsParam"),e.nonDefaultAfterDefault=()=>f("Diagnostic.nonDefaultAfterDefault"),e.noneNotCallable=()=>f("Diagnostic.noneNotCallable"),e.noneNotIterable=()=>f("Diagnostic.noneNotIterable"),e.noneNotSubscriptable=()=>f("Diagnostic.noneNotSubscriptable"),e.noneNotUsableWith=()=>f("Diagnostic.noneNotUsableWith"),e.noneOperator=()=>new d(f("Diagnostic.noneOperator")),e.noneUnknownMember=()=>new d(f("Diagnostic.noneUnknownMember")),e.nonLocalNoBinding=()=>new d(f("Diagnostic.nonLocalNoBinding")),e.nonLocalReassignment=()=>new d(f("Diagnostic.nonLocalReassignment")),e.nonLocalRedefinition=()=>new d(f("Diagnostic.nonLocalRedefinition")),e.nonLocalInModule=()=>f("Diagnostic.nonLocalInModule"),e.noOverload=()=>new d(f("Diagnostic.noOverload")),e.noReturnContainsReturn=()=>f("Diagnostic.noReturnContainsReturn"),e.noReturnContainsYield=()=>f("Diagnostic.noReturnContainsYield"),e.noReturnReturnsNone=()=>f("Diagnostic.noReturnReturnsNone"),e.objectNotCallable=()=>new d(f("Diagnostic.objectNotCallable")),e.obscuredClassDeclaration=()=>new d(f("Diagnostic.obscuredClassDeclaration")),e.obscuredFunctionDeclaration=()=>new d(f("Diagnostic.obscuredFunctionDeclaration")),e.obscuredParameterDeclaration=()=>new d(f("Diagnostic.obscuredParameterDeclaration")),e.obscuredVariableDeclaration=()=>new d(f("Diagnostic.obscuredVariableDeclaration")),e.operatorLessOrGreaterDeprecated=()=>f("Diagnostic.operatorLessOrGreaterDeprecated"),e.optionalExtraArgs=()=>f("Diagnostic.optionalExtraArgs"),e.overlappingOverload=()=>new d(f("Diagnostic.overlappingOverload")),e.overloadAbstractMismatch=()=>new d(f("Diagnostic.overloadAbstractMismatch")),e.overloadReturnTypeMismatch=()=>new d(f("Diagnostic.overloadReturnTypeMismatch")),e.paramAfterKwargsParam=()=>f("Diagnostic.paramAfterKwargsParam"),e.paramAlreadyAssigned=()=>new d(f("Diagnostic.paramAlreadyAssigned")),e.paramNameMissing=()=>new d(f("Diagnostic.paramNameMissing")),e.paramSpecAssignedName=()=>new d(f("Diagnostic.paramSpecAssignedName")),e.paramSpecContext=()=>f("Diagnostic.paramSpecContext"),e.paramSpecIllegal=()=>f("Diagnostic.paramSpecIllegal"),e.paramSpecFirstArg=()=>f("Diagnostic.paramSpecFirstArg"),e.paramSpecUnknownArg=()=>f("Diagnostic.paramSpecUnknownArg"),e.paramSpecUnknownMember=()=>new d(f("Diagnostic.paramSpecUnknownMember")),e.paramSpecUnknownParam=()=>new d(f("Diagnostic.paramSpecUnknownParam")),e.paramTypeCovariant=()=>f("Diagnostic.paramTypeCovariant"),e.paramTypeUnknown=()=>new d(f("Diagnostic.paramTypeUnknown")),e.paramAssignmentMismatch=()=>new d(f("Diagnostic.paramAssignmentMismatch")),e.paramTypePartiallyUnknown=()=>new d(f("Diagnostic.paramTypePartiallyUnknown")),e.positionArgAfterNamedArg=()=>f("Diagnostic.positionArgAfterNamedArg"),e.positionOnlyAfterNameOnly=()=>f("Diagnostic.positionOnlyAfterNameOnly"),e.positionOnlyIncompatible=()=>f("Diagnostic.positionOnlyIncompatible"),e.positionOnlyFirstParam=()=>f("Diagnostic.positionOnlyFirstParam"),e.privateUsedOutsideOfClass=()=>new d(f("Diagnostic.privateUsedOutsideOfClass")),e.privateUsedOutsideOfModule=()=>new d(f("Diagnostic.privateUsedOutsideOfModule")),e.propertyStaticOrClassMethod=()=>f("Diagnostic.propertyStaticOrClassMethod"),e.protectedUsedOutsideOfClass=()=>new d(f("Diagnostic.protectedUsedOutsideOfClass")),e.protocolIllegal=()=>f("Diagnostic.protocolIllegal"),e.protocolUsedInCall=()=>new d(f("Diagnostic.protocolUsedInCall")),e.raiseParams=()=>f("Diagnostic.raiseParams"),e.relativeImportNotAllowed=()=>f("Diagnostic.relativeImportNotAllowed"),e.returnMissing=()=>new d(f("Diagnostic.returnMissing")),e.returnOutsideFunction=()=>f("Diagnostic.returnOutsideFunction"),e.returnTypeContravariant=()=>f("Diagnostic.returnTypeContravariant"),e.returnTypeMismatch=()=>new d(f("Diagnostic.returnTypeMismatch")),e.returnTypeUnknown=()=>f("Diagnostic.returnTypeUnknown"),e.returnTypePartiallyUnknown=()=>new d(f("Diagnostic.returnTypePartiallyUnknown")),e.setterGetterTypeMismatch=()=>f("Diagnostic.setterGetterTypeMismatch"),e.singleOverload=()=>new d(f("Diagnostic.singleOverload")),e.staticClsSelfParam=()=>f("Diagnostic.staticClsSelfParam"),e.stringNonAsciiBytes=()=>f("Diagnostic.stringNonAsciiBytes"),e.stringUnsupportedEscape=()=>f("Diagnostic.stringUnsupportedEscape"),e.stringUnterminated=()=>f("Diagnostic.stringUnterminated"),e.stubFileMissing=()=>new d(f("Diagnostic.stubFileMissing")),e.stubUsesGetAttr=()=>f("Diagnostic.stubUsesGetAttr"),e.sublistParamsIncompatible=()=>f("Diagnostic.sublistParamsIncompatible"),e.superCallArgCount=()=>f("Diagnostic.superCallArgCount"),e.superCallFirstArg=()=>new d(f("Diagnostic.superCallFirstArg")),e.superCallSecondArg=()=>new d(f("Diagnostic.superCallSecondArg")),e.superCallZeroArgForm=()=>f("Diagnostic.superCallZeroArgForm"),e.symbolIsUnbound=()=>new d(f("Diagnostic.symbolIsUnbound")),e.symbolIsUndefined=()=>new d(f("Diagnostic.symbolIsUndefined")),e.symbolIsPossiblyUnbound=()=>new d(f("Diagnostic.symbolIsPossiblyUnbound")),e.symbolOverridden=()=>new d(f("Diagnostic.symbolOverridden")),e.tupleInAnnotation=()=>f("Diagnostic.tupleInAnnotation"),e.tupleSizeMismatch=()=>new d(f("Diagnostic.tupleSizeMismatch")),e.typeAbstract=()=>new d(f("Diagnostic.typeAbstract")),e.typeAliasIsRecursive=()=>new d(f("Diagnostic.typeAliasIsRecursive")),e.typeAliasNotInModule=()=>f("Diagnostic.typeAliasNotInModule"),e.typeAliasRedeclared=()=>new d(f("Diagnostic.typeAliasRedeclared")),e.typeArgsExpectingNone=()=>f("Diagnostic.typeArgsExpectingNone"),e.typeArgsMismatchOne=()=>new d(f("Diagnostic.typeArgsMismatchOne")),e.typeArgsMissingForAlias=()=>new d(f("Diagnostic.typeArgsMissingForAlias")),e.typeArgsMissingForClass=()=>new d(f("Diagnostic.typeArgsMissingForClass")),e.typeArgsTooFew=()=>new d(f("Diagnostic.typeArgsTooFew")),e.typeArgsTooMany=()=>new d(f("Diagnostic.typeArgsTooMany")),e.typeAssignmentMismatch=()=>new d(f("Diagnostic.typeAssignmentMismatch")),e.typeCallNotAllowed=()=>f("Diagnostic.typeCallNotAllowed"),e.typedDictAccess=()=>f("Diagnostic.typedDictAccess"),e.typedDictBadVar=()=>f("Diagnostic.typedDictBadVar"),e.typedDictBaseClass=()=>f("Diagnostic.typedDictBaseClass"),e.typedDictDelete=()=>f("Diagnostic.typedDictDelete"),e.typedDictEmptyName=()=>f("Diagnostic.typedDictEmptyName"),e.typedDictEntryName=()=>f("Diagnostic.typedDictEntryName"),e.typedDictEntryUnique=()=>f("Diagnostic.typedDictEntryUnique"),e.typedDictExtraArgs=()=>f("Diagnostic.typedDictExtraArgs"),e.typedDictFirstArg=()=>f("Diagnostic.typedDictFirstArg"),e.typedDictSecondArgDict=()=>f("Diagnostic.typedDictSecondArgDict"),e.typedDictSecondArgDictEntry=()=>f("Diagnostic.typedDictSecondArgDictEntry"),e.typedDictSet=()=>f("Diagnostic.typedDictSet"),e.typedDictTotalParam=()=>f("Diagnostic.typedDictTotalParam"),e.typeExpectedClass=()=>new d(f("Diagnostic.typeExpectedClass")),e.typeGuardArgCount=()=>f("Diagnostic.typeGuardArgCount"),e.typeNotAwaitable=()=>new d(f("Diagnostic.typeNotAwaitable")),e.typeNotCallable=()=>new d(f("Diagnostic.typeNotCallable")),e.typeNotIntantiable=()=>new d(f("Diagnostic.typeNotIntantiable")),e.typeNotIterable=()=>new d(f("Diagnostic.typeNotIterable")),e.typeNotSpecializable=()=>new d(f("Diagnostic.typeNotSpecializable")),e.typeNotSubscriptable=()=>new d(f("Diagnostic.typeNotSubscriptable")),e.typeNotUsableWith=()=>new d(f("Diagnostic.typeNotUsableWith")),e.typeNotSupportBinaryOperator=()=>new d(f("Diagnostic.typeNotSupportBinaryOperator")),e.typeNotSupportUnaryOperator=()=>new d(f("Diagnostic.typeNotSupportUnaryOperator")),e.typePartiallyUnknown=()=>new d(f("Diagnostic.typePartiallyUnknown")),e.typeUnknown=()=>new d(f("Diagnostic.typeUnknown")),e.typeVarAssignedName=()=>new d(f("Diagnostic.typeVarAssignedName")),e.typeVarAssignmentMismatch=()=>new d(f("Diagnostic.typeVarAssignmentMismatch")),e.typeVarBoundAndConstrained=()=>f("Diagnostic.typeVarBoundAndConstrained"),e.typeVarFirstArg=()=>f("Diagnostic.typeVarFirstArg"),e.typeVarGeneric=()=>f("Diagnostic.typeVarGeneric"),e.typeVarNotUsedByOuterScope=()=>new d(f("Diagnostic.typeVarNotUsedByOuterScope")),e.typeVarSingleConstraint=()=>f("Diagnostic.typeVarSingleConstraint"),e.typeVarUnknownParam=()=>new d(f("Diagnostic.typeVarUnknownParam")),e.typeVarUsedByOuterScope=()=>new d(f("Diagnostic.typeVarUsedByOuterScope")),e.typeVarVariance=()=>f("Diagnostic.typeVarVariance"),e.unaccessedClass=()=>new d(f("Diagnostic.unaccessedClass")),e.unaccessedFunction=()=>new d(f("Diagnostic.unaccessedFunction")),e.unaccessedImport=()=>new d(f("Diagnostic.unaccessedImport")),e.unaccessedSymbol=()=>new d(f("Diagnostic.unaccessedSymbol")),e.unaccessedVariable=()=>new d(f("Diagnostic.unaccessedVariable")),e.unexpectedAsyncToken=()=>f("Diagnostic.unexpectedAsyncToken"),e.unexpectedExprToken=()=>f("Diagnostic.unexpectedExprToken"),e.unexpectedIndent=()=>f("Diagnostic.unexpectedIndent"),e.unexpectedUnindent=()=>f("Diagnostic.unexpectedUnindent"),e.unionSyntaxIllegal=()=>f("Diagnostic.unionSyntaxIllegal"),e.unnecessaryCast=()=>new d(f("Diagnostic.unnecessaryCast")),e.unnecessaryIsInstanceNever=()=>new d(f("Diagnostic.unnecessaryIsInstanceNever")),e.unnecessaryIsInstanceAlways=()=>new d(f("Diagnostic.unnecessaryIsInstanceAlways")),e.unnecessaryIsSubclassAlways=()=>new d(f("Diagnostic.unnecessaryIsSubclassAlways")),e.unnecessaryIsSubclassNever=()=>new d(f("Diagnostic.unnecessaryIsSubclassNever")),e.unpackIllegalInComprehension=()=>f("Diagnostic.unpackIllegalInComprehension"),e.unpackInDict=()=>f("Diagnostic.unpackInDict"),e.unpackInSet=()=>f("Diagnostic.unpackInSet"),e.unpackTuplesIllegal=()=>f("Diagnostic.unpackTuplesIllegal"),e.unreachableCode=()=>f("Diagnostic.unreachableCode"),e.varAnnotationIllegal=()=>f("Diagnostic.varAnnotationIllegal"),e.walrusIllegal=()=>f("Diagnostic.walrusIllegal"),e.walrusNotAllowed=()=>f("Diagnostic.walrusNotAllowed"),e.wildcardInFunction=()=>f("Diagnostic.wildcardInFunction"),e.wildcardLibraryImport=()=>f("Diagnostic.wildcardLibraryImport"),e.yieldFromIllegal=()=>f("Diagnostic.yieldFromIllegal"),e.yieldFromOutsideAsync=()=>f("Diagnostic.yieldFromOutsideAsync"),e.yieldOutsideFunction=()=>f("Diagnostic.yieldOutsideFunction"),e.yieldTypeMismatch=()=>new d(f("Diagnostic.yieldTypeMismatch"))}(t=e.Diagnostic||(e.Diagnostic={})),function(e){e.argParam=()=>new d(f("DiagnosticAddendum.argParam")),e.argParamFunction=()=>new d(f("DiagnosticAddendum.argParamFunction")),e.argsParamMissing=()=>new d(f("DiagnosticAddendum.argsParamMissing")),e.argumentType=()=>new d(f("DiagnosticAddendum.argumentType")),e.argumentTypes=()=>new d(f("DiagnosticAddendum.argumentTypes")),e.assignToNone=()=>f("DiagnosticAddendum.assignToNone"),e.asyncHelp=()=>f("DiagnosticAddendum.asyncHelp"),e.finalMethod=()=>f("DiagnosticAddendum.finalMethod"),e.functionReturnTypeMismatch=()=>new d(f("DiagnosticAddendum.functionReturnTypeMismatch")),e.functionTooFewParams=()=>new d(f("DiagnosticAddendum.functionTooFewParams")),e.functionTooManyParams=()=>new d(f("DiagnosticAddendum.functionTooManyParams")),e.keyUndefined=()=>new d(f("DiagnosticAddendum.keyUndefined")),e.literalAssignmentMismatch=()=>new d(f("DiagnosticAddendum.literalAssignmentMismatch")),e.memberAssignment=()=>new d(f("DiagnosticAddendum.memberAssignment")),e.memberIsAbstract=()=>new d(f("DiagnosticAddendum.memberIsAbstract")),e.memberIsAbstractMore=()=>new d(f("DiagnosticAddendum.memberIsAbstractMore")),e.memberSetClassVar=()=>new d(f("DiagnosticAddendum.memberSetClassVar")),e.memberTypeMismatch=()=>new d(f("DiagnosticAddendum.memberTypeMismatch")),e.memberUnknown=()=>new d(f("DiagnosticAddendum.memberUnknown")),e.namedParamMissingInDest=()=>new d(f("DiagnosticAddendum.namedParamMissingInDest")),e.namedParamMissingInSource=()=>new d(f("DiagnosticAddendum.namedParamMissingInSource")),e.namedParamTypeMismatch=()=>new d(f("DiagnosticAddendum.namedParamTypeMismatch")),e.noOverloadAssignable=()=>new d(f("DiagnosticAddendum.noOverloadAssignable")),e.overloadCallName=()=>new d(f("DiagnosticAddendum.overloadCallName")),e.overloadNotAssignable=()=>new d(f("DiagnosticAddendum.overloadNotAssignable")),e.overriddenMethod=()=>f("DiagnosticAddendum.overriddenMethod"),e.overriddenSymbol=()=>f("DiagnosticAddendum.overriddenSymbol"),e.overrideParamCount=()=>new d(f("DiagnosticAddendum.overrideParamCount")),e.overrideParamName=()=>new d(f("DiagnosticAddendum.overrideParamName")),e.overrideParamType=()=>new d(f("DiagnosticAddendum.overrideParamType")),e.overrideReturnType=()=>new d(f("DiagnosticAddendum.overrideReturnType")),e.overrideType=()=>new d(f("DiagnosticAddendum.overrideType")),e.paramAssignment=()=>new d(f("DiagnosticAddendum.paramAssignment")),e.paramType=()=>new d(f("DiagnosticAddendum.paramType")),e.propertyMissingDeleter=()=>new d(f("DiagnosticAddendum.propertyMissingDeleter")),e.propertyMissingSetter=()=>new d(f("DiagnosticAddendum.propertyMissingSetter")),e.protocolMemberClassVar=()=>new d(f("DiagnosticAddendum.protocolMemberClassVar")),e.protocolMemberMissing=()=>new d(f("DiagnosticAddendum.protocolMemberMissing")),e.seeDeclaration=()=>f("DiagnosticAddendum.seeDeclaration"),e.seeClassDeclaration=()=>f("DiagnosticAddendum.seeClassDeclaration"),e.seeFunctionDeclaration=()=>f("DiagnosticAddendum.seeFunctionDeclaration"),e.seeMethodDeclaration=()=>f("DiagnosticAddendum.seeMethodDeclaration"),e.seeParameterDeclaration=()=>f("DiagnosticAddendum.seeParameterDeclaration"),e.seeVariableDeclaration=()=>f("DiagnosticAddendum.seeVariableDeclaration"),e.tupleEntryTypeMismatch=()=>new d(f("DiagnosticAddendum.tupleEntryTypeMismatch")),e.tupleSizeMismatch=()=>new d(f("DiagnosticAddendum.tupleSizeMismatch")),e.typeAssignmentMismatch=()=>new d(f("DiagnosticAddendum.typeAssignmentMismatch")),e.typeBound=()=>new d(f("DiagnosticAddendum.typeBound")),e.typeConstrainedTypeVar=()=>new d(f("DiagnosticAddendum.typeConstrainedTypeVar")),e.typeConstraint=()=>new d(f("DiagnosticAddendum.typeConstraint")),e.typedDictFieldMissing=()=>new d(f("DiagnosticAddendum.typedDictFieldMissing")),e.typedDictFieldNotRequired=()=>new d(f("DiagnosticAddendum.typedDictFieldNotRequired")),e.typedDictFieldRequired=()=>new d(f("DiagnosticAddendum.typedDictFieldRequired")),e.typedDictFieldTypeMismatch=()=>new d(f("DiagnosticAddendum.typedDictFieldTypeMismatch")),e.typedDictFieldUndefined=()=>new d(f("DiagnosticAddendum.typedDictFieldUndefined")),e.typeIncompatible=()=>new d(f("DiagnosticAddendum.typeIncompatible")),e.typeNotCallable=()=>new d(f("DiagnosticAddendum.typeNotCallable")),e.typeNotClass=()=>new d(f("DiagnosticAddendum.typeNotClass")),e.typeParamSpec=()=>new d(f("DiagnosticAddendum.typeParamSpec")),e.typeNotStringLiteral=()=>new d(f("DiagnosticAddendum.typeNotStringLiteral")),e.typeOfSymbol=()=>new d(f("DiagnosticAddendum.typeOfSymbol")),e.typeUnsupported=()=>new d(f("DiagnosticAddendum.typeUnsupported")),e.typeVarIsContravariant=()=>new d(f("DiagnosticAddendum.typeVarIsContravariant")),e.typeVarIsCovariant=()=>new d(f("DiagnosticAddendum.typeVarIsCovariant")),e.typeVarIsInvariant=()=>new d(f("DiagnosticAddendum.typeVarIsInvariant")),e.typeVarNotAllowed=()=>f("DiagnosticAddendum.typeVarNotAllowed"),e.useDictInstead=()=>f("DiagnosticAddendum.useDictInstead"),e.useListInstead=()=>f("DiagnosticAddendum.useListInstead"),e.useTupleInstead=()=>f("DiagnosticAddendum.useTupleInstead"),e.useTypeInstead=()=>f("DiagnosticAddendum.useTypeInstead")}(n=e.DiagnosticAddendum||(e.DiagnosticAddendum={})),function(e){e.addOptionalToAnnotation=()=>f("CodeAction.addOptionalToAnnotation"),e.createTypeStub=()=>f("CodeAction.createTypeStub"),e.createTypeStubFor=()=>new d(f("CodeAction.createTypeStubFor")),e.executingCommand=()=>f("CodeAction.executingCommand"),e.filesToAnalyzeOne=()=>f("CodeAction.filesToAnalyzeOne"),e.filesToAnalyzeCount=()=>new d(f("CodeAction.filesToAnalyzeCount")),e.findingReferences=()=>f("CodeAction.findingReferences"),e.organizeImports=()=>f("CodeAction.organizeImports")}(s=e.CodeAction||(e.CodeAction={}))}(t.Localizer||(t.Localizer={}))},9671:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterStream=void 0;const s=n(6956);t.CharacterStream=class{constructor(e){this._text=e,this._position=0,this._currentChar=e.length>0?e.charCodeAt(0):0,this._isEndOfStream=0===e.length}getText(){return this._text}get position(){return this._position}set position(e){this._position=e,this._checkBounds()}get currentChar(){return this._currentChar}getCurrentChar(){return this._currentChar}get nextChar(){return this.position+1<this._text.length?this._text.charCodeAt(this.position+1):0}get prevChar(){return this.position-1>=0?this._text.charCodeAt(this.position-1):0}isEndOfStream(){return this._isEndOfStream}lookAhead(e){const t=this._position+e;return t<0||t>=this._text.length?0:this._text.charCodeAt(t)}advance(e){this.position+=e}moveNext(){return this._position<this._text.length-1?(this._position+=1,this._currentChar=this._text.charCodeAt(this._position),!0):(this.advance(1),!this.isEndOfStream())}isAtWhiteSpace(){return s.isWhiteSpace(this.currentChar)}isAtLineBreak(){return s.isLineBreak(this.currentChar)}skipLineBreak(){13===this._currentChar?(this.moveNext(),10===this.currentChar&&this.moveNext()):10===this._currentChar&&this.moveNext()}skipWhitespace(){for(;!this.isEndOfStream()&&this.isAtWhiteSpace();)this.moveNext()}skipToEol(){for(;!this.isEndOfStream()&&!this.isAtLineBreak();)this.moveNext()}skipToWhitespace(){for(;!this.isEndOfStream()&&!this.isAtWhiteSpace();)this.moveNext()}charCodeAt(e){return this._text.charCodeAt(e)}get length(){return this._text.length}_checkBounds(){this._position<0&&(this._position=0),this._isEndOfStream=this._position>=this._text.length,this._isEndOfStream&&(this._position=this._text.length),this._currentChar=this._isEndOfStream?0:this._text.charCodeAt(this._position)}}},6956:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isBinary=t.isOctal=t.isHex=t.isDecimal=t.isNumber=t.isLineBreak=t.isWhiteSpace=t.isIdentifierChar=t.isIdentifierStartChar=void 0;const o=r(n(7770));var a;!function(e){e[e.NotIdentifierChar=0]="NotIdentifierChar",e[e.StartIdentifierChar=1]="StartIdentifierChar",e[e.IdentifierChar=2]="IdentifierChar"}(a||(a={}));const l=256,c=new Array(l),p={};let u=!1;function d(e){return e>=48&&e<=57||95===e}t.isIdentifierStartChar=function(e){return e<l?c[e]===a.StartIdentifierChar:(u||(g(!1),u=!0),p[e]===a.StartIdentifierChar)},t.isIdentifierChar=function(e){return e<l?c[e]===a.StartIdentifierChar||c[e]===a.IdentifierChar:p[e]===a.StartIdentifierChar||p[e]===a.IdentifierChar},t.isWhiteSpace=function(e){return 32===e||9===e||12===e},t.isLineBreak=function(e){return 13===e||10===e},t.isNumber=function(e){return e>=48&&e<=57||95===e},t.isDecimal=d,t.isHex=function(e){return d(e)||e>=97&&e<=102||e>=65&&e<=70||95===e},t.isOctal=function(e){return e>=48&&e<=55||95===e},t.isBinary=function(e){return 48===e||49===e||95===e};const h=[[95,6277,6278,8472,8494,12443,12444],o.unicodeLu,o.unicodeLl,o.unicodeLt,o.unicodeLo,o.unicodeLm,o.unicodeNl],m=[[183,903,4969,4970,4971,4972,4973,4974,4975,4976,4977,6618],o.unicodeMn,o.unicodeMc,o.unicodeNd,o.unicodePc];function y(e,t,n){for(let s=0;s<e.length;s++){const i=e[s];let r,o;Array.isArray(i)?(r=i[0],o=i[1]):r=o=i;for(let e=r;e<=o;e++)e<l?c[e]=t:p[e]=t;if(n&&r>=l)break}}function g(e){c.fill(a.NotIdentifierChar),m.forEach(t=>{y(t,a.IdentifierChar,e)}),h.forEach(t=>{y(t,a.StartIdentifierChar,e)})}g(!0)},5275:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RaiseNode=t.ReturnNode=t.ContinueNode=t.BreakNode=t.AssertNode=t.NonlocalNode=t.GlobalNode=t.ImportFromAsNode=t.ImportFromNode=t.ImportAsNode=t.ModuleNameNode=t.ImportNode=t.PassNode=t.DelNode=t.ArgumentNode=t.ListNode=t.SetNode=t.DictionaryExpandEntryNode=t.DictionaryKeyEntryNode=t.DictionaryNode=t.StringListNode=t.FormatStringNode=t.StringNode=t.NumberNode=t.EllipsisNode=t.ConstantNode=t.NameNode=t.LambdaNode=t.MemberAccessNode=t.YieldFromNode=t.YieldNode=t.SliceNode=t.IndexNode=t.IndexItemsNode=t.ListComprehensionNode=t.CallNode=t.TupleNode=t.UnpackNode=t.TernaryNode=t.AwaitNode=t.AugmentedAssignmentNode=t.FunctionAnnotationNode=t.TypeAnnotationNode=t.AssignmentNode=t.AssignmentExpressionNode=t.BinaryOperationNode=t.UnaryOperationNode=t.ErrorNode=t.isExpressionNode=t.StatementListNode=t.DecoratorNode=t.WithItemNode=t.WithNode=t.ClassNode=t.ParameterNode=t.FunctionNode=t.ExceptNode=t.TryNode=t.ListComprehensionIfNode=t.ListComprehensionForNode=t.ForNode=t.WhileNode=t.IfNode=t.SuiteNode=t.ModuleNode=t.extendRange=t.getNextNodeId=void 0;const s=n(3550);let i=1;function r(e,t){t.start<e.start&&(e.length+=e.start-t.start,e.start=t.start),s.TextRange.getEnd(t)>s.TextRange.getEnd(e)&&(e.length=s.TextRange.getEnd(t)-e.start)}var o;t.getNextNodeId=function(){return i++},t.extendRange=r,(t.ModuleNode||(t.ModuleNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:37,id:i++,statements:[]}},(t.SuiteNode||(t.SuiteNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:51,id:i++,statements:[]}},(t.IfNode||(t.IfNode={})).create=function(e,t,n,s){const o={start:e.start,length:e.length,nodeType:19,id:i++,testExpression:t,ifSuite:n,elseSuite:s};return t.parent=o,n.parent=o,r(o,t),r(o,n),s&&(r(o,s),s.parent=o),o},(t.WhileNode||(t.WhileNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:58,id:i++,testExpression:t,whileSuite:n};return t.parent=s,n.parent=s,r(s,n),s},(t.ForNode||(t.ForNode={})).create=function(e,t,n,s){const o={start:e.start,length:e.length,nodeType:27,id:i++,targetExpression:t,iterableExpression:n,forSuite:s};return t.parent=o,n.parent=o,s.parent=o,r(o,s),o},(t.ListComprehensionForNode||(t.ListComprehensionForNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:34,id:i++,targetExpression:t,iterableExpression:n};return t.parent=s,n.parent=s,r(s,t),r(s,n),s},(t.ListComprehensionIfNode||(t.ListComprehensionIfNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:35,id:i++,testExpression:t};return t.parent=n,r(n,t),n},(t.TryNode||(t.TryNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:54,id:i++,trySuite:t,exceptClauses:[]};return t.parent=n,r(n,t),n},(t.ExceptNode||(t.ExceptNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:26,id:i++,exceptSuite:t};return t.parent=n,r(n,t),n},(t.FunctionNode||(t.FunctionNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:29,id:i++,decorators:[],name:t,parameters:[],suite:n};return t.parent=s,n.parent=s,r(s,n),s},(t.ParameterNode||(t.ParameterNode={})).create=function(e,t){return{start:e.start,length:e.length,nodeType:42,id:i++,category:t}},(o=t.ClassNode||(t.ClassNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:10,id:i++,decorators:[],name:t,arguments:[],suite:n};return t.parent=s,n.parent=s,r(s,n),s},o.createDummyForDecorators=function(e){const t={start:0,length:0,nodeType:10,id:i++,decorators:e,name:{start:0,length:0,id:0,nodeType:39,token:{type:7,start:0,length:0,comments:[],value:""},value:""},arguments:[],suite:{start:0,length:0,id:0,nodeType:51,statements:[]}};return e.forEach(e=>{e.parent=t,r(t,e)}),t.name.parent=t,t.suite.parent=t,t},(t.WithNode||(t.WithNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:59,id:i++,withItems:[],suite:t};return t.parent=n,r(n,t),n},(t.WithItemNode||(t.WithItemNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:60,id:i++,expression:e};return e.parent=t,t},(t.DecoratorNode||(t.DecoratorNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:13,id:i++,expression:t};return t.parent=n,r(n,t),n},(t.StatementListNode||(t.StatementListNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:48,id:i++,statements:[]}},t.isExpressionNode=function(e){switch(e.nodeType){case 0:case 56:case 7:case 4:case 55:case 6:case 52:case 57:case 53:case 9:case 33:case 24:case 47:case 61:case 62:case 36:case 31:case 39:case 11:case 18:case 41:case 50:case 28:case 49:case 15:case 16:case 32:case 46:return!0;default:return!1}},(t.ErrorNode||(t.ErrorNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:0,id:i++,category:t,child:n};return n&&(n.parent=s,r(s,n)),s},(t.UnaryOperationNode||(t.UnaryOperationNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:56,id:i++,operator:n,operatorToken:e,expression:t};return t.parent=s,r(s,t),s},(t.BinaryOperationNode||(t.BinaryOperationNode={})).create=function(e,t,n,s){const o={start:e.start,length:e.length,nodeType:7,id:i++,leftExpression:e,operatorToken:n,operator:s,rightExpression:t};return e.parent=o,t.parent=o,r(o,t),o},(t.AssignmentExpressionNode||(t.AssignmentExpressionNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:4,id:i++,name:e,rightExpression:t};return e.parent=n,t.parent=n,r(n,t),n},(t.AssignmentNode||(t.AssignmentNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:3,id:i++,leftExpression:e,rightExpression:t};return e.parent=n,t.parent=n,r(n,t),n},(t.TypeAnnotationNode||(t.TypeAnnotationNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:55,id:i++,valueExpression:e,typeAnnotation:t};return e.parent=n,t.parent=n,r(n,t),n},(t.FunctionAnnotationNode||(t.FunctionAnnotationNode={})).create=function(e,t,n,s){const o={start:e.start,length:e.length,nodeType:63,id:i++,isParamListEllipsis:t,paramTypeAnnotations:n,returnTypeAnnotation:s};return n.forEach(e=>{e.parent=o}),s.parent=o,r(o,s),o},(t.AugmentedAssignmentNode||(t.AugmentedAssignmentNode={})).create=function(e,t,n,s){const o={start:e.start,length:e.length,nodeType:5,id:i++,leftExpression:e,operator:n,rightExpression:t,destExpression:s};return e.parent=o,t.parent=o,s.parent=o,r(o,t),o},(t.AwaitNode||(t.AwaitNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:6,id:i++,expression:t};return t.parent=n,r(n,t),n},(t.TernaryNode||(t.TernaryNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:52,id:i++,ifExpression:e,testExpression:t,elseExpression:n};return e.parent=s,t.parent=s,n.parent=s,r(s,n),s},(t.UnpackNode||(t.UnpackNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:57,id:i++,expression:t};return t.parent=n,r(n,t),n},(t.TupleNode||(t.TupleNode={})).create=function(e,t){return{start:e.start,length:e.length,nodeType:53,id:i++,expressions:[],enclosedInParens:t}},(t.CallNode||(t.CallNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:9,id:i++,leftExpression:e,arguments:[]};return e.parent=t,t},(t.ListComprehensionNode||(t.ListComprehensionNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:33,id:i++,expression:e,comprehensions:[]};return e.parent=t,t},(t.IndexItemsNode||(t.IndexItemsNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:25,id:i++,items:n};return n.forEach(e=>{e.parent=s}),r(s,t),s},(t.IndexNode||(t.IndexNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:24,id:i++,baseExpression:e,items:t};return e.parent=n,t.parent=n,r(n,t),n},(t.SliceNode||(t.SliceNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:47,id:i++}},(t.YieldNode||(t.YieldNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:61,id:i++,expression:t};return t&&(t.parent=n,r(n,t)),n},(t.YieldFromNode||(t.YieldFromNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:62,id:i++,expression:t};return t.parent=n,r(n,t),n},(t.MemberAccessNode||(t.MemberAccessNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:36,id:i++,leftExpression:e,memberName:t};return e.parent=n,t.parent=n,r(n,t),n},(t.LambdaNode||(t.LambdaNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:31,id:i++,parameters:[],expression:t};return t.parent=n,r(n,t),n},(t.NameNode||(t.NameNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:39,id:i++,token:e,value:e.value}},(t.ConstantNode||(t.ConstantNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:11,id:i++,constType:e.keywordType}},(t.EllipsisNode||(t.EllipsisNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:18,id:i++}},(t.NumberNode||(t.NumberNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:41,id:i++,value:e.value,isInteger:e.isInteger,isImaginary:e.isImaginary}},(t.StringNode||(t.StringNode={})).create=function(e,t,n){return{start:e.start,length:e.length,nodeType:50,id:i++,token:e,value:t,hasUnescapeErrors:n}},(t.FormatStringNode||(t.FormatStringNode={})).create=function(e,t,n,s){const r={start:e.start,length:e.length,nodeType:28,id:i++,token:e,value:t,hasUnescapeErrors:n,expressions:s};return s.forEach(e=>{e.parent=r}),r},(t.StringListNode||(t.StringListNode={})).create=function(e){const t={start:e[0].start,length:e[0].length,nodeType:49,id:i++,strings:e};return e.length>0&&(e.forEach(e=>{e.parent=t}),r(t,e[e.length-1])),t},(t.DictionaryNode||(t.DictionaryNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:15,id:i++,entries:[]}},(t.DictionaryKeyEntryNode||(t.DictionaryKeyEntryNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:17,id:i++,keyExpression:e,valueExpression:t};return e.parent=n,t.parent=n,r(n,t),n},(t.DictionaryExpandEntryNode||(t.DictionaryExpandEntryNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:16,id:i++,expandExpression:e};return e.parent=t,t},(t.SetNode||(t.SetNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:46,id:i++,entries:[]}},(t.ListNode||(t.ListNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:32,id:i++,entries:[]}},(t.ArgumentNode||(t.ArgumentNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:1,id:i++,valueExpression:t,argumentCategory:n};return t.parent=s,r(s,t),s},(t.DelNode||(t.DelNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:14,id:i++,expressions:[]}},(t.PassNode||(t.PassNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:43,id:i++}},(t.ImportNode||(t.ImportNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:20,id:i++,list:[]}},(t.ModuleNameNode||(t.ModuleNameNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:38,id:i++,leadingDots:0,nameParts:[]}},(t.ImportAsNode||(t.ImportAsNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:21,id:i++,module:e};return e.parent=t,t},(t.ImportFromNode||(t.ImportFromNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:22,id:i++,module:t,imports:[],isWildcardImport:!1,usesParens:!1};return t.parent=n,r(n,t),n},(t.ImportFromAsNode||(t.ImportFromAsNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:23,id:i++,name:e};return e.parent=t,t},(t.GlobalNode||(t.GlobalNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:30,id:i++,nameList:[]}},(t.NonlocalNode||(t.NonlocalNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:40,id:i++,nameList:[]}},(t.AssertNode||(t.AssertNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:2,id:i++,testExpression:t};return t.parent=n,r(n,t),n},(t.BreakNode||(t.BreakNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:8,id:i++}},(t.ContinueNode||(t.ContinueNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:12,id:i++}},(t.ReturnNode||(t.ReturnNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:45,id:i++}},(t.RaiseNode||(t.RaiseNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:44,id:i++}}},5303:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=t.ParseOptions=void 0;const o=n(5839),a=n(1290),l=n(3980),c=n(1464),p=n(6886),u=n(8718),d=n(2122),h=n(5275),m=r(n(5136)),y=n(7093),g=n(6180);class f{constructor(){this.isStubFile=!1,this.pythonVersion=p.latestStablePythonVersion,this.reportInvalidStringEscapeSequence=!1}}t.ParseOptions=f;class _{constructor(){this._tokenIndex=0,this._parseOptions=new f,this._diagSink=new l.DiagnosticSink,this._isInLoop=!1,this._isInFunction=!1,this._isInFinally=!1,this._isParsingTypeAnnotation=!1,this._isParsingIndexTrailer=!1,this._futureImportMap=new Map,this._importedModules=[],this._containsWildcardImport=!1,this._assignmentExpressionsAllowed=!0,this._typingImportAliases=[],this._typingSymbolAliases=new Map}parseSourceFile(e,t,n){u.timingStats.tokenizeFileTime.timeOperation(()=>{this._startNewParse(e,0,e.length,t,n)});const s=h.ModuleNode.create({start:0,length:e.length});return u.timingStats.parseFileTime.timeOperation(()=>{for(;!this._atEof();)if(!this._consumeTokenIfType(2)){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError(d.Localizer.Diagnostic.inconsistentTabs(),t):this._addError(d.Localizer.Diagnostic.unexpectedIndent(),e)}const t=this._parseStatement();t?(t.parent=s,s.statements.push(t)):this._consumeTokensUntilType([2])}}),o.assert(void 0!==this._tokenizerOutput),{text:e,parseTree:s,importedModules:this._importedModules,futureImports:this._futureImportMap,tokenizerOutput:this._tokenizerOutput,containsWildcardImport:this._containsWildcardImport}}parseTextExpression(e,t,n,s,i=0,r=0){const o=new l.DiagnosticSink;let a;return this._startNewParse(e,t,n,s,o,r),a=1===i?this._parseTypeAnnotation(!1):2===i?this._parseFunctionTypeAnnotation():this._parseTestExpression(!1),2===this._peekTokenType()&&this._getNextToken(),this._atEof()||this._addError(d.Localizer.Diagnostic.unexpectedExprToken(),this._peekToken()),{parseTree:a,lines:this._tokenizerOutput.lines,diagnostics:o.fetchAndClear()}}_startNewParse(e,t,n,s,i,r=0){this._fileContents=e,this._parseOptions=s,this._diagSink=i;const o=new y.Tokenizer;this._tokenizerOutput=o.tokenize(e,t,n,r),this._tokenIndex=0}_parseStatement(){switch(this._consumeTokenIfType(4)&&this._addError(d.Localizer.Diagnostic.unexpectedUnindent(),this._peekToken()),this._peekKeywordType()){case 19:return this._parseIfStatement();case 33:return this._parseWhileStatement();case 16:return this._parseForStatement();case 32:return this._parseTryStatement();case 34:return this._parseWithStatement();case 9:return this._parseFunctionDef();case 6:return this._parseClassDef();case 3:return this._parseAsyncStatement()}return 22===this._peekOperatorType()?this._parseDecorated():this._parseSimpleStatement()}_parseAsyncStatement(){const e=this._getKeywordToken(3);switch(this._peekKeywordType()){case 9:return this._parseFunctionDef(e);case 34:return this._parseWithStatement(e);case 16:return this._parseForStatement(e)}this._addError(d.Localizer.Diagnostic.unexpectedAsyncToken(),e)}_parseIfStatement(e=19){const t=this._getKeywordToken(e),n=this._parseTestExpression(!0),s=this._parseSuite(this._isInFunction),i=h.IfNode.create(t,n,s);return this._consumeTokenIfKeyword(12)?(i.elseSuite=this._parseSuite(this._isInFunction),i.elseSuite.parent=i,h.extendRange(i,i.elseSuite)):11===this._peekKeywordType()&&(i.elseSuite=this._parseIfStatement(11),i.elseSuite.parent=i,h.extendRange(i,i.elseSuite)),i}_parseLoopSuite(){const e=this._isInLoop,t=this._isInFinally;this._isInLoop=!0,this._isInFinally=!1;const n=this._parseSuite(this._isInFunction);return this._isInLoop=e,this._isInFinally=t,n}_parseSuite(e=!1,t){const n=this._peekToken(),s=h.SuiteNode.create(n);this._consumeTokenIfType(10)||(this._addError(d.Localizer.Diagnostic.expectedColon(),n),this._consumeTokensUntilType([2,10])&&this._getNextToken()),t&&t();const i=this._isInFunction;if(this._isInFunction=e,this._consumeTokenIfType(2)){t&&t();const e=this._peekToken();if(this._consumeTokenIfType(3)){const t=e;t.isIndentAmbiguous&&this._addError(d.Localizer.Diagnostic.inconsistentTabs(),t)}else this._addError(d.Localizer.Diagnostic.expectedIndentedBlock(),this._peekToken());for(;;){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError(d.Localizer.Diagnostic.inconsistentTabs(),t):this._addError(d.Localizer.Diagnostic.unexpectedIndent(),e)}const t=this._parseStatement();t?(t.parent=s,s.statements.push(t)):this._consumeTokensUntilType([2]);const n=this._peekToken();if(this._consumeTokenIfType(4)){n.matchesIndent||this._addError(d.Localizer.Diagnostic.inconsistentIndent(),n);break}if(1===this._peekTokenType())break}}else{const e=this._parseSimpleStatement();s.statements.push(e),e.parent=s}return s.statements.length>0&&h.extendRange(s,s.statements[s.statements.length-1]),this._isInFunction=i,s}_parseForStatement(e){const t=this._getKeywordToken(16),n=this._parseExpressionList(!0),s=this._makeExpressionOrTuple(n,!1);let i,r,o;this._consumeTokenIfKeyword(21)?(i=this._parseTestListAsExpression(2,d.Localizer.Diagnostic.expectedInExpr()),r=this._parseLoopSuite(),this._consumeTokenIfKeyword(12)&&(o=this._parseSuite(this._isInFunction))):(i=this._handleExpressionParseError(0,d.Localizer.Diagnostic.expectedIn()),r=h.SuiteNode.create(this._peekToken()));const a=h.ForNode.create(t,s,i,r);return a.elseSuite=o,o&&(h.extendRange(a,o),o.parent=a),e&&(a.isAsync=!0,h.extendRange(a,e)),a}_tryParseListComprehension(e){const t=this._tryParseCompForStatement();if(!t)return;57===e.nodeType?this._addError(d.Localizer.Diagnostic.unpackIllegalInComprehension(),e):16===e.nodeType&&this._addError(d.Localizer.Diagnostic.dictExpandIllegalInComprehension(),e);const n=h.ListComprehensionNode.create(e),s=[t];for(;;){const e=this._tryParseCompForStatement()||this._tryParseCompIfStatement();if(!e)break;e.parent=n,s.push(e)}return n.comprehensions=s,s.length>0&&(s.forEach(e=>{e.parent=n}),h.extendRange(n,s[s.length-1])),n}_tryParseCompForStatement(){const e=this._peekKeywordType();if(3===e){const e=this._peekToken(1);if(8!==e.type||16!==e.keywordType)return}else if(16!==e)return;let t;3===this._peekKeywordType()&&(t=this._getKeywordToken(3));const n=this._getKeywordToken(16),s=this._parseExpressionList(!0),i=this._makeExpressionOrTuple(s,!1);let r;this._consumeTokenIfKeyword(21)?this._disallowAssignmentExpression(()=>{r=this._parseOrTest()}):r=this._handleExpressionParseError(0,d.Localizer.Diagnostic.expectedIn());const o=h.ListComprehensionForNode.create(t||n,i,r);return t&&(o.isAsync=!0),o}_tryParseCompIfStatement(){if(19!==this._peekKeywordType())return;const e=this._getKeywordToken(19),t=this._tryParseLambdaExpression()||this._parseAssignmentExpression();return h.ListComprehensionIfNode.create(e,t)}_parseWhileStatement(){const e=this._getKeywordToken(33),t=h.WhileNode.create(e,this._parseTestExpression(!0),this._parseLoopSuite());return this._consumeTokenIfKeyword(12)&&(t.elseSuite=this._parseSuite(this._isInFunction),t.elseSuite.parent=t,h.extendRange(t,t.elseSuite)),t}_parseTryStatement(){const e=this._getKeywordToken(32),t=this._parseSuite(this._isInFunction),n=h.TryNode.create(e,t);let s=!1;for(;;){const e=this._peekToken();if(!this._consumeTokenIfKeyword(13))break;let t,i;if(10!==this._peekTokenType())if(t=this._parseTestExpression(!0),this._consumeTokenIfKeyword(1))i=this._getTokenIfIdentifier(),i||this._addError(d.Localizer.Diagnostic.expectedNameAfterAs(),this._peekToken());else{const e=this._peekToken();this._consumeTokenIfType(12)&&(this._addError(d.Localizer.Diagnostic.expectedAsAfterException(),e),this._parseTestExpression(!1))}t?s&&this._addError(d.Localizer.Diagnostic.namedExceptAfterCatchAll(),t):(s&&this._addError(d.Localizer.Diagnostic.duplicateCatchAll(),e),s=!0);const r=this._parseSuite(this._isInFunction),o=h.ExceptNode.create(e,r);t&&(o.typeExpression=t,o.typeExpression.parent=o),i&&(o.name=h.NameNode.create(i),o.name.parent=o),n.exceptClauses.push(o),o.parent=n}return n.exceptClauses.length>0&&(h.extendRange(n,n.exceptClauses[n.exceptClauses.length-1]),this._consumeTokenIfKeyword(12)&&(n.elseSuite=this._parseSuite(this._isInFunction),n.elseSuite.parent=n,h.extendRange(n,n.elseSuite))),this._consumeTokenIfKeyword(15)&&(n.finallySuite=this._parseSuite(this._isInFunction),n.finallySuite.parent=n,h.extendRange(n,n.finallySuite)),n}_parseFunctionDef(e,t){const n=this._getKeywordToken(9),s=this._getTokenIfIdentifier();if(!s)return this._addError(d.Localizer.Diagnostic.expectedFunctionName(),n),h.ErrorNode.create(n,10);if(!this._consumeTokenIfType(13))return this._addError(d.Localizer.Diagnostic.expectedOpenParen(),this._peekToken()),h.ErrorNode.create(s,10,h.NameNode.create(s));const i=this._parseVarArgsList(14,!0);let r,o;this._consumeTokenIfType(14)||(this._addError(d.Localizer.Diagnostic.expectedCloseParen(),this._peekToken()),this._consumeTokensUntilType([10])),this._consumeTokenIfType(21)&&(r=this._parseTypeAnnotation());const a=this._parseSuite(!0,()=>{o||(o=this._getTypeAnnotationCommentText())}),l=h.FunctionNode.create(n,h.NameNode.create(s),a);return e&&(l.isAsync=!0,h.extendRange(l,e)),l.parameters=i,i.forEach(e=>{e.parent=l}),t&&(l.decorators=t,t.forEach(e=>{e.parent=l}),t.length>0&&h.extendRange(l,t[0])),r&&(l.returnTypeAnnotation=r,l.returnTypeAnnotation.parent=l,h.extendRange(l,r)),o&&this._parseFunctionTypeAnnotationComment(o,l),l}_parseVarArgsList(e,t){const n=new Map,s=[];let i=!1,r=!1,o=!1,a=!1,l=!1,c=!1;for(;this._peekTokenType()!==e;){const p=this._parseParameter(t);if(!p){this._consumeTokensUntilType([e]);break}if(p.name){const e=p.name.value;n.has(e)?this._addError(d.Localizer.Diagnostic.duplicateParam().format({name:e}),p.name):n.set(e,e)}else 0===p.category&&0===s.length&&this._addError(d.Localizer.Diagnostic.positionOnlyFirstParam(),p);0===p.category&&(p.name?p.defaultValue?i=!0:!i||o||l||r||(this._addError(d.Localizer.Diagnostic.nonDefaultAfterDefault(),p),r=!0):(a?this._addError(d.Localizer.Diagnostic.duplicatePositionOnly(),p):o&&this._addError(d.Localizer.Diagnostic.positionOnlyAfterNameOnly(),p),a=!0)),s.push(p),1===p.category&&(p.name?(l&&this._addError(d.Localizer.Diagnostic.duplicateArgsParam(),p),l=!0):(o&&this._addError(d.Localizer.Diagnostic.duplicateNameOnly(),p),o=!0)),2===p.category?(c&&this._addError(d.Localizer.Diagnostic.duplicateKwargsParam(),p),c=!0):c&&this._addError(d.Localizer.Diagnostic.paramAfterKwargsParam(),p);const u=this._consumeTokenIfType(12);if(t&&!p.typeAnnotation){const e=this._parseVariableTypeAnnotationComment();e&&(p.typeAnnotationComment=e,p.typeAnnotationComment.parent=p,h.extendRange(p,p.typeAnnotationComment))}if(!u)break}if(s.length>0){const e=s[s.length-1];1!==e.category||e.name||this._addError(d.Localizer.Diagnostic.expectedNamedArgument(),e)}return s}_parseParameter(e){let t=0,n=0;const s=this._peekToken();this._consumeTokenIfOperator(26)?t=1:this._consumeTokenIfOperator(29)?t=2:this._consumeTokenIfOperator(10)&&(this._getLanguageVersion()<p.PythonVersion.V3_8&&this._addError(d.Localizer.Diagnostic.positionOnlyIncompatible(),s),n=1);const i=this._getTokenIfIdentifier();if(!i){if(1===t)return h.ParameterNode.create(s,1);if(1===n)return h.ParameterNode.create(s,0);if(13===this._peekTokenType()){const e=this._getNextToken();this._consumeTokensUntilType([14])&&this._getNextToken(),this._addError(d.Localizer.Diagnostic.sublistParamsIncompatible(),e)}else this._addError(d.Localizer.Diagnostic.expectedParamName(),this._peekToken())}let r=0;1===t?r=1:2===t&&(r=2);const o=h.ParameterNode.create(s,r);return i&&(o.name=h.NameNode.create(i),o.name.parent=o,h.extendRange(o,i)),e&&this._consumeTokenIfType(10)&&(o.typeAnnotation=this._parseTypeAnnotation(),o.typeAnnotation.parent=o,h.extendRange(o,o.typeAnnotation)),this._consumeTokenIfOperator(2)&&(o.defaultValue=this._parseTestExpression(!1),o.defaultValue.parent=o,h.extendRange(o,o.defaultValue),t>0&&this._addError(d.Localizer.Diagnostic.defaultValueNotAllowed(),o.defaultValue)),o}_parseWithStatement(e){const t=this._getKeywordToken(34),n=[];for(;n.push(this._parseWithItem()),this._consumeTokenIfType(12););const s=this._parseSuite(this._isInFunction),i=h.WithNode.create(t,s);return e&&(i.isAsync=!0,h.extendRange(i,e)),i.withItems=n,n.forEach(e=>{e.parent=i}),i}_parseWithItem(){const e=this._parseTestExpression(!0),t=h.WithItemNode.create(e);return this._consumeTokenIfKeyword(1)&&(t.target=this._parseExpression(!1),t.target.parent=t,h.extendRange(t,t.target)),t}_parseDecorated(){const e=[];for(;22===this._peekOperatorType();)e.push(this._parseDecorator());const t=this._peekToken();if(8===t.type)if(3===t.keywordType){if(this._getNextToken(),9===this._peekKeywordType())return this._parseFunctionDef(t,e);this._addError(d.Localizer.Diagnostic.expectedFunctionAfterAsync(),this._peekToken())}else{if(9===t.keywordType)return this._parseFunctionDef(void 0,e);if(6===t.keywordType)return this._parseClassDef(e)}return this._addError(d.Localizer.Diagnostic.expectedAfterDecorator(),this._peekToken()),h.ClassNode.createDummyForDecorators(e)}_parseDecorator(){const e=this._getNextToken();o.assert(22===e.operatorType);const t=this._parseTestExpression(!0);if(this._getLanguageVersion()<p.PythonVersion.V3_9){let e=!1;(this._isNameOrMemberAccessExpression(t)||9===t.nodeType&&this._isNameOrMemberAccessExpression(t.leftExpression))&&(e=!0),e||this._addError(d.Localizer.Diagnostic.expectedDecoratorExpr(),t)}const n=h.DecoratorNode.create(e,t);return this._consumeTokenIfType(2)||(this._addError(d.Localizer.Diagnostic.expectedDecoratorNewline(),this._peekToken()),this._consumeTokensUntilType([2])),n}_isNameOrMemberAccessExpression(e){return 39===e.nodeType||36===e.nodeType&&this._isNameOrMemberAccessExpression(e.leftExpression)}_parseClassDef(e){const t=this._getKeywordToken(6);let n=this._getTokenIfIdentifier();n||(this._addError(d.Localizer.Diagnostic.expectedClassName(),this._peekToken()),n=g.IdentifierToken.create(0,0,"",void 0));let s=[];this._consumeTokenIfType(13)&&(s=this._parseArgList(),this._consumeTokenIfType(14)||this._addError(d.Localizer.Diagnostic.expectedCloseParen(),this._peekToken()));const i=this._parseSuite(!1),r=h.ClassNode.create(t,h.NameNode.create(n),i);return r.arguments=s,s.forEach(e=>{e.parent=r}),e&&(r.decorators=e,e.length>0&&(e.forEach(e=>{e.parent=r}),h.extendRange(r,e[0]))),r}_parsePassStatement(){return h.PassNode.create(this._getKeywordToken(28))}_parseBreakStatement(){const e=this._getKeywordToken(5);return this._isInLoop||this._addError(d.Localizer.Diagnostic.breakOutsideLoop(),e),h.BreakNode.create(e)}_parseContinueStatement(){const e=this._getKeywordToken(7);return this._isInLoop?this._isInFinally&&this._addError(d.Localizer.Diagnostic.continueInFinally(),e):this._addError(d.Localizer.Diagnostic.continueOutsideLoop(),e),h.ContinueNode.create(e)}_parseReturnStatement(){const e=this._getKeywordToken(30),t=h.ReturnNode.create(e);if(this._isInFunction||this._addError(d.Localizer.Diagnostic.returnOutsideFunction(),e),!this._isNextTokenNeverExpression()){const e=this._parseTestOrStarListAsExpression(!0,2,d.Localizer.Diagnostic.expectedReturnExpr());this._reportConditionalErrorForStarTupleElement(e),t.returnExpression=e,t.returnExpression.parent=t,h.extendRange(t,e)}return t}_parseFromStatement(){const e=this._getKeywordToken(17),t=this._parseDottedModuleName(!0),n=h.ImportFromNode.create(e,t),s=0===t.leadingDots&&1===t.nameParts.length&&"__future__"===t.nameParts[0].value,i=this._peekToken();if(this._consumeTokenIfKeyword(20)){h.extendRange(n,i);const e=this._peekToken();if(this._consumeTokenIfOperator(26))h.extendRange(n,e),n.isWildcardImport=!0,n.wildcardToken=e,this._containsWildcardImport=!0;else{const e=this._consumeTokenIfType(13);for(;;){const e=this._getTokenIfIdentifier();if(!e)break;const t=h.ImportFromAsNode.create(h.NameNode.create(e));if(this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?(t.alias=h.NameNode.create(e),t.alias.parent=t,h.extendRange(t,e)):this._addError(d.Localizer.Diagnostic.expectedImportAlias(),this._peekToken())}if(n.imports.push(t),t.parent=n,h.extendRange(n,t),s&&this._futureImportMap.set(e.value,!0),!this._consumeTokenIfType(12))break}if(0===n.imports.length&&this._addError(d.Localizer.Diagnostic.expectedImportSymbols(),this._peekToken()),e){n.usesParens=!0;const e=this._peekToken();this._consumeTokenIfType(14)?h.extendRange(n,e):this._addError(d.Localizer.Diagnostic.expectedCloseParen(),this._peekToken())}}}else this._addError(d.Localizer.Diagnostic.expectedImport(),this._peekToken()),t.hasTrailingDot||(n.missingImportKeyword=!0);this._importedModules.push({nameNode:n.module,leadingDots:n.module.leadingDots,nameParts:n.module.nameParts.map(e=>e.value),importedSymbols:n.imports.map(e=>e.name.value)});let r=!1;if(1===n.module.nameParts.length){const e=n.module.nameParts[0].value;"typing"!==e&&"typing_extensions"!==e||(r=!0)}if(r){const e=["Literal","TypeAlias"];n.isWildcardImport?e.forEach(e=>{this._typingSymbolAliases.set(e,e)}):n.imports.forEach(t=>{var n;e.some(e=>e===t.name.value)&&this._typingSymbolAliases.set((null===(n=t.alias)||void 0===n?void 0:n.value)||t.name.value,t.name.value)})}return n}_parseImportStatement(){var e;const t=this._getKeywordToken(20),n=h.ImportNode.create(t);for(;;){const t=this._parseDottedModuleName(),s=h.ImportAsNode.create(t);if(this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?(s.alias=h.NameNode.create(e),s.alias.parent=s,h.extendRange(s,s.alias)):this._addError(d.Localizer.Diagnostic.expectedImportAlias(),this._peekToken())}if(s.module.leadingDots>0&&this._addError(d.Localizer.Diagnostic.relativeImportNotAllowed(),s.module),n.list.push(s),s.parent=n,this._importedModules.push({nameNode:s.module,leadingDots:s.module.leadingDots,nameParts:s.module.nameParts.map(e=>e.value),importedSymbols:void 0}),1===t.nameParts.length){const n=t.nameParts[0].value;"typing"!==n&&"typing_extensions"!==n||this._typingImportAliases.push((null===(e=s.alias)||void 0===e?void 0:e.value)||n)}if(!this._consumeTokenIfType(12))break}return n.list.length>0&&h.extendRange(n,n.list[n.list.length-1]),n}_parseDottedModuleName(e=!1){const t=h.ModuleNameNode.create(this._peekToken());for(;;)if(this._consumeTokenIfType(19))t.leadingDots+=3;else{if(!this._consumeTokenIfType(20))break;t.leadingDots++}for(;;){const n=this._getTokenIfIdentifier([20]);if(!n){e&&0!==t.leadingDots||(this._addError(d.Localizer.Diagnostic.expectedModuleName(),this._peekToken()),t.hasTrailingDot=!0);break}const s=h.NameNode.create(n);t.nameParts.push(s),s.parent=t,h.extendRange(t,s);const i=this._peekToken();if(!this._consumeTokenIfType(20))break;h.extendRange(t,i)}return t}_parseGlobalStatement(){const e=this._getKeywordToken(18),t=h.GlobalNode.create(e);return t.nameList=this._parseNameList(),t.nameList.length>0&&(t.nameList.forEach(e=>{e.parent=t}),h.extendRange(t,t.nameList[t.nameList.length-1])),t}_parseNonlocalStatement(){const e=this._getKeywordToken(25),t=h.NonlocalNode.create(e);return t.nameList=this._parseNameList(),t.nameList.length>0&&(t.nameList.forEach(e=>{e.parent=t}),h.extendRange(t,t.nameList[t.nameList.length-1])),t}_parseNameList(){const e=[];for(;;){const t=this._getTokenIfIdentifier();if(!t){this._addError(d.Localizer.Diagnostic.expectedIdentifier(),this._peekToken());break}if(e.push(h.NameNode.create(t)),!this._consumeTokenIfType(12))break}return e}_parseRaiseStatement(){const e=this._getKeywordToken(29),t=h.RaiseNode.create(e);return this._isNextTokenNeverExpression()||(t.typeExpression=this._parseTestExpression(!0),t.typeExpression.parent=t,h.extendRange(t,t.typeExpression),this._consumeTokenIfKeyword(17)?(t.valueExpression=this._parseTestExpression(!0),t.valueExpression.parent=t,h.extendRange(t,t.valueExpression)):this._consumeTokenIfType(12)&&(t.valueExpression=this._parseTestExpression(!0),t.valueExpression.parent=t,h.extendRange(t,t.valueExpression),this._consumeTokenIfType(12)&&(t.tracebackExpression=this._parseTestExpression(!0),t.tracebackExpression.parent=t,h.extendRange(t,t.tracebackExpression)))),t}_parseAssertStatement(){const e=this._getKeywordToken(2),t=this._parseTestExpression(!0),n=h.AssertNode.create(e,t);if(this._consumeTokenIfType(12)){const e=this._parseTestExpression(!0);n.exceptionExpression=e,n.exceptionExpression.parent=n,h.extendRange(n,e)}return n}_parseDelStatement(){const e=this._getKeywordToken(10),t=this._parseExpressionList(!0);t.parseError||0!==t.list.length||this._addError(d.Localizer.Diagnostic.expectedDelExpr(),this._peekToken());const n=h.DelNode.create(e);return n.expressions=t.list,n.expressions.length>0&&(n.expressions.forEach(e=>{e.parent=n}),h.extendRange(n,n.expressions[n.expressions.length-1])),n}_parseYieldExpression(){const e=this._getKeywordToken(35),t=this._peekToken();if(this._consumeTokenIfKeyword(17))return this._getLanguageVersion()<p.PythonVersion.V3_3&&this._addError(d.Localizer.Diagnostic.yieldFromIllegal(),t),h.YieldFromNode.create(e,this._parseTestExpression(!0));let n;return this._isNextTokenNeverExpression()||(n=this._parseTestOrStarListAsExpression(!0,2,d.Localizer.Diagnostic.expectedYieldExpr()),this._reportConditionalErrorForStarTupleElement(n)),h.YieldNode.create(e,n)}_tryParseYieldExpression(){if(35===this._peekKeywordType())return this._parseYieldExpression()}_parseSimpleStatement(){const e=h.StatementListNode.create(this._peekToken());for(;;){if(0===this._peekTokenType()){const e=this._getNextToken(),t=this._fileContents.substr(e.start,e.length).replace(/[\S\W]/g,"");this._addError(d.Localizer.Diagnostic.invalidTokenChars().format({text:t}),e),this._consumeTokensUntilType([2]);break}const t=this._parseSmallStatement();if(e.statements.push(t),t.parent=e,h.extendRange(e,t),0===t.nodeType)break;if(!this._consumeTokenIfType(11))break;const n=this._peekTokenType();if(2===n||1===n)break}return this._consumeTokenIfType(2)||this._addError(d.Localizer.Diagnostic.expectedNewlineOrSemicolon(),this._peekToken()),e}_parseSmallStatement(){switch(this._peekKeywordType()){case 28:return this._parsePassStatement();case 5:return this._parseBreakStatement();case 7:return this._parseContinueStatement();case 30:return this._parseReturnStatement();case 17:return this._parseFromStatement();case 20:return this._parseImportStatement();case 18:return this._parseGlobalStatement();case 25:return this._parseNonlocalStatement();case 29:return this._parseRaiseStatement();case 2:return this._parseAssertStatement();case 10:return this._parseDelStatement();case 35:return this._parseYieldExpression()}return this._parseExpressionStatement()}_makeExpressionOrTuple(e,t){if(1===e.list.length&&!e.trailingComma)return e.list[0];const n=e.list.length>0?e.list[0]:this._peekToken(-1),s=h.TupleNode.create(n,t);return s.expressions=e.list,e.list.length>0&&(e.list.forEach(e=>{e.parent=s}),h.extendRange(s,e.list[e.list.length-1])),s}_parseTestListAsExpression(e,t){if(this._isNextTokenNeverExpression())return this._handleExpressionParseError(e,t);const n=this._parseTestExpressionList();return n.parseError?n.parseError:this._makeExpressionOrTuple(n,!1)}_parseTestOrStarListAsExpression(e,t,n){if(this._isNextTokenNeverExpression())return this._handleExpressionParseError(t,n);const s=this._parseTestOrStarExpressionList(e);return s.parseError?s.parseError:this._makeExpressionOrTuple(s,!1)}_parseExpressionList(e){return this._parseExpressionListGeneric(()=>this._parseExpression(e))}_parseTestExpressionList(){return this._parseExpressionListGeneric(()=>this._parseTestExpression(!1))}_parseTestOrStarExpressionList(e){const t=this._parseExpressionListGeneric(()=>this._parseTestOrStarExpression(e));if(!t.parseError){let e=!1;for(const n of t.list)if(57===n.nodeType){if(e){this._addError(d.Localizer.Diagnostic.duplicateUnpack(),n);break}e=!0}}return t}_parseExpression(e){const t=this._peekToken();return e&&this._consumeTokenIfOperator(26)?h.UnpackNode.create(t,this._parseExpression(!1)):this._parseBitwiseOrExpression()}_parseTestOrStarExpression(e){return 26===this._peekOperatorType()?this._parseExpression(!0):this._parseTestExpression(e)}_parseTestExpression(e){if(23===this._peekKeywordType())return this._parseLambdaExpression();const t=e?this._parseAssignmentExpression():this._parseOrTest();if(0===t.nodeType)return t;if(!this._consumeTokenIfKeyword(19))return t;const n=this._parseAssignmentExpression();if(0===n.nodeType)return n;if(!this._consumeTokenIfKeyword(12))return this._handleExpressionParseError(1,d.Localizer.Diagnostic.expectedElse());const s=this._parseTestExpression(!0);return 0===s.nodeType?s:h.TernaryNode.create(t,n,s)}_parseAssignmentExpression(){const e=this._parseOrTest();if(0===e.nodeType)return e;if(39!==e.nodeType)return e;const t=this._peekToken();if(!this._consumeTokenIfOperator(35))return e;this._assignmentExpressionsAllowed||this._addError(d.Localizer.Diagnostic.walrusNotAllowed(),t),this._getLanguageVersion()<p.PythonVersion.V3_8&&this._addError(d.Localizer.Diagnostic.walrusIllegal(),t);const n=this._parseTestExpression(!1);return h.AssignmentExpressionNode.create(e,n)}_parseOrTest(){let e=this._parseAndTest();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfKeyword(27))break;const n=this._parseAndTest();e=h.BinaryOperationNode.create(e,n,t,37)}return e}_parseAndTest(){let e=this._parseNotTest();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfKeyword(0))break;const n=this._parseNotTest();e=h.BinaryOperationNode.create(e,n,t,36)}return e}_parseNotTest(){const e=this._peekToken();if(this._consumeTokenIfKeyword(26)){const t=this._parseNotTest();return h.UnaryOperationNode.create(e,t,38)}return this._parseComparison()}_parseComparison(){let e=this._parseBitwiseOrExpression();if(0===e.nodeType)return e;for(;;){let t;const n=this._peekToken();if(y.Tokenizer.isOperatorComparison(this._peekOperatorType()))t=this._peekOperatorType(),19===t&&(this._addError(d.Localizer.Diagnostic.operatorLessOrGreaterDeprecated(),n),t=28),this._getNextToken();else if(this._consumeTokenIfKeyword(21))t=41;else if(this._consumeTokenIfKeyword(22))t=this._consumeTokenIfKeyword(26)?40:39;else if(26===this._peekKeywordType()){const e=this._peekToken(1);8===e.type&&21===e.keywordType&&(this._getNextToken(),this._getNextToken(),t=42)}if(void 0===t)break;const s=this._parseBitwiseOrExpression();e=h.BinaryOperationNode.create(e,s,n,t)}return e}_parseBitwiseOrExpression(){let e=this._parseBitwiseXorExpression();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfOperator(6))break;const n=this._parseBitwiseXorExpression();e=h.BinaryOperationNode.create(e,n,t,6)}return e}_parseBitwiseXorExpression(){let e=this._parseBitwiseAndExpression();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfOperator(8))break;const n=this._parseBitwiseAndExpression();e=h.BinaryOperationNode.create(e,n,t,8)}return e}_parseBitwiseAndExpression(){let e=this._parseShiftExpression();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfOperator(3))break;const n=this._parseShiftExpression();e=h.BinaryOperationNode.create(e,n,t,3)}return e}_parseShiftExpression(){let e=this._parseArithmeticExpression();if(0===e.nodeType)return e;let t=this._peekToken(),n=this._peekOperatorType();for(;17===n||31===n;){this._getNextToken();const s=this._parseArithmeticExpression();e=h.BinaryOperationNode.create(e,s,t,n),t=this._peekToken(),n=this._peekOperatorType()}return e}_parseArithmeticExpression(){let e=this._parseArithmeticTerm();if(0===e.nodeType)return e;let t=this._peekToken(),n=this._peekOperatorType();for(;0===n||33===n;){this._getNextToken();const s=this._parseArithmeticTerm();if(0===s.nodeType)return s;e=h.BinaryOperationNode.create(e,s,t,n),t=this._peekToken(),n=this._peekOperatorType()}return e}_parseArithmeticTerm(){let e=this._parseArithmeticFactor();if(0===e.nodeType)return e;let t=this._peekToken(),n=this._peekOperatorType();for(;26===n||22===n||10===n||24===n||13===n;){this._getNextToken();const s=this._parseArithmeticFactor();e=h.BinaryOperationNode.create(e,s,t,n),t=this._peekToken(),n=this._peekOperatorType()}return e}_parseArithmeticFactor(){const e=this._peekToken(),t=this._peekOperatorType();if(0===t||33===t||5===t){this._getNextToken();const n=this._parseArithmeticFactor();return h.UnaryOperationNode.create(e,n,t)}const n=this._parseAtomExpression();if(0===n.nodeType)return n;const s=this._peekToken();if(this._consumeTokenIfOperator(29)){const e=this._parseArithmeticFactor();return h.BinaryOperationNode.create(n,e,s,29)}return n}_isTypingAnnotation(e,t){if(39===e.nodeType){if(this._typingSymbolAliases.get(e.value)===t)return!0}else if(36===e.nodeType&&39===e.leftExpression.nodeType&&e.memberName.value===t){const t=e.leftExpression.value;return this._typingImportAliases.some(e=>e===t)}return!1}_parseAtomExpression(){let e;4!==this._peekKeywordType()||this._isParsingTypeAnnotation||(e=this._getKeywordToken(4),this._getLanguageVersion()<p.PythonVersion.V3_5&&this._addError(d.Localizer.Diagnostic.awaitIllegal(),e));let t=this._parseAtom();if(0===t.nodeType)return t;for(;;){const e=this._peekToken();if(this._consumeTokenIfType(13)){const e=this._isParsingTypeAnnotation;this._isParsingTypeAnnotation=!1;const n=this._parseArgList(),s=h.CallNode.create(t);s.arguments=n,n.length>0&&(n.forEach(e=>{e.parent=s}),h.extendRange(s,n[n.length-1]));const i=this._peekToken();let r=!1;if(this._consumeTokenIfType(14)?(h.extendRange(s,i),r=!0):(this._addError(d.Localizer.Diagnostic.expectedCloseParen(),this._peekToken()),this._consumeTokensUntilType([2]),h.extendRange(s,this._peekToken())),this._isParsingTypeAnnotation=e,this._isParsingTypeAnnotation){const e=new a.DiagnosticAddendum;39===t.nodeType&&"type"===t.value&&(e.addMessage(d.Localizer.DiagnosticAddendum.useTypeInstead()),this._addError(d.Localizer.Diagnostic.typeCallNotAllowed()+e.getString(),s))}if(t=s,!r)break}else if(this._consumeTokenIfType(15)){const n=this._isTypingAnnotation(t,"Literal"),s=this._isParsingIndexTrailer,i=this._isParsingTypeAnnotation;n&&(this._isParsingTypeAnnotation=!1),this._isParsingIndexTrailer=!0;const r=this._parseSubscriptList();this._isParsingTypeAnnotation=i,this._isParsingIndexTrailer=s;const o=this._peekToken(),a=h.IndexItemsNode.create(e,o,r),l=h.IndexNode.create(t,a);h.extendRange(l,l),this._consumeTokenIfType(16)||this._handleExpressionParseError(6,d.Localizer.Diagnostic.expectedCloseBracket(),l),t=l}else{if(!this._consumeTokenIfType(20))break;{const e=this._getTokenIfIdentifier();if(!e)return this._handleExpressionParseError(7,d.Localizer.Diagnostic.expectedMemberName(),t);t=h.MemberAccessNode.create(t,h.NameNode.create(e))}}}return e?h.AwaitNode.create(e,t):t}_parseSubscriptList(){const e=this._parseExpressionListGeneric(()=>this._parseSubscript(),()=>10!==this._peekTokenType()&&this._isNextTokenNeverExpression());return e.parseError?[e.parseError]:0===e.list.length?[this._handleExpressionParseError(3,d.Localizer.Diagnostic.expectedSliceIndex())]:e.list}_parseSubscript(){const e=this._peekToken(),t=[void 0,void 0,void 0];let n=0,s=!1;for(;;){const e=this._peekTokenType();if(16===e||12===e)break;if(10!==e&&(t[n]=this._parseTestExpression(!1)),n++,n>=3||!this._consumeTokenIfType(10))break;s=!0}if(!s)return t[0];const i=h.SliceNode.create(e);i.startValue=t[0],i.startValue&&(i.startValue.parent=i),i.endValue=t[1],i.endValue&&(i.endValue.parent=i),i.stepValue=t[2],i.stepValue&&(i.stepValue.parent=i);const r=t[2]||t[1]||t[0];return r&&h.extendRange(i,r),i}_parseArgList(){const e=[];let t=!1;for(;;){const n=this._peekTokenType();if(14===n||2===n||1===n)break;const s=this._parseArgument();if(s.name?t=!0:t&&0===s.argumentCategory&&this._addError(d.Localizer.Diagnostic.positionArgAfterNamedArg(),s),e.push(s),!this._consumeTokenIfType(12))break}return e}_parseArgument(){const e=this._peekToken();let t=0;this._consumeTokenIfOperator(26)?t=1:this._consumeTokenIfOperator(29)&&(t=2);let n,s=this._parseTestExpression(!0);if(0===t)if(this._consumeTokenIfOperator(2)){const e=s;s=this._parseTestExpression(!1),39===e.nodeType?n=e.token:this._addError(d.Localizer.Diagnostic.expectedParamName(),e)}else{const e=this._tryParseListComprehension(s);e&&(s=e)}const i=h.ArgumentNode.create(e,s,t);return n&&(i.name=h.NameNode.create(n),i.name.parent=i),i}_parseAtom(){const e=this._peekToken();if(19===e.type)return h.EllipsisNode.create(this._getNextToken());if(6===e.type)return h.NumberNode.create(this._getNextToken());if(7===e.type)return h.NameNode.create(this._getNextToken());if(5===e.type)return this._parseStringList();if(22===e.type){this._getNextToken(),this._addError(d.Localizer.Diagnostic.backticksIllegal(),e);const t=this._parseTestListAsExpression(2,d.Localizer.Diagnostic.expectedExpr());return this._consumeTokenIfType(22),t}if(13===e.type){const e=this._parseTupleAtom();if(53===e.nodeType&&this._isParsingTypeAnnotation&&!this._isParsingIndexTrailer){const t=new a.DiagnosticAddendum;t.addMessage(d.Localizer.DiagnosticAddendum.useTupleInstead()),this._addError(d.Localizer.Diagnostic.tupleInAnnotation()+t.getString(),e)}return 7===e.nodeType&&(e.parenthesized=!0),e}if(15===e.type){const e=this._parseListAtom();if(this._isParsingTypeAnnotation&&!this._isParsingIndexTrailer){const t=new a.DiagnosticAddendum;t.addMessage(d.Localizer.DiagnosticAddendum.useListInstead()),this._addError(d.Localizer.Diagnostic.listInAnnotation()+t.getString(),e)}return e}if(17===e.type){const e=this._parseDictionaryOrSetAtom();if(this._isParsingTypeAnnotation){const t=new a.DiagnosticAddendum;t.addMessage(d.Localizer.DiagnosticAddendum.useDictInstead()),this._addError(d.Localizer.Diagnostic.dictInAnnotation()+t.getString(),e)}return e}if(8===e.type){const t=e;if(14===t.keywordType||31===t.keywordType||8===t.keywordType||24===t.keywordType)return h.ConstantNode.create(this._getNextToken());const n=this._getTokenIfIdentifier();if(n)return h.NameNode.create(n)}return this._handleExpressionParseError(2,d.Localizer.Diagnostic.expectedExpr())}_handleExpressionParseError(e,t,n){this._addError(t,this._peekToken());const s=h.ErrorNode.create(this._peekToken(),e,n);return this._consumeTokensUntilType([2]),s}_parseLambdaExpression(e=!0){const t=this._getKeywordToken(23),n=this._parseVarArgsList(10,!1);let s;this._consumeTokenIfType(10)||this._addError(d.Localizer.Diagnostic.expectedColon(),this._peekToken()),s=e?this._parseTestExpression(!1):this._tryParseLambdaExpression(!1)||this._parseOrTest();const i=h.LambdaNode.create(t,s);return i.parameters=n,n.forEach(e=>{e.parent=i}),i}_tryParseLambdaExpression(e=!0){if(23===this._peekKeywordType())return this._parseLambdaExpression(e)}_parseTupleAtom(){const e=this._getNextToken();o.assert(13===e.type);const t=this._tryParseYieldExpression();if(t)return 14!==this._peekTokenType()?this._handleExpressionParseError(8,d.Localizer.Diagnostic.expectedCloseParen()):(h.extendRange(t,this._getNextToken()),t);const n=this._parseTestListWithComprehension(),s=this._makeExpressionOrTuple(n,!0);return 14!==this._peekTokenType()?this._handleExpressionParseError(8,d.Localizer.Diagnostic.expectedCloseParen()):(h.extendRange(s,this._getNextToken()),s)}_parseListAtom(){const e=this._getNextToken();o.assert(15===e.type);const t=this._parseTestListWithComprehension(),n=this._peekToken();if(!this._consumeTokenIfType(16))return this._handleExpressionParseError(9,d.Localizer.Diagnostic.expectedCloseBracket());const s=h.ListNode.create(e);return h.extendRange(s,n),t.list.length>0&&(t.list.forEach(e=>{e.parent=s}),h.extendRange(s,t.list[t.list.length-1])),s.entries=t.list,s}_parseTestListWithComprehension(){let e=!1;return this._parseExpressionListGeneric(()=>{let t=this._parseTestOrStarExpression(!0);const n=this._tryParseListComprehension(t);return n&&(t=n,e=!0),t},()=>this._isNextTokenNeverExpression(),()=>e)}_parseDictionaryOrSetAtom(){const e=this._getNextToken();o.assert(17===e.type);const t=[],n=[];let s=!1,i=!1,r=!1,a=!0;for(;18!==this._peekTokenType();){let e,l,c;const p=this._peekToken();if(this._consumeTokenIfOperator(29)?e=this._parseExpression(!1):(l=this._parseTestOrStarExpression(!0),this._consumeTokenIfType(10)&&(c=this._parseTestExpression(!1))),l&&c)if(57===l.nodeType&&this._addError(d.Localizer.Diagnostic.unpackInDict(),l),i)this._addError(d.Localizer.Diagnostic.keyValueInSet(),c);else{const e=h.DictionaryKeyEntryNode.create(l,c);let n=e;const i=this._tryParseListComprehension(e);i&&(n=i,r=!0,a||this._addError(d.Localizer.Diagnostic.comprehensionInDict(),n)),t.push(n),s=!0}else if(e)if(i)this._addError(d.Localizer.Diagnostic.unpackInSet(),e);else{const n=h.DictionaryExpandEntryNode.create(e);h.extendRange(n,p);let i=n;const o=this._tryParseListComprehension(n);o&&(i=o,r=!0,a||this._addError(d.Localizer.Diagnostic.comprehensionInDict(),e)),t.push(i),s=!0}else if(o.assert(void 0!==l),l)if(s)this._addError(d.Localizer.Diagnostic.dictKeyValuePairs(),l);else{const e=this._tryParseListComprehension(l);e&&(l=e,r=!0,a||this._addError(d.Localizer.Diagnostic.comprehensionInSet(),l)),n.push(l),i=!0}if(r)break;if(!this._consumeTokenIfType(12))break;a=!1}let l=this._peekToken();if(this._consumeTokenIfType(18)||(this._addError(d.Localizer.Diagnostic.expectedCloseBrace(),this._peekToken()),l=void 0),i){const t=h.SetNode.create(e);return l&&h.extendRange(t,l),n.length>0&&h.extendRange(t,n[n.length-1]),n.forEach(e=>{e.parent=t}),t.entries=n,t}const c=h.DictionaryNode.create(e);return l&&h.extendRange(c,l),t.length>0&&(t.forEach(e=>{e.parent=c}),h.extendRange(c,t[t.length-1])),c.entries=t,c}_parseExpressionListGeneric(e,t=(()=>this._isNextTokenNeverExpression()),n=(()=>!1)){let s=!1;const i=[];let r;for(;!t();){const t=e();if(0===t.nodeType){r=t;break}if(i.push(t),n())break;if(!this._consumeTokenIfType(12)){s=!1;break}s=!0}return{trailingComma:s,list:i,parseError:r}}_parseExpressionStatement(){let e,t=this._parseTestOrStarListAsExpression(!1,2,d.Localizer.Diagnostic.expectedExpr());if(0===t.nodeType)return t;if(this._consumeTokenIfType(10)){if(e=this._parseTypeAnnotation(),t=h.TypeAnnotationNode.create(t,e),!this._parseOptions.isStubFile&&this._getLanguageVersion()<p.PythonVersion.V3_6&&this._addError(d.Localizer.Diagnostic.varAnnotationIllegal(),e),!this._consumeTokenIfOperator(2))return t;const n=this._isTypingAnnotation(e,"TypeAlias"),s=this._isParsingTypeAnnotation;n&&(this._isParsingTypeAnnotation=!0);const i=this._parseTestExpression(!1);return this._isParsingTypeAnnotation=s,h.AssignmentNode.create(t,i)}if(this._consumeTokenIfOperator(2))return this._parseChainAssignments(t);if(!e&&y.Tokenizer.isOperatorAssignment(this._peekOperatorType())){const e=this._getNextToken(),n=this._tryParseYieldExpression()||this._parseTestListAsExpression(2,d.Localizer.Diagnostic.expectedBinaryRightHandExpr()),s=Object.assign({},t);return s.id=h.getNextNodeId(),h.AugmentedAssignmentNode.create(t,n,e.operatorType,s)}return t}_parseChainAssignments(e){let t;if(t=this._tryParseYieldExpression(),t||(t=this._parseTestOrStarListAsExpression(!1,2,d.Localizer.Diagnostic.expectedAssignRightHandExpr())),0===t.nodeType)return h.AssignmentNode.create(e,t);if(this._consumeTokenIfOperator(2)&&(t=this._parseChainAssignments(t),0===t.nodeType))return t;const n=h.AssignmentNode.create(e,t),s=this._parseVariableTypeAnnotationComment();return s&&(n.typeAnnotationComment=s,n.typeAnnotationComment.parent=n,h.extendRange(n,n.typeAnnotationComment)),n}_parseFunctionTypeAnnotation(){const e=this._peekToken();if(!this._consumeTokenIfType(13))return void this._addError(d.Localizer.Diagnostic.expectedOpenParen(),this._peekToken());let t=[];for(;;){const e=this._peekTokenType();if(14===e||2===e||1===e)break;const n=this._parseTypeAnnotation();if(t.push(n),!this._consumeTokenIfType(12))break}if(this._consumeTokenIfType(14)||(this._addError(d.Localizer.Diagnostic.expectedCloseParen(),this._peekToken()),this._consumeTokensUntilType([10])),!this._consumeTokenIfType(21))return void this._addError(d.Localizer.Diagnostic.expectedArrow(),this._peekToken());const n=this._parseTypeAnnotation();let s=!1;return 1===t.length&&18===t[0].nodeType&&(t=[],s=!0),h.FunctionAnnotationNode.create(e,s,t,n)}_parseTypeAnnotation(e=!0){const t=this._isParsingTypeAnnotation;this._isParsingTypeAnnotation=!0;const n=this._parseTestExpression(!1);return this._isParsingTypeAnnotation=t,n}_reportStringTokenErrors(e,t){65536&e.flags&&this._addError(d.Localizer.Diagnostic.stringUnterminated(),e),t.nonAsciiInBytes&&this._addError(d.Localizer.Diagnostic.stringNonAsciiBytes(),e),64&e.flags&&(this._getLanguageVersion()<p.PythonVersion.V3_6&&this._addError(d.Localizer.Diagnostic.formatStringIllegal(),e),32&e.flags&&this._addError(d.Localizer.Diagnostic.formatStringBytes(),e),16&e.flags&&this._addError(d.Localizer.Diagnostic.formatStringUnicode(),e))}_makeStringNode(e){const t=m.getUnescapedString(e);return this._reportStringTokenErrors(e,t),h.StringNode.create(e,t.value,t.unescapeErrors.length>0)}_getTypeAnnotationCommentText(){if(0===this._tokenIndex)return;const e=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex-1),t=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex);if(e.start+e.length===t.start)return;const n=this._fileContents.substring(e.start+e.length,t.start).match(/^(\s*#\s*type:\s*)([^\r\n]*)/);if(!n)return;const s=n[2];if(s.trim().match(/^ignore(\s|\[|$)/))return;const i=e.start+e.length+n[1].length;return g.StringToken.create(i,s.length,0,s,0,void 0)}_parseVariableTypeAnnotationComment(){const e=this._getTypeAnnotationCommentText();if(!e)return;const t=this._makeStringNode(e),n=h.StringListNode.create([t]),s=(new _).parseTextExpression(this._fileContents,e.start,e.length,this._parseOptions,1);return s.diagnostics.forEach(e=>{this._addError(e.message,n)}),s.parseTree?s.parseTree:void 0}_parseFunctionTypeAnnotationComment(e,t){const n=this._makeStringNode(e),s=h.StringListNode.create([n]),i=(new _).parseTextExpression(this._fileContents,e.start,e.length,this._parseOptions,2);if(i.diagnostics.forEach(e=>{this._addError(e.message,s)}),!i.parseTree||63!==i.parseTree.nodeType)return;const r=i.parseTree;t.functionAnnotationComment=r,r.parent=t,h.extendRange(t,r)}_parseFormatStringSegment(e,t,n,s){o.assert(t.isExpression);const i=(new _).parseTextExpression(this._fileContents,e.start+e.prefixLength+e.quoteMarkLength+t.offset+n,s,this._parseOptions,0,1);return i.diagnostics.forEach(t=>{const n=(t.range?c.convertPositionToOffset(t.range.start,i.lines):e.start)||e.start,s={start:n,length:((t.range?(c.convertPositionToOffset(t.range.end,i.lines)||0)+1:e.start+e.length)||e.start+e.length)-n};this._addError(t.message,s)}),i.parseTree}_parseFormatString(e){const t=m.getUnescapedString(e);this._reportStringTokenErrors(e,t);const n=[];for(const s of t.formatStringSegments)if(s.isExpression){const t=this._getFormatStringExpressionLength(s.value.trimEnd()),i=this._parseFormatStringSegment(e,s,0,t);i&&n.push(i);const r=s.value.substr(t);let o=0,a=0;for(let i=0;i<r.length;i++)if(123===r.charCodeAt(i))0===o&&(a=i+1),o++;else if(125===r.charCodeAt(i)&&o>0&&(o--,0===o)){const r=this._parseFormatStringSegment(e,s,t+a,i-a);r&&n.push(r)}}return h.FormatStringNode.create(e,t.value,t.unescapeErrors.length>0,n)}_getFormatStringExpressionLength(e){let t=0;const n=[];let s=0,i=0,r=0,o=!1;for(;t<e.length;){const a=e[t],l=n.length>0||s>0||i>0||r>0,c=n.length>0;if("="===a)o=!0;else{if(":"===a){if(!l)break}else if("!"===a){if(!l&&(t===e.length-1||"="!==e[t+1]))break}else if("'"===a||'"'===a){let s=a;t+2<e.length&&e[t+1]===a&&e[t+2]===a&&(s=a+a+a,t+=2),n.length>0&&n[n.length-1]===s?n.pop():n.push(s)}else"("===a?c||i++:")"===a?!c&&i>0&&i--:"{"===a?c||s++:"}"===a?!c&&s>0&&s--:"["===a?c||r++:"]"===a&&!c&&r>0&&r--;o=!1}t++}return this._parseOptions.pythonVersion>=p.PythonVersion.V3_8&&o&&t--,t}_parseStringList(){const e=[];for(;5===this._peekTokenType();){const t=this._getNextToken();64&t.flags?e.push(this._parseFormatString(t)):e.push(this._makeStringNode(t))}const t=h.StringListNode.create(e);if(this._isParsingTypeAnnotation)if(t.strings.length>1)this._addError(d.Localizer.Diagnostic.annotationSpansStrings(),t);else if(4&t.strings[0].token.flags)this._addError(d.Localizer.Diagnostic.annotationTripleQuote(),t);else if(64&t.strings[0].token.flags)this._addError(d.Localizer.Diagnostic.annotationFormatString(),t);else{const e=t.strings[0].token,n=m.getUnescapedString(t.strings[0].token).value,s=e.start,i=e.prefixLength+e.quoteMarkLength;if(n.length!==e.length-i-e.quoteMarkLength)this._addError(d.Localizer.Diagnostic.annotationStringEscape(),t);else{const e=(new _).parseTextExpression(this._fileContents,s+i,n.length,this._parseOptions,1);e.diagnostics.forEach(e=>{this._addError(e.message,t)}),e.parseTree&&(t.typeAnnotation=e.parseTree,t.typeAnnotation.parent=t)}}return t}_reportConditionalErrorForStarTupleElement(e){if(53===e.nodeType&&!(e.enclosedInParens||this._parseOptions.pythonVersion>=p.PythonVersion.V3_8))for(const t of e.expressions)if(57===t.nodeType)return void this._addError(d.Localizer.Diagnostic.unpackTuplesIllegal(),t)}_isNextTokenNeverExpression(){switch(this._peekToken().type){case 8:switch(this._peekKeywordType()){case 16:case 21:case 19:return!0}break;case 9:switch(this._peekOperatorType()){case 1:case 34:case 27:case 11:case 25:case 4:case 7:case 9:case 18:case 32:case 30:case 14:case 2:return!0}break;case 3:case 4:case 2:case 1:case 11:case 14:case 16:case 18:case 12:case 10:return!0}return!1}_disallowAssignmentExpression(e){const t=this._assignmentExpressionsAllowed;this._assignmentExpressionsAllowed=!1,e(),this._assignmentExpressionsAllowed=t}_getNextToken(){const e=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex);return this._atEof()||this._tokenIndex++,e}_atEof(){return this._tokenIndex>=this._tokenizerOutput.tokens.count-1}_peekToken(e=0){return this._tokenIndex+e<0&&this._tokenizerOutput.tokens.getItemAt(0),this._tokenIndex+e>=this._tokenizerOutput.tokens.count?this._tokenizerOutput.tokens.getItemAt(this._tokenizerOutput.tokens.count-1):this._tokenizerOutput.tokens.getItemAt(this._tokenIndex+e)}_peekTokenType(){return this._peekToken().type}_peekKeywordType(){const e=this._peekToken();if(8===e.type)return e.keywordType}_peekOperatorType(){const e=this._peekToken();if(9===e.type)return e.operatorType}_getTokenIfIdentifier(e=[]){const t=this._peekToken();if(7===t.type)return this._getNextToken();if(0===t.type)return this._getNextToken(),this._addError(d.Localizer.Diagnostic.invalidIdentifierChar(),t),g.IdentifierToken.create(t.start,t.length,"",t.comments);if(8===t.type){const n=this._peekKeywordType();if(!e.find(e=>e===n)){const e=this._fileContents.substr(t.start,t.length);return this._getNextToken(),g.IdentifierToken.create(t.start,t.length,e,t.comments)}}}_consumeTokensUntilType(e){for(;;){const t=this._peekToken();if(e.some(e=>e===t.type))return!0;if(1===t.type)return!1;this._getNextToken()}}_consumeTokenIfType(e){return this._peekTokenType()===e&&(this._getNextToken(),!0)}_consumeTokenIfKeyword(e){return this._peekKeywordType()===e&&(this._getNextToken(),!0)}_consumeTokenIfOperator(e){return this._peekOperatorType()===e&&(this._getNextToken(),!0)}_getKeywordToken(e){const t=this._getNextToken();return o.assert(8===t.type),o.assert(t.keywordType===e),t}_getLanguageVersion(){return this._parseOptions.pythonVersion}_addError(e,t){o.assert(void 0!==t),this._diagSink.addError(e,c.convertOffsetsToRange(t.start,t.start+t.length,this._tokenizerOutput.lines))}}t.Parser=_},5136:(e,t)=>{"use strict";function n(e){return e>=48&&e<=57||e>=97&&e<=122||e>=65&&e<=90}function s(e){return e>=48&&e<=55}function i(e){return e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70}function r(e){return e>=48&&e<=57?e-48:e>=97&&e<=102?e-97+10:e>=65&&e<=70?e-65+10:0}Object.defineProperty(t,"__esModule",{value:!0}),t.getUnescapedString=void 0,t.getUnescapedString=function(e){const t=e.escapedValue,o=0!=(8&e.flags),a=0!=(32&e.flags),l=0!=(64&e.flags);let c=0,p={offset:0,length:0,value:"",isExpression:!1},u=0;const d={value:"",unescapeErrors:[],nonAsciiInBytes:!1,formatStringSegments:[]},h=()=>{o||d.unescapeErrors.push({offset:u-1,length:2,errorType:0})},m=(e=0)=>u+e>=t.length?3:t.charCodeAt(u+e),y=e=>{let t=!1,n=0,s="";for(let s=0;s<e;s++){const e=m(1+s);if(!i(e)){t=!0;break}n=16*n+r(e)}return t?(h(),s="\\"+String.fromCharCode(m()),u++):(s=String.fromCharCode(n),u+=1+e),s},g=e=>{const t=String.fromCharCode(e);d.value+=t,p.value+=t};for(;;){let e=m();if(3===e)return l&&(p.isExpression&&d.unescapeErrors.push({offset:p.offset,length:u-p.offset,errorType:3}),u!==p.offset&&(p.length=u-p.offset,d.formatStringSegments.push(p))),d;if(92===e){l&&p.isExpression&&d.unescapeErrors.push({offset:u,length:1,errorType:1}),u++,e=m();let t="";if(13===e||10===e)13===e&&10===m(1)&&(o&&(t+=String.fromCharCode(e)),u++,e=m()),o&&(t="\\"+t+String.fromCharCode(e)),u++;else if(o)t="\\"+String.fromCharCode(e),u++;else switch(e){case 92:case 39:case 34:t=String.fromCharCode(e),u++;break;case 97:t="",u++;break;case 98:t="\b",u++;break;case 102:t="\f",u++;break;case 110:t="\n",u++;break;case 114:t="\r",u++;break;case 116:t="\t",u++;break;case 118:t="\v",u++;break;case 120:t=y(2);break;case 78:{let s=!1,i=1;if(123!==m(i))s=!0;else for(i++;;){const e=m(i);if(125===e)break;if(!n(e)&&45!==e&&32!==(f=e)&&9!==f){s=!0;break}i++}s?(h(),t="\\"+String.fromCharCode(e),u++):(t="-",u+=1+i);break}case 117:t=y(4);break;case 85:t=y(8);break;default:if(s(e)){let n=e-48;u++,e=m(),s(e)&&(n=8*n+e-48,u++,e=m(),s(e)&&(n=8*n+e-48,u++)),t=String.fromCharCode(n)}else t="\\",h()}d.value+=t,p.value+=t}else if(10===e||13===e)13===e&&10===m(1)&&(g(e),u++,e=m()),g(e),u++;else if(l&&123===e)p.isExpression||123!==m(1)?(0===c?(p.length=u-p.offset,p.length>0&&d.formatStringSegments.push(p),u++,p={offset:u,length:0,value:"",isExpression:!0}):(g(e),u++),c++):(g(e),u+=2);else if(l&&125===e)p.isExpression||125!==m(1)?0===c?(d.unescapeErrors.push({offset:u,length:1,errorType:2}),u++):(c--,0===c?(p.length=u-p.offset,d.formatStringSegments.push(p),u++,p={offset:u,length:0,value:"",isExpression:!1}):(g(e),u++)):(g(e),u+=2);else if(!p.isExpression||39!==e&&34!==e)a&&e>=128&&(d.nonAsciiInBytes=!0),g(e),u++;else{const t=e;g(e);const n=m(1)===t&&m(2)===t;for(n&&(u+=2,g(e),g(e),d.value+=String.fromCharCode(e),d.value+=String.fromCharCode(e));;){u++;let e=m();if(3===e)break;if(92!==e){if(10===e||13===e)break;if(e===t){if(!n){u++,g(e);break}if(m(1)===t&&m(2)===t){u+=3,g(e),g(e),g(e);break}}g(e)}else g(e),u++,e=m(),g(e)}}}var f}},7093:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tokenizer=void 0;const s=n(3420),i=n(6956),r=n(9671),o=n(6180),a={and:0,as:1,assert:2,async:3,await:4,break:5,class:6,continue:7,__debug__:8,def:9,del:10,elif:11,else:12,except:13,finally:15,for:16,from:17,global:18,if:19,import:20,in:21,is:22,lambda:23,nonlocal:25,not:26,or:27,pass:28,raise:29,return:30,try:32,while:33,with:34,yield:35,False:14,None:24,True:31},l={0:3,1:4,2:4,3:2,4:4,5:1,6:2,7:4,8:2,9:4,10:2,11:4,12:10,13:2,14:4,15:10,16:10,17:2,18:4,19:26,20:10,21:10,22:2,23:4,24:2,25:4,26:2,27:4,28:10,29:2,30:4,31:2,32:4,33:2,34:4,36:2,37:2,38:1,39:2,40:2,41:2,42:2};t.Tokenizer=class{constructor(){this._cs=new r.CharacterStream(""),this._tokens=[],this._prevLineStart=0,this._parenDepth=0,this._lineRanges=[],this._indentAmounts=[],this._typeIgnoreAll=!1,this._typeIgnoreLines={},this._crCount=0,this._crLfCount=0,this._lfCount=0,this._indentCount=0,this._indentTabCount=0,this._indentSpacesTotal=0,this._singleQuoteCount=0,this._doubleQuoteCount=0}tokenize(e,t,n,i=0){if(void 0===t)t=0;else if(t<0||t>e.length)throw new Error("Invalid range start");if(void 0===n)n=e.length;else{if(n<0||t+n>e.length)throw new Error("Invalid range length");t+n<e.length&&(e=e.substr(0,t+n))}this._cs=new r.CharacterStream(e),this._cs.position=t,this._tokens=[],this._prevLineStart=0,this._parenDepth=i,this._lineRanges=[],this._indentAmounts=[];const a=t+n;for(;!(this._cs.isEndOfStream()||(this._addNextToken(),this._cs.position>=a)););0!==this._tokens.length&&2===this._tokens[this._tokens.length-1].type||this._tokens.push(o.NewLineToken.create(this._cs.position,0,3,this._getComments())),this._setIndent(0,0,!0,!1),this._tokens.push(o.Token.create(1,this._cs.position,0,this._getComments())),this._addLineRange();let l="\n";this._crCount>this._crLfCount&&this._crCount>this._lfCount?l="\r":this._crLfCount>this._crCount&&this._crLfCount>this._lfCount&&(l="\r\n");let c="    ";if(this._indentTabCount>this._indentCount/2)c="\t";else if(this._indentCount>0){let e=Math.round(this._indentSpacesTotal/this._indentCount);e<1?e=1:e>8&&(e=8),c="";for(let t=0;t<e;t++)c+=" "}return{tokens:new s.TextRangeCollection(this._tokens),lines:new s.TextRangeCollection(this._lineRanges),typeIgnoreLines:this._typeIgnoreLines,typeIgnoreAll:this._typeIgnoreAll,predominantEndOfLineSequence:l,predominantTabSequence:c,predominantSingleQuoteCharacter:this._singleQuoteCount>=this._doubleQuoteCount?"'":'"'}}static getOperatorInfo(e){return l[e]}static isOperatorAssignment(e){return void 0!==e&&void 0!==l[e]&&0!=(4&l[e])}static isOperatorComparison(e){return void 0!==e&&void 0!==l[e]&&0!=(8&l[e])}_addNextToken(){this._cs.skipWhitespace(),this._cs.isEndOfStream()||this._handleCharacter()||this._cs.moveNext()}_handleCharacter(){const e=this._getStringPrefixLength();if(e>=0){let t="";e>0&&(t=this._cs.getText().substr(this._cs.position,e),this._cs.advance(e));const n=this._getQuoteTypeFlags(t);if(0!==n)return this._handleString(n,e),!0}if(35===this._cs.currentChar)return this._handleComment(),!0;switch(this._cs.currentChar){case 65279:return 0!==this._cs.position&&this._handleInvalid();case 13:{const e=10===this._cs.nextChar?2:1,t=2===e?2:0;return this._handleNewLine(e,t),!0}case 10:return this._handleNewLine(1,1),!0;case 92:return 13===this._cs.nextChar?(10===this._cs.lookAhead(2)?this._cs.advance(3):this._cs.advance(2),this._addLineRange(),!0):10===this._cs.nextChar?(this._cs.advance(2),this._addLineRange(),!0):this._handleInvalid();case 40:this._parenDepth++,this._tokens.push(o.Token.create(13,this._cs.position,1,this._getComments()));break;case 41:this._parenDepth>0&&this._parenDepth--,this._tokens.push(o.Token.create(14,this._cs.position,1,this._getComments()));break;case 91:this._parenDepth++,this._tokens.push(o.Token.create(15,this._cs.position,1,this._getComments()));break;case 93:this._parenDepth>0&&this._parenDepth--,this._tokens.push(o.Token.create(16,this._cs.position,1,this._getComments()));break;case 123:this._parenDepth++,this._tokens.push(o.Token.create(17,this._cs.position,1,this._getComments()));break;case 125:this._parenDepth>0&&this._parenDepth--,this._tokens.push(o.Token.create(18,this._cs.position,1,this._getComments()));break;case 44:this._tokens.push(o.Token.create(12,this._cs.position,1,this._getComments()));break;case 96:this._tokens.push(o.Token.create(22,this._cs.position,1,this._getComments()));break;case 59:this._tokens.push(o.Token.create(11,this._cs.position,1,this._getComments()));break;case 58:if(61===this._cs.nextChar){this._tokens.push(o.OperatorToken.create(this._cs.position,2,35,this._getComments())),this._cs.advance(1);break}this._tokens.push(o.Token.create(10,this._cs.position,1,this._getComments()));break;default:if(this._isPossibleNumber()&&this._tryNumber())return!0;if(46===this._cs.currentChar){if(46===this._cs.nextChar&&46===this._cs.lookAhead(2))return this._tokens.push(o.Token.create(19,this._cs.position,3,this._getComments())),this._cs.advance(3),!0;this._tokens.push(o.Token.create(20,this._cs.position,1,this._getComments()));break}return!(!this._tryIdentifier()&&!this._tryOperator())||this._handleInvalid()}return!1}_addLineRange(){const e=this._cs.position-this._prevLineStart;e>0&&this._lineRanges.push({start:this._prevLineStart,length:e}),this._prevLineStart=this._cs.position}_handleNewLine(e,t){0===this._parenDepth&&3!==t&&(0!==this._tokens.length&&2===this._tokens[this._tokens.length-1].type||this._tokens.push(o.NewLineToken.create(this._cs.position,e,t,this._getComments()))),0===t?this._crCount++:2===t?this._crLfCount++:this._lfCount++,this._cs.advance(e),this._addLineRange(),this._readIndentationAfterNewLine()}_readIndentationAfterNewLine(){let e=0,t=0,n=!1,s=!1;for(;!this._cs.isEndOfStream();)switch(this._cs.currentChar){case 32:e++,t++,s=!0,this._cs.moveNext();break;case 9:e++,t+=8-t%8,n=!0,this._cs.moveNext();break;case 12:e=0,t=0,n=!1,s=!1,this._cs.moveNext();break;default:return void this._setIndent(e,t,s,n);case 35:case 10:case 13:return}}_setIndent(e,t,n,s){if(!(this._parenDepth>0))if(0===this._indentAmounts.length)t>0&&(this._indentCount++,s&&this._indentTabCount++,this._indentSpacesTotal+=t,this._indentAmounts.push({tab1Spaces:e,tab8Spaces:t,isSpacePresent:n,isTabPresent:s}),this._tokens.push(o.IndentToken.create(this._cs.position,0,t,!1,this._getComments())));else{const i=this._indentAmounts[this._indentAmounts.length-1];if(i.tab8Spaces<t){const r=(i.isSpacePresent&&s||i.isTabPresent&&n)&&i.tab1Spaces>=e;this._indentCount++,s&&this._indentTabCount++,this._indentSpacesTotal+=t-this._indentAmounts[this._indentAmounts.length-1].tab8Spaces,this._indentAmounts.push({tab1Spaces:e,tab8Spaces:t,isSpacePresent:n,isTabPresent:s}),this._tokens.push(o.IndentToken.create(this._cs.position,0,t,r,this._getComments()))}else{const e=[];for(;this._indentAmounts.length>0&&this._indentAmounts[this._indentAmounts.length-1].tab8Spaces>t;)e.push(this._indentAmounts.length>1?this._indentAmounts[this._indentAmounts.length-2].tab8Spaces:0),this._indentAmounts.pop();e.forEach((n,s)=>{const i=s<e.length-1||n===t,r=s<e.length-1?n:t;this._tokens.push(o.DedentToken.create(this._cs.position,0,r,i,this._getComments()))})}}}_tryIdentifier(){const e=this._cs.position;if(i.isIdentifierStartChar(this._cs.currentChar))for(this._cs.moveNext();i.isIdentifierChar(this._cs.currentChar);)this._cs.moveNext();if(this._cs.position>e){const t=this._cs.getText().substr(e,this._cs.position-e);return void 0!==a[t]?this._tokens.push(o.KeywordToken.create(e,this._cs.position-e,a[t],this._getComments())):this._tokens.push(o.IdentifierToken.create(e,this._cs.position-e,t,this._getComments())),!0}return!1}_isPossibleNumber(){return!!i.isDecimal(this._cs.currentChar)||!(46!==this._cs.currentChar||!i.isDecimal(this._cs.nextChar))}_tryNumber(){const e=this._cs.position;if(48===this._cs.currentChar){let t=0,n=0;if((120===this._cs.nextChar||88===this._cs.nextChar)&&i.isHex(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;i.isHex(this._cs.currentChar);)this._cs.moveNext();t=16}if((98===this._cs.nextChar||66===this._cs.nextChar)&&i.isBinary(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;i.isBinary(this._cs.currentChar);)this._cs.moveNext();t=2}if((111===this._cs.nextChar||79===this._cs.nextChar)&&i.isOctal(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;i.isOctal(this._cs.currentChar);)this._cs.moveNext();t=8}if(t>0){const s=this._cs.getText().substr(e,this._cs.position-e),i=parseInt(s.substr(n).replace(/_/g,""),t);if(!isNaN(i))return this._tokens.push(o.NumberToken.create(e,s.length,i,!0,!1,this._getComments())),!0}}let t=!1,n=!1;if(this._cs.currentChar>=49&&this._cs.currentChar<=57){for(;i.isDecimal(this._cs.currentChar);)n=!0,this._cs.moveNext();t=46!==this._cs.currentChar&&101!==this._cs.currentChar&&69!==this._cs.currentChar}if(48===this._cs.currentChar){for(n=!0;48===this._cs.currentChar||95===this._cs.currentChar;)this._cs.moveNext();t=46!==this._cs.currentChar&&101!==this._cs.currentChar&&69!==this._cs.currentChar}if(t){let t=this._cs.getText().substr(e,this._cs.position-e);const n=parseInt(t.replace(/_/g,""),10);if(!isNaN(n)){let s=!1;return 106!==this._cs.currentChar&&74!==this._cs.currentChar||(s=!0,t+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),this._tokens.push(o.NumberToken.create(e,t.length,n,!0,s,this._getComments())),!0}}if(this._cs.position=e,(n||46===this._cs.currentChar&&this._cs.nextChar>=48&&this._cs.nextChar<=57)&&this._skipFloatingPointCandidate()){let t=this._cs.getText().substr(e,this._cs.position-e);const n=parseFloat(t);if(!isNaN(n)){let s=!1;return 106!==this._cs.currentChar&&74!==this._cs.currentChar||(s=!0,t+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),this._tokens.push(o.NumberToken.create(e,this._cs.position-e,n,!1,s,this._getComments())),!0}}return this._cs.position=e,!1}_tryOperator(){let e=0;const t=this._cs.nextChar;let n;switch(this._cs.currentChar){case 43:e=61===t?2:1,n=2===e?1:0;break;case 38:e=61===t?2:1,n=2===e?4:3;break;case 124:e=61===t?2:1,n=2===e?7:6;break;case 94:e=61===t?2:1,n=2===e?9:8;break;case 61:e=61===t?2:1,n=2===e?12:2;break;case 33:if(61!==t)return!1;e=2,n=28;break;case 37:e=61===t?2:1,n=2===e?25:24;break;case 126:e=1,n=5;break;case 45:if(62===t)return this._tokens.push(o.Token.create(21,this._cs.position,2,this._getComments())),this._cs.advance(2),!0;e=61===t?2:1,n=2===e?34:33;break;case 42:42===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?30:29):(e=61===t?2:1,n=2===e?27:26);break;case 47:47===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?14:13):(e=61===t?2:1,n=2===e?11:10);break;case 60:60===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?18:17):62===t?(e=2,n=19):(e=61===t?2:1,n=2===e?21:20);break;case 62:62===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?32:31):(e=61===t?2:1,n=2===e?16:15);break;case 64:e=61===t?2:1,n=2===e?23:22;break;default:return!1}return this._tokens.push(o.OperatorToken.create(this._cs.position,e,n,this._getComments())),this._cs.advance(e),e>0}_handleInvalid(){const e=this._cs.position;for(;10!==this._cs.currentChar&&13!==this._cs.currentChar&&!this._cs.isAtWhiteSpace()&&!this._cs.isEndOfStream();)this._cs.moveNext();const t=this._cs.position-e;return t>0&&(this._tokens.push(o.Token.create(0,e,t,this._getComments())),!0)}_getComments(){const e=this._comments;return this._comments=void 0,e}_handleComment(){const e=this._cs.position+1;this._cs.skipToEol();const t=this._cs.position-e,n=this._cs.getText().substr(e,t),s=o.Comment.create(e,t,n);n.match(/^\s*type:\s*ignore(\s|\[|$)/)&&(this._tokens.findIndex(e=>2!==e.type&&e&&3!==e.type)<0?this._typeIgnoreAll=!0:this._typeIgnoreLines[this._lineRanges.length]=!0),this._comments?this._comments.push(s):this._comments=[s]}_getStringPrefixLength(){if(39===this._cs.currentChar||34===this._cs.currentChar)return 0;if(39===this._cs.nextChar||34===this._cs.nextChar)switch(this._cs.currentChar){case 102:case 70:case 114:case 82:case 98:case 66:case 117:case 85:return 1}if(39===this._cs.lookAhead(2)||34===this._cs.lookAhead(2))switch(this._cs.getText().substr(this._cs.position,2).toLowerCase()){case"rf":case"fr":case"ur":case"ru":case"br":case"rb":return 2}return-1}_getQuoteTypeFlags(e){let t=0;e=e.toLowerCase();for(let n=0;n<e.length;n++)switch(e[n]){case"u":t|=16;break;case"b":t|=32;break;case"r":t|=8;break;case"f":t|=64}return 39===this._cs.currentChar?(t|=1,39===this._cs.nextChar&&39===this._cs.lookAhead(2)&&(t|=4)):34===this._cs.currentChar&&(t|=2,34===this._cs.nextChar&&34===this._cs.lookAhead(2)&&(t|=4)),t}_handleString(e,t){const n=this._cs.position-t;4&e?this._cs.advance(3):(this._cs.moveNext(),1&e?this._singleQuoteCount++:this._doubleQuoteCount++);const s=this._skipToEndOfStringLiteral(e),i=this._cs.position;this._tokens.push(o.StringToken.create(n,i-n,s.flags,s.escapedValue,t,this._getComments()))}_skipToEndOfStringLiteral(e){const t=1&e?39:34,n=0!=(4&e);let s="";for(;;){if(this._cs.isEndOfStream())return{escapedValue:s,flags:e|=65536};if(92===this._cs.currentChar)s+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext(),13===this._cs.getCurrentChar()||10===this._cs.getCurrentChar()?(13===this._cs.getCurrentChar()&&10===this._cs.nextChar&&(s+=String.fromCharCode(this._cs.getCurrentChar()),this._cs.moveNext()),s+=String.fromCharCode(this._cs.getCurrentChar()),this._cs.moveNext(),this._addLineRange()):(s+=String.fromCharCode(this._cs.getCurrentChar()),this._cs.moveNext());else if(10===this._cs.currentChar||13===this._cs.currentChar){if(!n)return{escapedValue:s,flags:e|=65536};13===this._cs.currentChar&&10===this._cs.nextChar&&(s+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),s+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext(),this._addLineRange()}else{if(!n&&this._cs.currentChar===t){this._cs.moveNext();break}if(n&&this._cs.currentChar===t&&this._cs.nextChar===t&&this._cs.lookAhead(2)===t){this._cs.advance(3);break}s+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()}}return{escapedValue:s,flags:e}}_skipFloatingPointCandidate(){const e=this._cs.position;return this._skipFractionalNumber(),this._cs.position>e&&(101!==this._cs.currentChar&&69!==this._cs.currentChar||(this._cs.moveNext(),this._skipDecimalNumber(!0))),this._cs.position>e}_skipFractionalNumber(){this._skipDecimalNumber(!1),46===this._cs.currentChar&&this._cs.moveNext(),this._skipDecimalNumber(!1)}_skipDecimalNumber(e){for(!e||45!==this._cs.currentChar&&43!==this._cs.currentChar||this._cs.moveNext();i.isDecimal(this._cs.currentChar);)this._cs.moveNext()}}},6180:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentifierToken=t.OperatorToken=t.NumberToken=t.StringToken=t.KeywordToken=t.NewLineToken=t.DedentToken=t.IndentToken=t.Token=t.Comment=void 0,(t.Comment||(t.Comment={})).create=function(e,t,n){return{start:e,length:t,value:n}},(t.Token||(t.Token={})).create=function(e,t,n,s){return{start:t,length:n,type:e,comments:s}},(t.IndentToken||(t.IndentToken={})).create=function(e,t,n,s,i){return{start:e,length:t,type:3,isIndentAmbiguous:s,comments:i,indentAmount:n}},(t.DedentToken||(t.DedentToken={})).create=function(e,t,n,s,i){return{start:e,length:t,type:4,comments:i,indentAmount:n,matchesIndent:s}},(t.NewLineToken||(t.NewLineToken={})).create=function(e,t,n,s){return{start:e,length:t,type:2,comments:s,newLineType:n}},(t.KeywordToken||(t.KeywordToken={})).create=function(e,t,n,s){return{start:e,length:t,type:8,comments:s,keywordType:n}},(t.StringToken||(t.StringToken={})).create=function(e,t,n,s,i,r){return{start:e,length:t,type:5,flags:n,escapedValue:s,prefixLength:i,quoteMarkLength:4&n?3:1,comments:r}},(t.NumberToken||(t.NumberToken={})).create=function(e,t,n,s,i,r){return{start:e,length:t,type:6,isInteger:s,isImaginary:i,value:n,comments:r}},(t.OperatorToken||(t.OperatorToken={})).create=function(e,t,n,s){return{start:e,length:t,type:9,operatorType:n,comments:s}},(t.IdentifierToken||(t.IdentifierToken={})).create=function(e,t,n,s){return{start:e,length:t,type:7,value:n,comments:s}}},7770:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unicodePc=t.unicodeNd=t.unicodeMc=t.unicodeMn=t.unicodeNl=t.unicodeLm=t.unicodeLo=t.unicodeLt=t.unicodeLl=t.unicodeLu=void 0,t.unicodeLu=[[65,90],[192,214],[216,222],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,452,455,458,461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,497,500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],975,[978,980],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1012,1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],[4256,4293],4295,4301,[5024,5109],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8120,8123],[8136,8139],[8152,8155],[8168,8172],[8184,8187],8450,8455,[8459,8461],[8464,8466],8469,[8473,8477],8484,8486,8488,[8490,8493],[8496,8499],[8510,8511],8517,8579,[11264,11310],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,[65313,65338],[66560,66599],[66736,66771],[68736,68786],[71840,71871],[119808,119833],[119860,119885],[119912,119937],119964,[119966,119967],119970,[119973,119974],[119977,119980],[119982,119989],[120016,120041],[120068,120069],[120071,120074],[120077,120084],[120086,120092],[120120,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120172,120197],[120224,120249],[120276,120301],[120328,120353],[120380,120405],[120432,120457],[120488,120512],[120546,120570],[120604,120628],[120662,120686],[120720,120744],120778,[125184,125217]],t.unicodeLl=[[97,122],181,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,[311,312],314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,[396,397],402,405,[409,411],414,417,419,421,424,[426,427],429,432,436,438,[441,442],[445,447],454,457,460,462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,496],499,501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,545,547,549,551,553,555,557,559,561,[563,569],572,[575,576],578,583,585,587,589,[591,659],[661,687],881,883,887,[891,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,[1019,1020],[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1377,1415],[5112,5117],[7296,7304],[7424,7467],[7531,7543],[7545,7578],7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7837],7839,7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8071],[8080,8087],[8096,8103],[8112,8116],[8118,8119],8126,[8130,8132],[8134,8135],[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8458,[8462,8463],8467,8495,8500,8505,[8508,8509],[8518,8521],8526,8580,[11312,11358],11361,[11365,11366],11368,11370,11372,11377,[11379,11380],[11382,11387],11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,[11491,11492],11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,2581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,42651,42787,42789,42791,42793,42795,42797,[42799,42801],42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,42863,[42865,42872],42874,42876,42879,42881,42883,42885,42887,42892,42894,42897,[42899,42901],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42933,42935,43002,[43824,43866],[43872,43877],[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[68800,68850],[71872,71903],[119834,119859],[119886,119892],[119894,119911],[119938,119963],[119990,119993],119995,[119997,120003],[120005,120015],[120042,120067],[120094,120119],[120146,120171],[120198,120223],[120250,120275],[120302,120327],[120354,120379],[120406,120431],[120458,120485],[120514,120538],[120540,120545],[120572,120596],[120598,120603],[120630,120654],[120656,120661],[120688,120712],[120714,120719],[120746,120770],[120772,120777],120779,[125218,125251]],t.unicodeLt=[453,456,459,498,[8072,8079],[8088,8095],[8104,8111],8124,8140,8188],t.unicodeLo=[170,186,443,[448,451],660,[1488,1514],[1520,1522],[1568,1599],[1601,1610],[1646,1647],[1649,1747],1749,[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2048,2069],[2112,2136],[2144,2154],[2208,2228],[2230,2237],[2308,2361],2365,2384,[2392,2401],[2418,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,3294,[3296,3297],[3313,3314],[3333,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],[3634,3635],[3648,3653],[3713,3714],3716,[3719,3720],3722,3725,[3732,3735],[3737,3743],[3745,3747],3749,3751,[3754,3755],[3757,3760],[3762,3763],3773,[3776,3780],[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4304,4346],[4349,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5873,5880],[5888,5900],[5902,5905],[5920,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6108,[6176,6210],[6212,6263],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],[6917,6963],[6981,6987],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7287],[7401,7404],[7406,7409],[7413,7414],[8501,8504],[11568,11623],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],12294,12348,[12353,12438],12447,[12449,12538],12543,[12549,12590],[12593,12686],[12704,12730],[12784,12799],[13312,19893],[19968,40938],[40960,40980],[40982,42124],[42192,42231],[42240,42507],[42512,42527],[42538,42539],42606,[42656,42725],42895,42999,[43003,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,43261,[43274,43301],[43312,43334],[43360,43388],[43396,43442],[43488,43492],[43495,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43631],[43633,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43740],[43744,43754],43762,[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43968,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65382,65391],[65393,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[66176,66204],[66208,66256],[66304,66335],[66349,66368],[66370,66377],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66640,66717],[66816,66855],[66864,66915],[67072,67382],[67392,67413],[67424,67431],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68147],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[69635,69687],[69763,69807],[69840,69864],[69891,69926],[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],[71424,71449],71935,72192,[72203,72242],72250,72272,[72284,72323],[72326,72329],[72384,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73728,74649],[74880,75075],[77824,78894],[82944,83526],[92160,92728],[92736,92766],[92880,92909],[92928,92975],[93027,93047],[93053,93071],[93952,94020],94032,[94208,100332],[100352,101106],[110592,110878],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[124928,125124],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173782],[173824,177972],[177984,178205],[178208,183969],[183984,191456],[194560,195101]],t.unicodeLm=[[688,705],[710,721],[736,740],748,750,884,890,1369,1600,[1765,1766],[2036,2037],2042,2074,2084,2088,2417,3654,3782,4348,6103,6211,6823,[7288,7293],[7468,7530],7544,[7579,7615],8305,8319,[8336,8348],[11388,11389],11631,11823,12293,[12337,12341],12347,[12445,12446],[12540,12542],40981,[42232,42237],42508,42623,[42652,42653],[42775,42783],42864,42888,[43e3,43001],43471,43494,43632,43741,[43763,43764],[43868,43871],65392,[65438,65439],[92992,92995],[94099,94111],[94176,94177]],t.unicodeNl=[[5870,5872],[8544,8578],[8581,8584],12295,[12321,12329],[12344,12346],[42726,42735],[65856,65908],66369,66378,[66513,66517],[74752,74862]],t.unicodeMn=[[768,879],[1155,1159],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2260,2273],[2275,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2433,2492,[2497,2500],2509,[2530,2531],[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,2879,[2881,2884],2893,2902,[2914,2915],2946,3008,3021,3072,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,3263,3270,[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],3405,[3426,3427],3530,[3538,3540],3542,3633,[3636,3642],[3655,3662],3761,[3764,3769],[3771,3772],[3784,3789],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,[4957,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6109,[6155,6157],[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,[6832,6845],[6912,6915],6964,[6966,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7673],[7675,7679],[8400,8412],8417,[8421,8432],[11503,11505],11647,[11744,11775],[12330,12333],[12441,12442],42607,[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43045,43046],[43204,43205],[43232,43249],[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],43452,43493,[43561,43566],[43569,43570],[43573,43574],43587,43596,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,[43756,43757],43766,44005,44008,44013,64286,[65024,65039],[65056,65071],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],69633,[69688,69702],[69759,69761],[69811,69814],[69817,69818],[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70090,70092],[70191,70193],70196,[70198,70199],70206,70367,[70371,70378],[70400,70401],70460,70464,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,[70835,70840],70842,[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[72193,72198],[72201,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],72767,[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[92912,92916],[92976,92982],[94095,94098],[113821,113822],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[125136,125142],[125252,125258],[917760,917999]],t.unicodeMc=[2307,2363,[2366,2368],[2377,2380],[2382,2383],[2434,2435],[2494,2496],[2503,2504],[2507,2508],2519,2563,[2622,2624],2691,[2750,2752],2761,[2763,2764],[2818,2819],2878,2880,[2887,2888],[2891,2892],2903,[3006,3007],[3009,3010],[3014,3016],[3018,3020],3031,[3073,3075],[3137,3140],[3202,3203],3262,[3264,3268],[3271,3272],[3274,3275],[3285,3286],[3330,3331],[3390,3392],[3398,3400],[3402,3404],3415,[3458,3459],[3535,3537],[3544,3551],[3570,3571],[3902,3903],3967,[4139,4140],4145,4152,[4155,4156],[4182,4183],[4194,4196],[4199,4205],[4227,4228],[4231,4236],4239,[4250,4252],6070,[6078,6085],[6087,6088],[6435,6438],[6441,6443],[6448,6449],[6451,6456],[6681,6682],6741,6743,6753,[6755,6756],[6765,6770],6916,6965,6971,[6973,6977],[6979,6980],7042,7073,[7078,7079],7082,7143,[7146,7148],7150,[7154,7155],[7204,7211],[7220,7221],7393,[7410,7411],7415,[12334,12335],[43043,43044],43047,[43136,43137],[43188,43203],[43346,43347],43395,[43444,43445],[43450,43451],[43453,43456],[43567,43568],[43571,43572],43597,43643,43645,43755,[43758,43759],43765,[44003,44004],[44006,44007],[44009,44010],44012,69632,69634,69762,[69808,69810],[69815,69816],69932,70018,[70067,70069],[70079,70080],[70188,70190],[70194,70195],70197,[70368,70370],[70402,70403],[70462,70463],[70465,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70709,70711],[70720,70721],70725,[70832,70834],70841,[70843,70846],70849,[71087,71089],[71096,71099],71102,[71216,71218],[71227,71228],71230,71340,[71342,71343],71350,[71456,71457],71462,[72199,72200],72249,[72279,72280],72343,72751,72766,72873,72881,72884,[94033,94078],[119141,119142],[119149,119154]],t.unicodeNd=[[48,57],[1632,1641],[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2662,2671],[2790,2799],[2918,2927],[3046,3055],[3174,3183],[3302,3311],[3430,3439],[3558,3567],[3664,3673],[3792,3801],[3872,3881],[4160,4169],[4240,4249],[6112,6121],[6160,6169],[6470,6479],[6608,6617],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],[42528,42537],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[65296,65305],[66720,66729],[69734,69743],[69872,69881],[69942,69951],[70096,70105],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71481],[71904,71913],[72784,72793],[73040,73049],[92768,92777],[93008,93017],[120782,120831],[125264,125273]],t.unicodePc=[95,[8255,8256],8276,[65075,65076],[65101,65103],65343]},6249:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.main=void 0;const a=n(8718),l=o(n(3893)),c=o(n(2110)),p=r(n(1765)),u=n(2559),d=n(6708),h=n(1775),m=n(2211),y=n(6657),g=n(7830),f=n(3550);var _;!function(e){e[e.NoErrors=0]="NoErrors",e[e.ErrorsReported=1]="ErrorsReported",e[e.FatalError=2]="FatalError",e[e.ConfigFileParseError=3]="ConfigFileParseError"}(_||(_={}));const T=Object.freeze({isCancellationRequested:!1,onCancellationRequested:function(){return{dispose(){}}}});function v(){return n(306).i8.toString()}function b(e,t){return{file:e,severity:0===t.category?"error":"warning",message:t.message,range:f.isEmptyRange(t.range)?void 0:t.range,rule:t.getRule()}}function C(e,t="  "){let n=t;e.range&&!f.isEmptyRange(e.range)&&(n+=l.default.yellow(""+(e.range.start.line+1))+":"+l.default.yellow(""+(e.range.start.character+1))+" - ");const[s,...i]=e.message.split("\n");n+="error"===e.severity?l.default.red("error"):"warning"===e.severity?l.default.cyan("warning"):l.default.blue("info"),n+=": "+s,i.length>0&&(n+="\n"+t+i.join("\n"+t)),e.rule&&(n+=l.default.gray(` (${e.rule})`)),console.log(n)}t.main=function(){!function(){const e=[{name:"createstub",type:String},{name:"dependencies",type:Boolean},{name:"files",type:String,multiple:!0,defaultOption:!0},{name:"help",alias:"h",type:Boolean},{name:"lib",type:Boolean},{name:"outputjson",type:Boolean},{name:"project",alias:"p",type:String},{name:"stats"},{name:"typeshed-path",alias:"t",type:String},{name:"venv-path",alias:"v",type:String},{name:"verifytypes",type:String},{name:"verbose",type:Boolean},{name:"version",type:Boolean},{name:"watch",alias:"w",type:Boolean}];let t;try{t=c.default(e)}catch(e){const t=e;return t&&t.optionName?void console.error(`Unexpected option ${t.optionName}.\npyright --help for usage`):void console.error("Unexpected error\npyright --help for usage")}if(void 0!==t.help)return void console.log("Usage: pyright [options] files...\n  Options:\n  --createstub IMPORT              Create type stub file(s) for import\n  --dependencies                   Emit import dependency information\n  -h,--help                        Show this help message\n  --lib                            Use library code to infer types when stubs are missing\n  --outputjson                     Output results in JSON format\n  -p,--project FILE OR DIRECTORY   Use the configuration file at this location\n  --stats                          Print detailed performance stats\n  -t,--typeshed-path DIRECTORY     Use typeshed type stubs at this location\n  -v,--venv-path DIRECTORY         Directory that contains virtual environments\n  --verbose                        Emit verbose diagnostics\n  --version                        Print Pyright version\n  -w,--watch                       Continue to run and watch for changes\n");if(void 0!==t.version)return void console.log("pyright "+v());if(t.outputjson){const e=["watch","stats","verbose","createstub","dependencies"];for(const n of e)if(void 0!==t[n])return void console.error(`'outputjson' option cannot be used with '${n}' option`)}if(void 0!==t.verifytypes){const e=["watch","stats","createstub","dependencies"];for(const n of e)if(void 0!==t[n])return void console.error(`'verifytypes' option cannot be used with '${n}' option`)}if(t.createstub){const e=["watch","stats","verifytypes","dependencies"];for(const n of e)if(void 0!==t[n])return void console.error(`'createstub' option cannot be used with '${n}' option`)}const n=new h.CommandLineOptions(p.cwd(),!1);t.files&&Array.isArray(t.files)?(n.fileSpecs=t.files,n.fileSpecs=n.fileSpecs.map(e=>y.combinePaths(p.cwd(),e))):n.fileSpecs=[],t.project&&(n.configFilePath=y.combinePaths(p.cwd(),y.normalizePath(t.project))),t["venv-path"]&&(n.venvPath=y.combinePaths(p.cwd(),y.normalizePath(t["venv-path"]))),t["typeshed-path"]&&(n.typeshedPath=y.combinePaths(p.cwd(),y.normalizePath(t["typeshed-path"]))),t.createstub&&(n.typeStubTargetImportName=t.createstub),t.verbose&&(n.verboseOutput=!0),t.lib&&(n.useLibraryCodeForTypes=!0),n.checkOnlyOpenFiles=!1;const s=t.outputjson?new m.NullConsole:void 0,i=g.createFromRealFileSystem(s);void 0!==t.verifytypes&&function(e,t,n,s){try{const i=function(e,t){const n={version:v(),time:Date.now().toString(),diagnostics:[],summary:{filesAnalyzed:t.modules.length,errorCount:0,warningCount:0,informationCount:0,timeInSec:a.timingStats.getTotalDuration()}};return t.diagnostics.forEach(e=>{const t=b("",e);n.diagnostics.push(t),"error"===t.severity?n.summary.errorCount++:"warning"===t.severity?n.summary.warningCount++:"information"===t.severity&&n.summary.informationCount++}),n.typeCompleteness={packageName:e,packageRootDirectory:t.rootDirectory,pyTypedPath:t.pyTypedPath,symbolCount:t.symbolCount,unknownTypeCount:t.unknownTypeCount,missingFunctionDocStringCount:t.missingFunctionDocStringCount,missingClassDocStringCount:t.missingClassDocStringCount,missingDefaultParamCount:t.missingDefaultParamCount,completnessScore:0,modules:[]},t.modules.forEach(e=>{const t={name:e.name,symbols:[]};e.symbols.forEach(e=>{const n={name:e.name,fullName:e.fullName,symbolType:u.PackageTypeVerifier.getSymbolTypeString(e.symbolType)};t.symbols.push(n)}),n.typeCompleteness.modules.push(t)}),t.symbolCount>0&&(n.typeCompleteness.completnessScore=(t.symbolCount-t.unknownTypeCount)/t.symbolCount),n}(t,new u.PackageTypeVerifier(e).verify(t));s?console.log(JSON.stringify(i,void 0,4)):function(e,t){const n=e.typeCompleteness;console.log(`Package name: "${n.packageName}"`),void 0!==n.packageRootDirectory&&console.log(`Package directory: "${n.packageRootDirectory}"`),void 0!==n.pyTypedPath&&console.log(`Path of py.typed file: "${n.pyTypedPath}"`),e.diagnostics.forEach(e=>{"error"===e.severity&&C(e)}),e.diagnostics.forEach(e=>{"error"!==e.severity&&C(e)}),n.modules.length>0&&(console.log(""),console.log("Public modules: "+n.modules.length),n.modules.forEach(e=>{if(console.log(`   ${e.name} (${e.symbols.length} ${1===e.symbols.length?"symbol":"symbols"})`),t)for(const t of e.symbols)console.log(`      ${t.fullName} (${t.symbolType})`)})),console.log(""),console.log("Public symbols: "+n.symbolCount),console.log("  Symbols with unknown type: "+n.unknownTypeCount),console.log("  Functions with missing docstring: "+n.missingFunctionDocStringCount),console.log("  Functions with missing default param: "+n.missingDefaultParamCount),console.log("  Classes with missing docstring: "+n.missingClassDocStringCount),console.log(`Type completeness score: ${Math.round(1e3*n.completnessScore)/10}%`),console.log(""),console.info(`Completed in ${e.summary.timeInSec}sec`)}(i,n),p.exit(i.typeCompleteness.completnessScore<1?_.ErrorsReported:_.NoErrors)}catch(e){let t="";e instanceof Error&&(t=": "+e.message),console.error("Error occurred when verifying types: "+t),p.exit(_.FatalError)}}(i,t.verifytypes||"",!!t.verbose,!!t.outputjson);const r=void 0!==t.watch;n.watchForSourceChanges=r;const o=new d.AnalyzerService("<default>",i,s);o.setCompletionCallback(e=>{e.fatalErrorOccurred&&p.exit(_.FatalError),e.configParseErrorOccurred&&p.exit(_.ConfigFileParseError);let n=0;if(e.diagnostics.length>0&&!t.createstub&&!t.verifytypes)if(t.outputjson){const t=function(e,t,n){const s={version:v(),time:Date.now().toString(),diagnostics:[],summary:{filesAnalyzed:t,errorCount:0,warningCount:0,informationCount:0,timeInSec:n}};let i=0,r=0,o=0;return e.forEach(e=>{e.diagnostics.forEach(t=>{0!==t.category&&1!==t.category&&2!==t.category||(s.diagnostics.push(b(e.filePath,t)),0===t.category?i++:1===t.category?r++:2===t.category&&o++)})}),s.summary.errorCount=i,s.summary.warningCount=r,s.summary.informationCount=o,console.log(JSON.stringify(s,void 0,4)),{errorCount:i,warningCount:r,informationCount:o,diagnosticCount:i+r+o}}(e.diagnostics,e.filesInProgram,e.elapsedTime);n+=t.errorCount}else{const t=function(e){let t=0,n=0,s=0;return e.forEach(e=>{const i=e.diagnostics.filter(e=>3!==e.category);i.length>0&&(console.log(""+e.filePath),i.forEach(i=>{C(b(e.filePath,i)),0===i.category?t++:1===i.category?n++:2===i.category&&s++}))}),console.log(`${t.toString()} ${1===t?"error":"errors"}, ${n.toString()} ${1===n?"warning":"warnings"}, ${s.toString()} ${1===s?"info":"infos"} `),{errorCount:t,warningCount:n,informationCount:s,diagnosticCount:t+n+s}}(e.diagnostics);n+=t.errorCount}if(t.createstub&&0===e.filesRequiringAnalysis){try{o.writeTypeStub(T),o.dispose(),console.log(`Type stub was created for '${t.createstub}'`)}catch(e){let t="";e instanceof Error&&(t=": "+e.message),console.error("Error occurred when creating type stub: "+t),p.exit(_.FatalError)}p.exit(_.NoErrors)}t.outputjson||(r||a.timingStats.printSummary(console),void 0!==t.stats&&(o.printStats(),a.timingStats.printDetails(console)),t.dependencies&&o.printDependencies(!!t.verbose)),r?t.outputjson||console.log("Watching for file changes..."):p.exit(n>0?_.ErrorsReported:_.NoErrors)}),o.setOptions(n),new Promise(()=>{}).then().catch()}()}},8863:function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,r){function o(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.main=void 0;const i=n(4714),r=n(5013),o=n(1887),a=n(9560),l=n(9926),c=n(3213),p=n(2211),u=n(2489),d=n(6657),h=n(8992),m=n(8590),y={openFilesTimeInMs:50,noOpenFilesTimeInMs:200};class g extends h.LanguageServerBase{constructor(){const e=n(306).i8||"";super({productName:"Pyright",rootDirectory:global.__rootDirectory||__dirname,version:e,maxAnalysisTimeInForeground:y,progressReporterFactory:f,supportedCodeActions:[i.CodeActionKind.QuickFix,i.CodeActionKind.SourceOrganizeImports]}),this._controller=new l.CommandController(this)}getSettings(e){return s(this,void 0,void 0,(function*(){const t={watchForSourceChanges:!0,watchForLibraryChanges:!0,openFilesOnly:!0,useLibraryCodeForTypes:!1,disableLanguageServices:!1,disableOrganizeImports:!1,typeCheckingMode:"basic",diagnosticSeverityOverrides:{},logLevel:p.LogLevel.Info,autoImportCompletions:!0};try{const n=yield this.getConfiguration(e.rootUri,"python");if(n){const s=n.pythonPath;s&&u.isString(s)&&!o.isPythonBinary(s)&&(t.pythonPath=d.resolvePaths(e.rootPath,s));const i=n.venvPath;i&&u.isString(i)&&(t.venvPath=d.resolvePaths(e.rootPath,i))}const s=yield this.getConfiguration(e.rootUri,"python.analysis");if(s){const n=s.typeshedPaths;if(n&&Array.isArray(n)&&n.length>0){const s=n[0];s&&u.isString(s)&&(t.typeshedPath=d.resolvePaths(e.rootPath,s))}const i=s.stubPath;i&&u.isString(i)&&(t.stubPath=d.resolvePaths(e.rootPath,i));const r=s.diagnosticSeverityOverrides;if(r)for(const[e,n]of Object.entries(r)){const s=this.getDiagnosticRuleName(e),i=this.getSeverityOverrides(n);s&&i&&(t.diagnosticSeverityOverrides[s]=i)}void 0!==s.diagnosticMode?t.openFilesOnly=this.isOpenFilesOnly(s.diagnosticMode):void 0!==s.openFilesOnly&&(t.openFilesOnly=!!s.openFilesOnly),void 0!==s.useLibraryCodeForTypes&&(t.useLibraryCodeForTypes=!!s.useLibraryCodeForTypes),t.logLevel=this.convertLogLevel(s.logLevel),t.autoSearchPaths=!!s.autoSearchPaths;const o=s.extraPaths;o&&Array.isArray(o)&&o.length>0&&(t.extraPaths=o.filter(e=>e&&u.isString(e)).map(t=>d.resolvePaths(e.rootPath,t))),void 0!==s.typeCheckingMode&&(t.typeCheckingMode=s.typeCheckingMode),void 0!==s.autoImportCompletions&&(t.autoImportCompletions=s.autoImportCompletions)}else t.autoSearchPaths=!0;const i=yield this.getConfiguration(e.rootUri,"pyright");if(i){void 0!==i.openFilesOnly&&(t.openFilesOnly=!!i.openFilesOnly),void 0!==i.useLibraryCodeForTypes&&(t.useLibraryCodeForTypes=!!i.useLibraryCodeForTypes),t.disableLanguageServices=!!i.disableLanguageServices,t.disableOrganizeImports=!!i.disableOrganizeImports;const e=i.typeCheckingMode;e&&u.isString(e)&&(t.typeCheckingMode=e)}}catch(e){this.console.error("Error reading settings: "+e)}return t}))}createBackgroundAnalysis(){if(!u.isDebugMode()&&c.getCancellationFolderName())return new a.BackgroundAnalysis(this.console)}executeCommand(e,t){return this._controller.execute(e,t)}isLongRunningCommand(e){return this._controller.isLongRunningCommand(e)}executeCodeAction(e,t){return s(this,void 0,void 0,(function*(){this.recordUserInteractionTime();const n=d.convertUriToPath(e.textDocument.uri),s=yield this.getWorkspaceForFile(n);return m.CodeActionProvider.getCodeActionsForPosition(s,n,e.range,t)}))}}function f(e){return{isEnabled:e=>!0,begin(){e.sendNotification("pyright/beginProgress")},report(t){e.sendNotification("pyright/reportProgress",t)},end(){e.sendNotification("pyright/endProgress")}}}t.main=function(){r.isMainThread?new g:(new a.BackgroundAnalysisRunner).start()}},214:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceMap=void 0;const s=n(8304);class i extends Map{constructor(e){super(),this._ls=e,this._defaultWorkspacePath="<default>"}getNonDefaultWorkspaces(){const e=[];return this.forEach(t=>{t.rootPath&&e.push(t)}),e}getWorkspaceForFile(e){let t,n;if(this.forEach(s=>{s.rootPath&&e.startsWith(s.rootPath)&&(void 0===t||s.rootPath.startsWith(t))&&(t=s.rootPath,n=s)}),void 0===n){let e=this.get(this._defaultWorkspacePath);if(!e){const t=[...this.keys()];if(1===t.length)return this.get(t[0]);e={workspaceName:"",rootPath:"",rootUri:"",serviceInstance:this._ls.createAnalyzerService(this._defaultWorkspacePath),disableLanguageServices:!1,disableOrganizeImports:!1,isInitialized:s.createDeferred()},this.set(this._defaultWorkspacePath,e),this._ls.updateSettingsForWorkspace(e).ignoreErrors()}return e}return n}}t.WorkspaceMap=i}};
//# sourceMappingURL=pyright-internal.js.map