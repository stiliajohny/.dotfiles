(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b8d39cb"],{"2b10":function(t,e){function a(t,e,a){var n=-1,s=t.length;e<0&&(e=-e>s?0:s+e),a=a>s?s:a,a<0&&(a+=s),s=e>a?0:a-e>>>0,e>>>=0;var i=Array(s);while(++n<s)i[n]=t[n+e];return i}t.exports=a},3482:function(t,e,a){var n=a("087d"),s=a("5c69"),i=a("4359"),r=a("6747");function o(){var t=arguments.length;if(!t)return[];var e=Array(t-1),a=arguments[0],o=t;while(o--)e[o-1]=arguments[o];return n(r(a)?i(a):[a],s(e,1))}t.exports=o},"69f3":function(t,e,a){t.exports=a("a59b")},"8c57":function(t,e,a){"use strict";var n=a("ce02"),s=a.n(n);s.a},a59b:function(t,e){function a(t){return t&&t.length?t[0]:void 0}t.exports=a},b2fc:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sunburst"},[t._m(0),a("div",{staticClass:"main"},[a("div",{staticClass:"chart"},[a("div",{staticClass:"explanation"},[a("div",{staticClass:"base"},[t._v(t._s(t.centerMsg))]),t._m(1)])])])])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sidebar"},[a("div",{staticClass:"legend"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hover",staticStyle:{visibility:"hidden"}},[a("div",{staticClass:"date"}),a("div",{staticClass:"title"}),a("div",{staticClass:"time"}),a("div",{staticClass:"duration"}),a("div",{staticClass:"data",staticStyle:{"text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"}})])}],i=a("ce20"),r=a.n(i),o=a("69f3"),c=a.n(o),l=a("3482"),d=a.n(l),u=a("c707"),h=a.n(u),f=a("5acd");const p=a("5698"),m=a("c1df"),v=a("9031"),g=750,y=600,x=Math.min(g,y)/2,w={afk:v.getColorFromString("afk"),"not-afk":v.getColorFromString("not-afk"),hibernating:v.getColorFromString("hibernating")};let b,C,k,M;function A(t){b=p.select(".chart"),b.selectAll("svg").remove(),C=b.append("svg:svg").attr("width",g).attr("height",y).append("svg:g").attr("id","container").attr("transform","translate("+g/2+","+y/2+")"),z(t),k=p.partition().size([2*Math.PI,x*x]),M=p.arc().startAngle((function(t){return t.x0})).endAngle((function(t){return t.x1})).innerRadius((function(t){return Math.sqrt(t.y0)})).outerRadius((function(t){return Math.sqrt(t.y1)}))}function _(t){const e=Math.cos(t),a=Math.sin(t);C.append("line").attr("x1",170*e).attr("y1",170*a).attr("x2",155*e).attr("y2",155*a).style("stroke","#CCC").style("stroke-width",1)}function O(t,e,a){const n=2*Math.PI*(t/24+e/24/60)-.5*Math.PI;_(n);const s=Math.cos(n),i=Math.sin(n);C.append("text").text(a||m({hours:t}).format("HH:mm")).attr("text-anchor","middle").attr("font-size","1.2em").style("fill","#999").attr("x",130*s).attr("y",5+140*i)}function I(t,e){$(),t.querySelector("#container").innerHTML="",C.append("svg:circle").attr("r",x).style("opacity",0);let a=p.hierarchy(e),n=k(a);const s=!0;if(s){const t=!0;let a=m(e.timestamp),s=m(e.timestamp).add(e.duration,"seconds");if(t){a=a.startOf("day"),s=a.clone().endOf("day"),O(0,0),O(6,0),O(12,0),O(18,0);const t=m();O(t.hour(),t.minute(),"Now")}n=n.each((function(t){const e=m(t.data.timestamp).diff(a,"seconds",!0),n=m(t.data.timestamp).add(t.data.duration,"seconds").diff(a,"seconds",!0),i=Math.max(0,e/((s-a)/1e3)),r=Math.min(1,n/((s-a)/1e3));t.x0=2*Math.PI*i,t.x1=2*Math.PI*r})).descendants()}else a=a.sum(t=>t.duration).sort((t,e)=>JSON.stringify(t.data.data).localeCompare(JSON.stringify(e.data.data))),n=n.descendants();n=n.filter((function(t){const e=.001;return t.x1-t.x0>e})),C.data([e]).selectAll("path").data(n).enter().append("svg:path").attr("display",(function(t){return t.depth?null:"none"})).attr("d",M).attr("fill-rule","evenodd").style("fill",(function(t){return v.getColorFromString(t.data.data.status||t.data.data.app)})).style("opacity",1).on("mouseover",E).on("click",S),p.select("#container").on("mouseleave",H)}function S(t){console.log("Clicked"),console.log(t)}function B(t){const e=p.select(".explanation > .hover"),a=m(t.data.timestamp);e.select(".date").text(a.format("YYYY-MM-DD")),e.select(".time").text(a.format("HH:mm:ss"));const n=Object(f["seconds_to_duration"])(t.data.duration);e.select(".duration").text(n),e.select(".title").text(t.data.data.app||t.data.data.status),e.select(".data").text(t.data.data.title||""),p.select(".explanation > .base").style("display","none"),e.style("visibility","")}function E(t){B(t);const e=t.ancestors().reverse();e.shift(),b.selectAll("path").style("opacity",.5),b.selectAll("path").filter((function(t){return e.indexOf(t)>=0})).style("opacity",1)}function H(){b.selectAll("path").on("mouseover",null),b.selectAll("path").transition().duration(100).style("opacity",1).on("end",(function(){p.select(this).on("mouseover",E)})),b.select(".explanation > .base").style("display",""),b.select(".explanation > .hover").style("visibility","hidden")}function $(){const t=p.select(".sequence").append("svg:svg").attr("width",g).attr("height",50).attr("id","trail");t.append("svg:text").attr("id","endlabel").style("fill","#000")}function z(){const t={w:75,h:30,s:3,r:3},e=p.select(".legend").append("svg:svg").attr("width",t.w).attr("height",p.keys(w).length*(t.h+t.s)),a=e.selectAll("g").data(p.entries(w)).enter().append("svg:g").attr("transform",(function(e,a){return"translate(0,"+a*(t.h+t.s)+")"}));a.append("svg:rect").attr("rx",t.r).attr("ry",t.r).attr("width",t.w).attr("height",t.h).style("fill",(function(t){return t.value})),a.append("svg:text").attr("x",t.w/2).attr("y",t.h/2).attr("dy","0.35em").attr("text-anchor","middle").text((function(t){return t.key}))}var P={create:A,update:I},q=a("c1df"),F=a.n(q),J={name:"aw-sunburst-clock",props:["date","afkBucketId","windowBucketId"],data:()=>{return{starttime:F()(),endtime:F()(),centerMsg:"Loading..."}},watch:{date:function(t){this.starttime=F()(t),this.endtime=F()(this.starttime).add(1,"days"),this.visualize()}},mounted:function(){P.create(this.$el),this.starttime=F()(this.date),this.endtime=F()(this.date).add(1,"days"),this.visualize()},methods:{todaysEvents:function(t){return this.$aw.getEvents(t,{limit:-1,start:this.starttime.format(),end:this.endtime.format()})},visualize:function(){function t(t,e){t=h()(t,"timestamp","desc"),e=h()(e,"timestamp","desc");let a=0;for(let r=0;r<t.length;r++){const n=t[r],s=F()(n.timestamp),i=s.clone().add(n.duration,"seconds");n.children=[];while(a<e.length){const t=e[a],r=F()(t.timestamp),o=r.clone().add(t.duration,"seconds"),c=o.isBefore(s),l=r.isAfter(s)&&o.isBefore(i),u=r.isAfter(i);if(c)a++;else if(l)n.children=d()(n.children,t),a++;else{if(u)break;console.warn("Between parents"),n.children=d()(n.children,t),a++}}}const n=F()(c()(t).timestamp),s=F()(r()(t).timestamp),i=(s-n)/1e3;return{timestamp:c()(t).timestamp,duration:i,data:{title:"ROOT"},children:t}}this.todaysEvents(this.afkBucketId).then(e=>{this.todaysEvents(this.windowBucketId).then(a=>{let n=null;e.length>0&&a.length>0?(n=t(e,a),this.centerMsg="Hover to inspect"):(n={timestamp:"",duration:0,data:{title:"ROOT"},children:[]},this.centerMsg="No data"),P.update(this.$el,n)})})}}},N=J,R=(a("8c57"),a("2877")),Y=Object(R["a"])(N,n,s,!1,null,"6b529888",null);e["default"]=Y.exports},ce02:function(t,e,a){},ce20:function(t,e,a){var n=a("2b10");function s(t){var e=null==t?0:t.length;return e?n(t,1,e):[]}t.exports=s}}]);
//# sourceMappingURL=chunk-4b8d39cb.ef774457.js.map