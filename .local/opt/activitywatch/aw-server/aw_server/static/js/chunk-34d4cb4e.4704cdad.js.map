{"version":3,"sources":["webpack:///./src/visualizations/CategoryTree.vue?2118","webpack:///./src/visualizations/CategoryTree.vue?68cd","webpack:///src/visualizations/CategoryTree.vue","webpack:///./src/visualizations/CategoryTree.vue?1603","webpack:///./src/visualizations/CategoryTree.vue?fb54"],"names":["render","_vm","this","_h","$createElement","_c","_self","_l","cat","staticStyle","style","depth","_v","_e","_s","subname","_f","duration","staticRenderFns","_","classes","name","props","computed","category_hierarchy","events","JSON","parse","stringify","hier","build_category_hierarchy","map","e","cats","flatten_category_hierarchy","c","sumBy","filter","pcat","data","slice","length","isEqual","_get_child_cats","all_cats","parent","_assign_children","child_cats","children","sortBy","cc","cats_with_depth0","_flatten_hierarchy","flattenDeep","flatten","component"],"mappings":"yIAAA,yBAAqmB,EAAG,G,yCCAxmB,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAMJ,EAAIM,GAAIN,EAAsB,oBAAE,SAASO,GAAK,OAAOH,EAAG,MAAM,CAACI,YAAY,CAAC,QAAU,oBAAoB,CAACJ,EAAG,OAAO,CAACK,MAAO,iBAAmBF,EAAIG,MAAQ,MAAO,CAAEH,EAAIG,MAAQ,EAAGN,EAAG,OAAO,CAACJ,EAAIW,GAAG,QAAQX,EAAIY,KAAKZ,EAAIW,GAAGX,EAAIa,GAAGN,EAAIO,YAAYV,EAAG,OAAO,CAACI,YAAY,CAAC,MAAQ,UAAU,CAACR,EAAIW,GAAGX,EAAIa,GAAGb,EAAIe,GAAG,mBAAPf,CAA2BO,EAAIS,mBAAkB,IACpcC,EAAkB,GCiBtB,MAAMC,EAAI,EAAV,QACMC,EAAU,EAAhB,QAUA,OACEC,KAAM,kBACNC,MAAO,CAAC,UACRC,SAAU,CACRC,mBAAoB,WAClB,MAAMC,EAASC,KAAKC,MAAMD,KAAKE,UAAU1B,KAAKuB,SAExCI,EAAOT,EAAQU,yBAAyBX,EAAEY,IAAIN,EAAQO,IAC1D,MAAO,CAAf,6BAGM,IAAIC,EAAOb,EAAQc,2BAA2BL,GAAME,IAAII,IAKtD,OAJAA,EAAElB,SAAWE,EAAEiB,MAAMX,EAAOY,OAAOL,IACjC,MAAMM,EAAON,EAAEO,KAAK,aAAaC,MAAM,EAAGL,EAAEd,KAAKoB,QACjD,OAAOtB,EAAEuB,QAAQP,EAAEd,KAAMiB,KACnC,eACeH,IAGT,SAASQ,EAAgBnC,EAAKoC,GAC5B,OAAOzB,EAAEkB,OAAOO,EAAUT,GAAKhB,EAAEuB,QAAQP,EAAEU,OAAQrC,EAAIa,OAGzD,SAASyB,EAAiBD,EAAQD,GAChC,MAAMG,EAAaJ,EAAgBE,EAAQD,GAE3CzB,EAAEY,IAAIgB,EAAYZ,GAAKW,EAAiBX,EAAGS,IAC3CC,EAAOG,SAAW7B,EAAE8B,OAAOF,EAAYG,IAAOA,EAAGjC,UAGnD,MAAMkC,EAAmBhC,EAAE8B,OAAO9B,EAAEkB,OAAOJ,EAAME,GAAgB,GAAXA,EAAExB,OAAawB,IAAMA,EAAElB,UAI7E,SAASmC,EAAmBjB,GAC1B,OAAR,WACehB,EAAEkC,YAAY,CAAClB,EAAGhB,EAAEY,IAAII,EAAEa,SAAUE,GAAME,EAAmBF,MAD5E,GAMM,OAVA/B,EAAEY,IAAIoB,EAAkBhB,GAAKW,EAAiBX,EAAGF,IAOjDA,EAAOd,EAAEmC,QAAQnC,EAAEY,IAAIoB,EAAkBhB,GAAKiB,EAAmBjB,KAG1DF,KCtEyU,I,wBCQlVsB,EAAY,eACd,EACAvD,EACAkB,GACA,EACA,KACA,WACA,MAIa,aAAAqC,E","file":"js/chunk-34d4cb4e.4704cdad.js","sourcesContent":["import mod from \"-!../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CategoryTree.vue?vue&type=style&index=0&id=0d58b384&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CategoryTree.vue?vue&type=style&index=0&id=0d58b384&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',_vm._l((_vm.category_hierarchy),function(cat){return _c('div',{staticStyle:{\"padding\":\"0.1em 0 0.1em 0\"}},[_c('span',{style:('padding-left: ' + cat.depth + 'em')},[(cat.depth > 0)?_c('span',[_vm._v(\"тоб \")]):_vm._e(),_vm._v(_vm._s(cat.subname))]),_c('span',{staticStyle:{\"float\":\"right\"}},[_vm._v(_vm._s(_vm._f(\"friendlyduration\")(cat.duration)))])])}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\ndiv\n  div(v-for=\"cat in category_hierarchy\", style=\"padding: 0.1em 0 0.1em 0\")\n    span(:style=\"'padding-left: ' + cat.depth + 'em'\")\n      span(v-if=\"cat.depth > 0\") тоб&nbsp;\n      | {{cat.subname}}\n    span(style=\"float: right\")\n      | {{cat.duration | friendlyduration}}\n</template>\n\n<style scoped lang=\"scss\">\nsvg {\n    border: 1px solid #999;\n    border-radius: 0.5em;\n}\n</style>\n\n<script>\nconst _ = require('lodash');\nconst classes = require('~/util/classes.ts');\n\nfunction get_parent_cats(cat) {\n  const parents = [];\n  for(let i = 1; i<=cat.length; i++) {\n    parents.push(cat.slice(0, i));\n  }\n  return parents;\n}\n\nexport default {\n  name: \"aw-categorytree\",\n  props: ['events'],\n  computed: {\n    category_hierarchy: function() {\n      const events = JSON.parse(JSON.stringify(this.events));\n\n      const hier = classes.build_category_hierarchy(_.map(events, e => {\n        return { name: e.data[\"$category\"] }\n      }));\n\n      let cats = classes.flatten_category_hierarchy(hier).map(c => {\n        c.duration = _.sumBy(events.filter(e => {\n          const pcat = e.data[\"$category\"].slice(0, c.name.length);\n          return _.isEqual(c.name, pcat);\n        }), e => e.duration);\n        return c;\n      });\n\n      function _get_child_cats(cat, all_cats) {\n        return _.filter(all_cats, c => _.isEqual(c.parent, cat.name))\n      }\n\n      function _assign_children(parent, all_cats) {\n        const child_cats = _get_child_cats(parent, all_cats);\n        // Recurse\n        _.map(child_cats, c => _assign_children(c, all_cats));\n        parent.children = _.sortBy(child_cats, cc => -cc.duration);\n      }\n\n      const cats_with_depth0 = _.sortBy(_.filter(cats, c => c.depth == 0), c => -c.duration);\n      _.map(cats_with_depth0, c => _assign_children(c, cats));\n\n      // Flattens the category hierarchy\n      function _flatten_hierarchy(c) {\n        if(!c.children) return [];\n        return _.flattenDeep([c, _.map(c.children, cc => _flatten_hierarchy(cc))]);\n      }\n      cats = _.flatten(_.map(cats_with_depth0, c => _flatten_hierarchy(c)));\n      //console.log(cats);\n      // TODO: If a category has children, but also activity attributed directly to the parent that does not belong to a child, then create a \"Other\" child containing the activity.\n      return cats;\n    }\n  },\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CategoryTree.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CategoryTree.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CategoryTree.vue?vue&type=template&id=0d58b384&scoped=true&lang=pug&\"\nimport script from \"./CategoryTree.vue?vue&type=script&lang=js&\"\nexport * from \"./CategoryTree.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CategoryTree.vue?vue&type=style&index=0&id=0d58b384&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0d58b384\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}